{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///tick42-glue.min.js","webpack:///webpack/bootstrap bfb50f3ef20a3a10416b","webpack:///./src_js/activity/helpers/util.js","webpack:///./~/callback-registry/lib/index.js","webpack:///./src_js/activity/contracts/entityEvent.js","webpack:///./src_js/windows/store.js","webpack:///./src_js/activity/helpers/logger.js","webpack:///./src_js/app-manager/const/agm-names.js","webpack:///./~/shortid/lib/alphabet.js","webpack:///./src_js/activity/entities/activityEntity.js","webpack:///./src_js/activity/helpers/promiseExtensions.js","webpack:///./src_js/activity/core/activityAGM.js","webpack:///./src_js/activity/entities/activityType.js","webpack:///./src_js/app-manager/helper.js","webpack:///external \"cluster\"","webpack:///external \"crypto\"","webpack:///./src_js/activity/bridges/hcBridge.js","webpack:///./src_js/activity/contracts/activityStatus.js","webpack:///./src_js/activity/entities/activity.js","webpack:///./src_js/activity/entities/activityWindow.js","webpack:///./src_js/activity/entities/windowType.js","webpack:///./src_js/activity/helpers/readyMarker.js","webpack:///./src_js/layouts/layout.js","webpack:///./src_js/layouts/store.js","webpack:///./src_js/layouts/transform.js","webpack:///./src_js/windows/environment/helpers.js","webpack:///./src_js/windows/window.js","webpack:///external \"events\"","webpack:///external \"fs\"","webpack:///external \"http\"","webpack:///external \"https\"","webpack:///external \"path\"","webpack:///external \"stream\"","webpack:///external \"tls\"","webpack:///external \"url\"","webpack:///external \"util\"","webpack:///external \"zlib\"","webpack:///./src_js/glue.js","webpack:///./package.json","webpack:///./~/nanoid/format.js","webpack:///./~/nanoid/random.js","webpack:///./~/object-assign/index.js","webpack:///./~/shortid/index.js","webpack:///./~/shortid/lib/build.js","webpack:///./~/shortid/lib/generate.js","webpack:///./~/shortid/lib/index.js","webpack:///./~/shortid/lib/is-valid.js","webpack:///./~/shortid/lib/random/random-byte.js","webpack:///./~/shortid/lib/random/random-from-seed.js","webpack:///./~/shortid/lib/util/cluster-worker-id.js","webpack:///./~/tick42-glue-core/dist/node/tick42-glue-core.js","webpack:///./~/tick42-promisify/main.js","webpack:///./src_js/activity/API/activityAPI.js","webpack:///./src_js/activity/API/activityManagementAPI.js","webpack:///./src_js/activity/API/activityMyAPI.js","webpack:///./src_js/activity/activityModule.js","webpack:///./src_js/activity/bridges/gw3Bridge.js","webpack:///./src_js/activity/core/activityManager.js","webpack:///./src_js/activity/core/localWindowFactory.js","webpack:///./src_js/activity/entities/attachedActivityDescriptor.js","webpack:///./src_js/activity/helpers/entityObservableCollection.js","webpack:///./src_js/activity/main.js","webpack:///./src_js/app-manager/app-manager.js","webpack:///./src_js/app-manager/application.js","webpack:///./src_js/app-manager/const/event-names.js","webpack:///./src_js/app-manager/data-subscription.js","webpack:///./src_js/app-manager/entitlements.js","webpack:///./src_js/app-manager/instance.js","webpack:///./src_js/app-manager/main.js","webpack:///./src_js/app-manager/snapshot.js","webpack:///./src_js/config.js","webpack:///./src_js/layouts/contextProvider.js","webpack:///./src_js/layouts/layouts.js","webpack:///./src_js/layouts/main.js","webpack:///./src_js/layouts/stream/acsStream.js","webpack:///./src_js/layouts/stream/nullStream.js","webpack:///./src_js/main.js","webpack:///./src_js/utils.js","webpack:///./src_js/windows/environment/detector.js","webpack:///./src_js/windows/environment/gd/executor.js","webpack:///./src_js/windows/environment/gd/gd.js","webpack:///./src_js/windows/environment/hc/executor.js","webpack:///./src_js/windows/environment/hc/hc.js","webpack:///./src_js/windows/group.js","webpack:///./src_js/windows/groups.js","webpack:///./src_js/windows/main.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_12__","__WEBPACK_EXTERNAL_MODULE_13__","__WEBPACK_EXTERNAL_MODULE_25__","__WEBPACK_EXTERNAL_MODULE_26__","__WEBPACK_EXTERNAL_MODULE_27__","__WEBPACK_EXTERNAL_MODULE_28__","__WEBPACK_EXTERNAL_MODULE_29__","__WEBPACK_EXTERNAL_MODULE_30__","__WEBPACK_EXTERNAL_MODULE_31__","__WEBPACK_EXTERNAL_MODULE_32__","__WEBPACK_EXTERNAL_MODULE_33__","__WEBPACK_EXTERNAL_MODULE_34__","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","isNumber","arg","isString","isObject","isArray","Array","toString","isUndefined","isUndefinedOrNull","isEmpty","prop","isFunction","constructor","apply","some","array","predicate","index","length","first","undefined","ifNotUndefined","what","doWithIt","promisify","promise","successCallback","errorCallback","then","createRegistry","options","add","key","callback","callbacksForKey","callbacks","push","allForKey","reduce","acc","element","execute","argumentsArr","_i","arguments","results","forEach","result","err","_handleError","exceptionArtifact","errParam","Error","_userErrorHandler","msg","stack","errorHandling","console","error","clear","__extends","extendStatics","b","setPrototypeOf","__proto__","__","create","EntityEvent","entitiy","context","entity","EntityEventContext","eventType","type","ActivityStatusChangeEventContext","_super","newStatus","oldStatus","_this","EntityEventType","StatusChange","ActivityContextChangedEventContext","ActivityContextChange","JSON","parse","Added","Removed","Updated","Closed","ActivityWindowEvent","ActivityWindowJoinedActivity","ActivityWindowLeftActivity","ActivityState","Created","Started","Destroyed","CallbackFactory","WindowStore","waitForTimeoutInMilliseconds","_windows","_pendingWindows","_pendingWindowsStates","_registry","init","logger","_logger","id","getIfReady","window","API","remote","windowType","ready","urlChanged","remove","setReadyState","windowId","targetWindowState","markReadyToShow","setUrlChangedState","waitFor","Promise","resolve","reject","un","timeout","setTimeout","win","clearTimeout","onReadyWindow","w","onAdded","onRemoved","util","LogLevel","Trace","Debug","Info","Warn","Logger","_name","GlueLogger","_glueLogger","subLogger","GetNamed","Get","owner","GetTypeName","trace","message","Level","info","_getMessage","debug","warn","level","funcNameRegex","exec","ShutdownMethodName","FeedackMethodName","GetConfigurationRegionMethodName","SetConfigurationRegionMethodName","GetUserMethodName","GetBranchesMethodName","GetCurrentBranchMethodName","SetCurrentBranchMethodName","GetFunctionalEntitlementMethodName","CanIMethodName","StartApplicationMethodName","StopApplicationMethodName","ActivateApplicationMethodName","RunApplicationMethodName","OnEventMethodName","GetApplicationsMethodName","reset","shuffled","setCharacters","_alphabet_","alphabet","ORIGINAL","unique","split","filter","item","ind","arr","lastIndexOf","join","characters","setSeed","seed","randomFromSeed","previousSeed","shuffle","characterIndex","sourceArray","targetArray","r","nextValue","Math","floor","splice","getShuffled","lookup","ActivityEntity","_id","_update","other","_updateCore","_beforeDelete","nodeify","resp","nextTick","cb","util_1","ActivityAGM","activity","_activity","register","definition","handler","_ensureHasAgm","AGM","servers","windows","map","instance","methods","methodNames","methodsForWindow","currentWindowMethod","indexOf","methodsForInstance","invoke","methodName","target","success","activityServers","potentialTargets","server","firstElem","_isInstance","_isActivityWindow","unregister","createStream","methodDefinition","subscriptionAddedHandler","subscriptionRemovedHandler","subscriptionRequestHandler","subscribe","parameters","obj","application","activityEntity_1","ActivityType","ownerWindow","helperWindows","description","_description","_ownerWindow","_helperWindows","initiate","configuration","_manager","x","objectValues","source","keys","objectClone","stringify","entityEvent_1","activityStatus_1","activityType_1","windowType_1","activity_1","activityWindow_1","logger_1","readyMarker_1","HCBridge","agm","appManagerGetter","mode","typesToTrack","_activityTypeEntityName","_windowTypeEntityName","_activityEntityName","_windowEntityName","_lastSeq","_eventQueue","_activityTypeCallbacks","_windowTypeCallbacks","_activityCallbacks","_windowCallbacks","_agm","_appManagerGetter","_mode","_typesToTrack","_hcToJsActivityType","hcActType","ownerWindowType","helperWindowTypes","_getURLParameter","decodeURIComponent","RegExp","location","search","replace","joinActivity","activityId","leaveActivity","_readyMarker","ReadyMarker","_htmlContainer","htmlContainer","activityFacade","subscribeForJoinBreakEvents","e","_handleGenericEvents","initFunc","init2","jsAgmInstance","glueVersion","_hcEventHandler","bind","signal","initReady","setCallback","getError","event","_processEventBySeq","eventJson","seq","sequence","_processEvent","nextEvent","genericEvent","_processGenericEvent","entityType","eventContext","_convertContext","_publishActivityTypeStatusChange","_hcToJsWindowType","_publishWindowTypeStatusChange","_hcToJsActivity","_publishActivityStatusChange","_hcToJsWindow","_publishActivityWindowEvent","data","_activitiesAttachedHandler","_activitiesDetached","_activityAttachedDescriptorsRefreshed","hcContext","ActivityStatus","state","statusMessage","statusTime","newContext","hcAct","status","hcWinType","factories","_appByWindowTypeGetter","wt","applications","app","activityWindowType","getActivityTypes","infos","registerActivityType","activityTypeName","layoutConfig","config","newActivityType","unregisterActivityType","getWindowTypes","registerWindowFactory","windowTypeName","initiateActivity","activityType","getAnnouncementInfo","hc","getContext","activityWindowId","activityWindowIndependent","activityWindowName","announceWindow","getActivities","activitiesStr","activities","act","updateActivityContext","fullReplace","removedKeys","setActivityContext","newContextString","getActivityWindows","getWindows","wind","stopActivity","unregisterWindowFactory","createWindow","windowDefinition","objToSend","functionToUse","createWindow2","newId","createStackedWindows","windowDefinitions","createStackedWindows2","onActivityTypeStatusChange","onWindowTypeStatusChange","onActivityStatusChange","onActivityWindowChange","getWindowBounds","bounds","setWindowBounds","registerWindow","independent","closeWindow","activateWindow","focus","setWindowVisibility","visible","cloneActivity","_publishStatusChange","entityEvent","at","attachActivities","from","to","tag","detachActivities","newActivityInfo","newActivityId","onActivitiesAttached","onActivitiesDetached","onActivityAttachedDescriptorsRefreshed","getAttachedDescriptors","hcWindow","windowGetter","hcWindowId","list","isIndependent","time","getState","getMessage","getTime","activityAGM_1","attachedActivityDescriptor_1","promiseExtensions_1","Activity","actType","ownerId","_actType","_status","_context","_ownerId","getActivityType","addWindow","addWindowToActivity","windowTypes","leave","leaveWindowFromActivity","getWindowsByType","setContext","updateContext","onStatusChange","subscribeActivityEvents","a","ns","os","onWindowEvent","subscribeWindowEvents","onContextChanged","subscribeActivityContextChanged","stop","clone","attach","onActivityAttached","subscribeActivitiesAttached","newActId","oldActId","descriptor","onDetached","subscribeActivitiesDetached","newAct","originalActivity","_updateDescriptors","allStates","_attached","AttachedActivityDescriptor","setFrameColor","color","callbacksToWait","underlyingWindow","getFrameColor","frameColor","ActivityWindow","_type","_activityId","_instance","_isIndependent","_windowGetter","_hcWindowId","getBounds","getWindowType","getActivityById","setVisible","isVisible","activate","setBounds","close","onActivityJoined","_subscribeForActivityWindowEvent","onActivityRemoved","eventName","WindowType","appByWindowTypeGetter","assign","signalsToWait","_signals","_callbacks","isSet","isError","_error","LayoutImpl","components","LayoutStore","layouts","removeWhere","condition","where","transformACSLayout","something","initial","accumulator","current","convertedValue","toLowerCase","substr","getWindowsByTabGroupId","tabGroupId","store_1","memo","callback_registry_1","executor","resultWindow","navigate","newUrl","_url","onUrlChanged","url","setStyle","style","setTitle","newTitle","moveResize","dimensions","areHeightsEqual","height","_bounds","areWidthsEqual","width","areLeftsEqual","left","areTopsEqual","top","onBoundsChanged","addFrameButton","buttonInfo","buttonId","imageBase64","removeFrameButton","maximizeRestore","currEvent","_windowState","onMaximized","onNormal","maximize","restore","minimize","onMinimized","collapse","isCollapsed","onCollapsed","expand","onExpanded","toggleCollapse","snap","direction","attachTab","tab","sourceWindowId","targetWindowId","errorMessage","argsForSend","sourceWin","onAttached","detachTab","opt","_options","relativeTo","relativeDirection","hideTabHeader","visibilityChangeHeard","detachedHeard","unVisibility","isVisibilityCorrect","isTabHeaderVisible","unDetached","toBeVisible","_isVisible","onVisibilityChanged","showLoader","loader","hideLoader","lock","unlock","getIcon","icon","setIcon","base64Image","setTabHeaderVisible","toBeTabHeaderVisible","_isTabHeaderVisible","onTabHeaderVisibilityChanged","onTitleChanged","title","onClose","onFrameButtonAdded","onFrameButtonRemoved","onFrameButtonClicked","onContextUpdated","onLockingChanged","onFocusChanged","onFrameColorChanged","onWindowAttached","onWindowDetached","onGroupChanged","onTabSelectionChanged","handleTitleChanged","_title","handleUrlChanged","handleVisibilityChanged","handleWindowSettingsChanged","settings","_settings","handleContextUpdated","handleWindowClose","handleFrameButtonAdded","frameButton","buttonObj","k","_frameButtons","btn","handleFrameButtonRemoved","frameButtonId","button","handleFrameButtonClicked","handleWindowChangeState","handleFrameIsLockedChanged","isLocked","_isLocked","handleBoundsChanged","handleFocusChanged","isFocused","_focus","handleFrameColorChanged","_frameColor","handleFrameAttached","_tabGroupId","handleCompositionChanged","neighbours","groupId","_neighbours","_groupId","handleGroupHeaderVisibilityChanged","isGroupHeaderVisible","_isGroupHeaderVisible","handleTabHeaderVisibilityChanged","handleFrameSelectionChanged","newWindow","prevWindow","selectedWindow","_isTabSelected","previousWindow","un_1","newWin","prevWin","handleAttached","newTabGroupId","tabHeaderVisible","handleWindowAttached","handleDetached","handleWindowDetached","handleGroupChanged","newGroup","oldGroup","_group","handleGroupAssociation","group","getAllTabs","allWindows","mapWindowIdsToWindowObjects","windowIdArr","winId","getNeighboursByDirection","windowIds","getApplicationName","_APPLICATION_NAME","_t42","getWindowInfo","applicationName","glue42gd","isTabSelected","appManager","hostInstance","agmInstance","appName","windowStyleAttributes","frameButtons","opened","topNeighbours","leftNeighbours","rightNeighbours","bottomNeighbours","tabs","Events","tick42_glue_core_1","main_1","main_2","main_3","main_4","pjson","config_1","utils_1","createWindows","core","glueConfig","windowsLogger","getLibLogger","_appManager","gdMajorVersion","debugLog","createActivities","ActivityModule","checkIsUsingGW3Implementation","connection","activityLogger","contexts","logLevel","disableAutoAnnounce","disposeRequestHandling","announcementInfo","activityInfo","api","createAppManager","createLayouts","lay","activityGetter","loggerName","newLogger","loggerConfig","consoleLevel","publish","publishLevel","metrics","metricsLevel","entry","currentLog","getGDMajorVersion","gateway","ext","libs","version","enrichGlue","glue","glueFactoryLog","main","browser","types","docName","scripts","init-dev-mode","remove-installed-dependencies","clean","file-versionify","pre:build","tslint","tslint:fix","watch","build:dev","prepublish","build:prod","test","test:only","generate-docs","repository","author","license","dependencies","callback-registry","es6-promise","object-assign","shortid","tick42-glue-core","tick42-promisify","devDependencies","@types/object-assign","@types/shortid","@types/node","chai","glue-js-documentation-builder","mocha","onchange","pre-commit","readline-sync","shelljs","tick42-gateway","tick42-webpack-config","typescript","webpack","bundleDependencies","random","size","mask","log","LN2","step","ceil","bytes","byte","crypto","randomFillSync","buffers","buffer","Buffer","allocUnsafe","randomBytes","toObject","val","TypeError","getOwnPropertySymbols","propIsEnumerable","propertyIsEnumerable","test1","String","getOwnPropertyNames","test2","fromCharCode","test3","letter","symbols","build","clusterWorkerId","str","seconds","Date","now","REDUCE_TIME","previousSeconds","counter","generate","number","done","loopCounter","format","pow","seedValue","worker","workerId","newCharacters","isValid","isShortId","getNextValue","_seed_","cluster","clusterId","isMaster","parseInt","NODE_ENV","NODE_UNIQUE_ID","__WEBPACK_EXTERNAL_MODULE_3__","__WEBPACK_EXTERNAL_MODULE_6__","__WEBPACK_EXTERNAL_MODULE_114__","__WEBPACK_EXTERNAL_MODULE_115__","__WEBPACK_EXTERNAL_MODULE_116__","__WEBPACK_EXTERNAL_MODULE_117__","__WEBPACK_EXTERNAL_MODULE_118__","__WEBPACK_EXTERNAL_MODULE_119__","DEFAULT","STRING","NUMBER","COUNT","RATE","STATISTICS","TIMESTAMP","ADDRESS","TIMESPAN","OBJECT","validate","parent","transport","PerMessageDeflate","isServer","_isServer","_inflate","_deflate","params","zlib","AVAILABLE_WINDOW_BITS","extensionName","offer","serverNoContextTakeover","server_no_context_takeover","clientNoContextTakeover","client_no_context_takeover","serverMaxWindowBits","server_max_window_bits","clientMaxWindowBits","client_max_window_bits","accept","paramsList","normalizeParams","acceptAsServer","acceptAsClient","accepted","decompress","fin","onError","cleanup","onData","self","removeListener","endpoint","maxWindowBits","createInflateRaw","windowBits","on","write","flush","concat","compress","createDeflateRaw","Z_SYNC_FLUSH","memLevel","slice","default_1","ServerSubscription","protocol","repoMethod","subscription","stream","branchKey","closeSingleSubscription","pushDataToSingle","ContextMessageReplaySpec","GW_MESSAGE_CREATE_CONTEXT","GW_MESSAGE_ACTIVITY_CREATED","GW_MESSAGE_ACTIVITY_DESTROYED","GW_MESSAGE_CONTEXT_CREATED","GW_MESSAGE_CONTEXT_ADDED","GW_MESSAGE_SUBSCRIBE_CONTEXT","GW_MESSAGE_SUBSCRIBED_CONTEXT","GW_MESSAGE_UNSUBSCRIBE_CONTEXT","GW_MESSAGE_DESTROY_CONTEXT","GW_MESSAGE_CONTEXT_DESTROYED","GW_MESSAGE_UPDATE_CONTEXT","GW_MESSAGE_CONTEXT_UPDATED","GW_MESSAGE_JOINED_ACTIVITY","Utils","glueDesktop","ver","Number","isNaN","isNode","global","process","docs","test:core","test:agm","util-deprecate","ws","archiver","babel-core","babel-loader","babel-plugin-add-module-exports","babel-preset-es2015","babel-preset-stage-2","deep-equal","webpackEmptyContext","req","__filename","bindings","opts","defaults","module_root","getRoot","getFileName","path","extname","tries","code","arrow","fs","dirname","exists","existsSync","NODE_BINDINGS_ARROW","compiled","NODE_BINDINGS_COMPILED_DIR","platform","arch","versions","node","try","calling_file","fileName","origPST","prepareStackTrace","origSTL","stackTraceLimit","dummy","st","captureStackTrace","file","prev","dir","cwd","Options","internalValues","values","merge","required","missing","copy","read","filename","readFile","conf","readFileSync","isDefined","isDefinedAndNonNull","freeze","isValidErrorCode","1000","1001","1002","1003","1004","1005","1006","1007","1008","1009","1010","1011","extensions","v","token","shift","trim","parsedParams","param","parts","Receiver","fragmentedPoolPrevUsed","fragmentedBufferPool","BufferPool","db","used","unfragmentedPoolPrevUsed","unfragmentedBufferPool","activeFragmentedOperation","lastFragment","masked","opcode","fragmentedOperation","overflow","headerBuffer","expectOffset","expectBuffer","expectHandler","currentMessage","messageHandlers","expectHeader","processPacket","dead","processing","onerror","ontext","onbinary","onclose","onping","onpong","readUInt16BE","start","readUInt32BE","fastCopy","srcBuffer","dstBuffer","dstOffset","cloned","Validation","ErrorCodes","bufferUtil","BufferUtil","dataLength","toRead","min","bufferForHandler","fromOverflow","pop","expectData","allocateFromPool","isFragmented","compressed","opcodes","endPacket","unmask","buf","binary","concatBuffers","mergedBuffer","reason","protocolErrorCode","applyExtensions","messageBuffer","1","firstLength","getData","finish","packet","isValidUTF8","2","8","9","10","Sender","socket","events","EventEmitter","_socket","firstFragment","writeUInt16BE","offset","writeUInt32BE","getArrayBuffer","Uint8Array","byteLength","byteOffset","getRandomMask","inherits","dataBuffer","frameAndSend","ping","pong","send","finalFragment","compressFragment","emit","maskData","canModifyData","isBuffer","dataOffset","secondByte","mergeBuffers","totalLength","outputBuffer","_randomMask","WebSocket","address","protocols","_ultron","_closeReceived","bytesReceived","readyState","supports","initAsServerClient","initAsClient","MessageEvent","dataArg","typeArg","CloseEvent","wasClean","OpenEvent","upgradeHead","protocolVersion","upgradeReq","CONNECTING","establishConnection","ReceiverHixie","SenderHixie","origin","host","headers","agent","pfx","passphrase","cert","ca","ciphers","rejectUnauthorized","perMessageDeflate","serverUrl","isUnixSocket","isSecure","httpObj","https","http","port","auth","extensionsOffer","shasum","createHash","update","expectedServerKey","digest","headerHost","hostname","requestOptions","Connection","Upgrade","Host","Sec-WebSocket-Version","Sec-WebSocket-Key","Authorization","header","Extensions","Agent","socketPath","pathname","Origin","request","cleanupWebsocketResources","once","res","statusCode","abort","CLOSED","removeAllListeners","end","serverKey","serverProt","protList","protError","serverExtensions","ReceiverClass","SenderClass","firstHandler","OPEN","CLOSING","head","_receiver","dataHandler","realHandler","ultron","Ultron","setNoDelay","flags","errorCode","_sender","startQueue","_queue","executeQueueSends","queue","sendStream","emitClose","_closeTimer","_closeCode","_closeMessage","destroy","terminate","pause","dontFailWhenClosed","resume","ArrayBuffer","Uint16Array","Uint32Array","Int8Array","Int16Array","Int32Array","Float32Array","Float64Array","readable","Readable","Stream","final","amount","bufferSize","method","listener","listeners","_listener","set","addEventListener","onMessage","onOpen","ConnectionImpl","ids","registry","_connected","_protocol","_transport","onConnectedChanged","handleConnectionChanged","handleTransportMessage","product","isObjectBasedTransport","createObjectMessage","sendObject","strMessage","createStringMessage","messageHandler","off","connected","disconnected","login","authRequest","open","logout","loggedIn","toAPI","that","distributeMessage","handlers","handlerId","msgObj","processStringMessage","processObjectMessage","msgType","dummyConnection_1","timer_1","dummyConnection_2","main_5","contextMessageReplaySpec_1","main_6","GlueCore","userConfig","registerLib","inner","t","initStartTime","startTime","initTime","initEndTime","endTime","setupConnection","initTimer","internalConfig","_connection","authPromise","getGWToken","gatewayToken","authConfig","identity","machine","user","setupMetrics","_rootMetrics","_metrics","subSystem","_featureMetric_1","reportingSystem_1","def_1","conflation","featureMetric","action","payload","objectMetric","setupAGM","agmConfig","forceGW","force","gdVersion","agmLib","setupContexts","hasActivities","_contexts","ContextsModule","replayer","drain","setupChannels","_channels","setupExternalLibs","externalLibs","lib","setupExternalLib","createCallback","waitForLibs","libsReadyPromises","all","constructGlueObject","feedbackFunc","glueInitTimer","feedback","performance","timing","toJSON","memory","initTimes","period","perfDataNeeded","updatePerfData","delay","perfDataDelay","extOptions","getConnection","setupLogger","output","maskNum","readUInt32LE","num","writeUInt32LE","ee","has","fn","__ultron","args","_events","j","WS","Server","createServer","connect","createConnection","client","initialSize","growStrategy","shrinkStrategy","_growStrategy","_shrinkStrategy","_buffer","_offset","_used","_changeFactor","__defineGetter__","newBuf","forceNewBuffer","len","EMPTY","messageEnd","spanLength","bufferIndex","BODY","BINARYLENGTH","BINARYBODY","dataleft","outputIndex","bi","bl","lastBuffer","tail","continuationFrame","isClosed","lengthbytes","writeStartMarker","writeEndMarker","WebSocketServer","verifyClient","handleProtocols","noServer","disableHixie","clientTracking","_server","writeHead","Content-Type","listen","_closeServer","_webSocketPaths","handleUpgrade","clients","handleHybiUpgrade","errorHandler","abortConnection","completeHybiUpgrade2","acceptExtensions","completeHybiUpgrade1","callbackCalled","secure","authorized","encrypted","STATUS_CODES","handleHixieUpgrade","onClientVerified","wshost","completeHandshake","nonce","rest","k1","k2","md5","spaces","hashBuffer","handshakeBuffer","received","response","u","upgrade","client_1","server_1","AGMImpl","clientRepository","serverRepository","serverRemoved","serverAdded","serverMethodRemoved","serverMethodAdded","methodRemoved","methodAdded","methodFilter","streamDef","registerAsync","argumentObj","additionalOptions","updateInstance","newInstance","MachineName","UserName","environment","Environment","region","Region","invoke_1","promisify_1","Client","repo","clientInvocations","callProtocolSubscribe","targetServers","successProxy","errorProxy","methodResponseTimeout","waitTimeoutMs","methodDef","sub","method_response_timeout","wait_for_method_timeout","delayTillNow","currentServers","getServerMethodsByFilterAndTarget","retry_1","streamInfo","def","getInfoForUser","protocolState","getServers","serverMethodMap","getMethods","getMethodsForInstance","onMethodAdded","onMethodRemoved","onServerAdded","onServerRemoved","onServerMethodAdded","onServerMethodRemoved","methodResponseTimeoutMs","serversMethodMap","invokeUnExisting","serverMethodPair","invokeOnAll","callError","called_with","executed_by","returned","delayTillNow_1","retry_2","serverMethodsMap","successes","errors","sendResponse","result_1","invResult","all_return_values","all_errors","currentError","serverMethodsPair","filterByTarget","targetServerMethod","matchingMachine","matches","myMatches","instanceMatch","instanceFilter","instanceDefinition","containsProps","methodMatch","match","allServers","matchingServers","resultMethodsObject","methodKey","methodsForServer","getServerMethodsById","matchingMethods","random_1","ClientInvocations","_pendingCallbacks","onInvocationResult","invocationId","executedBy","resultMessage","processInvocationResult","argumentsObj","stuff","registerInvocation","calledWith","invocationInfo","ClientRepository","methodsCount","addServer","serverId","serverEntry","serverInfo","createUserServerInfo","getStreams","supportsStreaming","removeServerById","methodId","removeServerMethod","addServerMethod","createMethodId","methodEntity","createUserMethodInfo","getServersByMethod","methodInfo","accepts","returns","allMethods","unsubscribeFunc","getServerById","pid","peerId","displayName","objectTypes","object_types","display_name","NativeAGM","helpers","agmFacade","methodInfoAsObject","stringToObject","validateMethodInfo","caller","methodResult","tracker","successArgs","targetArgToObject","invoke2","parsed","createStream2","subscribe2","jsonResult","agmParse","transformServerObject","transformMethodObject","subscribed","Helpers","facade","dateTimeIdentifier","jsonValueDatePrefix","lenOfIdentifier","unixTimestampMs","parseFloat","convertInstanceToRegex","serverFilter","instanceConverted","propValue","stringPropName","jsAgmFacade","cfgAsString","createConfig","successInit","nativeAGM","agm_1","helpers_1","create_stream","methods_for_instance","method_added","method_removed","server_added","server_removed","server_method_added","server_method_removed","initAsync","metricsIdentity","metricsConfig","createOwnInstance","userSubmittedProperties","resolvedIdentity","document","instance_1","native_1","factory_1","repository_1","repository_2","protocolPromise","agmImpl","myIdentity","myInstance","STATUS_AWAITING_ACCEPT","STATUS_SUBSCRIBED","ERR_MSG_SUB_REJECTED","ClientStreaming","session","subscriptionsList","subscriptionIdToLocalKeyMap","nextSubLocalKey","handleErrorSubscribing","errorResponse","_tag","subLocalKey","pendingSub","trackedServers","timeoutId","callArgs","callOnClosedHandlers","handleSubscribed","acceptingServer","subscriptionId","subscription_id","isFirstResponse","dataCallback","queued","dataItem","onClosed","closedCallback","onFailed","closeSubscription","requestArguments","serverInstance","handleEventData","trackedServersFound","isPrivateData","oob","snapshot","sendingServerId","receivedStreamData","private","onDataHandlers","queuedData","handleSubscriptionCancelled","expectedNewLength","closers","streamingMethod","ERR_MSG_SUB_FAILED","getNextSubscriptionLocalKey","registerSubscription","server_id","method_id","arguments_kv","closersCount","closingServerId","closingServer","sendFireAndForget","reason_uri","client_streaming_1","ClientProtocol","handlePeerAdded","handlePeerRemoved","handleMethodsAddedMessage","handleMethodsRemovedMessage","streaming","handleResultMessage","handleInvocationError","newPeerId","new_peer_id","remoteId","removedPeerId","removed_id","input_signature","result_signature","methodIdList","libConfig","getAGM","handleReconnect","registeredMethods","getList","theFunction","userCallback","userCallbackAsync","handleInitialJoin","resolveReadyPromise","readyPromise","domain","onJoined","reconnect","ServerStreaming","ERR_URI_SUBSCRIPTION_FAILED","nextStreamId","handleAddInterest","handleRemoveInterest","acceptRequestOnBranch","requestContext","branch","subscriptionsMap","branchKeyToStreamIdMap","streamId","getStreamId","subscribeMsg","stream_id","rejectRequest","sendSubscriptionFailed","pushData","branches","br","Boolean","publishMessage","postMessage","dropSubscriptionMessage","closeMultipleSubscriptions","subscriptionsToClose","drop","getSubscriptionList","allSubscriptions","getBranchList","keysWithDuplicates","seen","bKey","onSubAdded","onSubscriptionLifetimeEvent","onSubRequest","onSubRemoved","getById","handlerFunc","getNextStreamId","caller_id","errorMsg","request_id","needleBranch","server_streaming_1","ServerProtocol","handleInvokeMessage","isStreaming","registrationCallbacks","fail","registerMsg","repoId","restrictions","handleRegisteredMessage","handleErrorRegister","onInvoked","methodInvocationResult","peer_id","invocation_id","closeAllSubscriptions","callerId","methodList","invocationArgs","subscription_1","ServerBranch","subscriptions","ServerRepository","nextId","Request","acceptOnBranch","streaming_1","stream_1","invocations","onMethodInvoked","wrappedCallbackFunction","resultCallback","registerCore","wrappedCallback","streamCallbacks","streamFrontObject","methodToExecute","_result","branch_1","ServerStream","bList","def2","request_1","rc","rm","handleSubRequest","handleSubAdded","handleSubRemoved","channels","swId","command","channel","__awaiter","thisArg","_arguments","P","generator","fulfilled","next","rejected","__generator","body","verb","op","f","_","y","label","ops","trys","g","sent","throw","return","Symbol","iterator","ChannelsImpl","shared","subsKey","changedKey","currentContext","switchChannel","unsubscribe","changed","meta","_a","onChannelAdded","onChannelRemoved","apps","channelId","SharedContextSubscriber","sharedContextName","_b","createContextName","allContexts","startsWith","sharedContexts","contexts_1","channels_1","getApplication","getConfigProp","prop1","prop2","masterConfigProp1","masterConfig","userProp1","dynamicDefaultsProp1","dynamicDefaults","hardDefaultsProp1","hardDefaults","ifNotFalse","uid","shortid_1","GLUE_CONFIG","GLUE_DEFAULT_CONFIG","containerName","browserWindowName","agm_application","documentTitle","system","service","metricsFacade","getIdentity","machineName","defaultProtocol","defaultWs","gwURL","reconnectInterval","gwConfig","reconnectAttempts","inproc","replaySpecs","gw","connection_1","messageReplayer_1","GW3ConnectionImpl","MessageReplayerImpl","gw3Protocol","superAPI","availableDomains","authToken","successMessages","errorMessages","gw3_1","hc_1","ws_1","gw3Connection_1","hc_2","inproc_1","gw3Connection","gw3Port","specs","specsNames","messages","subs","subsRefCount","specs_1","spec","name_1","this_1","_c","refCount","processMessage","isDone","name_2","dateMinLen","datePrefixFirstChar","substring","datePrefixLen","datePrefix","milliseconds","ex","oldToJson","loginConfig","username","password","shouldTryLogin","authentication","secret","helloMsg","globalDomain","gw3Domain_1","sendOptions","skipPeerId","initialLogin","retryInterval","maxRetries","resolved_identity","available_domains","access_token","setLoggedIn","pingTimer","sessions","isLoggedIn","domainName","domainLogger","handleDisconnected","initialLoginAttempts","createTokenReq","_latestOptions","isJoined","joinPromise","_connectionOn","destination","handleJoined","wasReconnect","tryReconnecting","handleConnectionDisconnected","handleConnectionLoggedIn","onLeft","handleErrorMessage","requestId","requestsMap","handleSuccessMessage","getNextRequestId","successMsg","callbackRegistry","sm","HCProtocol","messageObj","HCTransport","connectionId","loggingFacade","Inproc","gwToken","connectToken","_running","_initied","waitForSocketConnection","_ws","initiateSocket","notifyStatusChanged","onopen","onmessage","failed","retriesLeft","retries","gw3ContextData_1","GW3Bridge","_contextNameToData","_gw3Subscriptions","_nextCallbackSubscriptionNumber","_contextNameToId","_contextIdToName","_gw3Session","subscribeToContextCreatedMessages","subscribeToContextUpdatedMessages","subscribeToContextDestroyedMessages","handleContextCreatedMessage","handleContextUpdatedMessage","handleContextDestroyedMessage","dispose","contextName","createContext","lifetime","createContextMsg","context_id","contextData","GW3ContextData","isAnnounced","contextId","sentExplicitSubscription","invokeUpdateCallbacks","delta","calculatedDelta","calculateContextDelta","added","updated","removed","handleUpdated","thisCallbackSubscriptionNumber","updateCallbacks","hadCallbacks","hasCallbacks","joinedActivity","sendSubscribe","subscriptionKey","sendUnsubscribe","oldContext","applyContextDelta","deepEqual","createdMessageTypes","createdMessageTypes_1","createdMessageType","contextCreatedMsg","activity_id","updatedMessageTypes","updatedMessageTypes_1","updatedMessageType","contextUpdatedMsg","justSeen","context_snapshot","updateCallbackIndex","updateCallback","deepClone","destroyedMessageTypes","destroyedMessageTypes_1","destroyedMessageType","destroyedMsg","_facade","sharedContextFacade","allObj","gw3Bridge_1","hcBridge_1","_bridge","checkName","__assign","added_1","updated_1","mergeObjectsProperties","hash","WeakMap","Set","Map","withWhat","right","contextsModule_1","canPublish","restriction","order","levels_1","LoggerImpl","metricSystem","_subloggers","_parent","_path","_loggerFullName","existingSub","_publishLevel","_consoleLevel","metricsSystem","_metricLevel","_metricSystem","toAPIObject","toPrint","GetConnection","Instance","Message","Time","setState","identityStr","mainLogger","glue_1","addressMetric","newValue","_value","updateMetric","me","getValueType","resolution","metric_types_1","createMetric","countMetric","incrementBy","increment","decrement","decrementBy","numberMetric","mergeValues","rateMetric","statisticsMetric","stringMetric","timespanMetric","timestampMetric","sendFull","subSystems","sendFullSystem","createSystem","metric","heartbeat","publishingInterval","heartbeatInterval","updateSystem","serializer_1","instanceInfo","setInterval","metricToMessage","getMetricDefinition","_definition","getTypeFromValue","Composite","serializeValue","_metric","_valueTypes","valueOf","CompositeValue","InnerMetricName","valueType","rootStateMetric","composite","Description","Value","defineRootMetricsMsg","replayRepo","replaySystem","ss","normalizeMetricName","createMetricsMsg","shadowedUpdateMetric","timestamp","stateObj","composeMsgForRootStateMetric","rootMetric","serializeMetric","getMetricValueByType","publishMetricsMsg","getMetricTypeByValue","getTypeByValue","serializedMetrics","innerType","defineNestedComposite","publishNestedComposite","flatten","flat","toFlatten","getHighestState","sort","aggregateDescription","idx","aggregatedState","getAggregateState","merged","highestState","gw1_1","clickStream","_root","system_1","rootSystem","useClickStream","navigator","userAgent","clickStream_1","documentClickHandler","className","tagName","href","page","attachEvent","urlMetric","appNameMetric","startUrl","nameSystem","descriptionSystem","_subSystems","_system","_repo","stateDescription","_state","_getOrCreateMetric","metricDef","string_1","number_1","count_1","address_1","object_1","timespan_1","timestamp_1","rate_1","statistics_1","_unionToMetricDef","metricDefinition","expectedType","matching","shadowedMetric","existing","_buildPath","shadowedSystem","aggState","shadowedSubSystem","separator","activityManagementAPI_1","ActivityAPI","manager","my","_mgr","_my","ActivityManagementAPI","aware","inActivity","getAvailableFrameColors","frameColors","getFrameColors","_m","activityTypes","_getActivityTypesWrapper","subscribeActivityTypeEvents","_getWindowTypesWrapper","registerFactory","unregisterFactory","subscribeWindowTypeEvents","announce","instances","onActivityFrameColorChanged","subscribeActivityFrameColorChanged","ActivityMy","_myAttached","_myDetached","_myAttachedTo","_myDetachedFrom","_myActivityFrameColorChanged","_myActivityJoinedCallbacks","_myActivityRemovedCallbacks","_myContextUpdateCallbacks","am","_subscribeMyContextChanged","_subscribeMyWindowEvent","_subscribeActivitiesAttached","_subscribeActivitiesDetached","onWindowFrameColorChanged","_subscribeWindowFrameColorChanged","_w","announcedWindows","myWin","onActivityLeft","onActivityDetached","onAttachedToActivity","onDetachedFromActivity","attached","myActivity","_notifyMyContextChanged","_notifyMyWindowEvent","callbackStore","_notifyAttached","_notifyDetached","_notifyAttachedTo","_notifyDetachedFrom","detached","oldAct","activityMyAPI_1","activityManager_1","activityAPI_1","bridge","_isUsingHCImplementation","_isUsingGW3Implementation","activityManager","_api","_readyPromise","_activityChangeCallbacks","_activityTypeStatusChangeCallbacks","_activityWindowChangeCallbacks","_windowTypeStatusChangeCallbacks","_peerIdAndFactoryIdToPeerType","_peerFactoriesRegisteredByUs","_contextSubscriptions","_activityTypesInitiatedFromMe","_config","_sessionJoinedPromise","_sessionJoinedPromiseResolve","_activityJoinedPromise","_activityJoinedPromiseResolve","activityTypeGwMessageEntityToActivityType","nameToWindowType","windowName","owner_type","helper_types","peerFactoryGwMessageEntityToWindowType","peer_type","activityGwMessageToActivity","activity_type","activityToActivityStatusChangeEvent","forwardActivityTypeMessagesToStatusEventHandlers","handleActivityCreatedMessage","handleActivityDestroyedMessage","forwardActivityMessagesToStatusEventHandlers","forwardActivityCreatedAndJoinedActivityToActivityWindowEventHandlers","forwardPeerFactoryMessagesToStatusEventHandlers","forwardPeerFactoryMessagesToPeerFactoryRequests","handlePeerFactoriesAdded","handlePeerFactoriesRemoved","forwardActivityWindowMessagesToEventHandlers","exit","activity_types","toActivityPeerConfig","invokeCallbacks","factory_ids","initiateMsg","initial_context","isOverrideTypeDefinition","types_override","wd","sendCreateAndMapResultingMessagesToPromise","initMsg","removedKeys_1","shouldSendReady","generateWindowGetter","layout","cellSize","created_id","destroy_peer_id","URLSearchParams","searchParams","target_id","cloneOptions","into","getRandomRequestId","forwardAddedAndRemovedMessagesToEventHandler","addedMessageType","removedMessageType","mapper","sub1","sub2","getGetEntityEvent","isAdded","forwardMessageToEventHandler","messageType","getEntityEvent","ent","h","initiatedMessageType","initiatedMessageFilter","createdMessageFilter","cancelledMessageType","cancelledMessageFilter","createdMessageToPromiseResolution","resolveCreatedPromise","rejectCreatedPromise","initiatedSubscription","createdSubscription","cancelledSubscription","errorSubscription","reqId","createdPromise","initiatedMessageAck","dropSubscriptions","dropSubscription","msg4","msg1","msg2","msg3","toReturn","peerFactoryIdAndOwnerIdToWindowType","factoryId","peerType","subscribeToContext","unsubscribeContext","owner_id","activityCreatedMessage","participants","createdMessage","peer_factory","gateway_token","joinedMessage","joinedId","joined_id","joinedType","joined_type","joinedName","joined_name","peer_name","left_id","entityObservableCollection_1","localWindowFactory_1","entityEvent_2","ActivityManager","autoAnnounce","_announcedWindows","_attachedCallbacks","_detachedCallbacks","_frameColorChangesCallbacks","_activityTypes","EntityObservableCollection","_grabEntity","_windowTypes","_activities","_dataReadyMarker","_descriptorsMarker","dataErr","errCatch","refreshDescriptors","_handleActivitiesAttached","_handleActivitiesDetached","_handleActivityDescriptorsRefreshed","_handleWindowFrameColorChanged","_subscribeForData","aw","_getInitialData","bridgeType","getByName","ownerDefinition","helperDefinitions","actId","getOrWait","factoryMethod","getName","LocalWindowFactory","currentWindow","windowEventHandler_1","unsubscribeWindowEvents","window_1","windowTypeOrConfiguration","relativeToWindow","wid","relativeWindowTypes","relativeWindows","useExisting","activityWindows","alreadyCreated","removedKey","descriptors","stateWrapped","ac","descriptorAsObjectFromAPI","oldActivityId","createFunction","ownerActivityId","_ownerActivityId","detach","processNew","_items","_listeners","_processNew","addOne","items","internalEntity","_updateInternalCollections","_notifyListeners","entityAddedHandler","entityAsAny","isActivityDestroy","isWindowClose","oldEntity","activityModule_1","application_1","AppManagerImpl","_gdMajorVersion","_apps","_instances","getMyInstance","instanceId_1","appInstanceId","myWindowId_1","matchingInstances","isActivityInstance","handleAppAdded","props","_getAppId","_updateAppFromProps","handleAppUpdated","handleAppRemoved","handleAppReady","_getAppOrThrow","updateFromProps","available","handleInstanceStarted","Name","Id","_getInstanceId","_getInstanceAppName","_updateInstanceFromProps","handleInstanceStopped","_getInstanceOrThrow","_matchInstance","handleInstanceAgmServerReady","updateAgmInstanceFromProps","handleInstanceStartFailed","handleInstanceUpdated","onInstanceStarted","_replay","onInstanceStartFailed","onInstanceStopped","onInstanceUpdated","onInstanceAgmServerReady","onAppAdded","onAppRemoved","onAppAvailable","onAppUnavailable","onAppChanged","_getInstanceByIdAndName","itemsToReplay","itemsToReplayArr","AgmNames","helper_1","ApplicationImpl","_props","Title","Version","AutoStart","IsShell","Caption","IsHidden","ApplicationName","ActivityWindowType","Arguments","AllowMultiple","IsReady","Icon","IconUrl","SortOrder","UserProperties","autoStart","caption","hidden","container","allowMultiple","Type","Mode","isActivity","styleAttributes","WindowStyleAttributes","modeIndex","startModeIndex","stopModeIndex","createWindowArgs","waitForAGMReady","waitForAGMInstance","waitForInstance","waitForApplicationInstance","unsub","check","filtered","waitFunc","Context","WaitForAgmInstance","WaitForInstance","acsResult","Instance_0","onAvailable","onUnavailable","onChanged","OnNotificationEvent","OnBranchChangedEvent","OnBranchesModifiedEvent","OnApplicationAddedEvent","OnApplicationRemovedEvent","OnApplicationChangedEvent","OnApplicationReadyEvent","OnApplicationStartedEvent","OnApplicationRegisteredEvent","OnApplicationAgmServerReadyEvent","OnApplicationUpdatedEvent","OnApplicationStoppedEvent","OnApplicationStartFailedEvent","createDataSubscription","entitlements","skipIcons","resolveFunc","rejectFunc","resultPromise","skipIcon","streamData","EventNames","handleBranchModified","handleBranchesModified","EntitlementsImpl","getRegion","_agmInvoke","getBranches","Branches","getCurrentBranch","Branch","setRegion","ResultMessage","setCurrentBranch","currentUser","getFunctionalEntitlement","funct","Entitlement","Function","getFunctionalEntitlementBranch","canI","func","Result","canIBranch","onBranchesChanged","onBranchChanged","transformFunction","errHandler","InstanceImpl","_app","startFailed","onAgmReady","_addToRegistry","onStopped","_unsubscribeInstanceStopped","_unsubscribeInstanceAgmServerReady","activityInstance","instWinCntx","activityIsOwner","activityOwnerInstance","_startUpContext","_isActivityInstance","_inActivity","_agmInstance","ActivityId","AgmServers","GD3","agmInstances","gdAgmServers","propsAgmServer","propsAgm","userName","app_manager_1","entitlements_1","snapshot_1","data_subscription_1","getLibConfig","defaultMode","trueMode","getModeAsString","ContextProvider","activitiesGetter","registeredRequestsMethods","onSaveRequested","registerRequestMethods","isActivityOwner","myWindow","requestResult","activityContext","windowContext","contextProvider_1","transform_1","layout_1","LayoutsAPIImpl","onEvent","provider","gotSnapshot","save","verifyNotSlimMode","ignoreHidden","layoutObject","actIds","appIds","ignoreLayoutRestrictions","isVisibleWindow","ignoreMyInstance","invokeMethodAndTrack","activityIdToJoin","restoreActivityOwner","ignoreActivityWindowTypes","closeRunningInstance","reuseWindows","t42","restoreOptions","activityToJoin","closeOldWindows","reuseExistingWindows","toClose","splash","getInstancesToClose","handleResult","getObjectValues","Layouts","rename","newName","oldName","onRenamed","skipStreamEvent","agmResult","streamEventReceived","responseHandler","shellApp","isShell","shellApplicationName","acsStream","acsStream_1","layouts_1","ACSStream","resolveReady","rejectReady","resolveGotSnapshot","rejectGotSnapshot","noRetry","transform","checkForLayoutEventMethod","IsSnapshot","addLayouts","OnLayoutAdded","removeLayouts","OnLayoutRemoved","changeLayouts","OnLayoutChanged","renameLayouts","OnLayoutRenamed","streamEvent","Token","layoutsData","layoutData","removedLayouts","removedLayout","existingLayout","compareLayouts","changedLayouts","changedLayout","renamedLayouts","renamedLayout","layout1","layout2","Glue","gd_1","gd","hcPromise","gdPromise","race","ms","rej","objectAssign","GDExecutor","agmTarget","snappingEdge","dataURL","toShow","setGroupHeaderVisible","executor_1","GDEnvironment","wndId","_waitTimeout","normalizeInstance","_windowId","streamResolve","streamReject","updateWindow","copyOptions","windowState","tabAttached","tabDetached","onCompositionChanged","onGroupHeaderVisibilityChanged","onWindowGotFocus","onWindowLostFocus","windowInfo","extendedStreamEvent","getExtendedStreamEvent","windowInfoCreatedEvent","windowObjectAndEvents","theWindow","theWindowEvents","windowInfoBoundsChangedEvent","windowInfoUrlChangedEvent","windowInfoTitleChanged","windowInfoCompositionChanged","neighbors","groupHeaderVisible","windowInfoFocusChanged","focusChanged","frameId","winsToBeNotified_1","oldTabGroupId","winsToBeNotified_2","newWindowId","prevWindowId","windowObjAndEvents","mapToWindowConstructorOptions","isActiveTab","charAt","toUpperCase","HcExecutor","successHandler","conditionFunc","agmAction","isSame","collapsed","subscribeFunc","styles","Hidden","enabled","base64ImageSource","stickyFrameColor","ignoreTimeout","agmInvoke","removeCallback_1","isResolved_1","cntName","oldFrameColor","windowTitle","parsedWsa","parseWindowStyleAttributes","WindowState","windowStyles","hcEnv","streamPromise","listWindowsPromise","listWndResolve","listWndReject","existingWindow","_windowsId","groupObject","removeWindow","window_2","_mapToWindowObject","find","mappedWindow","mappedWindows","_mapToWindowObjects","showHeader","hideHeader","isGroupHeaderVisibleCalled","winObjects","windowObject","_getGroupHeaderVisibility","onHeaderVisibilityChanged","onWindowAdded","onWindowRemoved","isHeaderVisible","groupAPI","groupInternal","group_1","findGroupByWindow","_groups","groupFound","onWindowMoved","createOrGetGroup","createdGroup","deleteGroup","addNewWindow","windowGroupId","newGroupId","oldGroupId","groupsAPI","groupsEvents","detector_1","groups_1","isReady","windowsForListing","findById","windowAdded","windowRemoved","unsubFunc","unsubscribed","handleWindowAdded","handleWindowRemoved","groups","env","onTabAttached","onTabDetached"],"mappings":"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","file":"tick42-glue.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"cluster\"), require(\"crypto\"), require(\"events\"), require(\"fs\"), require(\"http\"), require(\"https\"), require(\"path\"), require(\"stream\"), require(\"tls\"), require(\"url\"), require(\"util\"), require(\"zlib\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"tick42-glue\", [\"cluster\", \"crypto\", \"events\", \"fs\", \"http\", \"https\", \"path\", \"stream\", \"tls\", \"url\", \"util\", \"zlib\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"tick42-glue\"] = factory(require(\"cluster\"), require(\"crypto\"), require(\"events\"), require(\"fs\"), require(\"http\"), require(\"https\"), require(\"path\"), require(\"stream\"), require(\"tls\"), require(\"url\"), require(\"util\"), require(\"zlib\"));\n\telse\n\t\troot[\"tick42-glue\"] = factory(root[\"cluster\"], root[\"crypto\"], root[\"events\"], root[\"fs\"], root[\"http\"], root[\"https\"], root[\"path\"], root[\"stream\"], root[\"tls\"], root[\"url\"], root[\"util\"], root[\"zlib\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_12__, __WEBPACK_EXTERNAL_MODULE_13__, __WEBPACK_EXTERNAL_MODULE_25__, __WEBPACK_EXTERNAL_MODULE_26__, __WEBPACK_EXTERNAL_MODULE_27__, __WEBPACK_EXTERNAL_MODULE_28__, __WEBPACK_EXTERNAL_MODULE_29__, __WEBPACK_EXTERNAL_MODULE_30__, __WEBPACK_EXTERNAL_MODULE_31__, __WEBPACK_EXTERNAL_MODULE_32__, __WEBPACK_EXTERNAL_MODULE_33__, __WEBPACK_EXTERNAL_MODULE_34__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"cluster\"), require(\"crypto\"), require(\"events\"), require(\"fs\"), require(\"http\"), require(\"https\"), require(\"path\"), require(\"stream\"), require(\"tls\"), require(\"url\"), require(\"util\"), require(\"zlib\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"tick42-glue\", [\"cluster\", \"crypto\", \"events\", \"fs\", \"http\", \"https\", \"path\", \"stream\", \"tls\", \"url\", \"util\", \"zlib\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"tick42-glue\"] = factory(require(\"cluster\"), require(\"crypto\"), require(\"events\"), require(\"fs\"), require(\"http\"), require(\"https\"), require(\"path\"), require(\"stream\"), require(\"tls\"), require(\"url\"), require(\"util\"), require(\"zlib\"));\n\telse\n\t\troot[\"tick42-glue\"] = factory(root[\"cluster\"], root[\"crypto\"], root[\"events\"], root[\"fs\"], root[\"http\"], root[\"https\"], root[\"path\"], root[\"stream\"], root[\"tls\"], root[\"url\"], root[\"util\"], root[\"zlib\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_12__, __WEBPACK_EXTERNAL_MODULE_13__, __WEBPACK_EXTERNAL_MODULE_25__, __WEBPACK_EXTERNAL_MODULE_26__, __WEBPACK_EXTERNAL_MODULE_27__, __WEBPACK_EXTERNAL_MODULE_28__, __WEBPACK_EXTERNAL_MODULE_29__, __WEBPACK_EXTERNAL_MODULE_30__, __WEBPACK_EXTERNAL_MODULE_31__, __WEBPACK_EXTERNAL_MODULE_32__, __WEBPACK_EXTERNAL_MODULE_33__, __WEBPACK_EXTERNAL_MODULE_34__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 74);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\n// some small useful functions (so we don't reference underscore or lodash)\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction isNumber(arg) {\r\n    return typeof arg === \"number\";\r\n}\r\nexports.isNumber = isNumber;\r\nfunction isString(arg) {\r\n    return typeof arg === \"string\";\r\n}\r\nexports.isString = isString;\r\nfunction isObject(arg) {\r\n    return typeof arg === \"object\" && arg !== null;\r\n}\r\nexports.isObject = isObject;\r\nfunction isArray(arg) {\r\n    // TODO optimize\r\n    if (Array.isArray) {\r\n        return Array.isArray(arg);\r\n    }\r\n    return toString.call(arg) === \"[object Array]\";\r\n}\r\nexports.isArray = isArray;\r\nfunction isUndefined(arg) {\r\n    return typeof arg === \"undefined\";\r\n}\r\nexports.isUndefined = isUndefined;\r\nfunction isUndefinedOrNull(arg) {\r\n    return !arg || typeof arg === \"undefined\";\r\n}\r\nexports.isUndefinedOrNull = isUndefinedOrNull;\r\n/**\r\n *  Checks if an object is empty (has no properties)\r\n * @private\r\n */\r\nfunction isEmpty(arg) {\r\n    for (var prop in arg) {\r\n        if (arg.hasOwnProperty(prop)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nexports.isEmpty = isEmpty;\r\nfunction isFunction(arg) {\r\n    return !!(arg && arg.constructor && arg.call && arg.apply);\r\n}\r\nexports.isFunction = isFunction;\r\nfunction some(array, predicate) {\r\n    for (var index = 0; index < array.length; index++) {\r\n        if (predicate(array[index], index)) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexports.some = some;\r\nfunction first(array, predicate) {\r\n    for (var index = 0; index < array.length; index++) {\r\n        if (predicate(array[index], index)) {\r\n            return array[index];\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\nexports.first = first;\r\nfunction ifNotUndefined(what, doWithIt) {\r\n    if (typeof what !== \"undefined\") {\r\n        doWithIt(what);\r\n    }\r\n}\r\nexports.ifNotUndefined = ifNotUndefined;\r\nfunction promisify(promise, successCallback, errorCallback) {\r\n    \"use strict\";\r\n    if (typeof successCallback !== \"function\" && typeof errorCallback !== \"function\") {\r\n        return promise;\r\n    }\r\n    if (typeof successCallback !== \"function\") {\r\n        successCallback = function () { return; };\r\n    }\r\n    else if (typeof errorCallback !== \"function\") {\r\n        errorCallback = function () { return; };\r\n    }\r\n    promise.then(successCallback, errorCallback);\r\n}\r\nexports.promisify = promisify;\r\n//# sourceMappingURL=util.js.map\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nfunction createRegistry(options) {\r\n    if (options && options.errorHandling\r\n        && typeof options.errorHandling !== \"function\"\r\n        && options.errorHandling !== \"log\"\r\n        && options.errorHandling !== \"silent\"\r\n        && options.errorHandling !== \"throw\") {\r\n        throw new Error(\"Invalid options passed to createRegistry. Prop errorHandling should be [\\\"log\\\" | \\\"silent\\\" | \\\"throw\\\" | (err) => void], but \" + typeof options.errorHandling + \" was passed\");\r\n    }\r\n    var _userErrorHandler = options && typeof options.errorHandling === \"function\" && options.errorHandling;\r\n    var callbacks = {};\r\n    function add(key, callback) {\r\n        var callbacksForKey = callbacks[key];\r\n        if (!callbacksForKey) {\r\n            callbacksForKey = [];\r\n            callbacks[key] = callbacksForKey;\r\n        }\r\n        callbacksForKey.push(callback);\r\n        return function () {\r\n            var allForKey = callbacks[key];\r\n            if (!allForKey) {\r\n                return;\r\n            }\r\n            allForKey = allForKey.reduce(function (acc, element, index) {\r\n                if (!(element === callback && acc.length === index)) {\r\n                    acc.push(element);\r\n                }\r\n                return acc;\r\n            }, []);\r\n            callbacks[key] = allForKey;\r\n        };\r\n    }\r\n    function execute(key) {\r\n        var argumentsArr = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            argumentsArr[_i - 1] = arguments[_i];\r\n        }\r\n        var callbacksForKey = callbacks[key];\r\n        if (!callbacksForKey || callbacksForKey.length === 0) {\r\n            return [];\r\n        }\r\n        var results = [];\r\n        callbacksForKey.forEach(function (callback) {\r\n            try {\r\n                var result = callback.apply(undefined, argumentsArr);\r\n                results.push(result);\r\n            }\r\n            catch (err) {\r\n                results.push(undefined);\r\n                _handleError(err, key);\r\n            }\r\n        });\r\n        return results;\r\n    }\r\n    function _handleError(exceptionArtifact, key) {\r\n        var errParam = exceptionArtifact instanceof Error ? exceptionArtifact : new Error(exceptionArtifact);\r\n        if (_userErrorHandler) {\r\n            _userErrorHandler(errParam);\r\n            return;\r\n        }\r\n        var msg = \"[ERROR] callback-registry: User callback for key \\\"\" + key + \"\\\" failed: \" + errParam.stack;\r\n        if (options) {\r\n            switch (options.errorHandling) {\r\n                case \"log\":\r\n                    return console.error(msg);\r\n                case \"silent\":\r\n                    return;\r\n                case \"throw\":\r\n                    throw new Error(msg);\r\n            }\r\n        }\r\n        console.error(msg);\r\n    }\r\n    function clear() {\r\n        callbacks = {};\r\n    }\r\n    return {\r\n        add: add,\r\n        execute: execute,\r\n        clear: clear\r\n    };\r\n}\r\n;\r\ncreateRegistry.default = createRegistry;\r\nmodule.exports = createRegistry;\r\n//# sourceMappingURL=index.js.map\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar EntityEvent = /** @class */ (function () {\r\n    function EntityEvent(entitiy, context) {\r\n        this.entity = entitiy;\r\n        this.context = context;\r\n    }\r\n    return EntityEvent;\r\n}());\r\nexports.EntityEvent = EntityEvent;\r\nvar EntityEventContext = /** @class */ (function () {\r\n    function EntityEventContext(eventType) {\r\n        this.type = eventType;\r\n    }\r\n    return EntityEventContext;\r\n}());\r\nexports.EntityEventContext = EntityEventContext;\r\nvar ActivityStatusChangeEventContext = /** @class */ (function (_super) {\r\n    __extends(ActivityStatusChangeEventContext, _super);\r\n    function ActivityStatusChangeEventContext(newStatus, oldStatus) {\r\n        var _this = _super.call(this, EntityEventType.StatusChange) || this;\r\n        _this.newStatus = newStatus;\r\n        _this.oldStatus = oldStatus;\r\n        return _this;\r\n    }\r\n    return ActivityStatusChangeEventContext;\r\n}(EntityEventContext));\r\nexports.ActivityStatusChangeEventContext = ActivityStatusChangeEventContext;\r\nvar ActivityContextChangedEventContext = /** @class */ (function (_super) {\r\n    __extends(ActivityContextChangedEventContext, _super);\r\n    function ActivityContextChangedEventContext(context) {\r\n        var _this = _super.call(this, EntityEventType.ActivityContextChange) || this;\r\n        _this.context = typeof context === \"string\" ? JSON.parse(context) : context;\r\n        return _this;\r\n    }\r\n    return ActivityContextChangedEventContext;\r\n}(EntityEventContext));\r\nexports.ActivityContextChangedEventContext = ActivityContextChangedEventContext;\r\nvar EntityEventType = /** @class */ (function () {\r\n    function EntityEventType() {\r\n    }\r\n    EntityEventType.Added = \"added\";\r\n    EntityEventType.Removed = \"removed\";\r\n    EntityEventType.Updated = \"updated\";\r\n    EntityEventType.Closed = \"closed\";\r\n    EntityEventType.StatusChange = \"statusChange\";\r\n    EntityEventType.ActivityContextChange = \"activityContextUpdate\";\r\n    EntityEventType.ActivityWindowEvent = \"activityWindowEvent\";\r\n    // #deleteme TODO: these are not implemented in HC\r\n    EntityEventType.ActivityWindowJoinedActivity = \"joined\";\r\n    EntityEventType.ActivityWindowLeftActivity = \"left\";\r\n    return EntityEventType;\r\n}());\r\nexports.EntityEventType = EntityEventType;\r\nvar ActivityState = /** @class */ (function () {\r\n    function ActivityState() {\r\n    }\r\n    ActivityState.Created = \"created\";\r\n    ActivityState.Started = \"started\";\r\n    ActivityState.Destroyed = \"destroyed\";\r\n    return ActivityState;\r\n}());\r\nexports.ActivityState = ActivityState;\r\n//# sourceMappingURL=entityEvent.js.map\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = __webpack_require__(1);\r\nvar WindowStore = /** @class */ (function () {\r\n    function WindowStore() {\r\n        this.waitForTimeoutInMilliseconds = 60000;\r\n        this._windows = {};\r\n        this._pendingWindows = {};\r\n        this._pendingWindowsStates = {};\r\n        this._registry = CallbackFactory();\r\n    }\r\n    WindowStore.prototype.init = function (logger) {\r\n        this._logger = logger;\r\n    };\r\n    // Returns a window which either in Ready OR NOT 'ready' state (when the window is NOT marked with readyToShow)\r\n    WindowStore.prototype.get = function (id) {\r\n        return this._windows[id] || this._pendingWindows[id];\r\n    };\r\n    // Returns a window which is in 'ready' state (when the window is marked with readyToShow)\r\n    WindowStore.prototype.getIfReady = function (id) {\r\n        return this._windows[id];\r\n    };\r\n    Object.defineProperty(WindowStore.prototype, \"list\", {\r\n        get: function () {\r\n            return this._windows;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    WindowStore.prototype.add = function (window) {\r\n        var isExist = this._pendingWindows[window.API.id] ? true : false;\r\n        if (isExist) {\r\n            this._logger.error(\"trying to add window with id \" + window.API.id + \" from windowStore, which already exists\");\r\n            return;\r\n        }\r\n        var remote = window.API.windowType === \"remote\";\r\n        this._pendingWindows[window.API.id] = window;\r\n        this._pendingWindowsStates[window.API.id] = {\r\n            ready: false,\r\n            urlChanged: remote,\r\n        };\r\n        this._registry.execute(\"on-added\", window);\r\n    };\r\n    WindowStore.prototype.remove = function (window) {\r\n        delete this._windows[window.API.id];\r\n        delete this._pendingWindows[window.API.id];\r\n        delete this._pendingWindowsStates[window.API.id];\r\n        this._registry.execute(\"on-removed\", window);\r\n    };\r\n    WindowStore.prototype.setReadyState = function (windowId) {\r\n        var targetWindowState = this._pendingWindowsStates[windowId];\r\n        if (typeof targetWindowState === \"undefined\") {\r\n            return;\r\n        }\r\n        targetWindowState.ready = true;\r\n        if (targetWindowState.urlChanged) {\r\n            this.markReadyToShow(windowId);\r\n        }\r\n    };\r\n    WindowStore.prototype.setUrlChangedState = function (windowId) {\r\n        var targetWindowState = this._pendingWindowsStates[windowId];\r\n        if (typeof targetWindowState === \"undefined\") {\r\n            return;\r\n        }\r\n        targetWindowState.urlChanged = true;\r\n        if (targetWindowState.ready) {\r\n            this.markReadyToShow(windowId);\r\n        }\r\n    };\r\n    WindowStore.prototype.waitFor = function (id) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var un;\r\n            var timeout = setTimeout(function () {\r\n                un();\r\n                reject(\"waitFor timed out.\");\r\n            }, _this.waitForTimeoutInMilliseconds);\r\n            var win = _this._windows[id];\r\n            if (win) {\r\n                clearTimeout(timeout);\r\n                resolve(win.API);\r\n            }\r\n            else {\r\n                un = _this.onReadyWindow(function (w) {\r\n                    if (w.API.id !== id) {\r\n                        return;\r\n                    }\r\n                    clearTimeout(timeout);\r\n                    un();\r\n                    resolve(w.API);\r\n                });\r\n            }\r\n        });\r\n    };\r\n    WindowStore.prototype.onReadyWindow = function (callback) {\r\n        return this._registry.add(\"on-ready\", callback);\r\n    };\r\n    WindowStore.prototype.onAdded = function (callback) {\r\n        return this._registry.add(\"on-added\", callback);\r\n    };\r\n    WindowStore.prototype.onRemoved = function (callback) {\r\n        return this._registry.add(\"on-removed\", callback);\r\n    };\r\n    // newly created windows now need to hear both \"ready\" and \"urlChanged\" events in otder to be markedReadyToShow\r\n    WindowStore.prototype.markReadyToShow = function (windowId) {\r\n        if (this._pendingWindows[windowId]) {\r\n            this._windows[windowId] = this._pendingWindows[windowId];\r\n            delete this._pendingWindows[windowId];\r\n            delete this._pendingWindowsStates[windowId];\r\n        }\r\n        this._registry.execute(\"on-ready\", this._windows[windowId]);\r\n    };\r\n    return WindowStore;\r\n}());\r\nexports.WindowStore = WindowStore;\r\nexports.default = new WindowStore();\r\n//# sourceMappingURL=store.js.map\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\n/* tslint:disable */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar util = __webpack_require__(0);\r\nvar LogLevel = /** @class */ (function () {\r\n    function LogLevel() {\r\n    }\r\n    LogLevel.Trace = \"trace\";\r\n    LogLevel.Debug = \"debug\";\r\n    LogLevel.Info = \"info\";\r\n    LogLevel.Warn = \"warn\";\r\n    LogLevel.Error = \"error\";\r\n    return LogLevel;\r\n}());\r\nexports.LogLevel = LogLevel;\r\nvar Logger = /** @class */ (function () {\r\n    function Logger(name) {\r\n        this._name = name;\r\n        // we have a glue logger let's create a new logger for it\r\n        if (!util.isUndefinedOrNull(Logger.GlueLogger)) {\r\n            this._glueLogger = Logger.GlueLogger.subLogger(name);\r\n        }\r\n    }\r\n    Logger.GetNamed = function (name) {\r\n        return new Logger(name);\r\n    };\r\n    Logger.Get = function (owner) {\r\n        return new Logger(Logger.GetTypeName(owner));\r\n    };\r\n    Logger.prototype.trace = function (message) {\r\n        if (!util.isUndefinedOrNull(this._glueLogger)) {\r\n            this._glueLogger.trace(message);\r\n        }\r\n        else {\r\n            if (Logger.Level === LogLevel.Trace) {\r\n                console.info(this._getMessage(message, LogLevel.Trace));\r\n            }\r\n        }\r\n    };\r\n    Logger.prototype.debug = function (message) {\r\n        if (!util.isUndefinedOrNull(this._glueLogger)) {\r\n            this._glueLogger.debug(message);\r\n        }\r\n        else {\r\n            if (Logger.Level === LogLevel.Debug ||\r\n                Logger.Level === LogLevel.Trace) {\r\n                console.info(this._getMessage(message, LogLevel.Debug));\r\n            }\r\n        }\r\n    };\r\n    Logger.prototype.info = function (message) {\r\n        if (!util.isUndefinedOrNull(this._glueLogger)) {\r\n            this._glueLogger.info(message);\r\n        }\r\n        else {\r\n            if (Logger.Level === LogLevel.Debug ||\r\n                Logger.Level === LogLevel.Trace ||\r\n                Logger.Level === LogLevel.Info) {\r\n                console.info(this._getMessage(message, LogLevel.Info));\r\n            }\r\n        }\r\n    };\r\n    Logger.prototype.warn = function (message) {\r\n        if (!util.isUndefinedOrNull(this._glueLogger)) {\r\n            this._glueLogger.warn(message);\r\n        }\r\n        else {\r\n            if (Logger.Level === LogLevel.Debug ||\r\n                Logger.Level === LogLevel.Trace ||\r\n                Logger.Level === LogLevel.Info ||\r\n                Logger.Level === LogLevel.Warn) {\r\n                console.info(this._getMessage(message, LogLevel.Info));\r\n            }\r\n        }\r\n    };\r\n    Logger.prototype.error = function (message) {\r\n        if (!util.isUndefinedOrNull(this._glueLogger)) {\r\n            this._glueLogger.error(message);\r\n        }\r\n        else {\r\n            console.error(this._getMessage(message, LogLevel.Error));\r\n            console.trace();\r\n        }\r\n    };\r\n    Logger.prototype._getMessage = function (message, level) {\r\n        return \"[\" + level + \"] \" + this._name + \" - \" + message;\r\n    };\r\n    /**\r\n     * Returns the function name for a given object (same as constructor.name but cross-browser)\r\n     */\r\n    Logger.GetTypeName = function (object) {\r\n        var funcNameRegex = /function (.{1,})\\(/;\r\n        var results = (funcNameRegex).exec(object.constructor.toString());\r\n        return (results && results.length > 1) ? results[1] : \"\";\r\n    };\r\n    Logger.Level = LogLevel.Info;\r\n    return Logger;\r\n}());\r\nexports.Logger = Logger;\r\n//# sourceMappingURL=logger.js.map\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ShutdownMethodName = \"T42.ACS.Shutdown\";\r\nexports.FeedackMethodName = \"T42.ACS.Feedback\";\r\nexports.GetConfigurationRegionMethodName = \"T42.ACS.GetConfigurationRegion\";\r\nexports.SetConfigurationRegionMethodName = \"T42.ACS.SetConfigurationRegion\";\r\nexports.GetUserMethodName = \"T42.ACS.GetUser\";\r\nexports.GetBranchesMethodName = \"T42.ACS.GetBranches\";\r\nexports.GetCurrentBranchMethodName = \"T42.ACS.GetCurrentBranch\";\r\nexports.SetCurrentBranchMethodName = \"T42.ACS.SetCurrentBranch\";\r\nexports.GetFunctionalEntitlementMethodName = \"T42.ACS.GetFunctionalEntitlement\";\r\nexports.CanIMethodName = \"T42.ACS.CanI\";\r\nexports.StartApplicationMethodName = \"T42.ACS.StartApplication\";\r\nexports.StopApplicationMethodName = \"T42.ACS.StopApplication\";\r\nexports.ActivateApplicationMethodName = \"T42.ACS.ActivateApplication\";\r\nexports.RunApplicationMethodName = \"T42.ACS.RunApplication\";\r\nexports.OnEventMethodName = \"T42.ACS.OnEvent\";\r\nexports.GetApplicationsMethodName = \"T42.ACS.GetApplications\";\r\n//# sourceMappingURL=agm-names.js.map\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar randomFromSeed = __webpack_require__(46);\n\nvar ORIGINAL = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-';\nvar alphabet;\nvar previousSeed;\n\nvar shuffled;\n\nfunction reset() {\n    shuffled = false;\n}\n\nfunction setCharacters(_alphabet_) {\n    if (!_alphabet_) {\n        if (alphabet !== ORIGINAL) {\n            alphabet = ORIGINAL;\n            reset();\n        }\n        return;\n    }\n\n    if (_alphabet_ === alphabet) {\n        return;\n    }\n\n    if (_alphabet_.length !== ORIGINAL.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. You submitted ' + _alphabet_.length + ' characters: ' + _alphabet_);\n    }\n\n    var unique = _alphabet_.split('').filter(function(item, ind, arr){\n       return ind !== arr.lastIndexOf(item);\n    });\n\n    if (unique.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. These characters were not unique: ' + unique.join(', '));\n    }\n\n    alphabet = _alphabet_;\n    reset();\n}\n\nfunction characters(_alphabet_) {\n    setCharacters(_alphabet_);\n    return alphabet;\n}\n\nfunction setSeed(seed) {\n    randomFromSeed.seed(seed);\n    if (previousSeed !== seed) {\n        reset();\n        previousSeed = seed;\n    }\n}\n\nfunction shuffle() {\n    if (!alphabet) {\n        setCharacters(ORIGINAL);\n    }\n\n    var sourceArray = alphabet.split('');\n    var targetArray = [];\n    var r = randomFromSeed.nextValue();\n    var characterIndex;\n\n    while (sourceArray.length > 0) {\n        r = randomFromSeed.nextValue();\n        characterIndex = Math.floor(r * sourceArray.length);\n        targetArray.push(sourceArray.splice(characterIndex, 1)[0]);\n    }\n    return targetArray.join('');\n}\n\nfunction getShuffled() {\n    if (shuffled) {\n        return shuffled;\n    }\n    shuffled = shuffle();\n    return shuffled;\n}\n\n/**\n * lookup shuffled letter\n * @param index\n * @returns {string}\n */\nfunction lookup(index) {\n    var alphabetShuffled = getShuffled();\n    return alphabetShuffled[index];\n}\n\nfunction get () {\n  return alphabet || ORIGINAL;\n}\n\nmodule.exports = {\n    get: get,\n    characters: characters,\n    seed: setSeed,\n    lookup: lookup,\n    shuffled: getShuffled\n};\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Base class for activity entities with reference to the activity manager\r\n * @private\r\n */\r\nvar ActivityEntity = /** @class */ (function () {\r\n    function ActivityEntity(id) {\r\n        this._id = id;\r\n    }\r\n    Object.defineProperty(ActivityEntity.prototype, \"id\", {\r\n        get: function () {\r\n            return this._id;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Updates the properties of the current object using the properties of another object\r\n     * These two should have the same id.\r\n     */\r\n    ActivityEntity.prototype._update = function (other) {\r\n        if (other._id !== this._id) {\r\n            throw Error(\"Can not update from entity with different id.\");\r\n        }\r\n        this._updateCore(other);\r\n    };\r\n    ActivityEntity.prototype._updateCore = function (other) {\r\n        return;\r\n    };\r\n    ActivityEntity.prototype._beforeDelete = function (other) {\r\n        return;\r\n    };\r\n    return ActivityEntity;\r\n}());\r\nexports.default = ActivityEntity;\r\n//# sourceMappingURL=activityEntity.js.map\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar util = __webpack_require__(0);\r\nvar nextTick = function (cb) {\r\n    setTimeout(cb, 0);\r\n};\r\n/**\r\n * Convert a Promise to node style callback\r\n * @private\r\n */\r\nfunction nodeify(promise, callback) {\r\n    if (!util.isFunction(callback)) {\r\n        return promise;\r\n    }\r\n    promise.then(function (resp) {\r\n        nextTick(function () {\r\n            callback(null, resp);\r\n        });\r\n    }, function (err) {\r\n        nextTick(function () {\r\n            callback(err, null);\r\n        });\r\n    });\r\n}\r\nexports.nodeify = nodeify;\r\n//# sourceMappingURL=promiseExtensions.js.map\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar util = __webpack_require__(0);\r\nvar util_1 = __webpack_require__(0);\r\n// A helper class that provides lame activity AGM implementation\r\n// Can be initialized with or without activity - in case no activity (independent windows outside activity) only\r\n// subset of the methods work\r\nvar ActivityAGM = /** @class */ (function () {\r\n    function ActivityAGM(activity) {\r\n        this._activity = activity;\r\n    }\r\n    ActivityAGM.prototype.register = function (definition, handler) {\r\n        this._ensureHasAgm();\r\n        ActivityAGM.AGM.register(definition, handler);\r\n    };\r\n    ActivityAGM.prototype.servers = function () {\r\n        this._ensureHasAgm();\r\n        if (util.isUndefinedOrNull(this._activity)) {\r\n            // or return ActivityAGM.AGM.servers()\r\n            return [];\r\n        }\r\n        return this._activity.windows.map(function (w) {\r\n            return w.instance;\r\n        });\r\n    };\r\n    ActivityAGM.prototype.methods = function () {\r\n        var _this = this;\r\n        this._ensureHasAgm();\r\n        if (util.isUndefinedOrNull(this._activity)) {\r\n            // or return ActivityAGM.AGM.methods()\r\n            return [];\r\n        }\r\n        var windows = this._activity.windows;\r\n        var methodNames = [];\r\n        var methods = [];\r\n        // get all windows and their methods, then assemble distinct methods\r\n        windows.forEach(function (window) {\r\n            var windowMethods = _this.methodsForWindow(window);\r\n            windowMethods.forEach(function (currentWindowMethod) {\r\n                if (methodNames.indexOf(currentWindowMethod.name) === -1) {\r\n                    methodNames.push(currentWindowMethod.name);\r\n                    methods.push(currentWindowMethod);\r\n                }\r\n            });\r\n        });\r\n        return methods;\r\n    };\r\n    ActivityAGM.prototype.methodsForWindow = function (window) {\r\n        this._ensureHasAgm();\r\n        // get instance and use agm to get methods for instance\r\n        if (!window.instance) {\r\n            return [];\r\n        }\r\n        return ActivityAGM.AGM.methodsForInstance(window.instance);\r\n    };\r\n    /** Possible invoke targets\r\n     *\r\n     * \"activity.all\" - [default]\r\n     * \"activity.best\"\r\n     * ActivityWindow\r\n     * [ActivityWindow] -\r\n     *\r\n     * classic AGM\r\n     * \"all\" - agm all\r\n     * \"best\" - agm best\r\n     * instance - agm\r\n     * [ instances ]\r\n     *\r\n     */\r\n    ActivityAGM.prototype.invoke = function (methodName, arg, target, options, success, error) {\r\n        this._ensureHasAgm();\r\n        var activityServers = this.servers();\r\n        var serversToInvokeAgainst = [];\r\n        if (util.isUndefinedOrNull(target)) {\r\n            target = \"activity.all\";\r\n        }\r\n        if (util.isString(target)) {\r\n            if (target === \"activity.all\") {\r\n                serversToInvokeAgainst = activityServers;\r\n            }\r\n            else if (target === \"activity.best\") {\r\n                var potentialTargets = activityServers.filter(function (server) {\r\n                    var methods = ActivityAGM.AGM.methodsForInstance(server);\r\n                    return methods.filter(function (m) {\r\n                        return m.name === methodName;\r\n                    }).length > 0;\r\n                });\r\n                if (potentialTargets.length > 0) {\r\n                    serversToInvokeAgainst = [potentialTargets[0]];\r\n                }\r\n            }\r\n            else if (target === \"all\" || target === \"best\") {\r\n                return util_1.promisify(ActivityAGM.AGM.invoke(methodName, arg, target, options), success, error);\r\n            }\r\n            else {\r\n                throw new Error(\"Invalid invoke target \" + target);\r\n            }\r\n        }\r\n        else if (util.isArray(target)) {\r\n            // if the array is not empty\r\n            if (target.length >= 0) {\r\n                var firstElem = target[0];\r\n                // check argument type\r\n                if (this._isInstance(firstElem)) {\r\n                    serversToInvokeAgainst = target.map(function (instance) { return instance; });\r\n                }\r\n                else if (this._isActivityWindow(firstElem)) {\r\n                    serversToInvokeAgainst = target.map(function (win) { return win.instance; });\r\n                }\r\n                else {\r\n                    throw new Error(\"Unknown target object\");\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (this._isInstance(target)) {\r\n                serversToInvokeAgainst = [target];\r\n            }\r\n            else if (this._isActivityWindow(target)) {\r\n                serversToInvokeAgainst = [target.instance];\r\n            }\r\n            else {\r\n                throw new Error(\"Unknown target object\");\r\n            }\r\n        }\r\n        throw new Error(\"Not implemented\");\r\n        // return promisify(ActivityAGM.AGM.invoke(methodName, arg, serversToInvokeAgainst, options), success, error);\r\n    };\r\n    ActivityAGM.prototype.unregister = function (definition) {\r\n        this._ensureHasAgm();\r\n        return ActivityAGM.AGM.unregister(definition);\r\n    };\r\n    ActivityAGM.prototype.createStream = function (methodDefinition, subscriptionAddedHandler, subscriptionRemovedHandler) {\r\n        this._ensureHasAgm();\r\n        ActivityAGM.AGM.createStream(methodDefinition, {\r\n            subscriptionAddedHandler: subscriptionAddedHandler,\r\n            subscriptionRemovedHandler: subscriptionRemovedHandler,\r\n            subscriptionRequestHandler: undefined\r\n        });\r\n    };\r\n    ActivityAGM.prototype.subscribe = function (methodDefinition, parameters, target) {\r\n        this._ensureHasAgm();\r\n        // #deleteme TODO: check servers needed?\r\n        // const servers = this.servers();\r\n        return ActivityAGM.AGM.subscribe(methodDefinition, parameters);\r\n    };\r\n    ActivityAGM.prototype._ensureHasAgm = function () {\r\n        if (util.isUndefinedOrNull(ActivityAGM.AGM)) {\r\n            throw new Error(\"Agm should be configured to be used in activity\");\r\n        }\r\n    };\r\n    ActivityAGM.prototype._isInstance = function (obj) {\r\n        // lame check\r\n        return obj.application !== undefined;\r\n    };\r\n    ActivityAGM.prototype._isActivityWindow = function (obj) {\r\n        return obj.instance !== undefined;\r\n    };\r\n    return ActivityAGM;\r\n}());\r\nexports.ActivityAGM = ActivityAGM;\r\n//# sourceMappingURL=activityAGM.js.map\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityEntity_1 = __webpack_require__(7);\r\nvar util_1 = __webpack_require__(0);\r\n/**\r\n * An activity type is a definition template for an activity, consisting of a collection of window types,\r\n * their layout and an initial activity context.\r\n *\r\n * @module activityType\r\n */\r\nvar ActivityType = /** @class */ (function (_super) {\r\n    __extends(ActivityType, _super);\r\n    function ActivityType(name, ownerWindow, helperWindows, description) {\r\n        var _this = _super.call(this, name) || this;\r\n        _this._name = name;\r\n        _this._description = description;\r\n        _this._ownerWindow = ownerWindow;\r\n        _this._helperWindows = helperWindows || [];\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ActivityType.prototype, \"name\", {\r\n        /**\r\n         * @var {string} name Name of the activity type\r\n         */\r\n        get: function () {\r\n            return this._name;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityType.prototype, \"description\", {\r\n        /**\r\n         * @var {string} description description for the activity type\r\n         */\r\n        get: function () {\r\n            return this._description;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityType.prototype, \"helperWindows\", {\r\n        /**\r\n         * A list of window types that should be created when initiating a new instance of that activity type\r\n         * @var {windowDefinition[]} helperWindows\r\n         */\r\n        get: function () {\r\n            return this._helperWindows;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityType.prototype, \"ownerWindow\", {\r\n        /**\r\n         * @var {windowDefinition} ownerWindow Returns the definition of the owner window for that activity type\r\n         */\r\n        get: function () {\r\n            return this._ownerWindow;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Initiates a new activity of this type\r\n     *\r\n     * @function initiate\r\n     * @param {object} context The initial context to be used for the new activity\r\n     * @param callback\r\n     * @param configuration\r\n     * @returns {Promise<activity>}\r\n     */\r\n    ActivityType.prototype.initiate = function (context, callback, configuration) {\r\n        return this._manager.initiate(this._name, context, callback, configuration);\r\n    };\r\n    ActivityType.prototype._updateCore = function (other) {\r\n        var _this = this;\r\n        _super.prototype._updateCore.call(this, other);\r\n        util_1.ifNotUndefined(other._description, function (x) { return _this._description = x; });\r\n        util_1.ifNotUndefined(other._ownerWindow, function (x) { return _this._ownerWindow = x; });\r\n        util_1.ifNotUndefined(other._helperWindows, function (x) { return _this._helperWindows = x; });\r\n    };\r\n    return ActivityType;\r\n}(activityEntity_1.default));\r\nexports.default = ActivityType;\r\n//# sourceMappingURL=activityType.js.map\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction objectValues(source) {\r\n    if (!source) {\r\n        return [];\r\n    }\r\n    return Object.keys(source).map(function (key) { return source[key]; });\r\n}\r\nexports.objectValues = objectValues;\r\nfunction objectClone(obj) {\r\n    var result;\r\n    try {\r\n        result = JSON.parse(JSON.stringify(obj || {}));\r\n    }\r\n    catch (error) {\r\n        result = {};\r\n    }\r\n    return result;\r\n}\r\nexports.objectClone = objectClone;\r\n//# sourceMappingURL=helper.js.map\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"cluster\");\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"crypto\");\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar entityEvent_1 = __webpack_require__(2);\r\nvar activityStatus_1 = __webpack_require__(15);\r\nvar activityType_1 = __webpack_require__(10);\r\nvar windowType_1 = __webpack_require__(18);\r\nvar activity_1 = __webpack_require__(16);\r\nvar activityWindow_1 = __webpack_require__(17);\r\nvar logger_1 = __webpack_require__(4);\r\nvar readyMarker_1 = __webpack_require__(19);\r\nvar util = __webpack_require__(0);\r\n/**\r\n * HtmlContainer (HC) bridge\r\n * @private\r\n * @module hcBridge\r\n */\r\nvar HCBridge = /** @class */ (function () {\r\n    function HCBridge(agm, windows, appManagerGetter, mode, typesToTrack) {\r\n        // HC constants\r\n        this._activityTypeEntityName = \"activityType\";\r\n        this._windowTypeEntityName = \"windowType\";\r\n        this._activityEntityName = \"activity\";\r\n        this._windowEntityName = \"activityWindow\";\r\n        this._logger = logger_1.Logger.Get(\"hcBridge\");\r\n        // event sequences\r\n        this._lastSeq = 0;\r\n        this._eventQueue = [];\r\n        this._activityTypeCallbacks = [];\r\n        this._windowTypeCallbacks = [];\r\n        this._activityCallbacks = [];\r\n        this._windowCallbacks = [];\r\n        this._agm = agm;\r\n        this._windows = windows;\r\n        this._appManagerGetter = appManagerGetter;\r\n        this._mode = mode;\r\n        this._typesToTrack = typesToTrack;\r\n    }\r\n    /**\r\n     *  Convert an ActivityType entity coming from HC to ActivityType\r\n     */\r\n    HCBridge._hcToJsActivityType = function (hcActType) {\r\n        return new activityType_1.default(hcActType.name, hcActType.ownerWindowType, hcActType.helperWindowTypes, hcActType.description);\r\n    };\r\n    HCBridge._getURLParameter = function (name) {\r\n        return decodeURIComponent((new RegExp(\"[?|&]\" + name + \"=\" + \"([^&;]+?)(&|#|;|$)\").exec(location.search) || [, \"\"])[1].replace(/\\+/g, \"%20\")) || null;\r\n    };\r\n    Object.defineProperty(HCBridge.prototype, \"bridgeType\", {\r\n        get: function () {\r\n            return \"HC\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    HCBridge.prototype.joinActivity = function (activityId, windowId) {\r\n        throw new Error(\"Not implemented\");\r\n    };\r\n    HCBridge.prototype.leaveActivity = function (activityId, windowId) {\r\n        throw new Error(\"Not implemented\");\r\n    };\r\n    HCBridge.prototype.init = function () {\r\n        var _this = this;\r\n        this._readyMarker = new readyMarker_1.ReadyMarker(\"HC Bridge\", 1);\r\n        this._htmlContainer = window.htmlContainer.activityFacade;\r\n        if (this._htmlContainer.subscribeForJoinBreakEvents) {\r\n            this._htmlContainer.subscribeForJoinBreakEvents(function (e) {\r\n                _this._handleGenericEvents(e);\r\n            });\r\n        }\r\n        var options = this._agm ? this._agm.instance : undefined;\r\n        var initFunc = this._htmlContainer.init;\r\n        if (this._htmlContainer.init2) {\r\n            initFunc = this._htmlContainer.init2;\r\n            options = {\r\n                jsAgmInstance: options,\r\n                glueVersion: 3,\r\n                mode: this._mode,\r\n                typesToTrack: this._typesToTrack\r\n            };\r\n        }\r\n        initFunc(options, this._hcEventHandler.bind(this), // event listener\r\n        function () {\r\n            _this._readyMarker.signal(\"Init done from HC\");\r\n        }, function (error) {\r\n            _this._readyMarker.error(error);\r\n        });\r\n    };\r\n    HCBridge.prototype.initReady = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._readyMarker.setCallback(function (err) {\r\n                if (!err) {\r\n                    resolve(_this);\r\n                }\r\n                else {\r\n                    _this._logger.error(\"Error initializing HC bridge - \" + err);\r\n                    reject(_this._readyMarker.getError());\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.ready = function () {\r\n        return this.initReady();\r\n    };\r\n    HCBridge.prototype._handleGenericEvents = function (event) {\r\n        this._processEventBySeq(event);\r\n    };\r\n    HCBridge.prototype._hcEventHandler = function (eventJson) {\r\n        this._logger.trace(eventJson);\r\n        var event = JSON.parse(eventJson);\r\n        this._processEventBySeq(event);\r\n    };\r\n    HCBridge.prototype._processEventBySeq = function (event) {\r\n        var seq = event.sequence;\r\n        if (seq === this._lastSeq + 1) {\r\n            // if this is the event we expect process it\r\n            this._processEvent(event);\r\n            this._lastSeq++;\r\n            // empty the next items in the queue - if any\r\n            var nextEvent = this._eventQueue[seq + 1];\r\n            if (!util.isUndefined(nextEvent)) {\r\n                this._logger.debug(\"replaying message number \" + seq);\r\n                this._processEventBySeq(nextEvent);\r\n                delete this._eventQueue[seq + 1];\r\n            }\r\n        }\r\n        else {\r\n            // save in the queue\r\n            this._eventQueue[seq] = event;\r\n            this._logger.debug(\"Got out of order event with number \" + seq + \". Will wait for previous event(s) before replaying.\");\r\n        }\r\n    };\r\n    HCBridge.prototype._processEvent = function (event) {\r\n        if (event.genericEvent) {\r\n            this._processGenericEvent(event);\r\n            return;\r\n        }\r\n        var entityType = event.entityType;\r\n        var eventContext = this._convertContext(event.context);\r\n        var entity;\r\n        switch (entityType) {\r\n            case this._activityTypeEntityName:\r\n                entity = HCBridge._hcToJsActivityType(event.entity);\r\n                this._publishActivityTypeStatusChange(entity, eventContext);\r\n                break;\r\n            case this._windowTypeEntityName:\r\n                entity = this._hcToJsWindowType(event.entity);\r\n                this._publishWindowTypeStatusChange(entity, eventContext);\r\n                break;\r\n            case this._activityEntityName:\r\n                entity = this._hcToJsActivity(event.entity);\r\n                this._publishActivityStatusChange(entity, eventContext);\r\n                break;\r\n            case this._windowEntityName:\r\n                entity = this._hcToJsWindow(event.entity);\r\n                this._publishActivityWindowEvent(entity, eventContext);\r\n                break;\r\n        }\r\n    };\r\n    HCBridge.prototype._processGenericEvent = function (event) {\r\n        var info = event.data;\r\n        if (event.type === \"ActivitiesAttached\") {\r\n            if (this._activitiesAttachedHandler) {\r\n                this._activitiesAttachedHandler(info);\r\n            }\r\n        }\r\n        else if (event.type === \"ActivitiesDetached\") {\r\n            if (this._activitiesDetached) {\r\n                this._activitiesDetached(info);\r\n            }\r\n        }\r\n        else if (event.type === \"ActivityAttachedDescriptorsRefreshed\") {\r\n            if (this._activityAttachedDescriptorsRefreshed) {\r\n                this._activityAttachedDescriptorsRefreshed(info);\r\n            }\r\n        }\r\n    };\r\n    HCBridge.prototype._convertContext = function (hcContext) {\r\n        if (hcContext.type === entityEvent_1.EntityEventType.StatusChange) {\r\n            var oldStatus = new activityStatus_1.ActivityStatus(hcContext.oldStatus.state, hcContext.oldStatus.statusMessage, hcContext.oldStatus.statusTime);\r\n            var newStatus = new activityStatus_1.ActivityStatus(hcContext.newStatus.state, hcContext.newStatus.statusMessage, hcContext.newStatus.statusTime);\r\n            return new entityEvent_1.ActivityStatusChangeEventContext(newStatus, oldStatus);\r\n        }\r\n        else if (hcContext.type === entityEvent_1.EntityEventType.ActivityWindowEvent) {\r\n            return new entityEvent_1.EntityEventContext(hcContext.event);\r\n        }\r\n        else if (hcContext.type === entityEvent_1.EntityEventType.ActivityContextChange) {\r\n            return new entityEvent_1.ActivityContextChangedEventContext(hcContext.newContext);\r\n        }\r\n        return new entityEvent_1.EntityEventContext(hcContext.type);\r\n    };\r\n    /**\r\n     *  Convert an Activity entity from HC to Activity\r\n     */\r\n    HCBridge.prototype._hcToJsActivity = function (hcAct) {\r\n        var window = hcAct.owner ? this._hcToJsWindow(hcAct.owner) : null;\r\n        var windowId = window ? window.id : null;\r\n        var status = new activityStatus_1.ActivityStatus(hcAct.status.state, hcAct.status.statusMessage, hcAct.status.statusTime);\r\n        var context = JSON.parse(hcAct.context);\r\n        return new activity_1.default(hcAct.id, hcAct.type.name, status, context, windowId);\r\n    };\r\n    /**\r\n     *  Convert a WindowType entity coming from HC to WindowType\r\n     */\r\n    HCBridge.prototype._hcToJsWindowType = function (hcWinType) {\r\n        var _this = this;\r\n        if (util.isUndefined(hcWinType.factories)) {\r\n            hcWinType.factories = [];\r\n        }\r\n        // lazy init\r\n        if (!this._appByWindowTypeGetter) {\r\n            if (!this._appManagerGetter) {\r\n                this._appByWindowTypeGetter = function () { return undefined; };\r\n            }\r\n            this._appByWindowTypeGetter = function (wt) {\r\n                var appMgr = _this._appManagerGetter();\r\n                return appMgr.applications().filter(function (app) { return app.activityWindowType === wt; })[0];\r\n            };\r\n        }\r\n        return new windowType_1.default(hcWinType.name, this._appByWindowTypeGetter);\r\n    };\r\n    // /** Convert a WindowFactory entity coming from HC to WindowFactory */\r\n    // static _hcToJsWindowTypeFactory(hcWinTypeFactory: any): WindowFactory {\r\n    //   return new ProxyWindowFactory(hcWinTypeFactory.description);\r\n    // }\r\n    HCBridge.prototype.getActivityTypes = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // get all from HC\r\n            _this._htmlContainer.getActivityTypes(function (infos) {\r\n                // transform to Activity Js Entities\r\n                var result = infos.map(function (info) { return HCBridge._hcToJsActivityType(info); });\r\n                resolve(result);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.registerActivityType = function (activityTypeName, ownerWindow, helperWindows, layoutConfig, description) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (helperWindows === undefined) {\r\n                helperWindows = [];\r\n            }\r\n            var config = {\r\n                name: activityTypeName,\r\n                ownerWindowType: ownerWindow,\r\n                helperWindowTypes: helperWindows,\r\n                description: description,\r\n                layoutConfig: JSON.stringify(layoutConfig)\r\n            };\r\n            // pass create request to HC\r\n            _this._htmlContainer.registerActivityType(JSON.stringify(config), function (info) {\r\n                // transform to Activity Js Entity\r\n                var newActivityType = HCBridge._hcToJsActivityType(info);\r\n                resolve(newActivityType);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.unregisterActivityType = function (activityTypeName) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // pass create request to HC\r\n            _this._htmlContainer.unregisterActivityType(activityTypeName, \r\n            /*( info )*/ function () {\r\n                resolve();\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.getWindowTypes = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // get all from HC\r\n            _this._htmlContainer.getWindowTypes(function (infos) {\r\n                // transform to Activity Js Entities\r\n                var result = infos.map(function (info) { return _this._hcToJsWindowType(info); });\r\n                resolve(result);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.registerWindowFactory = function (windowTypeName, factory, parameters) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(windowTypeName)) {\r\n                reject(\"windowTypeName should be provided\");\r\n                return;\r\n            }\r\n            // pass create request to HC\r\n            _this._htmlContainer.registerWindowFactory(windowTypeName, factory.create.bind(factory), \r\n            /*(info)*/ function () {\r\n                resolve();\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.initiateActivity = function (activityType, context, configuration) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(activityType)) {\r\n                reject(\"windowTypeName should be provided\");\r\n                return;\r\n            }\r\n            if (util.isUndefinedOrNull(context)) {\r\n                context = {};\r\n            }\r\n            // pass create request to HC\r\n            _this._htmlContainer.initiate(activityType, JSON.stringify(context), function (activityId) {\r\n                resolve(activityId);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.getAnnouncementInfo = function () {\r\n        var hc = window.htmlContainer;\r\n        var context = hc.getContext();\r\n        var result = { activityWindowId: \"\", activityWindowType: \"\", activityWindowIndependent: false, activityWindowName: \"\" };\r\n        if (!context.activityId) {\r\n            // in case we're not in activity just return. this will\r\n            // lead to window not registering itself\r\n            return result;\r\n        }\r\n        result.activityWindowType = context.activityWindowType;\r\n        if (util.isUndefined(result.activityWindowType)) {\r\n            result.activityWindowType = HCBridge._getURLParameter(\"activityWindowType\");\r\n        }\r\n        result.activityWindowId = context.activityWindowId;\r\n        if (util.isUndefined(result.activityWindowId)) {\r\n            result.activityWindowId = HCBridge._getURLParameter(\"activityWindowId\");\r\n        }\r\n        result.activityWindowIndependent = context.activityWindowIndependent;\r\n        if (util.isUndefined(result.activityWindowIndependent)) {\r\n            // TODO parse\r\n            // result.activityWindowIndependent = this._getURLParameter(\"activityWindowIndependent\");\r\n        }\r\n        result.activityWindowName = context.activityWindowName;\r\n        if (util.isUndefined(result.activityWindowName)) {\r\n            result.activityWindowName = HCBridge._getURLParameter(\"activityWindowName\");\r\n        }\r\n        return result;\r\n    };\r\n    HCBridge.prototype.announceWindow = function (windowType, activityWindowId) {\r\n        var _this = this;\r\n        if (util.isUndefined(windowType)) {\r\n            throw new Error(\"can not determine window type\");\r\n        }\r\n        if (util.isUndefined(windowType)) {\r\n            throw new Error(\"can not determine window activityWindowId\");\r\n        }\r\n        this._htmlContainer.announceWindow(windowType, activityWindowId, function (error) {\r\n            _this._logger.error(\"Error announcing activity window with id '\" + activityWindowId + \"'. \" + error);\r\n        });\r\n    };\r\n    HCBridge.prototype.getActivities = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // get all from HC\r\n            _this._logger.trace(\"Executing getActivities()\");\r\n            _this._htmlContainer.getActivities(function (activitiesStr) {\r\n                // transform to Activity Js Entities\r\n                _this._logger.trace(\"Got getActivities() :\" + activitiesStr);\r\n                var activities = JSON.parse(activitiesStr);\r\n                var result = activities.map(function (act) { return _this._hcToJsActivity(act); });\r\n                resolve(result);\r\n            }, function (error) {\r\n                _this._logger.trace(\"Error in getActivities() :\" + error);\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.updateActivityContext = function (activity, context, fullReplace, removedKeys) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (util.isUndefined(removedKeys)) {\r\n                removedKeys = [];\r\n            }\r\n            var options = {\r\n                fullReplace: fullReplace,\r\n                removedKeys: removedKeys\r\n            };\r\n            _this._htmlContainer.setActivityContext(activity.id, JSON.stringify(context), JSON.stringify(options), function (newContextString) {\r\n                // receives the new context as string\r\n                var newContext = JSON.parse(newContextString);\r\n                resolve(newContext);\r\n            }, function (error) { return reject(error); });\r\n        });\r\n    };\r\n    HCBridge.prototype.getActivityWindows = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // get all from HC\r\n            _this._htmlContainer.getWindows(function (windows) {\r\n                // transform to Activity Js Entities\r\n                var result = windows.map(function (wind) { return _this._hcToJsWindow(wind); });\r\n                resolve(result);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.stopActivity = function (activity) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.stopActivity(activity.id, function (result) {\r\n                resolve(result);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.unregisterWindowFactory = function (windowTypeName) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.registerWindowFactory(windowTypeName, \r\n            /*(info)*/ function () {\r\n                resolve();\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.createWindow = function (id, windowDefinition) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var objToSend = windowDefinition;\r\n            var functionToUse = _this._htmlContainer.createWindow2;\r\n            if (!functionToUse) {\r\n                functionToUse = _this._htmlContainer.createWindow;\r\n                objToSend = JSON.stringify(windowDefinition);\r\n            }\r\n            functionToUse(id, objToSend, function (newId) {\r\n                resolve(newId);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.createStackedWindows = function (id, windowDefinitions, timeout) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var objToSend = windowDefinitions;\r\n            var functionToUse = _this._htmlContainer.createStackedWindows2;\r\n            if (!functionToUse) {\r\n                functionToUse = _this._htmlContainer.createStackedWindows;\r\n                objToSend = JSON.stringify(windowDefinitions);\r\n            }\r\n            functionToUse(id, objToSend, timeout, function (newId) {\r\n                resolve(newId);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.onActivityTypeStatusChange = function (callback) {\r\n        this._activityTypeCallbacks.push(callback);\r\n    };\r\n    HCBridge.prototype.onWindowTypeStatusChange = function (callback) {\r\n        this._windowTypeCallbacks.push(callback);\r\n    };\r\n    HCBridge.prototype.onActivityStatusChange = function (callback) {\r\n        this._activityCallbacks.push(callback);\r\n    };\r\n    HCBridge.prototype.onActivityWindowChange = function (callback) {\r\n        this._windowCallbacks.push(callback);\r\n    };\r\n    HCBridge.prototype.getWindowBounds = function (id) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.getWindowBounds(id, function (bounds) {\r\n                resolve(bounds);\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.setWindowBounds = function (id, bounds) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.setWindowBounds(id, JSON.stringify(bounds), function () {\r\n                resolve();\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.registerWindow = function (type, name, independent) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.registerWindow(type, name, independent, function (id) {\r\n                resolve(id);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.closeWindow = function (id) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.closeWindow(id, function () {\r\n                resolve();\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.activateWindow = function (id, focus) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.activateWindow(id, focus, function () {\r\n                resolve();\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.setWindowVisibility = function (id, visible) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.setWindowVisibility(id, visible, function () {\r\n                resolve();\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.cloneActivity = function (id, options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.cloneActivity(id, options, function (activityId) {\r\n                resolve(activityId);\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype._publishStatusChange = function (entity, context, callbacks) {\r\n        var entityEvent = new entityEvent_1.EntityEvent(entity, context);\r\n        callbacks.forEach(function (callback) {\r\n            callback(entityEvent);\r\n        });\r\n    };\r\n    HCBridge.prototype._publishActivityTypeStatusChange = function (at, context) {\r\n        this._publishStatusChange(at, context, this._activityTypeCallbacks);\r\n    };\r\n    HCBridge.prototype._publishWindowTypeStatusChange = function (wt, context) {\r\n        this._publishStatusChange(wt, context, this._windowTypeCallbacks);\r\n    };\r\n    HCBridge.prototype._publishActivityStatusChange = function (act, context) {\r\n        this._publishStatusChange(act, context, this._activityCallbacks);\r\n    };\r\n    HCBridge.prototype._publishActivityWindowEvent = function (w, context) {\r\n        this._publishStatusChange(w, context, this._windowCallbacks);\r\n    };\r\n    HCBridge.prototype.attachActivities = function (from, to, tag) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.attachActivities(from, to, tag, function (state) {\r\n                resolve(state);\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.detachActivities = function (activityId, newActivityInfo) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.detachActivities(activityId, newActivityInfo, function (newActivityId) {\r\n                resolve(newActivityId);\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.onActivitiesAttached = function (callback) {\r\n        this._activitiesAttachedHandler = callback;\r\n    };\r\n    HCBridge.prototype.onActivitiesDetached = function (callback) {\r\n        this._activitiesDetached = callback;\r\n    };\r\n    HCBridge.prototype.onActivityAttachedDescriptorsRefreshed = function (callback) {\r\n        this._activityAttachedDescriptorsRefreshed = callback;\r\n    };\r\n    HCBridge.prototype.getAttachedDescriptors = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!_this._htmlContainer.getAttachedDescriptors) {\r\n                // support for container that does not have descriptors\r\n                resolve([]);\r\n                return;\r\n            }\r\n            _this._htmlContainer.getAttachedDescriptors(function (result) {\r\n                resolve(result);\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     *  Convert a ActivityWindow entity coming from HC to ActivityWindow\r\n     */\r\n    HCBridge.prototype._hcToJsWindow = function (hcWindow) {\r\n        var _this = this;\r\n        var windowGetter = function () { return undefined; };\r\n        if (this._windows) {\r\n            if (hcWindow.hcWindowId) {\r\n                windowGetter = function () { return _this._windows.list().filter(function (w) { return w.id === hcWindow.hcWindowId; })[0]; };\r\n            }\r\n            else {\r\n                // backward compatibility for HC < 1.58\r\n                windowGetter = function () { return _this._windows.list().filter(function (w) { return w.application === hcWindow.instance.application; })[0]; };\r\n            }\r\n        }\r\n        return new activityWindow_1.default(hcWindow.id, hcWindow.name, hcWindow.type, hcWindow.activityId, hcWindow.instance, hcWindow.isIndependent, windowGetter, hcWindow.hcWindowId);\r\n    };\r\n    return HCBridge;\r\n}());\r\nexports.default = HCBridge;\r\n//# sourceMappingURL=hcBridge.js.map\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * @typedef {Object} activityStatus Defines activity instance status\r\n * @property {string} state Current state\r\n * @property {string} message Message\r\n * @property {Date} time Time of the last status update\r\n */\r\nvar ActivityStatus = /** @class */ (function () {\r\n    function ActivityStatus(state, message, time) {\r\n        this.state = state;\r\n        this.message = message;\r\n        this.time = time;\r\n    }\r\n    ActivityStatus.prototype.getState = function () {\r\n        return this.state;\r\n    };\r\n    ActivityStatus.prototype.getMessage = function () {\r\n        return this.message;\r\n    };\r\n    ActivityStatus.prototype.getTime = function () {\r\n        return this.time;\r\n    };\r\n    return ActivityStatus;\r\n}());\r\nexports.ActivityStatus = ActivityStatus;\r\n//# sourceMappingURL=activityStatus.js.map\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityEntity_1 = __webpack_require__(7);\r\nvar activityAGM_1 = __webpack_require__(9);\r\nvar attachedActivityDescriptor_1 = __webpack_require__(57);\r\nvar promiseExtensions_1 = __webpack_require__(8);\r\nvar util_1 = __webpack_require__(0);\r\n/**\r\n * Activity is an instance of an activity type just like an object is an instance of a class\r\n * in class-based languages (and just like ‘John’ is an instance of a 'Person’).\r\n *\r\n * Activity is often used as a synonym for activity instance.\r\n *\r\n * Each activity instance has a single owner window and can optionally have one or more helper windows.\r\n *\r\n * @module activity\r\n */\r\nvar Activity = /** @class */ (function (_super) {\r\n    __extends(Activity, _super);\r\n    function Activity(id, actType, status, context, ownerId) {\r\n        var _this = _super.call(this, id) || this;\r\n        _this._id = id;\r\n        _this._actType = actType;\r\n        _this._status = status;\r\n        _this._context = context;\r\n        _this._ownerId = ownerId;\r\n        _this._agm = new activityAGM_1.ActivityAGM(_this);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Activity.prototype, \"type\", {\r\n        /**\r\n         * Activity type\r\n         * @var {module:activityType} type\r\n         */\r\n        get: function () {\r\n            if (this._manager) {\r\n                return this._manager.getActivityType(this._actType);\r\n            }\r\n            return undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Activity.prototype, \"context\", {\r\n        /**\r\n         * Get current activity context. To update use updateContext , to replace setContext\r\n         * @var {object} context\r\n         */\r\n        get: function () {\r\n            return this._context;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Activity.prototype, \"status\", {\r\n        /**\r\n         * Get activity status\r\n         * @var {activityStatus} status\r\n         */\r\n        get: function () {\r\n            return this._status;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Activity.prototype, \"owner\", {\r\n        /**\r\n         * The owner window\r\n         * @var {module:activityWindow} owner\r\n         */\r\n        get: function () {\r\n            if (!this._ownerId) {\r\n                return null;\r\n            }\r\n            return this._manager.getWindows({ id: this._ownerId })[0];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Activity.prototype, \"windows\", {\r\n        /**\r\n         * All windows participating in the activity\r\n         * @var {module:activityWindow[]} windows\r\n         */\r\n        get: function () {\r\n            return this._manager.getWindows({ activityId: this._id });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Activity.prototype, \"agm\", {\r\n        /**\r\n         * @var {module:activityAGM} agm\r\n         */\r\n        get: function () {\r\n            return this._agm;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Joins a specific window to the activity\r\n     *\r\n     * @private\r\n     * @function join\r\n     * @param window    The window to join\r\n     * @param callback  (Optional) Result callback\r\n     * @returns         Promise for ActivityWindow\r\n     */\r\n    Activity.prototype.addWindow = function (window, callback) {\r\n        return this._manager.addWindowToActivity(this, window, callback);\r\n    };\r\n    /**\r\n     * Creates a new window and joins it to the activity\r\n     *\r\n     * @function createWindow\r\n     * @param {string|windowDefinition} windowType The type of the window to be created\r\n     * @param callback\r\n     * @returns {Promise<module:activityWindow>}\r\n     */\r\n    Activity.prototype.createWindow = function (windowType, callback) {\r\n        return this._manager.createWindow(this, windowType, callback);\r\n    };\r\n    /**\r\n     * Creates a stacked set of windows and joins them to the\r\n     *\r\n     * @function createStackedWindows\r\n     * @param {string[] | windowDefinition[]} windowTypes The types of the windows to be created\r\n     * @param {number} timeout\r\n     * @param callback\r\n     * @returns {Promise<module:activityWindow[]>}\r\n     */\r\n    Activity.prototype.createStackedWindows = function (windowTypes, timeout, callback) {\r\n        return this._manager.createStackedWindows(this, windowTypes, timeout, callback);\r\n    };\r\n    /**\r\n     * Removes a window from the activity\r\n     *\r\n     * @private\r\n     * @param window\r\n     * @param callback\r\n     * @returns     Promise for ActivityWindow\r\n     */\r\n    Activity.prototype.leave = function (window, callback) {\r\n        return this._manager.leaveWindowFromActivity(this, window, callback);\r\n    };\r\n    /**\r\n     * Get all windows participating in the activity from a given type\r\n     *\r\n     * @param {string} windowType\r\n     * @returns {module:activityWindow[]}\r\n     */\r\n    Activity.prototype.getWindowsByType = function (windowType) {\r\n        var filter = { activityId: this._id, type: windowType };\r\n        return this._manager.getWindows(filter);\r\n    };\r\n    /**\r\n     * Replaces the activity context with a new one.\r\n     *\r\n     * @function setContext\r\n     * @param {object} context   The new context\r\n     * @param callback\r\n     * @returns {Promise<Object>}\r\n     */\r\n    Activity.prototype.setContext = function (context, callback) {\r\n        return this._manager.setActivityContext(this, context, callback);\r\n    };\r\n    /**\r\n     * Updates activity context using the properties from the context argument.\r\n     * If old context is {a:1, b:2, c:3} and invoking updateContext({b:3, c:null}) will result a context\r\n     * be {a:1, b:3}\r\n     *\r\n     * @function updateContext\r\n     * @param {object} context\r\n     * @param callback\r\n     * @return {Promise<object>}\r\n     */\r\n    Activity.prototype.updateContext = function (context, callback) {\r\n        return this._manager.updateActivityContext(this, context, callback);\r\n    };\r\n    /**\r\n     * Subscribe for status change events\r\n     *\r\n     * @function onStatusChange\r\n     *\r\n     * @param {activityStatusChangeHandler} handler Handler function that will receive status notifications\r\n     */\r\n    Activity.prototype.onStatusChange = function (handler) {\r\n        var _this = this;\r\n        return this._manager.subscribeActivityEvents(function (a, ns, os) {\r\n            if (a.id === _this.id) {\r\n                handler(a, ns, os);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Subscribe for window related events, like joined, removed from activity\r\n     *\r\n     * @function onWindowEvent\r\n     * @param {windowEventHandler} handler Handler function that will receive windows events\r\n     */\r\n    Activity.prototype.onWindowEvent = function (handler) {\r\n        var _this = this;\r\n        return this._manager.subscribeWindowEvents(function (a, w, e) {\r\n            if (a.id === _this.id) {\r\n                handler(a, w, e);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Subscribe for context updates\r\n     *\r\n     * @function onContextChanged\r\n     * @param {contextChangedHandler} handler Handler function that will receive context related events\r\n     */\r\n    Activity.prototype.onContextChanged = function (handler) {\r\n        var _this = this;\r\n        this._manager.subscribeActivityContextChanged(function (act, context) {\r\n            if (act.id === _this.id) {\r\n                handler(context, act);\r\n            }\r\n        });\r\n        try {\r\n            // replay the context at the time of subscribing, swallow user exceptions\r\n            handler(this.context, this);\r\n        }\r\n        catch (e) {\r\n            return;\r\n        }\r\n    };\r\n    /**\r\n     * Stops the activity\r\n     * @function stop\r\n     */\r\n    Activity.prototype.stop = function () {\r\n        this._manager.stopActivity(this);\r\n    };\r\n    /**\r\n     * Clones the activity into a new one\r\n     * @function clone\r\n     * @param {CloneOptions} options\r\n     */\r\n    Activity.prototype.clone = function (options) {\r\n        return this._manager.clone(this, options);\r\n    };\r\n    Activity.prototype.attach = function (activity, tag) {\r\n        var activityId;\r\n        if (typeof activity === \"string\") {\r\n            activityId = activity;\r\n        }\r\n        else {\r\n            activityId = activity.id;\r\n        }\r\n        return this._manager.attachActivities(activityId, this.id, tag);\r\n    };\r\n    Activity.prototype.onActivityAttached = function (callback) {\r\n        var _this = this;\r\n        this._manager.subscribeActivitiesAttached(function (newActId, oldActId, descriptor) {\r\n            if (newActId !== _this._id) {\r\n                return;\r\n            }\r\n            callback(descriptor);\r\n        });\r\n    };\r\n    Activity.prototype.onDetached = function (callback) {\r\n        var _this = this;\r\n        this._manager.subscribeActivitiesDetached(function (newAct, originalActivity, state) {\r\n            if (originalActivity.id !== _this._id) {\r\n                return;\r\n            }\r\n            callback(newAct, state);\r\n        });\r\n    };\r\n    Activity.prototype._updateCore = function (other) {\r\n        var _this = this;\r\n        _super.prototype._updateCore.call(this, other);\r\n        util_1.ifNotUndefined(other._actType, function (x) { return _this._actType = x; });\r\n        util_1.ifNotUndefined(other._context, function (x) { return _this._context = x; });\r\n        util_1.ifNotUndefined(other._ownerId, function (x) { return _this._ownerId = x; });\r\n        if (other._status && (!this._status || (this._status.state !== other._status.state))) {\r\n            this._status = other._status;\r\n        }\r\n    };\r\n    Activity.prototype._updateDescriptors = function (allStates) {\r\n        var _this = this;\r\n        this._attached = allStates.map(function (s) {\r\n            return new attachedActivityDescriptor_1.AttachedActivityDescriptor(_this._manager, _this._id, s);\r\n        });\r\n    };\r\n    Object.defineProperty(Activity.prototype, \"attached\", {\r\n        get: function () {\r\n            return this._attached;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Activity.prototype.setFrameColor = function (color, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            var callbacksToWait = _this.windows.length;\r\n            if (callbacksToWait === 0) {\r\n                resolve(_this);\r\n            }\r\n            _this.windows.forEach(function (w) {\r\n                w.underlyingWindow.setFrameColor(color, function () {\r\n                    callbacksToWait--;\r\n                    if (callbacksToWait <= 0) {\r\n                        resolve(_this);\r\n                    }\r\n                });\r\n            });\r\n            setTimeout(function () {\r\n                if (callbacksToWait > 0) {\r\n                    reject(_this.id + \" - timed out waiting for setFrameColor with\" + color);\r\n                }\r\n            }, 5000);\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    Activity.prototype.getFrameColor = function () {\r\n        if (!this.windows || this.windows.length === 0) {\r\n            return \"\";\r\n        }\r\n        return this.windows[0].underlyingWindow.frameColor;\r\n    };\r\n    return Activity;\r\n}(activityEntity_1.default));\r\nexports.default = Activity;\r\n//# sourceMappingURL=activity.js.map\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityEntity_1 = __webpack_require__(7);\r\nvar logger_1 = __webpack_require__(4);\r\nvar util = __webpack_require__(0);\r\nvar util_1 = __webpack_require__(0);\r\nvar entityEvent_1 = __webpack_require__(2);\r\n/**\r\n * A window participating in an activity\r\n *\r\n * @module activityWindow\r\n */\r\nvar ActivityWindow = /** @class */ (function (_super) {\r\n    __extends(ActivityWindow, _super);\r\n    function ActivityWindow(id, name, type, activityId, instance, isIndependent, windowGetter, hcWindowId) {\r\n        var _this = _super.call(this, id) || this;\r\n        _this._logger = logger_1.Logger.Get(\"window\");\r\n        _this._type = type;\r\n        _this._activityId = activityId;\r\n        _this._name = name;\r\n        _this._instance = instance;\r\n        _this._isIndependent = isIndependent;\r\n        _this._windowGetter = windowGetter;\r\n        _this._hcWindowId = hcWindowId;\r\n        return _this;\r\n    }\r\n    /**\r\n     * Return window's title\r\n     * @function getBounds\r\n     * @return {Promise<WindowBounds>}\r\n     */\r\n    ActivityWindow.prototype.getBounds = function () {\r\n        return this._manager.getWindowBounds(this.id);\r\n    };\r\n    Object.defineProperty(ActivityWindow.prototype, \"name\", {\r\n        /**\r\n         * @var {string} name The window name\r\n         */\r\n        get: function () {\r\n            return this._name;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityWindow.prototype, \"isIndependent\", {\r\n        /**\r\n         * @var {bool} isIndependent True if this is an independent window\r\n         */\r\n        get: function () {\r\n            return this._isIndependent;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityWindow.prototype, \"type\", {\r\n        /**\r\n         * @var {module:windowType} type The window type\r\n         */\r\n        get: function () {\r\n            if (this._manager) {\r\n                return this._manager.getWindowType(this._type);\r\n            }\r\n            return undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityWindow.prototype, \"activity\", {\r\n        /**\r\n         * @var {module:activity} activity The activity that the window is part of\r\n         */\r\n        get: function () {\r\n            if (util.isUndefined(this._activityId)) {\r\n                return undefined;\r\n            }\r\n            return this._manager.getActivityById(this._activityId);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityWindow.prototype, \"isOwner\", {\r\n        /**\r\n         * @var {bool} isOwner True if the window is the owner of the activity.\r\n         */\r\n        get: function () {\r\n            var act = this.activity;\r\n            if (util.isUndefined(act)) {\r\n                return false;\r\n            }\r\n            return act.owner.id === this.id;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Sets window's visibility\r\n     *\r\n     * @function setVisible\r\n     * @param {boolean} isVisible\r\n     * @returns {Promise<module:activityWindow>}\r\n     */\r\n    ActivityWindow.prototype.setVisible = function (isVisible, callback) {\r\n        return this._manager.setWindowVisibility(this.id, isVisible);\r\n    };\r\n    /**\r\n     * Activate window\r\n     * @function activate\r\n     * @param {boolean} focus If true then activate window with focus otherwise activate window without focus\r\n     */\r\n    ActivityWindow.prototype.activate = function (focus) {\r\n        return this._manager.activateWindow(this.id, focus);\r\n    };\r\n    /**\r\n     * Sets window's bounds\r\n     * @function setBounds\r\n     *\r\n     * @param {bounds} bounds The new bounds to be applied\r\n     * @returns  {Promise<module:activityWindow>}\r\n     */\r\n    ActivityWindow.prototype.setBounds = function (bounds, callback) {\r\n        return this._manager.setWindowBounds(this.id, bounds, callback);\r\n    };\r\n    /**\r\n     * Closes the window\r\n     *\r\n     * @function close\r\n     * @returns {Promise}\r\n     */\r\n    ActivityWindow.prototype.close = function () {\r\n        return this._manager.closeWindow(this.id);\r\n    };\r\n    Object.defineProperty(ActivityWindow.prototype, \"instance\", {\r\n        /**\r\n         * @var {agmInstance} instance The agm instance of that window. You can use this to invoke AGM methods against that window\r\n         */\r\n        get: function () {\r\n            return this._instance;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityWindow.prototype, \"underlyingWindow\", {\r\n        /**\r\n         * Returns the window as object from Windows API (glue.windows).\r\n         *\r\n         * @var {window} underlyingWindow\r\n         */\r\n        get: function () {\r\n            var window = this._windowGetter();\r\n            if (!window) {\r\n                // we don't have the window object any more, let's return as much as we can\r\n                return {\r\n                    id: this._hcWindowId\r\n                };\r\n            }\r\n            return window;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ActivityWindow.prototype.onActivityJoined = function (callback) {\r\n        this._subscribeForActivityWindowEvent(entityEvent_1.EntityEventType.ActivityWindowJoinedActivity, callback);\r\n    };\r\n    ActivityWindow.prototype.onActivityRemoved = function (callback) {\r\n        this._subscribeForActivityWindowEvent(entityEvent_1.EntityEventType.ActivityWindowLeftActivity, callback);\r\n    };\r\n    ActivityWindow.prototype._updateCore = function (other) {\r\n        var _this = this;\r\n        util_1.ifNotUndefined(other._activityId, function (x) { return _this._activityId = x; });\r\n        util_1.ifNotUndefined(other._isIndependent, function (x) { return _this._isIndependent = x; });\r\n        util_1.ifNotUndefined(other._hcWindowId, function (x) { return _this._hcWindowId = x; });\r\n        util_1.ifNotUndefined(other._type, function (x) { return _this._type = x; });\r\n        util_1.ifNotUndefined(other._name, function (x) { return _this._name = x; });\r\n        if (!util.isUndefinedOrNull(other._instance)) {\r\n            this._instance = other._instance;\r\n        }\r\n    };\r\n    ActivityWindow.prototype._subscribeForActivityWindowEvent = function (eventName, callback) {\r\n        var _this = this;\r\n        this._manager.subscribeWindowEvents(function (activity, window, event) {\r\n            // ignore events not related to this window\r\n            if (window.id !== _this.id) {\r\n                return;\r\n            }\r\n            if (event === eventName) {\r\n                callback(activity);\r\n            }\r\n        });\r\n    };\r\n    ActivityWindow.prototype._beforeDelete = function (other) {\r\n        this._hcWindowId = other._hcWindowId;\r\n    };\r\n    return ActivityWindow;\r\n}(activityEntity_1.default));\r\nexports.default = ActivityWindow;\r\n//# sourceMappingURL=activityWindow.js.map\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityEntity_1 = __webpack_require__(7);\r\n/**\r\n * A window type is a definition of a window, typically configured in ACS.\r\n *\r\n * @module windowType\r\n */\r\nvar WindowType = /** @class */ (function (_super) {\r\n    __extends(WindowType, _super);\r\n    function WindowType(name, appByWindowTypeGetter) {\r\n        var _this = _super.call(this, name) || this;\r\n        _this._name = name;\r\n        _this._appByWindowTypeGetter = appByWindowTypeGetter;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(WindowType.prototype, \"name\", {\r\n        /**\r\n         * Name of the window type\r\n         * @var {string} name\r\n         */\r\n        get: function () {\r\n            return this._name;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(WindowType.prototype, \"config\", {\r\n        /**\r\n         * Returns the ACS configuration related to this window type (as application object from AppManager API)\r\n         * @returns {any}\r\n         */\r\n        get: function () {\r\n            return this._appByWindowTypeGetter(this._name);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(WindowType.prototype, \"windows\", {\r\n        /**\r\n         * @var {activityWindow[]} windows All windows from that type\r\n         */\r\n        get: function () {\r\n            return this._manager.getWindows({ type: this._name });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    WindowType.prototype.create = function (activity, configuration) {\r\n        var definition = Object.assign({ type: this.name, name: this.name, isIndependent: false }, configuration);\r\n        return this._manager.createWindow(activity, definition);\r\n    };\r\n    return WindowType;\r\n}(activityEntity_1.default));\r\nexports.default = WindowType;\r\n//# sourceMappingURL=windowType.js.map\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar logger_1 = __webpack_require__(4);\r\nvar util = __webpack_require__(0);\r\n/**\r\n * Class that can be used as a marker for successful completion of a set of events\r\n * @private\r\n * @module readyMarker\r\n */\r\nvar ReadyMarker = /** @class */ (function () {\r\n    /**\r\n     * Creates new marker\r\n     * @param name Name of the marker, useful in logging\r\n     * @param signalsToWait Number of signals(events) that needs to be signaled (completed) before the marker is set as completed\r\n     */\r\n    function ReadyMarker(name, signalsToWait) {\r\n        this._logger = logger_1.Logger.Get(\"ReadyMarker [\" + name + \"]\");\r\n        this._logger.debug(\"Initializing ready marker for '\" + name + \"' with \" + signalsToWait + \" signals to wait\");\r\n        if (signalsToWait <= 0) {\r\n            throw new Error(\"Invalid signal number. Should be > 0\");\r\n        }\r\n        this._signals = signalsToWait;\r\n        this._callbacks = [];\r\n        this._name = name;\r\n    }\r\n    /**\r\n     * Adds a new callback that will be notified when the events are completed (success) or some error happened\r\n     */\r\n    ReadyMarker.prototype.setCallback = function (callback) {\r\n        if (this.isSet()) {\r\n            callback(undefined);\r\n            return;\r\n        }\r\n        else if (this.isError()) {\r\n            callback(this._error);\r\n            return;\r\n        }\r\n        this._callbacks.push(callback);\r\n    };\r\n    /**\r\n     * Signals for a completion of an event. If this is the last event success callbacks will be called\r\n     */\r\n    ReadyMarker.prototype.signal = function (message) {\r\n        this._logger.debug(\"Signaled - \" + message + \" - signals left \" + (this._signals - 1));\r\n        this._signals--;\r\n        if (this._signals < 0) {\r\n            throw new Error(\"Error in ready marker '\" + this._name + \" - signals are \" + this._signals);\r\n        }\r\n        if (this.isSet()) {\r\n            this._callbacks.forEach(function (callback) {\r\n                callback(undefined);\r\n            });\r\n        }\r\n    };\r\n    /**\r\n     * Signals for an error in some of the events. This will notify all callbacks that the marker has failed\r\n     */\r\n    ReadyMarker.prototype.error = function (error) {\r\n        this._error = error;\r\n        this._callbacks.forEach(function (errorCallback) {\r\n            errorCallback(error);\r\n        });\r\n    };\r\n    /**\r\n     * Checks if the marker is set (completed)\r\n     */\r\n    ReadyMarker.prototype.isSet = function () {\r\n        if (this.isError()) {\r\n            return false;\r\n        }\r\n        return this._signals === 0;\r\n    };\r\n    /**\r\n     * Checks if the marker has failed (some of the events has failed)\r\n     */\r\n    ReadyMarker.prototype.isError = function () {\r\n        return !util.isUndefined(this._error);\r\n    };\r\n    /**\r\n     * Returns the last reported error (undefined if no error)\r\n     */\r\n    ReadyMarker.prototype.getError = function () {\r\n        return this._error;\r\n    };\r\n    return ReadyMarker;\r\n}());\r\nexports.ReadyMarker = ReadyMarker;\r\n//# sourceMappingURL=readyMarker.js.map\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LayoutImpl = /** @class */ (function () {\r\n    function LayoutImpl(data) {\r\n        this.name = data.name;\r\n        this.type = data.type;\r\n        this.components = data.components;\r\n        this.context = data.context;\r\n    }\r\n    return LayoutImpl;\r\n}());\r\nexports.default = LayoutImpl;\r\n//# sourceMappingURL=layout.js.map\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// provides a unified way to access layouts array\r\nvar LayoutStore = /** @class */ (function () {\r\n    function LayoutStore() {\r\n        this.layouts = [];\r\n    }\r\n    LayoutStore.prototype.removeWhere = function (condition) {\r\n        this.layouts = this.layouts.filter(condition);\r\n    };\r\n    LayoutStore.prototype.add = function (item) {\r\n        this.layouts.push(item);\r\n    };\r\n    Object.defineProperty(LayoutStore.prototype, \"all\", {\r\n        get: function () {\r\n            return this.layouts;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayoutStore.prototype.where = function (condition) {\r\n        return this.layouts.filter(condition);\r\n    };\r\n    LayoutStore.prototype.first = function (condition) {\r\n        return this.where(condition)[0];\r\n    };\r\n    return LayoutStore;\r\n}());\r\nexports.LayoutStore = LayoutStore;\r\nexports.default = new LayoutStore();\r\n//# sourceMappingURL=store.js.map\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// A simple transformation that makes object to start with lowercase\r\n// Note that this is not full implementation as it supports only:\r\n// undefined, null, arrays, number, string, bool. Anything out of this\r\n// list is considered Object\r\nfunction transformACSLayout(something) {\r\n    if (!something) {\r\n        return something;\r\n    }\r\n    if (Array.isArray(something)) {\r\n        return something.map(function (item) {\r\n            return transformACSLayout(item);\r\n        });\r\n    }\r\n    if (typeof something === \"string\" || typeof something === \"number\" || typeof something === \"boolean\") {\r\n        return something;\r\n    }\r\n    var initial = {};\r\n    return Object.keys(something).reduce(function (accumulator, current) {\r\n        var value = something[current];\r\n        var convertedValue = transformACSLayout(value);\r\n        var key = current;\r\n        if (current[0].toLowerCase() !== current[0]) {\r\n            key = current[0].toLowerCase() + current.substr(1);\r\n        }\r\n        accumulator[key] = convertedValue;\r\n        return accumulator;\r\n    }, initial);\r\n}\r\nexports.default = transformACSLayout;\r\n//# sourceMappingURL=transform.js.map\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar store_1 = __webpack_require__(3);\r\nfunction getWindowsByTabGroupId(windowId, tabGroupId) {\r\n    var windows = store_1.default.list;\r\n    return Object.keys(windows).reduce(function (memo, id) {\r\n        var win = windows[id];\r\n        if (win.API.tabGroupId === tabGroupId && win.API.id !== windowId) {\r\n            memo[id] = win;\r\n        }\r\n        return memo;\r\n    }, {});\r\n}\r\nexports.getWindowsByTabGroupId = getWindowsByTabGroupId;\r\n//# sourceMappingURL=helpers.js.map\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar store_1 = __webpack_require__(3);\r\nexports.default = (function (id, options, executor, logger, appManagerGetter) {\r\n    var _registry = callback_registry_1.default();\r\n    var _logger = logger.subLogger(\"window \" + id);\r\n    var _name = options.name;\r\n    var _mode = options.mode;\r\n    var _url = options.url;\r\n    var _title = options.title;\r\n    var _context = options.context || {};\r\n    var _bounds = options.bounds;\r\n    var _frameColor = options.frameColor;\r\n    var _focus = options.focus;\r\n    var _neighbours = options.neighbours || {};\r\n    var _groupId = options.groupId;\r\n    var _isGroupHeaderVisible = options.isGroupHeaderVisible;\r\n    var _isTabHeaderVisible = options.isTabHeaderVisible;\r\n    var _isTabSelected = options.isTabSelected;\r\n    var _settings = options.settings;\r\n    // is Window visible\r\n    var _isVisible = options.isVisible;\r\n    // Window state Collapsed | Expanded\r\n    var isCollapsed = options.isCollapsed;\r\n    // Window state normal | maximized | minimized\r\n    var _windowState = options.state;\r\n    // tabGroupId only for window with 'Tab' mode\r\n    var _tabGroupId = options.tabGroupId;\r\n    // window is locked or unlocked;\r\n    var _isLocked = options.isLocked;\r\n    var _group;\r\n    var resultWindow;\r\n    // Holding all frame buttons\r\n    var _frameButtons = [];\r\n    //#region \"AGM methods\"\r\n    function close(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.close(resultWindow)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function navigate(newUrl, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.navigate(resultWindow, newUrl)\r\n                .then(function () {\r\n                if (newUrl === _url) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onUrlChanged(function (url, win) {\r\n                    if (win.id === id && url === win.url) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setStyle(style, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setStyle(resultWindow, style)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setTitle(newTitle, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setTitle(resultWindow, newTitle)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n        // OPTION 2\r\n        // const promise = executor.setTitle(resultWindow, newTitle)\r\n        // return promisify\r\n    }\r\n    function moveResize(dimensions, success, error) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            executor.moveResize(resultWindow, dimensions)\r\n                .then(function () {\r\n                var areHeightsEqual = dimensions.height ? _bounds.height === dimensions.height : true;\r\n                var areWidthsEqual = dimensions.width ? _bounds.width === dimensions.width : true;\r\n                var areLeftsEqual = dimensions.left ? _bounds.left === dimensions.left : true;\r\n                var areTopsEqual = dimensions.top ? _bounds.top === dimensions.top : true;\r\n                if (areHeightsEqual &&\r\n                    areWidthsEqual &&\r\n                    areLeftsEqual &&\r\n                    areTopsEqual) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = _this.onBoundsChanged(function (win) {\r\n                    areHeightsEqual = dimensions.height ? win.bounds.height === dimensions.height : true;\r\n                    areWidthsEqual = dimensions.width ? win.bounds.width === dimensions.width : true;\r\n                    areLeftsEqual = dimensions.left ? win.bounds.left === dimensions.left : true;\r\n                    areTopsEqual = dimensions.top ? win.bounds.top === dimensions.top : true;\r\n                    if (win.id === _this.id &&\r\n                        areHeightsEqual &&\r\n                        areWidthsEqual &&\r\n                        areLeftsEqual &&\r\n                        areTopsEqual) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function addFrameButton(buttonInfo, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            if (typeof buttonInfo === \"undefined\") {\r\n                if (typeof error === \"function\") {\r\n                    error(\"No button info\");\r\n                    return;\r\n                }\r\n                reject(\"No button info\");\r\n                return;\r\n            }\r\n            if (buttonInfo.buttonId === undefined) {\r\n                if (typeof error === \"function\") {\r\n                    error(\"No buttonId\");\r\n                    return;\r\n                }\r\n                reject(\"No buttonId\");\r\n                return;\r\n            }\r\n            if (buttonInfo.imageBase64 === undefined) {\r\n                if (typeof error === \"function\") {\r\n                    error(\"No imageBase64\");\r\n                    return;\r\n                }\r\n                reject(\"No imageBase64\");\r\n                return;\r\n            }\r\n            executor.addFrameButton(resultWindow, buttonInfo)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function removeFrameButton(buttonId, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            if (buttonId === undefined || buttonId === \"\") {\r\n                if (typeof error === \"function\") {\r\n                    error(\"No buttonId\");\r\n                    return;\r\n                }\r\n                reject(\"No buttonId\");\r\n                return;\r\n            }\r\n            executor.removeFrameButton(resultWindow, buttonId)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function activate(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.activate(resultWindow)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function focus(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.focus(resultWindow)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function maximizeRestore(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            var currEvent = _windowState === \"normal\" ? onMaximized : onNormal;\r\n            executor.maximizeRestore(resultWindow)\r\n                .then(function () {\r\n                var un = currEvent(function () {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    un();\r\n                    resolve(resultWindow);\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function maximize(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.maximize(resultWindow)\r\n                .then(function () {\r\n                if (_windowState === \"maximized\") {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onMaximized(function (win) {\r\n                    if (win.id === id && win.state === \"maximized\") {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function restore(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.restore(resultWindow)\r\n                .then(function () {\r\n                if (_windowState === \"normal\") {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onNormal(function (win) {\r\n                    if (id === win.id && win.state === \"normal\") {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function minimize(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.minimize(resultWindow)\r\n                .then(function () {\r\n                if (_windowState === \"minimized\") {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onMinimized(function (win) {\r\n                    if (id === win.id && win.state === \"minimized\") {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        return resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function collapse(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.collapse(resultWindow)\r\n                .then(function () {\r\n                if (isCollapsed) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onCollapsed(function (win) {\r\n                    if (win.id === id) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function expand(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.expand(resultWindow)\r\n                .then(function () {\r\n                if (!isCollapsed) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onExpanded(function (win) {\r\n                    if (win.id === id) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function toggleCollapse(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            var currEvent = isCollapsed ? onExpanded : onCollapsed;\r\n            executor.toggleCollapse(resultWindow)\r\n                .then(function () {\r\n                currEvent(function (win) {\r\n                    if (win.id === id) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function snap(target, direction, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.snap(resultWindow, target, direction)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function attachTab(tab, index, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            var sourceWindowId;\r\n            var targetWindowId = resultWindow.id;\r\n            var errorMessage = \"Invalid tab parameter - should be an object with property id or a string. Invoked for source window id:\" + resultWindow.id;\r\n            if (!tab) {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            if (typeof tab === \"string\") {\r\n                sourceWindowId = tab;\r\n            }\r\n            else if (typeof tab.id !== \"undefined\") {\r\n                sourceWindowId = tab.id;\r\n            }\r\n            else {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            var argsForSend = {\r\n                sourceWindowId: sourceWindowId,\r\n                targetWindowId: targetWindowId,\r\n            };\r\n            if (index) {\r\n                argsForSend.index = index;\r\n            }\r\n            executor.attachTab(resultWindow, argsForSend)\r\n                .then(function () {\r\n                var sourceWin = store_1.default.get(argsForSend.sourceWindowId).API;\r\n                sourceWin.onAttached(function (win) {\r\n                    if (win.id === sourceWin.id) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function detachTab(opt, success, error) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var argsForSend = { windowId: resultWindow.id };\r\n            var _options = opt || {};\r\n            if (typeof _options.relativeTo !== \"undefined\") {\r\n                if (typeof _options.relativeTo === \"string\") {\r\n                    argsForSend.relativeTo = _options.relativeTo;\r\n                }\r\n                else if (typeof _options.relativeTo.id !== \"undefined\") {\r\n                    argsForSend.relativeTo = _options.relativeTo.id;\r\n                }\r\n                if (typeof _options.relativeDirection !== \"undefined\") {\r\n                    argsForSend.relativeDirection = _options.relativeDirection;\r\n                }\r\n                if (typeof _options.width !== \"undefined\") {\r\n                    argsForSend.width = _options.width;\r\n                }\r\n                if (typeof _options.height !== \"undefined\") {\r\n                    argsForSend.height = _options.height;\r\n                }\r\n            }\r\n            if (typeof _options.bounds !== \"undefined\") {\r\n                argsForSend.bounds = _options.bounds;\r\n            }\r\n            if (typeof _options.hideTabHeader !== \"undefined\") {\r\n                argsForSend.hideTabHeader = _options.hideTabHeader;\r\n            }\r\n            executor.detachTab(resultWindow, argsForSend)\r\n                .then(function () {\r\n                var visibilityChangeHeard = false;\r\n                var detachedHeard = false;\r\n                var unVisibility = _registry.add(\"frame-attached\", (function (win) {\r\n                    var isVisibilityCorrect = _options.hideTabHeader === undefined || _options.hideTabHeader !== win.isTabHeaderVisible;\r\n                    if (id === win.id && isVisibilityCorrect) {\r\n                        visibilityChangeHeard = true;\r\n                        unVisibility();\r\n                        if (detachedHeard) {\r\n                            if (typeof success === \"function\") {\r\n                                success(resultWindow);\r\n                            }\r\n                            resolve(resultWindow);\r\n                            if (typeof unDetached === \"function\") {\r\n                                unDetached();\r\n                            }\r\n                        }\r\n                    }\r\n                }));\r\n                var unDetached = _this.onDetached(function (win) {\r\n                    if (id === win.id) {\r\n                        detachedHeard = true;\r\n                        unDetached();\r\n                        if (visibilityChangeHeard) {\r\n                            if (typeof success === \"function\") {\r\n                                success(resultWindow);\r\n                            }\r\n                            resolve(resultWindow);\r\n                            if (typeof unVisibility === \"function\") {\r\n                                unVisibility();\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setVisible(toBeVisible, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setVisible(resultWindow, toBeVisible)\r\n                .then(function () {\r\n                var isVisibilityCorrect = toBeVisible === undefined ? _isVisible === true : _isVisible === toBeVisible;\r\n                if (isVisibilityCorrect) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onVisibilityChanged(function (win) {\r\n                    isVisibilityCorrect = toBeVisible === undefined ? win.isVisible === true : win.isVisible === toBeVisible;\r\n                    if (win.id === id && isVisibilityCorrect) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function showLoader(loader) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.showLoader(resultWindow, loader)\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function hideLoader() {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.hideLoader(resultWindow)\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function updateContext(context, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.updateContext(resultWindow, context)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function lock(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.lock(resultWindow)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function unlock(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.unlock(resultWindow)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function getIcon(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            // agm.invoke(\"T42.Wnd.GetIcon\", { windowId: resultWindow.id }, \"best\", {}, successHandler, error);\r\n            executor.getIcon(resultWindow)\r\n                .then(function (icon) {\r\n                if (typeof success === \"function\") {\r\n                    success(icon);\r\n                }\r\n                resolve(icon);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setIcon(base64Image, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setIcon(resultWindow, base64Image)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setFrameColor(frameColor, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setFrameColor(resultWindow, frameColor)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setTabHeaderVisible(toBeTabHeaderVisible, success, error) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setTabHeaderVisible(resultWindow, toBeTabHeaderVisible)\r\n                .then(function () {\r\n                if (_isTabHeaderVisible === toBeTabHeaderVisible) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = _this.onTabHeaderVisibilityChanged(function (win) {\r\n                    if (win.id === id && win.isTabHeaderVisible === toBeTabHeaderVisible) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    //#endregion \"AGM methods\"\r\n    //#region \"Events\"\r\n    function onTitleChanged(callback) {\r\n        callback(resultWindow.title, resultWindow);\r\n        return _registry.add(\"onTitleChanged\", callback);\r\n    }\r\n    function onClose(callback) {\r\n        return _registry.add(\"onClose\", callback);\r\n    }\r\n    function onUrlChanged(callback) {\r\n        return _registry.add(\"onUrlChanged\", callback);\r\n    }\r\n    function onFrameButtonAdded(callback) {\r\n        return _registry.add(\"onFrameButtonAdded\", callback);\r\n    }\r\n    function onFrameButtonRemoved(callback) {\r\n        return _registry.add(\"onFrameButtonRemoved\", callback);\r\n    }\r\n    function onFrameButtonClicked(callback) {\r\n        return _registry.add(\"onFrameButtonClicked\", callback);\r\n    }\r\n    function onCollapsed(callback) {\r\n        if (isCollapsed) {\r\n            callback(resultWindow);\r\n        }\r\n        return _registry.add(\"collapsed\", callback);\r\n    }\r\n    function onExpanded(callback) {\r\n        if (!isCollapsed) {\r\n            callback(resultWindow);\r\n        }\r\n        return _registry.add(\"expanded\", callback);\r\n    }\r\n    function onMaximized(callback) {\r\n        if (_windowState === \"maximized\") {\r\n            callback(resultWindow);\r\n        }\r\n        return _registry.add(\"maximized\", callback);\r\n    }\r\n    function onMinimized(callback) {\r\n        if (_windowState === \"minimized\") {\r\n            callback(resultWindow);\r\n        }\r\n        return _registry.add(\"minimized\", callback);\r\n    }\r\n    function onNormal(callback) {\r\n        if (_windowState === \"normal\") {\r\n            callback(resultWindow);\r\n        }\r\n        return _registry.add(\"normal\", callback);\r\n    }\r\n    function onAttached(callback) {\r\n        return _registry.add(\"attached\", callback);\r\n    }\r\n    function onDetached(callback) {\r\n        return _registry.add(\"detached\", callback);\r\n    }\r\n    function onVisibilityChanged(callback) {\r\n        return _registry.add(\"visibility-changed\", callback);\r\n    }\r\n    function onContextUpdated(callback) {\r\n        return _registry.add(\"context-updated\", callback);\r\n    }\r\n    function onLockingChanged(callback) {\r\n        return _registry.add(\"lock-changed\", callback);\r\n    }\r\n    function onBoundsChanged(callback) {\r\n        return _registry.add(\"bounds-changed\", callback);\r\n    }\r\n    function onFocusChanged(callback) {\r\n        return _registry.add(\"focus-changed\", callback);\r\n    }\r\n    function onFrameColorChanged(callback) {\r\n        return _registry.add(\"frame-color-changed\", callback);\r\n    }\r\n    function onTabHeaderVisibilityChanged(callback) {\r\n        return _registry.add(\"tab-header-visibility-changed\", callback);\r\n    }\r\n    function onWindowAttached(callback) {\r\n        return _registry.add(\"window-attached\", callback);\r\n    }\r\n    function onWindowDetached(callback) {\r\n        return _registry.add(\"window-detached\", callback);\r\n    }\r\n    function onGroupChanged(callback) {\r\n        return _registry.add(\"group-changed\", callback);\r\n    }\r\n    function onTabSelectionChanged(callback) {\r\n        return _registry.add(\"tab-selection-changed\", callback);\r\n    }\r\n    //#endregion \"Events\"\r\n    //#region \"Stream function\"\r\n    function handleTitleChanged(newTitle) {\r\n        _title = newTitle;\r\n        _registry.execute(\"onTitleChanged\", newTitle, resultWindow);\r\n    }\r\n    function handleUrlChanged(newUrl) {\r\n        _url = newUrl;\r\n        _registry.execute(\"onUrlChanged\", newUrl, resultWindow);\r\n    }\r\n    function handleVisibilityChanged(isVisible) {\r\n        if (isVisible === _isVisible) {\r\n            return;\r\n        }\r\n        _isVisible = isVisible;\r\n        _registry.execute(\"visibility-changed\", resultWindow);\r\n    }\r\n    function handleWindowSettingsChanged(settings) {\r\n        _settings = settings;\r\n        _registry.execute(\"settings-changed\", resultWindow);\r\n    }\r\n    function handleContextUpdated(context) {\r\n        _context = context;\r\n        _registry.execute(\"context-updated\", _context, resultWindow);\r\n    }\r\n    function handleWindowClose() {\r\n        if (resultWindow.id === undefined) {\r\n            return;\r\n        }\r\n        resultWindow.id = undefined;\r\n        _registry.execute(\"onClose\", resultWindow);\r\n    }\r\n    function handleFrameButtonAdded(frameButton) {\r\n        var buttonObj = [\"buttonId\", \"imageBase64\", \"order\", \"tooltip\"].reduce(function (memo, k) {\r\n            memo[k] = frameButton[k];\r\n            return memo;\r\n        }, {});\r\n        var frameButtonsIds = _frameButtons.map(function (btn) {\r\n            return btn.buttonId;\r\n        });\r\n        if (frameButtonsIds.indexOf(frameButton.buttonId) === -1) {\r\n            _frameButtons.push(buttonObj);\r\n        }\r\n        _registry.execute(\"onFrameButtonAdded\", buttonObj, resultWindow);\r\n    }\r\n    function handleFrameButtonRemoved(frameButtonId) {\r\n        var button;\r\n        _frameButtons = _frameButtons.reduce(function (memo, btn) {\r\n            if (btn.buttonId === frameButtonId) {\r\n                button = btn;\r\n            }\r\n            else {\r\n                memo.push(btn);\r\n            }\r\n            return memo;\r\n        }, []);\r\n        if (button !== undefined) {\r\n            _registry.execute(\"onFrameButtonRemoved\", button, resultWindow);\r\n        }\r\n    }\r\n    function handleFrameButtonClicked(frameButton) {\r\n        var button = _frameButtons.filter(function (btn) {\r\n            return btn.buttonId === frameButton.buttonId;\r\n        });\r\n        if (button.length > 0) {\r\n            _registry.execute(\"onFrameButtonClicked\", button[0], resultWindow);\r\n        }\r\n    }\r\n    function handleWindowChangeState(state) {\r\n        if (state === \"collapsed\") {\r\n            isCollapsed = true;\r\n        }\r\n        else if (state === \"expanded\") {\r\n            isCollapsed = false;\r\n        }\r\n        else {\r\n            _windowState = state;\r\n        }\r\n        _registry.execute(state, resultWindow);\r\n    }\r\n    function handleFrameIsLockedChanged(isLocked) {\r\n        _isLocked = isLocked;\r\n        _registry.execute(\"lock-changed\", resultWindow);\r\n    }\r\n    function handleBoundsChanged(bounds) {\r\n        if (_bounds.top === bounds.top && _bounds.left === bounds.left && _bounds.width === bounds.width && _bounds.height === bounds.height) {\r\n            return;\r\n        }\r\n        _bounds.top = bounds.top;\r\n        _bounds.left = bounds.left;\r\n        _bounds.width = bounds.width;\r\n        _bounds.height = bounds.height;\r\n        _registry.execute(\"bounds-changed\", resultWindow);\r\n    }\r\n    function handleFocusChanged(isFocused) {\r\n        _focus = isFocused;\r\n        _registry.execute(\"focus-changed\", resultWindow);\r\n    }\r\n    function handleFrameColorChanged(frameColor) {\r\n        _frameColor = frameColor;\r\n        _registry.execute(\"frame-color-changed\", resultWindow);\r\n    }\r\n    function handleFrameAttached(tabGroupId, isTabHeaderVisible) {\r\n        _tabGroupId = tabGroupId;\r\n        _isTabHeaderVisible = isTabHeaderVisible;\r\n        _registry.execute(\"frame-attached\", resultWindow);\r\n    }\r\n    function handleCompositionChanged(neighbours, groupId) {\r\n        _neighbours = neighbours || {};\r\n        _groupId = groupId;\r\n    }\r\n    function handleGroupHeaderVisibilityChanged(isGroupHeaderVisible) {\r\n        _isGroupHeaderVisible = isGroupHeaderVisible;\r\n    }\r\n    function handleTabHeaderVisibilityChanged(isTabHeaderVisible) {\r\n        if (_isTabHeaderVisible !== isTabHeaderVisible) {\r\n            _isTabHeaderVisible = isTabHeaderVisible;\r\n            _registry.execute(\"tab-header-visibility-changed\", resultWindow);\r\n        }\r\n    }\r\n    function handleFrameSelectionChanged(newWindow, prevWindow) {\r\n        var selectedWindow;\r\n        if (typeof newWindow !== \"undefined\" && newWindow === id) {\r\n            _isTabSelected = true;\r\n            selectedWindow = resultWindow;\r\n        }\r\n        else {\r\n            _isTabSelected = false;\r\n            selectedWindow = store_1.default.get(newWindow) ? store_1.default.get(newWindow).API : undefined;\r\n        }\r\n        var previousWindow = store_1.default.get(prevWindow) ? store_1.default.get(prevWindow).API : undefined;\r\n        if (_isTabSelected && previousWindow) {\r\n            var un_1 = previousWindow.onTabSelectionChanged(function (newWin, prevWin) {\r\n                if (prevWin.id === previousWindow.id) {\r\n                    un_1();\r\n                    _registry.execute(\"tab-selection-changed\", selectedWindow, previousWindow, resultWindow);\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            _registry.execute(\"tab-selection-changed\", selectedWindow, previousWindow, resultWindow);\r\n        }\r\n    }\r\n    function handleAttached(newTabGroupId, tabHeaderVisible) {\r\n        _tabGroupId = newTabGroupId;\r\n        _isTabHeaderVisible = tabHeaderVisible;\r\n        _registry.execute(\"attached\", resultWindow);\r\n    }\r\n    function handleWindowAttached(win) {\r\n        _registry.execute(\"window-attached\", win);\r\n    }\r\n    function handleDetached(tabGroupId) {\r\n        // this tabGroupId is always the same as the current one\r\n        // the tabGroupId is actually changed in the frame-attached event\r\n        var un = _registry.add(\"frame-attached\", function (win) {\r\n            if (win.id === id) {\r\n                un();\r\n                _registry.execute(\"detached\", resultWindow);\r\n            }\r\n        });\r\n    }\r\n    function handleWindowDetached(win) {\r\n        _registry.execute(\"window-detached\", win);\r\n    }\r\n    //#endregion \"Stream function\"\r\n    //#region \"Group Events\"\r\n    function handleGroupChanged(newGroup, oldGroup) {\r\n        logger.trace(\"handle group changed to win: \" + id + \" with group id: \" + newGroup.id);\r\n        _group = newGroup;\r\n        _groupId = newGroup.id;\r\n        _registry.execute(\"group-changed\", resultWindow, newGroup, oldGroup);\r\n    }\r\n    // This is used to set the relation from window to corespondent group API, it could be undefined, if the window is removed from group\r\n    function handleGroupAssociation(group) {\r\n        if (group) {\r\n            _logger.trace(\"setting group to win: \" + id + \" with group id: \" + group.id);\r\n        }\r\n        _group = group;\r\n    }\r\n    //#region \"Internal function\"\r\n    function getAllTabs() {\r\n        var allWindows = store_1.default.list;\r\n        if (_mode.toLowerCase() !== \"tab\") {\r\n            return [];\r\n        }\r\n        return Object.keys(allWindows).reduce(function (memo, win) {\r\n            var window = allWindows[win];\r\n            if (window\r\n                && window.API.tabGroupId\r\n                && typeof window.API.tabGroupId !== \"undefined\"\r\n                && typeof resultWindow.tabGroupId !== \"undefined\"\r\n                && window.API.tabGroupId === resultWindow.tabGroupId) {\r\n                memo.push(window.API);\r\n            }\r\n            return memo;\r\n        }, []);\r\n    }\r\n    function mapWindowIdsToWindowObjects(windowIdArr) {\r\n        return windowIdArr.reduce(function (memo, winId) {\r\n            var window = store_1.default.get(winId);\r\n            if (window) {\r\n                memo.push(window.API);\r\n            }\r\n            return memo;\r\n        }, []);\r\n    }\r\n    function getNeighboursByDirection(direction) {\r\n        var windowIds = _neighbours[direction];\r\n        if (typeof windowIds !== \"undefined\") {\r\n            return mapWindowIdsToWindowObjects(windowIds);\r\n        }\r\n    }\r\n    function getApplicationName() {\r\n        if (_context._APPLICATION_NAME) {\r\n            return _context._APPLICATION_NAME;\r\n        }\r\n        if (_context && _context._t42 && _context._t42.application) {\r\n            return _context._t42.application;\r\n        }\r\n        var info = getWindowInfo();\r\n        if (!info) {\r\n            return undefined;\r\n        }\r\n        return info.applicationName;\r\n    }\r\n    function getWindowInfo() {\r\n        if (typeof window.glue42gd !== \"undefined\" && window.glue42gd.getWindowInfo) {\r\n            var info = window.glue42gd.getWindowInfo(id);\r\n            if (!info) {\r\n                return undefined;\r\n            }\r\n            else {\r\n                return info;\r\n            }\r\n        }\r\n    }\r\n    //#endregion \"Internal function\"\r\n    //#region \"API\"\r\n    resultWindow = {\r\n        get name() {\r\n            return _name;\r\n        },\r\n        get application() {\r\n            var appManager = appManagerGetter();\r\n            return appManager ? appManager.application(getApplicationName()) : undefined;\r\n        },\r\n        get hostInstance() {\r\n            return executor.hostInstance;\r\n        },\r\n        get agmInstance() {\r\n            var appName = getApplicationName();\r\n            return appName ? { application: appName } : undefined;\r\n        },\r\n        get url() {\r\n            return _url;\r\n        },\r\n        id: id,\r\n        get title() {\r\n            return _title;\r\n        },\r\n        get windowStyleAttributes() {\r\n            return _settings;\r\n        },\r\n        get settings() {\r\n            return _settings;\r\n        },\r\n        get tabGroupId() {\r\n            return _mode.toLowerCase() === \"tab\" ? _tabGroupId : undefined;\r\n        },\r\n        get frameButtons() {\r\n            return _frameButtons;\r\n        },\r\n        get mode() {\r\n            return _mode;\r\n        },\r\n        get state() {\r\n            return _windowState;\r\n        },\r\n        get isCollapsed() {\r\n            return isCollapsed;\r\n        },\r\n        get isVisible() {\r\n            return _isVisible;\r\n        },\r\n        get isLocked() {\r\n            return _isLocked;\r\n        },\r\n        get context() {\r\n            return _context;\r\n        },\r\n        get bounds() {\r\n            return _bounds;\r\n        },\r\n        get isFocused() {\r\n            return _focus;\r\n        },\r\n        get frameColor() {\r\n            return _frameColor;\r\n        },\r\n        get opened() {\r\n            return resultWindow.id !== undefined;\r\n        },\r\n        get group() {\r\n            return _group;\r\n        },\r\n        get groupId() {\r\n            return _groupId;\r\n        },\r\n        get topNeighbours() {\r\n            return getNeighboursByDirection(\"top\");\r\n        },\r\n        get leftNeighbours() {\r\n            return getNeighboursByDirection(\"left\");\r\n        },\r\n        get rightNeighbours() {\r\n            return getNeighboursByDirection(\"right\");\r\n        },\r\n        get bottomNeighbours() {\r\n            return getNeighboursByDirection(\"bottom\");\r\n        },\r\n        get isGroupHeaderVisible() {\r\n            return _isGroupHeaderVisible;\r\n        },\r\n        get activityId() {\r\n            if (_context._t42) {\r\n                return _context._t42.activityId;\r\n            }\r\n            var info = getWindowInfo();\r\n            if (!info) {\r\n                return undefined;\r\n            }\r\n            return info.activityId;\r\n        },\r\n        get activityWindowId() {\r\n            if (_context._t42) {\r\n                return _context._t42.activityWindowId;\r\n            }\r\n            var info = getWindowInfo();\r\n            if (!info) {\r\n                return undefined;\r\n            }\r\n            return info.activityWindowId;\r\n        },\r\n        get windowType() {\r\n            return options.windowType || \"electron\";\r\n        },\r\n        maximize: maximize,\r\n        restore: restore,\r\n        minimize: minimize,\r\n        maximizeRestore: maximizeRestore,\r\n        collapse: collapse,\r\n        expand: expand,\r\n        toggleCollapse: toggleCollapse,\r\n        focus: focus,\r\n        activate: activate,\r\n        moveResize: moveResize,\r\n        setTitle: setTitle,\r\n        setStyle: setStyle,\r\n        navigate: navigate,\r\n        addFrameButton: addFrameButton,\r\n        removeFrameButton: removeFrameButton,\r\n        setVisible: setVisible,\r\n        close: close,\r\n        snap: snap,\r\n        showLoader: showLoader,\r\n        hideLoader: hideLoader,\r\n        updateContext: updateContext,\r\n        lock: lock,\r\n        unlock: unlock,\r\n        getIcon: getIcon,\r\n        setIcon: setIcon,\r\n        setFrameColor: setFrameColor,\r\n        attachTab: attachTab,\r\n        detachTab: detachTab,\r\n        setTabHeaderVisible: setTabHeaderVisible,\r\n        onClose: onClose,\r\n        onUrlChanged: onUrlChanged,\r\n        onTitleChanged: onTitleChanged,\r\n        onFrameButtonAdded: onFrameButtonAdded,\r\n        onFrameButtonRemoved: onFrameButtonRemoved,\r\n        onFrameButtonClicked: onFrameButtonClicked,\r\n        onCollapsed: onCollapsed,\r\n        onExpanded: onExpanded,\r\n        onMinimized: onMinimized,\r\n        onMaximized: onMaximized,\r\n        onNormal: onNormal,\r\n        onAttached: onAttached,\r\n        onDetached: onDetached,\r\n        onVisibilityChanged: onVisibilityChanged,\r\n        onContextUpdated: onContextUpdated,\r\n        onLockingChanged: onLockingChanged,\r\n        onBoundsChanged: onBoundsChanged,\r\n        onFrameColorChanged: onFrameColorChanged,\r\n        onFocusChanged: onFocusChanged,\r\n        onGroupChanged: onGroupChanged,\r\n        onWindowAttached: onWindowAttached,\r\n        onWindowDetached: onWindowDetached,\r\n        onTabSelectionChanged: onTabSelectionChanged,\r\n        onTabHeaderVisibilityChanged: onTabHeaderVisibilityChanged,\r\n        get tabs() {\r\n            return getAllTabs();\r\n        },\r\n        get isTabHeaderVisible() {\r\n            return _isTabHeaderVisible;\r\n        },\r\n        get isTabSelected() {\r\n            return _isTabSelected;\r\n        },\r\n    };\r\n    //#endregion \"API\"\r\n    //#endregion \"Group Events\"\r\n    var events = {\r\n        handleWindowClose: handleWindowClose,\r\n        handleWindowChangeState: handleWindowChangeState,\r\n        handleTitleChanged: handleTitleChanged,\r\n        handleVisibilityChanged: handleVisibilityChanged,\r\n        handleUrlChanged: handleUrlChanged,\r\n        handleWindowSettingsChanged: handleWindowSettingsChanged,\r\n        handleContextUpdated: handleContextUpdated,\r\n        handleFrameIsLockedChanged: handleFrameIsLockedChanged,\r\n        handleBoundsChanged: handleBoundsChanged,\r\n        handleFocusChanged: handleFocusChanged,\r\n        handleFrameButtonAdded: handleFrameButtonAdded,\r\n        handleFrameButtonRemoved: handleFrameButtonRemoved,\r\n        handleFrameButtonClicked: handleFrameButtonClicked,\r\n        handleFrameColorChanged: handleFrameColorChanged,\r\n        handleFrameAttached: handleFrameAttached,\r\n        handleFrameSelectionChanged: handleFrameSelectionChanged,\r\n        handleCompositionChanged: handleCompositionChanged,\r\n        handleGroupHeaderVisibilityChanged: handleGroupHeaderVisibilityChanged,\r\n        handleTabHeaderVisibilityChanged: handleTabHeaderVisibilityChanged,\r\n        handleGroupChanged: handleGroupChanged,\r\n        handleGroupAssociation: handleGroupAssociation,\r\n        handleAttached: handleAttached,\r\n        handleDetached: handleDetached,\r\n        handleWindowAttached: handleWindowAttached,\r\n        handleWindowDetached: handleWindowDetached,\r\n    };\r\n    return {\r\n        API: resultWindow,\r\n        Events: events,\r\n    };\r\n});\r\n//# sourceMappingURL=window.js.map\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"events\");\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"fs\");\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"http\");\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"https\");\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"path\");\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"stream\");\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"tls\");\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"url\");\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"util\");\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"zlib\");\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tick42_glue_core_1 = __webpack_require__(48);\r\nvar main_1 = __webpack_require__(59);\r\nvar main_2 = __webpack_require__(66);\r\nvar main_3 = __webpack_require__(83);\r\nvar main_4 = __webpack_require__(71);\r\nvar pjson = __webpack_require__(36);\r\nvar config_1 = __webpack_require__(68);\r\nvar utils_1 = __webpack_require__(75);\r\nexports.default = (function (options) {\r\n    var gdMajorVersion = utils_1.default.getGDMajorVersion();\r\n    // get config object\r\n    // basically selecting some properties (and defaulting them)\r\n    // it's used to extract things like layouts, appManager, activities etc things\r\n    // that glueCore itself doesn't know about\r\n    options = options || {};\r\n    var glueConfig = config_1.default(options);\r\n    options.gateway = options.gateway || {};\r\n    // Init the GLUE namespace\r\n    var hc = typeof window !== \"undefined\" && window.htmlContainer;\r\n    var _appManager;\r\n    var _activity;\r\n    var _windows;\r\n    // dependency graph:\r\n    //   windows: agm, appManager (via getter)\r\n    //   activities: contexts, agm, logger, windows, appManager (via getter)\r\n    //   appManager: agm, windows, logger, activities\r\n    //   layouts: agm, appManager, logger\r\n    function createWindows(core) {\r\n        if (glueConfig.windows) {\r\n            var windowsLogger = getLibLogger(\"windows\", core.logger, glueConfig.windows);\r\n            _windows = main_3.default(core.agm, windowsLogger, function () {\r\n                return _appManager;\r\n            }, gdMajorVersion);\r\n            debugLog(_windows);\r\n            return _windows;\r\n        }\r\n    }\r\n    function createActivities(core) {\r\n        if (glueConfig.activities) {\r\n            if ((gdMajorVersion === 2) ||\r\n                (main_1.ActivityModule.checkIsUsingGW3Implementation &&\r\n                    main_1.ActivityModule.checkIsUsingGW3Implementation(core.connection))) {\r\n                var activityLogger = getLibLogger(\"activity\", core.logger, glueConfig.activities);\r\n                _activity = new main_1.ActivityModule({\r\n                    connection: core.connection,\r\n                    contexts: core.contexts,\r\n                    agm: core.agm,\r\n                    logger: activityLogger,\r\n                    logLevel: \"info\",\r\n                    disableAutoAnnounce: false,\r\n                    disposeRequestHandling: \"ignore\",\r\n                    announcementInfo: null,\r\n                    windows: _windows,\r\n                    appManagerGetter: function () {\r\n                        return _appManager;\r\n                    },\r\n                    mode: glueConfig.activities.mode,\r\n                    typesToTrack: glueConfig.activities.typesToTrack,\r\n                    activityId: typeof window !== \"undefined\" && window.glue42gd && window.glue42gd.activityInfo && window.glue42gd.activityInfo.activityId,\r\n                    gdMajorVersion: gdMajorVersion\r\n                }).api;\r\n                debugLog(_activity);\r\n                return _activity;\r\n            }\r\n        }\r\n    }\r\n    function createAppManager(core) {\r\n        if (!glueConfig.appManager) {\r\n            return;\r\n        }\r\n        var logger = getLibLogger(\"appManager\", core.logger, glueConfig.appManager);\r\n        // AppManager v3\r\n        _appManager = main_2.default({\r\n            agm: core.agm,\r\n            windows: _windows,\r\n            logger: logger,\r\n            activities: _activity,\r\n            mode: glueConfig.appManager.mode,\r\n            gdMajorVersion: gdMajorVersion\r\n        });\r\n        debugLog(_appManager);\r\n        return _appManager;\r\n    }\r\n    function createLayouts(core) {\r\n        if (!glueConfig.layouts) {\r\n            return;\r\n        }\r\n        var logger = getLibLogger(\"layouts\", core.logger, glueConfig.layouts);\r\n        var lay = main_4.default({\r\n            agm: core.agm,\r\n            appManager: _appManager,\r\n            activityGetter: function () { return _activity; },\r\n            logger: logger,\r\n            mode: glueConfig.layouts.mode,\r\n        });\r\n        debugLog(lay);\r\n        return lay;\r\n    }\r\n    function getLibLogger(loggerName, logger, config) {\r\n        var newLogger = logger.subLogger(loggerName);\r\n        if (config && config.logger) {\r\n            var loggerConfig = config.logger;\r\n            if (loggerConfig.console) {\r\n                newLogger.consoleLevel(loggerConfig.console);\r\n            }\r\n            if (loggerConfig.publish) {\r\n                newLogger.publishLevel(loggerConfig.publish);\r\n            }\r\n            if (loggerConfig.metrics) {\r\n                newLogger.metricsLevel(loggerConfig.metrics);\r\n            }\r\n        }\r\n        return newLogger;\r\n    }\r\n    var ext = {\r\n        // define extra libraries for glue-core to raise\r\n        libs: [\r\n            { name: \"windows\", create: createWindows },\r\n            { name: \"activities\", create: createActivities },\r\n            { name: \"appManager\", create: createAppManager },\r\n            { name: \"layouts\", create: createLayouts },\r\n        ],\r\n        version: pjson.version,\r\n        enrichGlue: function (glue) {\r\n            // put some data to config\r\n            glue.config.activities = glueConfig.activities;\r\n            glue.config.windows = glueConfig.windows;\r\n            glue.config.appManager = glueConfig.appManager;\r\n            glue.config.layouts = glueConfig.layouts;\r\n        },\r\n    };\r\n    var currentLog = [];\r\n    if (typeof window !== \"undefined\") {\r\n        if (!window.glueFactoryLog) {\r\n            window.glueFactoryLog = [];\r\n        }\r\n        window.glueFactoryLog.push(currentLog);\r\n    }\r\n    function debugLog(entry) {\r\n        currentLog.push(entry);\r\n    }\r\n    return tick42_glue_core_1.default(options, ext);\r\n});\r\n//# sourceMappingURL=glue.js.map\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports) {\n\nmodule.exports = {\"name\":\"tick42-glue\",\"description\":\"Tick42 GLUE\",\"version\":\"4.2.4\",\"main\":\"./dist/node/tick42-glue.js\",\"browser\":\"./dist/web/tick42-glue.js\",\"types\":\"./glue.d.ts\",\"docName\":\"Glue\",\"scripts\":{\"init-dev-mode\":\"node ./build/scripts/init-dev-mode.js\",\"remove-installed-dependencies\":\"node ./build/scripts/remove-installed-dependencies.js\",\"clean\":\"node ./build/scripts/clean.js\",\"file-versionify\":\"node ./build/scripts/file-versionify.js\",\"pre:build\":\"npm run tslint && tsc && set NODE_ENV=development && npm run clean\",\"tslint\":\"tslint -t codeFrame ./src/**/*.ts\",\"tslint:fix\":\"tslint -t codeFrame --fix ./src/**/*.ts\",\"watch\":\"onchange ./src/**/*.ts -- npm run build:dev\",\"build:dev\":\"npm run pre:build && set NODE_ENV=development && webpack && npm run file-versionify\",\"prepublish\":\"npm run build:prod && npm run test:only\",\"build:prod\":\"npm run pre:build && set NODE_ENV=development && webpack && set NODE_ENV=production && webpack && npm run file-versionify\",\"test\":\"npm run build:dev && mocha ./tests\",\"test:only\":\"mocha ./tests\",\"generate-docs\":\"glue-js-documentation-builder build-reference --project g4e --modules ./glue.d.ts,./node_modules/tick42-glue-core/glue.d.ts\"},\"repository\":{\"type\":\"git\",\"url\":\"https://stash.tick42.com:8443/scm/ofgw/js-glue.git\"},\"author\":{\"name\":\"Tick42\",\"url\":\"http://www.glue42.com\"},\"license\":\"ISC\",\"dependencies\":{\"callback-registry\":\"^2.4.0\",\"es6-promise\":\"^4.1.1\",\"object-assign\":\"^4.1.1\",\"shortid\":\"^2.2.8\",\"tick42-glue-core\":\"^4.1.5\",\"tick42-promisify\":\"^1.0.3\"},\"devDependencies\":{\"@types/object-assign\":\"^4.0.30\",\"@types/shortid\":\"0.0.29\",\"@types/node\":\"^10.7.1\",\"chai\":\"^4.1.0\",\"glue-js-documentation-builder\":\"*\",\"mocha\":\"^2.4.5\",\"onchange\":\"3.*\",\"pre-commit\":\"^1.1.3\",\"readline-sync\":\"^1.4.5\",\"shelljs\":\"^0.6.0\",\"tick42-gateway\":\"^0.2.2\",\"tick42-webpack-config\":\"4.1.6\",\"tslint\":\"^5.5.0\",\"typescript\":\"^3.0.1\",\"webpack\":\"2.3.3\"},\"bundleDependencies\":[\"tick42-glue-core\",\"tick42-promisify\"]}\n\n/***/ }),\n/* 37 */\n/***/ (function(module, exports) {\n\n/**\n * Secure random string generator with custom alphabet.\n *\n * Alphabet must contain 256 symbols or less. Otherwise, the generator\n * will not be secure.\n *\n * @param {generator} random The random bytes generator.\n * @param {string} alphabet Symbols to be used in new random string.\n * @param {size} size The number of symbols in new random string.\n *\n * @return {string} Random string.\n *\n * @example\n * const format = require('nanoid/format')\n *\n * function random (size) {\n *   const result = []\n *   for (let i = 0; i < size; i++) {\n *     result.push(randomByte())\n *   }\n *   return result\n * }\n *\n * format(random, \"abcdef\", 5) //=> \"fbaef\"\n *\n * @name format\n * @function\n */\nmodule.exports = function (random, alphabet, size) {\n  var mask = (2 << Math.log(alphabet.length - 1) / Math.LN2) - 1\n  var step = Math.ceil(1.6 * mask * size / alphabet.length)\n\n  var id = ''\n  while (true) {\n    var bytes = random(step)\n    for (var i = 0; i < step; i++) {\n      var byte = bytes[i] & mask\n      if (alphabet[byte]) {\n        id += alphabet[byte]\n        if (id.length === size) return id\n      }\n    }\n  }\n}\n\n/**\n * @callback generator\n * @param {number} bytes The number of bytes to generate.\n * @return {number[]} Random bytes.\n */\n\n\n/***/ }),\n/* 38 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar crypto = __webpack_require__(13)\n\nif (crypto.randomFillSync) {\n  var buffers = { }\n  module.exports = function (bytes) {\n    var buffer = buffers[bytes]\n    if (!buffer) {\n      buffer = Buffer.allocUnsafe(bytes)\n      if (bytes <= 255) buffers[bytes] = buffer\n    }\n    return crypto.randomFillSync(buffer)\n  }\n} else {\n  module.exports = crypto.randomBytes\n}\n\n\n/***/ }),\n/* 39 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n\n/***/ }),\n/* 40 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nmodule.exports = __webpack_require__(43);\n\n\n/***/ }),\n/* 41 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar generate = __webpack_require__(42);\nvar alphabet = __webpack_require__(6);\n\n// Ignore all milliseconds before a certain time to reduce the size of the date entropy without sacrificing uniqueness.\n// This number should be updated every year or so to keep the generated id short.\n// To regenerate `new Date() - 0` and bump the version. Always bump the version!\nvar REDUCE_TIME = 1459707606518;\n\n// don't change unless we change the algos or REDUCE_TIME\n// must be an integer and less than 16\nvar version = 6;\n\n// Counter is used when shortid is called multiple times in one second.\nvar counter;\n\n// Remember the last time shortid was called in case counter is needed.\nvar previousSeconds;\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction build(clusterWorkerId) {\n    var str = '';\n\n    var seconds = Math.floor((Date.now() - REDUCE_TIME) * 0.001);\n\n    if (seconds === previousSeconds) {\n        counter++;\n    } else {\n        counter = 0;\n        previousSeconds = seconds;\n    }\n\n    str = str + generate(version);\n    str = str + generate(clusterWorkerId);\n    if (counter > 0) {\n        str = str + generate(counter);\n    }\n    str = str + generate(seconds);\n    return str;\n}\n\nmodule.exports = build;\n\n\n/***/ }),\n/* 42 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar alphabet = __webpack_require__(6);\nvar random = __webpack_require__(45);\nvar format = __webpack_require__(37);\n\nfunction generate(number) {\n    var loopCounter = 0;\n    var done;\n\n    var str = '';\n\n    while (!done) {\n        str = str + format(random, alphabet.get(), 1);\n        done = number < (Math.pow(16, loopCounter + 1 ) );\n        loopCounter++;\n    }\n    return str;\n}\n\nmodule.exports = generate;\n\n\n/***/ }),\n/* 43 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar alphabet = __webpack_require__(6);\nvar build = __webpack_require__(41);\nvar isValid = __webpack_require__(44);\n\n// if you are using cluster or multiple servers use this to make each instance\n// has a unique value for worker\n// Note: I don't know if this is automatically set when using third\n// party cluster solutions such as pm2.\nvar clusterWorkerId = __webpack_require__(47) || 0;\n\n/**\n * Set the seed.\n * Highly recommended if you don't want people to try to figure out your id schema.\n * exposed as shortid.seed(int)\n * @param seed Integer value to seed the random alphabet.  ALWAYS USE THE SAME SEED or you might get overlaps.\n */\nfunction seed(seedValue) {\n    alphabet.seed(seedValue);\n    return module.exports;\n}\n\n/**\n * Set the cluster worker or machine id\n * exposed as shortid.worker(int)\n * @param workerId worker must be positive integer.  Number less than 16 is recommended.\n * returns shortid module so it can be chained.\n */\nfunction worker(workerId) {\n    clusterWorkerId = workerId;\n    return module.exports;\n}\n\n/**\n *\n * sets new characters to use in the alphabet\n * returns the shuffled alphabet\n */\nfunction characters(newCharacters) {\n    if (newCharacters !== undefined) {\n        alphabet.characters(newCharacters);\n    }\n\n    return alphabet.shuffled();\n}\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction generate() {\n  return build(clusterWorkerId);\n}\n\n// Export all other functions as properties of the generate function\nmodule.exports = generate;\nmodule.exports.generate = generate;\nmodule.exports.seed = seed;\nmodule.exports.worker = worker;\nmodule.exports.characters = characters;\nmodule.exports.isValid = isValid;\n\n\n/***/ }),\n/* 44 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar alphabet = __webpack_require__(6);\n\nfunction isShortId(id) {\n    if (!id || typeof id !== 'string' || id.length < 6 ) {\n        return false;\n    }\n\n    var nonAlphabetic = new RegExp('[^' +\n      alphabet.get().replace(/[|\\\\{}()[\\]^$+*?.-]/g, '\\\\$&') +\n    ']');\n    return !nonAlphabetic.test(id);\n}\n\nmodule.exports = isShortId;\n\n\n/***/ }),\n/* 45 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(38);\n\n\n/***/ }),\n/* 46 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n// Found this seed-based random generator somewhere\n// Based on The Central Randomizer 1.3 (C) 1997 by Paul Houle (houle@msc.cornell.edu)\n\nvar seed = 1;\n\n/**\n * return a random number based on a seed\n * @param seed\n * @returns {number}\n */\nfunction getNextValue() {\n    seed = (seed * 9301 + 49297) % 233280;\n    return seed/(233280.0);\n}\n\nfunction setSeed(_seed_) {\n    seed = _seed_;\n}\n\nmodule.exports = {\n    nextValue: getNextValue,\n    seed: setSeed\n};\n\n\n/***/ }),\n/* 47 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar cluster = __webpack_require__(12);\n\nvar clusterId = 0;\nif (!cluster.isMaster && cluster.worker) {\n    clusterId = cluster.worker.id;\n}\nmodule.exports = parseInt(__webpack_require__.i({\"NODE_ENV\":\"production\"}).NODE_UNIQUE_ID || clusterId, 10);\n\n\n/***/ }),\n/* 48 */\n/***/ (function(module, exports, __webpack_require__) {\n\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(true)\n\t\tmodule.exports = factory(__webpack_require__(33), __webpack_require__(25), __webpack_require__(13), __webpack_require__(26), __webpack_require__(27), __webpack_require__(32), __webpack_require__(12), __webpack_require__(28), __webpack_require__(29), __webpack_require__(30), __webpack_require__(31), __webpack_require__(34));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"tick42-glue-core\", [\"util\", \"events\", \"crypto\", \"fs\", \"http\", \"url\", \"cluster\", \"https\", \"path\", \"stream\", \"tls\", \"zlib\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"tick42-glue-core\"] = factory(require(\"util\"), require(\"events\"), require(\"crypto\"), require(\"fs\"), require(\"http\"), require(\"url\"), require(\"cluster\"), require(\"https\"), require(\"path\"), require(\"stream\"), require(\"tls\"), require(\"zlib\"));\n\telse\n\t\troot[\"tick42-glue-core\"] = factory(root[\"util\"], root[\"events\"], root[\"crypto\"], root[\"fs\"], root[\"http\"], root[\"url\"], root[\"cluster\"], root[\"https\"], root[\"path\"], root[\"stream\"], root[\"tls\"], root[\"zlib\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_6__, __WEBPACK_EXTERNAL_MODULE_12__, __WEBPACK_EXTERNAL_MODULE_27__, __WEBPACK_EXTERNAL_MODULE_28__, __WEBPACK_EXTERNAL_MODULE_29__, __WEBPACK_EXTERNAL_MODULE_114__, __WEBPACK_EXTERNAL_MODULE_115__, __WEBPACK_EXTERNAL_MODULE_116__, __WEBPACK_EXTERNAL_MODULE_117__, __WEBPACK_EXTERNAL_MODULE_118__, __WEBPACK_EXTERNAL_MODULE_119__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 96);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.default = {\r\n    DEFAULT: 0,\r\n    STRING: 1,\r\n    NUMBER: 2,\r\n    COUNT: 3,\r\n    RATE: 4,\r\n    STATISTICS: 6,\r\n    TIMESTAMP: 7,\r\n    ADDRESS: 8,\r\n    TIMESPAN: 10,\r\n    OBJECT: 11\r\n};\r\n//# sourceMappingURL=metric-types.js.map\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nfunction createRegistry(options) {\r\n    if (options && options.errorHandling\r\n        && typeof options.errorHandling !== \"function\"\r\n        && options.errorHandling !== \"log\"\r\n        && options.errorHandling !== \"silent\"\r\n        && options.errorHandling !== \"throw\") {\r\n        throw new Error(\"Invalid options passed to createRegistry. Prop errorHandling should be [\\\"log\\\" | \\\"silent\\\" | \\\"throw\\\" | (err) => void], but \" + typeof options.errorHandling + \" was passed\");\r\n    }\r\n    var _userErrorHandler = options && typeof options.errorHandling === \"function\" && options.errorHandling;\r\n    var callbacks = {};\r\n    function add(key, callback) {\r\n        var callbacksForKey = callbacks[key];\r\n        if (!callbacksForKey) {\r\n            callbacksForKey = [];\r\n            callbacks[key] = callbacksForKey;\r\n        }\r\n        callbacksForKey.push(callback);\r\n        return function () {\r\n            var allForKey = callbacks[key];\r\n            if (!allForKey) {\r\n                return;\r\n            }\r\n            allForKey = allForKey.reduce(function (acc, element, index) {\r\n                if (!(element === callback && acc.length === index)) {\r\n                    acc.push(element);\r\n                }\r\n                return acc;\r\n            }, []);\r\n            callbacks[key] = allForKey;\r\n        };\r\n    }\r\n    function execute(key) {\r\n        var argumentsArr = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            argumentsArr[_i - 1] = arguments[_i];\r\n        }\r\n        var callbacksForKey = callbacks[key];\r\n        if (!callbacksForKey || callbacksForKey.length === 0) {\r\n            return [];\r\n        }\r\n        var results = [];\r\n        callbacksForKey.forEach(function (callback) {\r\n            try {\r\n                var result = callback.apply(undefined, argumentsArr);\r\n                results.push(result);\r\n            }\r\n            catch (err) {\r\n                results.push(undefined);\r\n                _handleError(err, key);\r\n            }\r\n        });\r\n        return results;\r\n    }\r\n    function _handleError(exceptionArtifact, key) {\r\n        var errParam = exceptionArtifact instanceof Error ? exceptionArtifact : new Error(exceptionArtifact);\r\n        if (_userErrorHandler) {\r\n            _userErrorHandler(errParam);\r\n            return;\r\n        }\r\n        var msg = \"[ERROR] callback-registry: User callback for key \\\"\" + key + \"\\\" failed: \" + errParam.stack;\r\n        if (options) {\r\n            switch (options.errorHandling) {\r\n                case \"log\":\r\n                    return console.error(msg);\r\n                case \"silent\":\r\n                    return;\r\n                case \"throw\":\r\n                    throw new Error(msg);\r\n            }\r\n        }\r\n        console.error(msg);\r\n    }\r\n    function clear() {\r\n        callbacks = {};\r\n    }\r\n    return {\r\n        add: add,\r\n        execute: execute,\r\n        clear: clear\r\n    };\r\n}\r\n;\r\ncreateRegistry.default = createRegistry;\r\nmodule.exports = createRegistry;\r\n//# sourceMappingURL=index.js.map\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.default = {\r\n    validate: function (definition, parent, transport) {\r\n        if (definition === null || typeof definition !== \"object\") {\r\n            throw new Error(\"Missing definition\");\r\n        }\r\n        if (parent === null || typeof parent !== \"object\") {\r\n            throw new Error(\"Missing parent\");\r\n        }\r\n        if (transport === null || typeof transport !== \"object\") {\r\n            throw new Error(\"Missing transport\");\r\n        }\r\n    },\r\n};\r\n//# sourceMappingURL=helpers.js.map\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(33);\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar randomFromSeed = __webpack_require__(40);\n\nvar ORIGINAL = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-';\nvar alphabet;\nvar previousSeed;\n\nvar shuffled;\n\nfunction reset() {\n    shuffled = false;\n}\n\nfunction setCharacters(_alphabet_) {\n    if (!_alphabet_) {\n        if (alphabet !== ORIGINAL) {\n            alphabet = ORIGINAL;\n            reset();\n        }\n        return;\n    }\n\n    if (_alphabet_ === alphabet) {\n        return;\n    }\n\n    if (_alphabet_.length !== ORIGINAL.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. You submitted ' + _alphabet_.length + ' characters: ' + _alphabet_);\n    }\n\n    var unique = _alphabet_.split('').filter(function(item, ind, arr){\n       return ind !== arr.lastIndexOf(item);\n    });\n\n    if (unique.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. These characters were not unique: ' + unique.join(', '));\n    }\n\n    alphabet = _alphabet_;\n    reset();\n}\n\nfunction characters(_alphabet_) {\n    setCharacters(_alphabet_);\n    return alphabet;\n}\n\nfunction setSeed(seed) {\n    randomFromSeed.seed(seed);\n    if (previousSeed !== seed) {\n        reset();\n        previousSeed = seed;\n    }\n}\n\nfunction shuffle() {\n    if (!alphabet) {\n        setCharacters(ORIGINAL);\n    }\n\n    var sourceArray = alphabet.split('');\n    var targetArray = [];\n    var r = randomFromSeed.nextValue();\n    var characterIndex;\n\n    while (sourceArray.length > 0) {\n        r = randomFromSeed.nextValue();\n        characterIndex = Math.floor(r * sourceArray.length);\n        targetArray.push(sourceArray.splice(characterIndex, 1)[0]);\n    }\n    return targetArray.join('');\n}\n\nfunction getShuffled() {\n    if (shuffled) {\n        return shuffled;\n    }\n    shuffled = shuffle();\n    return shuffled;\n}\n\n/**\n * lookup shuffled letter\n * @param index\n * @returns {string}\n */\nfunction lookup(index) {\n    var alphabetShuffled = getShuffled();\n    return alphabetShuffled[index];\n}\n\nfunction get () {\n  return alphabet || ORIGINAL;\n}\n\nmodule.exports = {\n    get: get,\n    characters: characters,\n    seed: setSeed,\n    lookup: lookup,\n    shuffled: getShuffled\n};\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\nvar zlib = __webpack_require__(119);\n\nvar AVAILABLE_WINDOW_BITS = [8, 9, 10, 11, 12, 13, 14, 15];\nvar DEFAULT_WINDOW_BITS = 15;\nvar DEFAULT_MEM_LEVEL = 8;\n\nPerMessageDeflate.extensionName = 'permessage-deflate';\n\n/**\n * Per-message Compression Extensions implementation\n */\n\nfunction PerMessageDeflate(options, isServer) {\n  this._options = options || {};\n  this._isServer = !!isServer;\n  this._inflate = null;\n  this._deflate = null;\n  this.params = null;\n}\n\n/**\n * Create extension parameters offer\n *\n * @api public\n */\n\nPerMessageDeflate.prototype.offer = function() {\n  var params = {};\n  if (this._options.serverNoContextTakeover) {\n    params.server_no_context_takeover = true;\n  }\n  if (this._options.clientNoContextTakeover) {\n    params.client_no_context_takeover = true;\n  }\n  if (this._options.serverMaxWindowBits) {\n    params.server_max_window_bits = this._options.serverMaxWindowBits;\n  }\n  if (this._options.clientMaxWindowBits) {\n    params.client_max_window_bits = this._options.clientMaxWindowBits;\n  } else if (this._options.clientMaxWindowBits == null) {\n    params.client_max_window_bits = true;\n  }\n  return params;\n};\n\n/**\n * Accept extension offer\n *\n * @api public\n */\n\nPerMessageDeflate.prototype.accept = function(paramsList) {\n  paramsList = this.normalizeParams(paramsList);\n\n  var params;\n  if (this._isServer) {\n    params = this.acceptAsServer(paramsList);\n  } else {\n    params = this.acceptAsClient(paramsList);\n  }\n\n  this.params = params;\n  return params;\n};\n\n/**\n * Accept extension offer from client\n *\n * @api private\n */\n\nPerMessageDeflate.prototype.acceptAsServer = function(paramsList) {\n  var accepted = {};\n  var result = paramsList.some(function(params) {\n    accepted = {};\n    if (this._options.serverNoContextTakeover === false && params.server_no_context_takeover) {\n      return;\n    }\n    if (this._options.serverMaxWindowBits === false && params.server_max_window_bits) {\n      return;\n    }\n    if (typeof this._options.serverMaxWindowBits === 'number' &&\n        typeof params.server_max_window_bits === 'number' &&\n        this._options.serverMaxWindowBits > params.server_max_window_bits) {\n      return;\n    }\n    if (typeof this._options.clientMaxWindowBits === 'number' && !params.client_max_window_bits) {\n      return;\n    }\n\n    if (this._options.serverNoContextTakeover || params.server_no_context_takeover) {\n      accepted.server_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover) {\n      accepted.client_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover !== false && params.client_no_context_takeover) {\n      accepted.client_no_context_takeover = true;\n    }\n    if (typeof this._options.serverMaxWindowBits === 'number') {\n      accepted.server_max_window_bits = this._options.serverMaxWindowBits;\n    } else if (typeof params.server_max_window_bits === 'number') {\n      accepted.server_max_window_bits = params.server_max_window_bits;\n    }\n    if (typeof this._options.clientMaxWindowBits === 'number') {\n      accepted.client_max_window_bits = this._options.clientMaxWindowBits;\n    } else if (this._options.clientMaxWindowBits !== false && typeof params.client_max_window_bits === 'number') {\n      accepted.client_max_window_bits = params.client_max_window_bits;\n    }\n    return true;\n  }, this);\n\n  if (!result) {\n    throw new Error('Doesn\\'t support the offered configuration');\n  }\n\n  return accepted;\n};\n\n/**\n * Accept extension response from server\n *\n * @api privaye\n */\n\nPerMessageDeflate.prototype.acceptAsClient = function(paramsList) {\n  var params = paramsList[0];\n  if (this._options.clientNoContextTakeover != null) {\n    if (this._options.clientNoContextTakeover === false && params.client_no_context_takeover) {\n      throw new Error('Invalid value for \"client_no_context_takeover\"');\n    }\n  }\n  if (this._options.clientMaxWindowBits != null) {\n    if (this._options.clientMaxWindowBits === false && params.client_max_window_bits) {\n      throw new Error('Invalid value for \"client_max_window_bits\"');\n    }\n    if (typeof this._options.clientMaxWindowBits === 'number' &&\n        (!params.client_max_window_bits || params.client_max_window_bits > this._options.clientMaxWindowBits)) {\n      throw new Error('Invalid value for \"client_max_window_bits\"');\n    }\n  }\n  return params;\n};\n\n/**\n * Normalize extensions parameters\n *\n * @api private\n */\n\nPerMessageDeflate.prototype.normalizeParams = function(paramsList) {\n  return paramsList.map(function(params) {\n    Object.keys(params).forEach(function(key) {\n      var value = params[key];\n      if (value.length > 1) {\n        throw new Error('Multiple extension parameters for ' + key);\n      }\n\n      value = value[0];\n\n      switch (key) {\n      case 'server_no_context_takeover':\n      case 'client_no_context_takeover':\n        if (value !== true) {\n          throw new Error('invalid extension parameter value for ' + key + ' (' + value + ')');\n        }\n        params[key] = true;\n        break;\n      case 'server_max_window_bits':\n      case 'client_max_window_bits':\n        if (typeof value === 'string') {\n          value = parseInt(value, 10);\n          if (!~AVAILABLE_WINDOW_BITS.indexOf(value)) {\n            throw new Error('invalid extension parameter value for ' + key + ' (' + value + ')');\n          }\n        }\n        if (!this._isServer && value === true) {\n          throw new Error('Missing extension parameter value for ' + key);\n        }\n        params[key] = value;\n        break;\n      default:\n        throw new Error('Not defined extension parameter (' + key + ')');\n      }\n    }, this);\n    return params;\n  }, this);\n};\n\n/**\n * Decompress message\n *\n * @api public\n */\n\nPerMessageDeflate.prototype.decompress = function (data, fin, callback) {\n  var endpoint = this._isServer ? 'client' : 'server';\n\n  if (!this._inflate) {\n    var maxWindowBits = this.params[endpoint + '_max_window_bits'];\n    this._inflate = zlib.createInflateRaw({\n      windowBits: 'number' === typeof maxWindowBits ? maxWindowBits : DEFAULT_WINDOW_BITS\n    });\n  }\n\n  var self = this;\n  var buffers = [];\n\n  this._inflate.on('error', onError).on('data', onData);\n  this._inflate.write(data);\n  if (fin) {\n    this._inflate.write(new Buffer([0x00, 0x00, 0xff, 0xff]));\n  }\n  this._inflate.flush(function() {\n    cleanup();\n    callback(null, Buffer.concat(buffers));\n  });\n\n  function onError(err) {\n    cleanup();\n    callback(err);\n  }\n\n  function onData(data) {\n    buffers.push(data);\n  }\n\n  function cleanup() {\n    self._inflate.removeListener('error', onError);\n    self._inflate.removeListener('data', onData);\n    if (fin && self.params[endpoint + '_no_context_takeover']) {\n      self._inflate = null;\n    }\n  }\n};\n\n/**\n * Compress message\n *\n * @api public\n */\n\nPerMessageDeflate.prototype.compress = function (data, fin, callback) {\n  var endpoint = this._isServer ? 'server' : 'client';\n\n  if (!this._deflate) {\n    var maxWindowBits = this.params[endpoint + '_max_window_bits'];\n    this._deflate = zlib.createDeflateRaw({\n      flush: zlib.Z_SYNC_FLUSH,\n      windowBits: 'number' === typeof maxWindowBits ? maxWindowBits : DEFAULT_WINDOW_BITS,\n      memLevel: this._options.memLevel || DEFAULT_MEM_LEVEL\n    });\n  }\n\n  var self = this;\n  var buffers = [];\n\n  this._deflate.on('error', onError).on('data', onData);\n  this._deflate.write(data);\n  this._deflate.flush(function() {\n    cleanup();\n    var data = Buffer.concat(buffers);\n    if (fin) {\n      data = data.slice(0, data.length - 4);\n    }\n    callback(null, data);\n  });\n\n  function onError(err) {\n    cleanup();\n    callback(err);\n  }\n\n  function onData(data) {\n    buffers.push(data);\n  }\n\n  function cleanup() {\n    self._deflate.removeListener('error', onError);\n    self._deflate.removeListener('data', onData);\n    if (fin && self.params[endpoint + '_no_context_takeover']) {\n      self._deflate = null;\n    }\n  }\n};\n\nmodule.exports = PerMessageDeflate;\n\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(25);\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nmodule.exports = __webpack_require__(37);\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction default_1(promise, successCallback, errorCallback) {\r\n    if (typeof successCallback !== \"function\" && typeof errorCallback !== \"function\") {\r\n        return promise;\r\n    }\r\n    if (typeof successCallback !== \"function\") {\r\n        successCallback = function () { };\r\n    }\r\n    else if (typeof errorCallback !== \"function\") {\r\n        errorCallback = function () { };\r\n    }\r\n    promise.then(successCallback, errorCallback);\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=promisify.js.map\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ServerSubscription = (function () {\r\n    function ServerSubscription(protocol, repoMethod, subscription) {\r\n        this.protocol = protocol;\r\n        this.repoMethod = repoMethod;\r\n        this.subscription = subscription;\r\n    }\r\n    Object.defineProperty(ServerSubscription.prototype, \"stream\", {\r\n        get: function () { return this.repoMethod.stream; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ServerSubscription.prototype, \"arguments\", {\r\n        get: function () { return this.subscription.arguments || {}; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ServerSubscription.prototype, \"branchKey\", {\r\n        get: function () { return this.subscription.branchKey; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ServerSubscription.prototype, \"instance\", {\r\n        get: function () { return this.subscription.instance; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ServerSubscription.prototype.close = function () {\r\n        this.protocol.server.closeSingleSubscription(this.repoMethod, this.subscription);\r\n    };\r\n    ServerSubscription.prototype.push = function (data) {\r\n        this.protocol.server.pushDataToSingle(this.repoMethod, this.subscription, data);\r\n    };\r\n    return ServerSubscription;\r\n}());\r\nexports.default = ServerSubscription;\r\n//# sourceMappingURL=subscription.js.map\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar msg = __webpack_require__(25);\r\nexports.ContextMessageReplaySpec = {\r\n    get name() {\r\n        return \"context\";\r\n    },\r\n    get types() {\r\n        return [\r\n            msg.GW_MESSAGE_CREATE_CONTEXT,\r\n            msg.GW_MESSAGE_ACTIVITY_CREATED,\r\n            msg.GW_MESSAGE_ACTIVITY_DESTROYED,\r\n            msg.GW_MESSAGE_CONTEXT_CREATED,\r\n            msg.GW_MESSAGE_CONTEXT_ADDED,\r\n            msg.GW_MESSAGE_SUBSCRIBE_CONTEXT,\r\n            msg.GW_MESSAGE_SUBSCRIBED_CONTEXT,\r\n            msg.GW_MESSAGE_UNSUBSCRIBE_CONTEXT,\r\n            msg.GW_MESSAGE_DESTROY_CONTEXT,\r\n            msg.GW_MESSAGE_CONTEXT_DESTROYED,\r\n            msg.GW_MESSAGE_UPDATE_CONTEXT,\r\n            msg.GW_MESSAGE_CONTEXT_UPDATED,\r\n            msg.GW_MESSAGE_JOINED_ACTIVITY\r\n        ];\r\n    }\r\n};\r\n//# sourceMappingURL=contextMessageReplaySpec.js.map\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Utils = (function () {\r\n    function Utils() {\r\n    }\r\n    Utils.getGDMajorVersion = function () {\r\n        if (typeof window === \"undefined\") {\r\n            return -1;\r\n        }\r\n        if (!window.glueDesktop) {\r\n            return -1;\r\n        }\r\n        if (!window.glueDesktop.version) {\r\n            return -1;\r\n        }\r\n        var ver = Number(window.glueDesktop.version.substr(0, 1));\r\n        return isNaN(ver) ? -1 : ver;\r\n    };\r\n    Utils.isNode = function () {\r\n        try {\r\n            return Object.prototype.toString.call(global.process) === \"[object process]\";\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    };\r\n    return Utils;\r\n}());\r\nexports.default = Utils;\r\n//# sourceMappingURL=utils.js.map\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(13);\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports) {\n\nmodule.exports = {\"name\":\"tick42-glue-core\",\"version\":\"4.1.5\",\"description\":\"Glue42 core library including logger, connection, agm and metrics\",\"main\":\"./dist/node/tick42-glue-core.js\",\"types\":\"./glue.d.ts\",\"browser\":\"./dist/web/tick42-glue-core.js\",\"scripts\":{\"init-dev-mode\":\"node ./build/scripts/init-dev-mode.js\",\"remove-installed-dependencies\":\"node ./build/scripts/remove-installed-dependencies.js\",\"clean\":\"node ./build/scripts/clean.js\",\"pre:build\":\"npm run clean && npm run tslint && tsc && set NODE_ENV=development\",\"file-versionify\":\"node ./build/scripts/file-versionify.js\",\"tslint\":\"tslint -t codeFrame ./src/**.ts\",\"tslint:fix\":\"tslint -t codeFrame --fix ./src/**.ts\",\"watch\":\"onchange ./src/**/*.ts -- npm run build:dev\",\"build:dev\":\"npm run pre:build && set NODE_ENV=development && webpack && npm run file-versionify\",\"build:prod\":\"npm run pre:build && set NODE_ENV=development && webpack && set NODE_ENV=production && webpack && npm run file-versionify\",\"docs\":\"typedoc --options typedoc.json ./src\",\"prepublish\":\"npm run build:prod && npm run test:only\",\"test\":\"npm run build:dev && npm run test:only\",\"test:only\":\"mocha ./tests/ --recursive\",\"test:core\":\"mocha ./tests/core\",\"test:agm\":\"mocha ./tests/agm\"},\"repository\":{\"type\":\"git\",\"url\":\"https://stash.tick42.com/scm/tg/js-glue-core.git\"},\"author\":{\"name\":\"Tick42\",\"url\":\"http://www.glue42.com\"},\"license\":\"ISC\",\"dependencies\":{\"callback-registry\":\"^2.4.0\",\"es6-promise\":\"^4.1.0\",\"shortid\":\"^2.2.6\",\"util-deprecate\":\"^1.0.2\",\"ws\":\"^0.7.2\"},\"devDependencies\":{\"@types/node\":\"^10.7.0\",\"@types/shortid\":\"0.0.29\",\"archiver\":\"^1.3.0\",\"babel-core\":\"^6.25.0\",\"babel-loader\":\"^6.4.1\",\"babel-plugin-add-module-exports\":\"^0.2.1\",\"babel-preset-es2015\":\"^6.16.0\",\"babel-preset-stage-2\":\"^6.22.0\",\"chai\":\"^4.0.2\",\"deep-equal\":\"^1.0.1\",\"mocha\":\"^2.5.3\",\"onchange\":\"3.*\",\"pre-commit\":\"^1.1.3\",\"readline-sync\":\"^1.4.5\",\"shelljs\":\"^0.6.0\",\"tick42-gateway\":\"^0.2.2\",\"tick42-webpack-config\":\"4.1.6\",\"tslint\":\"^5.11.0\",\"typescript\":\"^3.0.1\",\"webpack\":\"2.3.3\"}}\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports) {\n\nfunction webpackEmptyContext(req) {\n\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 14;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(__filename) {\n/**\n * Module dependencies.\n */\n\nvar fs = __webpack_require__(27)\n  , path = __webpack_require__(116)\n  , join = path.join\n  , dirname = path.dirname\n  , exists = fs.existsSync || path.existsSync\n  , defaults = {\n        arrow: __webpack_require__.i({\"NODE_ENV\":\"production\"}).NODE_BINDINGS_ARROW || ' → '\n      , compiled: __webpack_require__.i({\"NODE_ENV\":\"production\"}).NODE_BINDINGS_COMPILED_DIR || 'compiled'\n      , platform: process.platform\n      , arch: process.arch\n      , version: process.versions.node\n      , bindings: 'bindings.node'\n      , try: [\n          // node-gyp's linked version in the \"build\" dir\n          [ 'module_root', 'build', 'bindings' ]\n          // node-waf and gyp_addon (a.k.a node-gyp)\n        , [ 'module_root', 'build', 'Debug', 'bindings' ]\n        , [ 'module_root', 'build', 'Release', 'bindings' ]\n          // Debug files, for development (legacy behavior, remove for node v0.9)\n        , [ 'module_root', 'out', 'Debug', 'bindings' ]\n        , [ 'module_root', 'Debug', 'bindings' ]\n          // Release files, but manually compiled (legacy behavior, remove for node v0.9)\n        , [ 'module_root', 'out', 'Release', 'bindings' ]\n        , [ 'module_root', 'Release', 'bindings' ]\n          // Legacy from node-waf, node <= 0.4.x\n        , [ 'module_root', 'build', 'default', 'bindings' ]\n          // Production \"Release\" buildtype binary (meh...)\n        , [ 'module_root', 'compiled', 'version', 'platform', 'arch', 'bindings' ]\n        ]\n    }\n\n/**\n * The main `bindings()` function loads the compiled bindings for a given module.\n * It uses V8's Error API to determine the parent filename that this function is\n * being invoked from, which is then used to find the root directory.\n */\n\nfunction bindings (opts) {\n\n  // Argument surgery\n  if (typeof opts == 'string') {\n    opts = { bindings: opts }\n  } else if (!opts) {\n    opts = {}\n  }\n  opts.__proto__ = defaults\n\n  // Get the module root\n  if (!opts.module_root) {\n    opts.module_root = exports.getRoot(exports.getFileName())\n  }\n\n  // Ensure the given bindings name ends with .node\n  if (path.extname(opts.bindings) != '.node') {\n    opts.bindings += '.node'\n  }\n\n  var tries = []\n    , i = 0\n    , l = opts.try.length\n    , n\n    , b\n    , err\n\n  for (; i<l; i++) {\n    n = join.apply(null, opts.try[i].map(function (p) {\n      return opts[p] || p\n    }))\n    tries.push(n)\n    try {\n      b = opts.path ? /*require.resolve*/(!(function webpackMissingModule() { var e = new Error(\"Cannot find module \\\".\\\"\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())) : !(function webpackMissingModule() { var e = new Error(\"Cannot find module \\\".\\\"\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())\n      if (!opts.path) {\n        b.path = n\n      }\n      return b\n    } catch (e) {\n      if (!/not find/i.test(e.message)) {\n        throw e\n      }\n    }\n  }\n\n  err = new Error('Could not locate the bindings file. Tried:\\n'\n    + tries.map(function (a) { return opts.arrow + a }).join('\\n'))\n  err.tries = tries\n  throw err\n}\nmodule.exports = exports = bindings\n\n\n/**\n * Gets the filename of the JavaScript file that invokes this function.\n * Used to help find the root directory of a module.\n * Optionally accepts an filename argument to skip when searching for the invoking filename\n */\n\nexports.getFileName = function getFileName (calling_file) {\n  var origPST = Error.prepareStackTrace\n    , origSTL = Error.stackTraceLimit\n    , dummy = {}\n    , fileName\n\n  Error.stackTraceLimit = 10\n\n  Error.prepareStackTrace = function (e, st) {\n    for (var i=0, l=st.length; i<l; i++) {\n      fileName = st[i].getFileName()\n      if (fileName !== __filename) {\n        if (calling_file) {\n            if (fileName !== calling_file) {\n              return\n            }\n        } else {\n          return\n        }\n      }\n    }\n  }\n\n  // run the 'prepareStackTrace' function above\n  Error.captureStackTrace(dummy)\n  dummy.stack\n\n  // cleanup\n  Error.prepareStackTrace = origPST\n  Error.stackTraceLimit = origSTL\n\n  return fileName\n}\n\n/**\n * Gets the root directory of a module, given an arbitrary filename\n * somewhere in the module tree. The \"root directory\" is the directory\n * containing the `package.json` file.\n *\n *   In:  /home/nate/node-native-module/lib/index.js\n *   Out: /home/nate/node-native-module\n */\n\nexports.getRoot = function getRoot (file) {\n  var dir = dirname(file)\n    , prev\n  while (true) {\n    if (dir === '.') {\n      // Avoids an infinite loop in rare cases, like the REPL\n      dir = process.cwd()\n    }\n    if (exists(join(dir, 'package.json')) || exists(join(dir, 'node_modules'))) {\n      // Found the 'package.json' file or 'node_modules' dir; we're done\n      return dir\n    }\n    if (prev === dir) {\n      // Got to the top\n      throw new Error('Could not find module root given file: \"' + file\n                    + '\". Do you have a `package.json` file? ')\n    }\n    // Try the parent dir next\n    prev = dir\n    dir = join(dir, '..')\n  }\n}\n\n/* WEBPACK VAR INJECTION */}.call(exports, \"/index.js\"))\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar fs = __webpack_require__(27);\n\nfunction Options(defaults) {\n  var internalValues = {};\n  var values = this.value = {};\n  Object.keys(defaults).forEach(function(key) {\n    internalValues[key] = defaults[key];\n    Object.defineProperty(values, key, {\n      get: function() { return internalValues[key]; },\n      configurable: false,\n      enumerable: true\n    });\n  });\n  this.reset = function() {\n    Object.keys(defaults).forEach(function(key) {\n      internalValues[key] = defaults[key];\n    });\n    return this;\n  };\n  this.merge = function(options, required) {\n    options = options || {};\n    if (Object.prototype.toString.call(required) === '[object Array]') {\n      var missing = [];\n      for (var i = 0, l = required.length; i < l; ++i) {\n        var key = required[i];\n        if (!(key in options)) {\n          missing.push(key);\n        }\n      }\n      if (missing.length > 0) {\n        if (missing.length > 1) {\n          throw new Error('options ' +\n            missing.slice(0, missing.length - 1).join(', ') + ' and ' +\n            missing[missing.length - 1] + ' must be defined');\n        }\n        else throw new Error('option ' + missing[0] + ' must be defined');\n      }\n    }\n    Object.keys(options).forEach(function(key) {\n      if (key in internalValues) {\n        internalValues[key] = options[key];\n      }\n    });\n    return this;\n  };\n  this.copy = function(keys) {\n    var obj = {};\n    Object.keys(defaults).forEach(function(key) {\n      if (keys.indexOf(key) !== -1) {\n        obj[key] = values[key];\n      }\n    });\n    return obj;\n  };\n  this.read = function(filename, cb) {\n    if (typeof cb == 'function') {\n      var self = this;\n      fs.readFile(filename, function(error, data) {\n        if (error) return cb(error);\n        var conf = JSON.parse(data);\n        self.merge(conf);\n        cb();\n      });\n    }\n    else {\n      var conf = JSON.parse(fs.readFileSync(filename));\n      this.merge(conf);\n    }\n    return this;\n  };\n  this.isDefined = function(key) {\n    return typeof values[key] != 'undefined';\n  };\n  this.isDefinedAndNonNull = function(key) {\n    return typeof values[key] != 'undefined' && values[key] !== null;\n  };\n  Object.freeze(values);\n  Object.freeze(this);\n}\n\nmodule.exports = Options;\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\ntry {\n  module.exports = __webpack_require__(32);\n} catch (e) {\n  module.exports = __webpack_require__(47);\n}\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nmodule.exports = {\n  isValidErrorCode: function(code) {\n    return (code >= 1000 && code <= 1011 && code != 1004 && code != 1005 && code != 1006) ||\n         (code >= 3000 && code <= 4999);\n  },\n  1000: 'normal',\n  1001: 'going away',\n  1002: 'protocol error',\n  1003: 'unsupported data',\n  1004: 'reserved',\n  1005: 'reserved for extensions',\n  1006: 'reserved for extensions',\n  1007: 'inconsistent or invalid data',\n  1008: 'policy violation',\n  1009: 'message too big',\n  1010: 'extension handshake missing',\n  1011: 'an unexpected condition prevented the request from being fulfilled',\n};\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\nvar util = __webpack_require__(3);\n\n/**\n * Module exports.\n */\n\nexports.parse = parse;\nexports.format = format;\n\n/**\n * Parse extensions header value\n */\n\nfunction parse(value) {\n  value = value || '';\n\n  var extensions = {};\n\n  value.split(',').forEach(function(v) {\n    var params = v.split(';');\n    var token = params.shift().trim();\n    var paramsList = extensions[token] = extensions[token] || [];\n    var parsedParams = {};\n\n    params.forEach(function(param) {\n      var parts = param.trim().split('=');\n      var key = parts[0];\n      var value = parts[1];\n      if (typeof value === 'undefined') {\n        value = true;\n      } else {\n        // unquote value\n        if (value[0] === '\"') {\n          value = value.slice(1);\n        }\n        if (value[value.length - 1] === '\"') {\n          value = value.slice(0, value.length - 1);\n        }\n      }\n      (parsedParams[key] = parsedParams[key] || []).push(value);\n    });\n\n    paramsList.push(parsedParams);\n  });\n\n  return extensions;\n}\n\n/**\n * Format extensions header value\n */\n\nfunction format(value) {\n  return Object.keys(value).map(function(token) {\n    var paramsList = value[token];\n    if (!util.isArray(paramsList)) {\n      paramsList = [paramsList];\n    }\n    return paramsList.map(function(params) {\n      return [token].concat(Object.keys(params).map(function(k) {\n        var p = params[k];\n        if (!util.isArray(p)) p = [p];\n        return p.map(function(v) {\n          return v === true ? k : k + '=' + v;\n        }).join('; ');\n      })).join('; ');\n    }).join(', ');\n  }).join(', ');\n}\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar util = __webpack_require__(3)\n  , Validation = __webpack_require__(51).Validation\n  , ErrorCodes = __webpack_require__(18)\n  , BufferPool = __webpack_require__(46)\n  , bufferUtil = __webpack_require__(17).BufferUtil\n  , PerMessageDeflate = __webpack_require__(5);\n\n/**\n * HyBi Receiver implementation\n */\n\nfunction Receiver (extensions) {\n  // memory pool for fragmented messages\n  var fragmentedPoolPrevUsed = -1;\n  this.fragmentedBufferPool = new BufferPool(1024, function(db, length) {\n    return db.used + length;\n  }, function(db) {\n    return fragmentedPoolPrevUsed = fragmentedPoolPrevUsed >= 0 ?\n      (fragmentedPoolPrevUsed + db.used) / 2 :\n      db.used;\n  });\n\n  // memory pool for unfragmented messages\n  var unfragmentedPoolPrevUsed = -1;\n  this.unfragmentedBufferPool = new BufferPool(1024, function(db, length) {\n    return db.used + length;\n  }, function(db) {\n    return unfragmentedPoolPrevUsed = unfragmentedPoolPrevUsed >= 0 ?\n      (unfragmentedPoolPrevUsed + db.used) / 2 :\n      db.used;\n  });\n\n  this.extensions = extensions || {};\n  this.state = {\n    activeFragmentedOperation: null,\n    lastFragment: false,\n    masked: false,\n    opcode: 0,\n    fragmentedOperation: false\n  };\n  this.overflow = [];\n  this.headerBuffer = new Buffer(10);\n  this.expectOffset = 0;\n  this.expectBuffer = null;\n  this.expectHandler = null;\n  this.currentMessage = [];\n  this.messageHandlers = [];\n  this.expectHeader(2, this.processPacket);\n  this.dead = false;\n  this.processing = false;\n\n  this.onerror = function() {};\n  this.ontext = function() {};\n  this.onbinary = function() {};\n  this.onclose = function() {};\n  this.onping = function() {};\n  this.onpong = function() {};\n}\n\nmodule.exports = Receiver;\n\n/**\n * Add new data to the parser.\n *\n * @api public\n */\n\nReceiver.prototype.add = function(data) {\n  var dataLength = data.length;\n  if (dataLength == 0) return;\n  if (this.expectBuffer == null) {\n    this.overflow.push(data);\n    return;\n  }\n  var toRead = Math.min(dataLength, this.expectBuffer.length - this.expectOffset);\n  fastCopy(toRead, data, this.expectBuffer, this.expectOffset);\n  this.expectOffset += toRead;\n  if (toRead < dataLength) {\n    this.overflow.push(data.slice(toRead));\n  }\n  while (this.expectBuffer && this.expectOffset == this.expectBuffer.length) {\n    var bufferForHandler = this.expectBuffer;\n    this.expectBuffer = null;\n    this.expectOffset = 0;\n    this.expectHandler.call(this, bufferForHandler);\n  }\n};\n\n/**\n * Releases all resources used by the receiver.\n *\n * @api public\n */\n\nReceiver.prototype.cleanup = function() {\n  this.dead = true;\n  this.overflow = null;\n  this.headerBuffer = null;\n  this.expectBuffer = null;\n  this.expectHandler = null;\n  this.unfragmentedBufferPool = null;\n  this.fragmentedBufferPool = null;\n  this.state = null;\n  this.currentMessage = null;\n  this.onerror = null;\n  this.ontext = null;\n  this.onbinary = null;\n  this.onclose = null;\n  this.onping = null;\n  this.onpong = null;\n};\n\n/**\n * Waits for a certain amount of header bytes to be available, then fires a callback.\n *\n * @api private\n */\n\nReceiver.prototype.expectHeader = function(length, handler) {\n  if (length == 0) {\n    handler(null);\n    return;\n  }\n  this.expectBuffer = this.headerBuffer.slice(this.expectOffset, this.expectOffset + length);\n  this.expectHandler = handler;\n  var toRead = length;\n  while (toRead > 0 && this.overflow.length > 0) {\n    var fromOverflow = this.overflow.pop();\n    if (toRead < fromOverflow.length) this.overflow.push(fromOverflow.slice(toRead));\n    var read = Math.min(fromOverflow.length, toRead);\n    fastCopy(read, fromOverflow, this.expectBuffer, this.expectOffset);\n    this.expectOffset += read;\n    toRead -= read;\n  }\n};\n\n/**\n * Waits for a certain amount of data bytes to be available, then fires a callback.\n *\n * @api private\n */\n\nReceiver.prototype.expectData = function(length, handler) {\n  if (length == 0) {\n    handler(null);\n    return;\n  }\n  this.expectBuffer = this.allocateFromPool(length, this.state.fragmentedOperation);\n  this.expectHandler = handler;\n  var toRead = length;\n  while (toRead > 0 && this.overflow.length > 0) {\n    var fromOverflow = this.overflow.pop();\n    if (toRead < fromOverflow.length) this.overflow.push(fromOverflow.slice(toRead));\n    var read = Math.min(fromOverflow.length, toRead);\n    fastCopy(read, fromOverflow, this.expectBuffer, this.expectOffset);\n    this.expectOffset += read;\n    toRead -= read;\n  }\n};\n\n/**\n * Allocates memory from the buffer pool.\n *\n * @api private\n */\n\nReceiver.prototype.allocateFromPool = function(length, isFragmented) {\n  return (isFragmented ? this.fragmentedBufferPool : this.unfragmentedBufferPool).get(length);\n};\n\n/**\n * Start processing a new packet.\n *\n * @api private\n */\n\nReceiver.prototype.processPacket = function (data) {\n  if (this.extensions[PerMessageDeflate.extensionName]) {\n    if ((data[0] & 0x30) != 0) {\n      this.error('reserved fields (2, 3) must be empty', 1002);\n      return;\n    }\n  } else {\n    if ((data[0] & 0x70) != 0) {\n      this.error('reserved fields must be empty', 1002);\n      return;\n    }\n  }\n  this.state.lastFragment = (data[0] & 0x80) == 0x80;\n  this.state.masked = (data[1] & 0x80) == 0x80;\n  var compressed = (data[0] & 0x40) == 0x40;\n  var opcode = data[0] & 0xf;\n  if (opcode === 0) {\n    if (compressed) {\n      this.error('continuation frame cannot have the Per-message Compressed bits', 1002);\n      return;\n    }\n    // continuation frame\n    this.state.fragmentedOperation = true;\n    this.state.opcode = this.state.activeFragmentedOperation;\n    if (!(this.state.opcode == 1 || this.state.opcode == 2)) {\n      this.error('continuation frame cannot follow current opcode', 1002);\n      return;\n    }\n  }\n  else {\n    if (opcode < 3 && this.state.activeFragmentedOperation != null) {\n      this.error('data frames after the initial data frame must have opcode 0', 1002);\n      return;\n    }\n    if (opcode >= 8 && compressed) {\n      this.error('control frames cannot have the Per-message Compressed bits', 1002);\n      return;\n    }\n    this.state.compressed = compressed;\n    this.state.opcode = opcode;\n    if (this.state.lastFragment === false) {\n      this.state.fragmentedOperation = true;\n      this.state.activeFragmentedOperation = opcode;\n    }\n    else this.state.fragmentedOperation = false;\n  }\n  var handler = opcodes[this.state.opcode];\n  if (typeof handler == 'undefined') this.error('no handler for opcode ' + this.state.opcode, 1002);\n  else {\n    handler.start.call(this, data);\n  }\n};\n\n/**\n * Endprocessing a packet.\n *\n * @api private\n */\n\nReceiver.prototype.endPacket = function() {\n  if (!this.state.fragmentedOperation) this.unfragmentedBufferPool.reset(true);\n  else if (this.state.lastFragment) this.fragmentedBufferPool.reset(false);\n  this.expectOffset = 0;\n  this.expectBuffer = null;\n  this.expectHandler = null;\n  if (this.state.lastFragment && this.state.opcode === this.state.activeFragmentedOperation) {\n    // end current fragmented operation\n    this.state.activeFragmentedOperation = null;\n  }\n  this.state.lastFragment = false;\n  this.state.opcode = this.state.activeFragmentedOperation != null ? this.state.activeFragmentedOperation : 0;\n  this.state.masked = false;\n  this.expectHeader(2, this.processPacket);\n};\n\n/**\n * Reset the parser state.\n *\n * @api private\n */\n\nReceiver.prototype.reset = function() {\n  if (this.dead) return;\n  this.state = {\n    activeFragmentedOperation: null,\n    lastFragment: false,\n    masked: false,\n    opcode: 0,\n    fragmentedOperation: false\n  };\n  this.fragmentedBufferPool.reset(true);\n  this.unfragmentedBufferPool.reset(true);\n  this.expectOffset = 0;\n  this.expectBuffer = null;\n  this.expectHandler = null;\n  this.overflow = [];\n  this.currentMessage = [];\n  this.messageHandlers = [];\n};\n\n/**\n * Unmask received data.\n *\n * @api private\n */\n\nReceiver.prototype.unmask = function (mask, buf, binary) {\n  if (mask != null && buf != null) bufferUtil.unmask(buf, mask);\n  if (binary) return buf;\n  return buf != null ? buf.toString('utf8') : '';\n};\n\n/**\n * Concatenates a list of buffers.\n *\n * @api private\n */\n\nReceiver.prototype.concatBuffers = function(buffers) {\n  var length = 0;\n  for (var i = 0, l = buffers.length; i < l; ++i) length += buffers[i].length;\n  var mergedBuffer = new Buffer(length);\n  bufferUtil.merge(mergedBuffer, buffers);\n  return mergedBuffer;\n};\n\n/**\n * Handles an error\n *\n * @api private\n */\n\nReceiver.prototype.error = function (reason, protocolErrorCode) {\n  this.reset();\n  this.onerror(reason, protocolErrorCode);\n  return this;\n};\n\n/**\n * Execute message handler buffers\n *\n * @api private\n */\n\nReceiver.prototype.flush = function() {\n  if (this.processing || this.dead) return;\n\n  var handler = this.messageHandlers.shift();\n  if (!handler) return;\n\n  this.processing = true;\n  var self = this;\n\n  handler(function() {\n    self.processing = false;\n    self.flush();\n  });\n};\n\n/**\n * Apply extensions to message\n *\n * @api private\n */\n\nReceiver.prototype.applyExtensions = function(messageBuffer, fin, compressed, callback) {\n  var self = this;\n  if (compressed) {\n    this.extensions[PerMessageDeflate.extensionName].decompress(messageBuffer, fin, function(err, buffer) {\n      if (self.dead) return;\n      if (err) {\n        callback(new Error('invalid compressed data'));\n        return;\n      }\n      callback(null, buffer);\n    });\n  } else {\n    callback(null, messageBuffer);\n  }\n};\n\n/**\n * Buffer utilities\n */\n\nfunction readUInt16BE(start) {\n  return (this[start]<<8) +\n         this[start+1];\n}\n\nfunction readUInt32BE(start) {\n  return (this[start]<<24) +\n         (this[start+1]<<16) +\n         (this[start+2]<<8) +\n         this[start+3];\n}\n\nfunction fastCopy(length, srcBuffer, dstBuffer, dstOffset) {\n  switch (length) {\n    default: srcBuffer.copy(dstBuffer, dstOffset, 0, length); break;\n    case 16: dstBuffer[dstOffset+15] = srcBuffer[15];\n    case 15: dstBuffer[dstOffset+14] = srcBuffer[14];\n    case 14: dstBuffer[dstOffset+13] = srcBuffer[13];\n    case 13: dstBuffer[dstOffset+12] = srcBuffer[12];\n    case 12: dstBuffer[dstOffset+11] = srcBuffer[11];\n    case 11: dstBuffer[dstOffset+10] = srcBuffer[10];\n    case 10: dstBuffer[dstOffset+9] = srcBuffer[9];\n    case 9: dstBuffer[dstOffset+8] = srcBuffer[8];\n    case 8: dstBuffer[dstOffset+7] = srcBuffer[7];\n    case 7: dstBuffer[dstOffset+6] = srcBuffer[6];\n    case 6: dstBuffer[dstOffset+5] = srcBuffer[5];\n    case 5: dstBuffer[dstOffset+4] = srcBuffer[4];\n    case 4: dstBuffer[dstOffset+3] = srcBuffer[3];\n    case 3: dstBuffer[dstOffset+2] = srcBuffer[2];\n    case 2: dstBuffer[dstOffset+1] = srcBuffer[1];\n    case 1: dstBuffer[dstOffset] = srcBuffer[0];\n  }\n}\n\nfunction clone(obj) {\n  var cloned = {};\n  for (var k in obj) {\n    if (obj.hasOwnProperty(k)) {\n      cloned[k] = obj[k];\n    }\n  }\n  return cloned;\n}\n\n/**\n * Opcode handlers\n */\n\nvar opcodes = {\n  // text\n  '1': {\n    start: function(data) {\n      var self = this;\n      // decode length\n      var firstLength = data[1] & 0x7f;\n      if (firstLength < 126) {\n        opcodes['1'].getData.call(self, firstLength);\n      }\n      else if (firstLength == 126) {\n        self.expectHeader(2, function(data) {\n          opcodes['1'].getData.call(self, readUInt16BE.call(data, 0));\n        });\n      }\n      else if (firstLength == 127) {\n        self.expectHeader(8, function(data) {\n          if (readUInt32BE.call(data, 0) != 0) {\n            self.error('packets with length spanning more than 32 bit is currently not supported', 1008);\n            return;\n          }\n          opcodes['1'].getData.call(self, readUInt32BE.call(data, 4));\n        });\n      }\n    },\n    getData: function(length) {\n      var self = this;\n      if (self.state.masked) {\n        self.expectHeader(4, function(data) {\n          var mask = data;\n          self.expectData(length, function(data) {\n            opcodes['1'].finish.call(self, mask, data);\n          });\n        });\n      }\n      else {\n        self.expectData(length, function(data) {\n          opcodes['1'].finish.call(self, null, data);\n        });\n      }\n    },\n    finish: function(mask, data) {\n      var self = this;\n      var packet = this.unmask(mask, data, true) || new Buffer(0);\n      var state = clone(this.state);\n      this.messageHandlers.push(function(callback) {\n        self.applyExtensions(packet, state.lastFragment, state.compressed, function(err, buffer) {\n          if (err) return self.error(err.message, 1007);\n          if (buffer != null) self.currentMessage.push(buffer);\n\n          if (state.lastFragment) {\n            var messageBuffer = self.concatBuffers(self.currentMessage);\n            self.currentMessage = [];\n            if (!Validation.isValidUTF8(messageBuffer)) {\n              self.error('invalid utf8 sequence', 1007);\n              return;\n            }\n            self.ontext(messageBuffer.toString('utf8'), {masked: state.masked, buffer: messageBuffer});\n          }\n          callback();\n        });\n      });\n      this.flush();\n      this.endPacket();\n    }\n  },\n  // binary\n  '2': {\n    start: function(data) {\n      var self = this;\n      // decode length\n      var firstLength = data[1] & 0x7f;\n      if (firstLength < 126) {\n        opcodes['2'].getData.call(self, firstLength);\n      }\n      else if (firstLength == 126) {\n        self.expectHeader(2, function(data) {\n          opcodes['2'].getData.call(self, readUInt16BE.call(data, 0));\n        });\n      }\n      else if (firstLength == 127) {\n        self.expectHeader(8, function(data) {\n          if (readUInt32BE.call(data, 0) != 0) {\n            self.error('packets with length spanning more than 32 bit is currently not supported', 1008);\n            return;\n          }\n          opcodes['2'].getData.call(self, readUInt32BE.call(data, 4, true));\n        });\n      }\n    },\n    getData: function(length) {\n      var self = this;\n      if (self.state.masked) {\n        self.expectHeader(4, function(data) {\n          var mask = data;\n          self.expectData(length, function(data) {\n            opcodes['2'].finish.call(self, mask, data);\n          });\n        });\n      }\n      else {\n        self.expectData(length, function(data) {\n          opcodes['2'].finish.call(self, null, data);\n        });\n      }\n    },\n    finish: function(mask, data) {\n      var self = this;\n      var packet = this.unmask(mask, data, true) || new Buffer(0);\n      var state = clone(this.state);\n      this.messageHandlers.push(function(callback) {\n        self.applyExtensions(packet, state.lastFragment, state.compressed, function(err, buffer) {\n          if (err) return self.error(err.message, 1007);\n          if (buffer != null) self.currentMessage.push(buffer);\n          if (state.lastFragment) {\n            var messageBuffer = self.concatBuffers(self.currentMessage);\n            self.currentMessage = [];\n            self.onbinary(messageBuffer, {masked: state.masked, buffer: messageBuffer});\n          }\n          callback();\n        });\n      });\n      this.flush();\n      this.endPacket();\n    }\n  },\n  // close\n  '8': {\n    start: function(data) {\n      var self = this;\n      if (self.state.lastFragment == false) {\n        self.error('fragmented close is not supported', 1002);\n        return;\n      }\n\n      // decode length\n      var firstLength = data[1] & 0x7f;\n      if (firstLength < 126) {\n        opcodes['8'].getData.call(self, firstLength);\n      }\n      else {\n        self.error('control frames cannot have more than 125 bytes of data', 1002);\n      }\n    },\n    getData: function(length) {\n      var self = this;\n      if (self.state.masked) {\n        self.expectHeader(4, function(data) {\n          var mask = data;\n          self.expectData(length, function(data) {\n            opcodes['8'].finish.call(self, mask, data);\n          });\n        });\n      }\n      else {\n        self.expectData(length, function(data) {\n          opcodes['8'].finish.call(self, null, data);\n        });\n      }\n    },\n    finish: function(mask, data) {\n      var self = this;\n      data = self.unmask(mask, data, true);\n\n      var state = clone(this.state);\n      this.messageHandlers.push(function() {\n        if (data && data.length == 1) {\n          self.error('close packets with data must be at least two bytes long', 1002);\n          return;\n        }\n        var code = data && data.length > 1 ? readUInt16BE.call(data, 0) : 1000;\n        if (!ErrorCodes.isValidErrorCode(code)) {\n          self.error('invalid error code', 1002);\n          return;\n        }\n        var message = '';\n        if (data && data.length > 2) {\n          var messageBuffer = data.slice(2);\n          if (!Validation.isValidUTF8(messageBuffer)) {\n            self.error('invalid utf8 sequence', 1007);\n            return;\n          }\n          message = messageBuffer.toString('utf8');\n        }\n        self.onclose(code, message, {masked: state.masked});\n        self.reset();\n      });\n      this.flush();\n    },\n  },\n  // ping\n  '9': {\n    start: function(data) {\n      var self = this;\n      if (self.state.lastFragment == false) {\n        self.error('fragmented ping is not supported', 1002);\n        return;\n      }\n\n      // decode length\n      var firstLength = data[1] & 0x7f;\n      if (firstLength < 126) {\n        opcodes['9'].getData.call(self, firstLength);\n      }\n      else {\n        self.error('control frames cannot have more than 125 bytes of data', 1002);\n      }\n    },\n    getData: function(length) {\n      var self = this;\n      if (self.state.masked) {\n        self.expectHeader(4, function(data) {\n          var mask = data;\n          self.expectData(length, function(data) {\n            opcodes['9'].finish.call(self, mask, data);\n          });\n        });\n      }\n      else {\n        self.expectData(length, function(data) {\n          opcodes['9'].finish.call(self, null, data);\n        });\n      }\n    },\n    finish: function(mask, data) {\n      var self = this;\n      data = this.unmask(mask, data, true);\n      var state = clone(this.state);\n      this.messageHandlers.push(function(callback) {\n        self.onping(data, {masked: state.masked, binary: true});\n        callback();\n      });\n      this.flush();\n      this.endPacket();\n    }\n  },\n  // pong\n  '10': {\n    start: function(data) {\n      var self = this;\n      if (self.state.lastFragment == false) {\n        self.error('fragmented pong is not supported', 1002);\n        return;\n      }\n\n      // decode length\n      var firstLength = data[1] & 0x7f;\n      if (firstLength < 126) {\n        opcodes['10'].getData.call(self, firstLength);\n      }\n      else {\n        self.error('control frames cannot have more than 125 bytes of data', 1002);\n      }\n    },\n    getData: function(length) {\n      var self = this;\n      if (this.state.masked) {\n        this.expectHeader(4, function(data) {\n          var mask = data;\n          self.expectData(length, function(data) {\n            opcodes['10'].finish.call(self, mask, data);\n          });\n        });\n      }\n      else {\n        this.expectData(length, function(data) {\n          opcodes['10'].finish.call(self, null, data);\n        });\n      }\n    },\n    finish: function(mask, data) {\n      var self = this;\n      data = self.unmask(mask, data, true);\n      var state = clone(this.state);\n      this.messageHandlers.push(function(callback) {\n        self.onpong(data, {masked: state.masked, binary: true});\n        callback();\n      });\n      this.flush();\n      this.endPacket();\n    }\n  }\n}\n\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar events = __webpack_require__(6)\n  , util = __webpack_require__(3)\n  , EventEmitter = events.EventEmitter\n  , ErrorCodes = __webpack_require__(18)\n  , bufferUtil = __webpack_require__(17).BufferUtil\n  , PerMessageDeflate = __webpack_require__(5);\n\n/**\n * HyBi Sender implementation\n */\n\nfunction Sender(socket, extensions) {\n  events.EventEmitter.call(this);\n\n  this._socket = socket;\n  this.extensions = extensions || {};\n  this.firstFragment = true;\n  this.compress = false;\n  this.messageHandlers = [];\n  this.processing = false;\n}\n\n/**\n * Inherits from EventEmitter.\n */\n\nutil.inherits(Sender, events.EventEmitter);\n\n/**\n * Sends a close instruction to the remote party.\n *\n * @api public\n */\n\nSender.prototype.close = function(code, data, mask, cb) {\n  if (typeof code !== 'undefined') {\n    if (typeof code !== 'number' ||\n      !ErrorCodes.isValidErrorCode(code)) throw new Error('first argument must be a valid error code number');\n  }\n  code = code || 1000;\n  var dataBuffer = new Buffer(2 + (data ? Buffer.byteLength(data) : 0));\n  writeUInt16BE.call(dataBuffer, code, 0);\n  if (dataBuffer.length > 2) dataBuffer.write(data, 2);\n\n  var self = this;\n  this.messageHandlers.push(function(callback) {\n    self.frameAndSend(0x8, dataBuffer, true, mask);\n    callback();\n    if (typeof cb == 'function') cb();\n  });\n  this.flush();\n};\n\n/**\n * Sends a ping message to the remote party.\n *\n * @api public\n */\n\nSender.prototype.ping = function(data, options) {\n  var mask = options && options.mask;\n  var self = this;\n  this.messageHandlers.push(function(callback) {\n    self.frameAndSend(0x9, data || '', true, mask);\n    callback();\n  });\n  this.flush();\n};\n\n/**\n * Sends a pong message to the remote party.\n *\n * @api public\n */\n\nSender.prototype.pong = function(data, options) {\n  var mask = options && options.mask;\n  var self = this;\n  this.messageHandlers.push(function(callback) {\n    self.frameAndSend(0xa, data || '', true, mask);\n    callback();\n  });\n  this.flush();\n};\n\n/**\n * Sends text or binary data to the remote party.\n *\n * @api public\n */\n\nSender.prototype.send = function(data, options, cb) {\n  var finalFragment = options && options.fin === false ? false : true;\n  var mask = options && options.mask;\n  var compress = options && options.compress;\n  var opcode = options && options.binary ? 2 : 1;\n  if (this.firstFragment === false) {\n    opcode = 0;\n    compress = false;\n  } else {\n    this.firstFragment = false;\n    this.compress = compress;\n  }\n  if (finalFragment) this.firstFragment = true\n\n  var compressFragment = this.compress;\n\n  var self = this;\n  this.messageHandlers.push(function(callback) {\n    self.applyExtensions(data, finalFragment, compressFragment, function(err, data) {\n      if (err) {\n        if (typeof cb == 'function') cb(err);\n        else self.emit('error', err);\n        return;\n      }\n      self.frameAndSend(opcode, data, finalFragment, mask, compress, cb);\n      callback();\n    });\n  });\n  this.flush();\n};\n\n/**\n * Frames and sends a piece of data according to the HyBi WebSocket protocol.\n *\n * @api private\n */\n\nSender.prototype.frameAndSend = function(opcode, data, finalFragment, maskData, compressed, cb) {\n  var canModifyData = false;\n\n  if (!data) {\n    try {\n      this._socket.write(new Buffer([opcode | (finalFragment ? 0x80 : 0), 0 | (maskData ? 0x80 : 0)].concat(maskData ? [0, 0, 0, 0] : [])), 'binary', cb);\n    }\n    catch (e) {\n      if (typeof cb == 'function') cb(e);\n      else this.emit('error', e);\n    }\n    return;\n  }\n\n  if (!Buffer.isBuffer(data)) {\n    canModifyData = true;\n    if (data && (typeof data.byteLength !== 'undefined' || typeof data.buffer !== 'undefined')) {\n      data = getArrayBuffer(data);\n    } else {\n      data = new Buffer(data);\n    }\n  }\n\n  var dataLength = data.length\n    , dataOffset = maskData ? 6 : 2\n    , secondByte = dataLength;\n\n  if (dataLength >= 65536) {\n    dataOffset += 8;\n    secondByte = 127;\n  }\n  else if (dataLength > 125) {\n    dataOffset += 2;\n    secondByte = 126;\n  }\n\n  var mergeBuffers = dataLength < 32768 || (maskData && !canModifyData);\n  var totalLength = mergeBuffers ? dataLength + dataOffset : dataOffset;\n  var outputBuffer = new Buffer(totalLength);\n  outputBuffer[0] = finalFragment ? opcode | 0x80 : opcode;\n  if (compressed) outputBuffer[0] |= 0x40;\n\n  switch (secondByte) {\n    case 126:\n      writeUInt16BE.call(outputBuffer, dataLength, 2);\n      break;\n    case 127:\n      writeUInt32BE.call(outputBuffer, 0, 2);\n      writeUInt32BE.call(outputBuffer, dataLength, 6);\n  }\n\n  if (maskData) {\n    outputBuffer[1] = secondByte | 0x80;\n    var mask = this._randomMask || (this._randomMask = getRandomMask());\n    outputBuffer[dataOffset - 4] = mask[0];\n    outputBuffer[dataOffset - 3] = mask[1];\n    outputBuffer[dataOffset - 2] = mask[2];\n    outputBuffer[dataOffset - 1] = mask[3];\n    if (mergeBuffers) {\n      bufferUtil.mask(data, mask, outputBuffer, dataOffset, dataLength);\n      try {\n        this._socket.write(outputBuffer, 'binary', cb);\n      }\n      catch (e) {\n        if (typeof cb == 'function') cb(e);\n        else this.emit('error', e);\n      }\n    }\n    else {\n      bufferUtil.mask(data, mask, data, 0, dataLength);\n      try {\n        this._socket.write(outputBuffer, 'binary');\n        this._socket.write(data, 'binary', cb);\n      }\n      catch (e) {\n        if (typeof cb == 'function') cb(e);\n        else this.emit('error', e);\n      }\n    }\n  }\n  else {\n    outputBuffer[1] = secondByte;\n    if (mergeBuffers) {\n      data.copy(outputBuffer, dataOffset);\n      try {\n        this._socket.write(outputBuffer, 'binary', cb);\n      }\n      catch (e) {\n        if (typeof cb == 'function') cb(e);\n        else this.emit('error', e);\n      }\n    }\n    else {\n      try {\n        this._socket.write(outputBuffer, 'binary');\n        this._socket.write(data, 'binary', cb);\n      }\n      catch (e) {\n        if (typeof cb == 'function') cb(e);\n        else this.emit('error', e);\n      }\n    }\n  }\n};\n\n/**\n * Execute message handler buffers\n *\n * @api private\n */\n\nSender.prototype.flush = function() {\n  if (this.processing) return;\n\n  var handler = this.messageHandlers.shift();\n  if (!handler) return;\n\n  this.processing = true;\n\n  var self = this;\n\n  handler(function() {\n    self.processing = false;\n    self.flush();\n  });\n};\n\n/**\n * Apply extensions to message\n *\n * @api private\n */\n\nSender.prototype.applyExtensions = function(data, fin, compress, callback) {\n  if (compress && data) {\n    this.extensions[PerMessageDeflate.extensionName].compress(data, fin, callback);\n  } else {\n    callback(null, data);\n  }\n};\n\nmodule.exports = Sender;\n\nfunction writeUInt16BE(value, offset) {\n  this[offset] = (value & 0xff00)>>8;\n  this[offset+1] = value & 0xff;\n}\n\nfunction writeUInt32BE(value, offset) {\n  this[offset] = (value & 0xff000000)>>24;\n  this[offset+1] = (value & 0xff0000)>>16;\n  this[offset+2] = (value & 0xff00)>>8;\n  this[offset+3] = value & 0xff;\n}\n\nfunction getArrayBuffer(data) {\n  // data is either an ArrayBuffer or ArrayBufferView.\n  var array = new Uint8Array(data.buffer || data)\n    , l = data.byteLength || data.length\n    , o = data.byteOffset || 0\n    , buffer = new Buffer(l);\n  for (var i = 0; i < l; ++i) {\n    buffer[i] = array[o+i];\n  }\n  return buffer;\n}\n\nfunction getRandomMask() {\n  return new Buffer([\n    ~~(Math.random() * 255),\n    ~~(Math.random() * 255),\n    ~~(Math.random() * 255),\n    ~~(Math.random() * 255)\n  ]);\n}\n\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar url = __webpack_require__(29)\n  , util = __webpack_require__(3)\n  , http = __webpack_require__(28)\n  , https = __webpack_require__(115)\n  , crypto = __webpack_require__(12)\n  , stream = __webpack_require__(117)\n  , Ultron = __webpack_require__(42)\n  , Options = __webpack_require__(16)\n  , Sender = __webpack_require__(21)\n  , Receiver = __webpack_require__(20)\n  , SenderHixie = __webpack_require__(49)\n  , ReceiverHixie = __webpack_require__(48)\n  , Extensions = __webpack_require__(19)\n  , PerMessageDeflate = __webpack_require__(5)\n  , EventEmitter = __webpack_require__(6).EventEmitter;\n\n/**\n * Constants\n */\n\n// Default protocol version\n\nvar protocolVersion = 13;\n\n// Close timeout\n\nvar closeTimeout = 30 * 1000; // Allow 30 seconds to terminate the connection cleanly\n\n/**\n * WebSocket implementation\n *\n * @constructor\n * @param {String} address Connection address.\n * @param {String|Array} protocols WebSocket protocols.\n * @param {Object} options Additional connection options.\n * @api public\n */\nfunction WebSocket(address, protocols, options) {\n  EventEmitter.call(this);\n\n  if (protocols && !Array.isArray(protocols) && 'object' === typeof protocols) {\n    // accept the \"options\" Object as the 2nd argument\n    options = protocols;\n    protocols = null;\n  }\n\n  if ('string' === typeof protocols) {\n    protocols = [ protocols ];\n  }\n\n  if (!Array.isArray(protocols)) {\n    protocols = [];\n  }\n\n  this._socket = null;\n  this._ultron = null;\n  this._closeReceived = false;\n  this.bytesReceived = 0;\n  this.readyState = null;\n  this.supports = {};\n  this.extensions = {};\n\n  if (Array.isArray(address)) {\n    initAsServerClient.apply(this, address.concat(options));\n  } else {\n    initAsClient.apply(this, [address, protocols, options]);\n  }\n}\n\n/**\n * Inherits from EventEmitter.\n */\nutil.inherits(WebSocket, EventEmitter);\n\n/**\n * Ready States\n */\n[\"CONNECTING\", \"OPEN\", \"CLOSING\", \"CLOSED\"].forEach(function each(state, index) {\n    WebSocket.prototype[state] = WebSocket[state] = index;\n});\n\n/**\n * Gracefully closes the connection, after sending a description message to the server\n *\n * @param {Object} data to be sent to the server\n * @api public\n */\nWebSocket.prototype.close = function close(code, data) {\n  if (this.readyState === WebSocket.CLOSED) return;\n\n  if (this.readyState === WebSocket.CONNECTING) {\n    this.readyState = WebSocket.CLOSED;\n    return;\n  }\n\n  if (this.readyState === WebSocket.CLOSING) {\n    if (this._closeReceived && this._isServer) {\n      this.terminate();\n    }\n    return;\n  }\n\n  var self = this;\n  try {\n    this.readyState = WebSocket.CLOSING;\n    this._closeCode = code;\n    this._closeMessage = data;\n    var mask = !this._isServer;\n    this._sender.close(code, data, mask, function(err) {\n      if (err) self.emit('error', err);\n\n      if (self._closeReceived && self._isServer) {\n        self.terminate();\n      } else {\n        // ensure that the connection is cleaned up even when no response of closing handshake.\n        clearTimeout(self._closeTimer);\n        self._closeTimer = setTimeout(cleanupWebsocketResources.bind(self, true), closeTimeout);\n      }\n    });\n  } catch (e) {\n    this.emit('error', e);\n  }\n};\n\n/**\n * Pause the client stream\n *\n * @api public\n */\nWebSocket.prototype.pause = function pauser() {\n  if (this.readyState !== WebSocket.OPEN) throw new Error('not opened');\n\n  return this._socket.pause();\n};\n\n/**\n * Sends a ping\n *\n * @param {Object} data to be sent to the server\n * @param {Object} Members - mask: boolean, binary: boolean\n * @param {boolean} dontFailWhenClosed indicates whether or not to throw if the connection isnt open\n * @api public\n */\nWebSocket.prototype.ping = function ping(data, options, dontFailWhenClosed) {\n  if (this.readyState !== WebSocket.OPEN) {\n    if (dontFailWhenClosed === true) return;\n    throw new Error('not opened');\n  }\n\n  options = options || {};\n\n  if (typeof options.mask === 'undefined') options.mask = !this._isServer;\n\n  this._sender.ping(data, options);\n};\n\n/**\n * Sends a pong\n *\n * @param {Object} data to be sent to the server\n * @param {Object} Members - mask: boolean, binary: boolean\n * @param {boolean} dontFailWhenClosed indicates whether or not to throw if the connection isnt open\n * @api public\n */\nWebSocket.prototype.pong = function(data, options, dontFailWhenClosed) {\n  if (this.readyState !== WebSocket.OPEN) {\n    if (dontFailWhenClosed === true) return;\n    throw new Error('not opened');\n  }\n\n  options = options || {};\n\n  if (typeof options.mask === 'undefined') options.mask = !this._isServer;\n\n  this._sender.pong(data, options);\n};\n\n/**\n * Resume the client stream\n *\n * @api public\n */\nWebSocket.prototype.resume = function resume() {\n  if (this.readyState !== WebSocket.OPEN) throw new Error('not opened');\n\n  return this._socket.resume();\n};\n\n/**\n * Sends a piece of data\n *\n * @param {Object} data to be sent to the server\n * @param {Object} Members - mask: boolean, binary: boolean, compress: boolean\n * @param {function} Optional callback which is executed after the send completes\n * @api public\n */\n\nWebSocket.prototype.send = function send(data, options, cb) {\n  if (typeof options === 'function') {\n    cb = options;\n    options = {};\n  }\n\n  if (this.readyState !== WebSocket.OPEN) {\n    if (typeof cb === 'function') cb(new Error('not opened'));\n    else throw new Error('not opened');\n    return;\n  }\n\n  if (!data) data = '';\n  if (this._queue) {\n    var self = this;\n    this._queue.push(function() { self.send(data, options, cb); });\n    return;\n  }\n\n  options = options || {};\n  options.fin = true;\n\n  if (typeof options.binary === 'undefined') {\n    options.binary = (data instanceof ArrayBuffer || data instanceof Buffer ||\n      data instanceof Uint8Array ||\n      data instanceof Uint16Array ||\n      data instanceof Uint32Array ||\n      data instanceof Int8Array ||\n      data instanceof Int16Array ||\n      data instanceof Int32Array ||\n      data instanceof Float32Array ||\n      data instanceof Float64Array);\n  }\n\n  if (typeof options.mask === 'undefined') options.mask = !this._isServer;\n  if (typeof options.compress === 'undefined') options.compress = true;\n  if (!this.extensions[PerMessageDeflate.extensionName]) {\n    options.compress = false;\n  }\n\n  var readable = typeof stream.Readable === 'function'\n    ? stream.Readable\n    : stream.Stream;\n\n  if (data instanceof readable) {\n    startQueue(this);\n    var self = this;\n\n    sendStream(this, data, options, function send(error) {\n      process.nextTick(function tock() {\n        executeQueueSends(self);\n      });\n\n      if (typeof cb === 'function') cb(error);\n    });\n  } else {\n    this._sender.send(data, options, cb);\n  }\n};\n\n/**\n * Streams data through calls to a user supplied function\n *\n * @param {Object} Members - mask: boolean, binary: boolean, compress: boolean\n * @param {function} 'function (error, send)' which is executed on successive ticks of which send is 'function (data, final)'.\n * @api public\n */\nWebSocket.prototype.stream = function stream(options, cb) {\n  if (typeof options === 'function') {\n    cb = options;\n    options = {};\n  }\n\n  var self = this;\n\n  if (typeof cb !== 'function') throw new Error('callback must be provided');\n\n  if (this.readyState !== WebSocket.OPEN) {\n    if (typeof cb === 'function') cb(new Error('not opened'));\n    else throw new Error('not opened');\n    return;\n  }\n\n  if (this._queue) {\n    this._queue.push(function () { self.stream(options, cb); });\n    return;\n  }\n\n  options = options || {};\n\n  if (typeof options.mask === 'undefined') options.mask = !this._isServer;\n  if (typeof options.compress === 'undefined') options.compress = true;\n  if (!this.extensions[PerMessageDeflate.extensionName]) {\n    options.compress = false;\n  }\n\n  startQueue(this);\n\n  function send(data, final) {\n    try {\n      if (self.readyState !== WebSocket.OPEN) throw new Error('not opened');\n      options.fin = final === true;\n      self._sender.send(data, options);\n      if (!final) process.nextTick(cb.bind(null, null, send));\n      else executeQueueSends(self);\n    } catch (e) {\n      if (typeof cb === 'function') cb(e);\n      else {\n        delete self._queue;\n        self.emit('error', e);\n      }\n    }\n  }\n\n  process.nextTick(cb.bind(null, null, send));\n};\n\n/**\n * Immediately shuts down the connection\n *\n * @api public\n */\nWebSocket.prototype.terminate = function terminate() {\n  if (this.readyState === WebSocket.CLOSED) return;\n\n  if (this._socket) {\n    this.readyState = WebSocket.CLOSING;\n\n    // End the connection\n    try { this._socket.end(); }\n    catch (e) {\n      // Socket error during end() call, so just destroy it right now\n      cleanupWebsocketResources.call(this, true);\n      return;\n    }\n\n    // Add a timeout to ensure that the connection is completely\n    // cleaned up within 30 seconds, even if the clean close procedure\n    // fails for whatever reason\n    // First cleanup any pre-existing timeout from an earlier \"terminate\" call,\n    // if one exists.  Otherwise terminate calls in quick succession will leak timeouts\n    // and hold the program open for `closeTimout` time.\n    if (this._closeTimer) { clearTimeout(this._closeTimer); }\n    this._closeTimer = setTimeout(cleanupWebsocketResources.bind(this, true), closeTimeout);\n  } else if (this.readyState === WebSocket.CONNECTING) {\n    cleanupWebsocketResources.call(this, true);\n  }\n};\n\n/**\n * Expose bufferedAmount\n *\n * @api public\n */\nObject.defineProperty(WebSocket.prototype, 'bufferedAmount', {\n  get: function get() {\n    var amount = 0;\n    if (this._socket) {\n      amount = this._socket.bufferSize || 0;\n    }\n    return amount;\n  }\n});\n\n/**\n * Emulates the W3C Browser based WebSocket interface using function members.\n *\n * @see http://dev.w3.org/html5/websockets/#the-websocket-interface\n * @api public\n */\n['open', 'error', 'close', 'message'].forEach(function(method) {\n  Object.defineProperty(WebSocket.prototype, 'on' + method, {\n    /**\n     * Returns the current listener\n     *\n     * @returns {Mixed} the set function or undefined\n     * @api public\n     */\n    get: function get() {\n      var listener = this.listeners(method)[0];\n      return listener ? (listener._listener ? listener._listener : listener) : undefined;\n    },\n\n    /**\n     * Start listening for events\n     *\n     * @param {Function} listener the listener\n     * @returns {Mixed} the set function or undefined\n     * @api public\n     */\n    set: function set(listener) {\n      this.removeAllListeners(method);\n      this.addEventListener(method, listener);\n    }\n  });\n});\n\n/**\n * Emulates the W3C Browser based WebSocket interface using addEventListener.\n *\n * @see https://developer.mozilla.org/en/DOM/element.addEventListener\n * @see http://dev.w3.org/html5/websockets/#the-websocket-interface\n * @api public\n */\nWebSocket.prototype.addEventListener = function(method, listener) {\n  var target = this;\n\n  function onMessage (data, flags) {\n    listener.call(target, new MessageEvent(data, flags.binary ? 'Binary' : 'Text', target));\n  }\n\n  function onClose (code, message) {\n    listener.call(target, new CloseEvent(code, message, target));\n  }\n\n  function onError (event) {\n    event.target = target;\n    listener.call(target, event);\n  }\n\n  function onOpen () {\n    listener.call(target, new OpenEvent(target));\n  }\n\n  if (typeof listener === 'function') {\n    if (method === 'message') {\n      // store a reference so we can return the original function from the\n      // addEventListener hook\n      onMessage._listener = listener;\n      this.on(method, onMessage);\n    } else if (method === 'close') {\n      // store a reference so we can return the original function from the\n      // addEventListener hook\n      onClose._listener = listener;\n      this.on(method, onClose);\n    } else if (method === 'error') {\n      // store a reference so we can return the original function from the\n      // addEventListener hook\n      onError._listener = listener;\n      this.on(method, onError);\n    } else if (method === 'open') {\n      // store a reference so we can return the original function from the\n      // addEventListener hook\n      onOpen._listener = listener;\n      this.on(method, onOpen);\n    } else {\n      this.on(method, listener);\n    }\n  }\n};\n\nmodule.exports = WebSocket;\n\n/**\n * W3C MessageEvent\n *\n * @see http://www.w3.org/TR/html5/comms.html\n * @constructor\n * @api private\n */\nfunction MessageEvent(dataArg, typeArg, target) {\n  this.data = dataArg;\n  this.type = typeArg;\n  this.target = target;\n}\n\n/**\n * W3C CloseEvent\n *\n * @see http://www.w3.org/TR/html5/comms.html\n * @constructor\n * @api private\n */\nfunction CloseEvent(code, reason, target) {\n  this.wasClean = (typeof code === 'undefined' || code === 1000);\n  this.code = code;\n  this.reason = reason;\n  this.target = target;\n}\n\n/**\n * W3C OpenEvent\n *\n * @see http://www.w3.org/TR/html5/comms.html\n * @constructor\n * @api private\n */\nfunction OpenEvent(target) {\n  this.target = target;\n}\n\n/**\n * Entirely private apis,\n * which may or may not be bound to a sepcific WebSocket instance.\n */\nfunction initAsServerClient(req, socket, upgradeHead, options) {\n  options = new Options({\n    protocolVersion: protocolVersion,\n    protocol: null,\n    extensions: {}\n  }).merge(options);\n\n  // expose state properties\n  this.protocol = options.value.protocol;\n  this.protocolVersion = options.value.protocolVersion;\n  this.extensions = options.value.extensions;\n  this.supports.binary = (this.protocolVersion !== 'hixie-76');\n  this.upgradeReq = req;\n  this.readyState = WebSocket.CONNECTING;\n  this._isServer = true;\n\n  // establish connection\n  if (options.value.protocolVersion === 'hixie-76') {\n    establishConnection.call(this, ReceiverHixie, SenderHixie, socket, upgradeHead);\n  } else {\n    establishConnection.call(this, Receiver, Sender, socket, upgradeHead);\n  }\n}\n\nfunction initAsClient(address, protocols, options) {\n  options = new Options({\n    origin: null,\n    protocolVersion: protocolVersion,\n    host: null,\n    headers: null,\n    protocol: protocols.join(','),\n    agent: null,\n\n    // ssl-related options\n    pfx: null,\n    key: null,\n    passphrase: null,\n    cert: null,\n    ca: null,\n    ciphers: null,\n    rejectUnauthorized: null,\n    perMessageDeflate: true\n  }).merge(options);\n\n  if (options.value.protocolVersion !== 8 && options.value.protocolVersion !== 13) {\n    throw new Error('unsupported protocol version');\n  }\n\n  // verify URL and establish http class\n  var serverUrl = url.parse(address);\n  var isUnixSocket = serverUrl.protocol === 'ws+unix:';\n  if (!serverUrl.host && !isUnixSocket) throw new Error('invalid url');\n  var isSecure = serverUrl.protocol === 'wss:' || serverUrl.protocol === 'https:';\n  var httpObj = isSecure ? https : http;\n  var port = serverUrl.port || (isSecure ? 443 : 80);\n  var auth = serverUrl.auth;\n\n  // prepare extensions\n  var extensionsOffer = {};\n  var perMessageDeflate;\n  if (options.value.perMessageDeflate) {\n    perMessageDeflate = new PerMessageDeflate(typeof options.value.perMessageDeflate !== true ? options.value.perMessageDeflate : {}, false);\n    extensionsOffer[PerMessageDeflate.extensionName] = perMessageDeflate.offer();\n  }\n\n  // expose state properties\n  this._isServer = false;\n  this.url = address;\n  this.protocolVersion = options.value.protocolVersion;\n  this.supports.binary = (this.protocolVersion !== 'hixie-76');\n\n  // begin handshake\n  var key = new Buffer(options.value.protocolVersion + '-' + Date.now()).toString('base64');\n  var shasum = crypto.createHash('sha1');\n  shasum.update(key + '258EAFA5-E914-47DA-95CA-C5AB0DC85B11');\n  var expectedServerKey = shasum.digest('base64');\n\n  var agent = options.value.agent;\n\n  var headerHost = serverUrl.hostname;\n  // Append port number to Host header, only if specified in the url\n  // and non-default\n  if (serverUrl.port) {\n    if ((isSecure && (port !== 443)) || (!isSecure && (port !== 80))){\n      headerHost = headerHost + ':' + port;\n    }\n  }\n\n  var requestOptions = {\n    port: port,\n    host: serverUrl.hostname,\n    headers: {\n      'Connection': 'Upgrade',\n      'Upgrade': 'websocket',\n      'Host': headerHost,\n      'Sec-WebSocket-Version': options.value.protocolVersion,\n      'Sec-WebSocket-Key': key\n    }\n  };\n\n  // If we have basic auth.\n  if (auth) {\n    requestOptions.headers.Authorization = 'Basic ' + new Buffer(auth).toString('base64');\n  }\n\n  if (options.value.protocol) {\n    requestOptions.headers['Sec-WebSocket-Protocol'] = options.value.protocol;\n  }\n\n  if (options.value.host) {\n    requestOptions.headers.Host = options.value.host;\n  }\n\n  if (options.value.headers) {\n    for (var header in options.value.headers) {\n       if (options.value.headers.hasOwnProperty(header)) {\n        requestOptions.headers[header] = options.value.headers[header];\n       }\n    }\n  }\n\n  if (Object.keys(extensionsOffer).length) {\n    requestOptions.headers['Sec-WebSocket-Extensions'] = Extensions.format(extensionsOffer);\n  }\n\n  if (options.isDefinedAndNonNull('pfx')\n   || options.isDefinedAndNonNull('key')\n   || options.isDefinedAndNonNull('passphrase')\n   || options.isDefinedAndNonNull('cert')\n   || options.isDefinedAndNonNull('ca')\n   || options.isDefinedAndNonNull('ciphers')\n   || options.isDefinedAndNonNull('rejectUnauthorized')) {\n\n    if (options.isDefinedAndNonNull('pfx')) requestOptions.pfx = options.value.pfx;\n    if (options.isDefinedAndNonNull('key')) requestOptions.key = options.value.key;\n    if (options.isDefinedAndNonNull('passphrase')) requestOptions.passphrase = options.value.passphrase;\n    if (options.isDefinedAndNonNull('cert')) requestOptions.cert = options.value.cert;\n    if (options.isDefinedAndNonNull('ca')) requestOptions.ca = options.value.ca;\n    if (options.isDefinedAndNonNull('ciphers')) requestOptions.ciphers = options.value.ciphers;\n    if (options.isDefinedAndNonNull('rejectUnauthorized')) requestOptions.rejectUnauthorized = options.value.rejectUnauthorized;\n\n    if (!agent) {\n        // global agent ignores client side certificates\n        agent = new httpObj.Agent(requestOptions);\n    }\n  }\n\n  requestOptions.path = serverUrl.path || '/';\n\n  if (agent) {\n    requestOptions.agent = agent;\n  }\n\n  if (isUnixSocket) {\n    requestOptions.socketPath = serverUrl.pathname;\n  }\n  if (options.value.origin) {\n    if (options.value.protocolVersion < 13) requestOptions.headers['Sec-WebSocket-Origin'] = options.value.origin;\n    else requestOptions.headers.Origin = options.value.origin;\n  }\n\n  var self = this;\n  var req = httpObj.request(requestOptions);\n\n  req.on('error', function onerror(error) {\n    self.emit('error', error);\n    cleanupWebsocketResources.call(self, error);\n  });\n\n  req.once('response', function response(res) {\n    var error;\n\n    if (!self.emit('unexpected-response', req, res)) {\n      error = new Error('unexpected server response (' + res.statusCode + ')');\n      req.abort();\n      self.emit('error', error);\n    }\n\n    cleanupWebsocketResources.call(self, error);\n  });\n\n  req.once('upgrade', function upgrade(res, socket, upgradeHead) {\n    if (self.readyState === WebSocket.CLOSED) {\n      // client closed before server accepted connection\n      self.emit('close');\n      self.removeAllListeners();\n      socket.end();\n      return;\n    }\n\n    var serverKey = res.headers['sec-websocket-accept'];\n    if (typeof serverKey === 'undefined' || serverKey !== expectedServerKey) {\n      self.emit('error', 'invalid server key');\n      self.removeAllListeners();\n      socket.end();\n      return;\n    }\n\n    var serverProt = res.headers['sec-websocket-protocol'];\n    var protList = (options.value.protocol || \"\").split(/, */);\n    var protError = null;\n\n    if (!options.value.protocol && serverProt) {\n      protError = 'server sent a subprotocol even though none requested';\n    } else if (options.value.protocol && !serverProt) {\n      protError = 'server sent no subprotocol even though requested';\n    } else if (serverProt && protList.indexOf(serverProt) === -1) {\n      protError = 'server responded with an invalid protocol';\n    }\n\n    if (protError) {\n      self.emit('error', protError);\n      self.removeAllListeners();\n      socket.end();\n      return;\n    } else if (serverProt) {\n      self.protocol = serverProt;\n    }\n\n    var serverExtensions = Extensions.parse(res.headers['sec-websocket-extensions']);\n    if (perMessageDeflate && serverExtensions[PerMessageDeflate.extensionName]) {\n      try {\n        perMessageDeflate.accept(serverExtensions[PerMessageDeflate.extensionName]);\n      } catch (err) {\n        self.emit('error', 'invalid extension parameter');\n        self.removeAllListeners();\n        socket.end();\n        return;\n      }\n      self.extensions[PerMessageDeflate.extensionName] = perMessageDeflate;\n    }\n\n    establishConnection.call(self, Receiver, Sender, socket, upgradeHead);\n\n    // perform cleanup on http resources\n    req.removeAllListeners();\n    req = null;\n    agent = null;\n  });\n\n  req.end();\n  this.readyState = WebSocket.CONNECTING;\n}\n\nfunction establishConnection(ReceiverClass, SenderClass, socket, upgradeHead) {\n  var ultron = this._ultron = new Ultron(socket);\n  this._socket = socket;\n\n  socket.setTimeout(0);\n  socket.setNoDelay(true);\n  var self = this;\n  this._receiver = new ReceiverClass(this.extensions);\n\n  // socket cleanup handlers\n  ultron.on('end', cleanupWebsocketResources.bind(this));\n  ultron.on('close', cleanupWebsocketResources.bind(this));\n  ultron.on('error', cleanupWebsocketResources.bind(this));\n\n  // ensure that the upgradeHead is added to the receiver\n  function firstHandler(data) {\n    if (self.readyState !== WebSocket.OPEN && self.readyState !== WebSocket.CLOSING) return;\n\n    if (upgradeHead && upgradeHead.length > 0) {\n      self.bytesReceived += upgradeHead.length;\n      var head = upgradeHead;\n      upgradeHead = null;\n      self._receiver.add(head);\n    }\n\n    dataHandler = realHandler;\n\n    if (data) {\n      self.bytesReceived += data.length;\n      self._receiver.add(data);\n    }\n  }\n\n  // subsequent packets are pushed straight to the receiver\n  function realHandler(data) {\n    if (data) self.bytesReceived += data.length;\n    self._receiver.add(data);\n  }\n\n  var dataHandler = firstHandler;\n\n  // if data was passed along with the http upgrade,\n  // this will schedule a push of that on to the receiver.\n  // this has to be done on next tick, since the caller\n  // hasn't had a chance to set event handlers on this client\n  // object yet.\n  process.nextTick(firstHandler);\n\n  // receiver event handlers\n  self._receiver.ontext = function ontext(data, flags) {\n    flags = flags || {};\n\n    self.emit('message', data, flags);\n  };\n\n  self._receiver.onbinary = function onbinary(data, flags) {\n    flags = flags || {};\n\n    flags.binary = true;\n    self.emit('message', data, flags);\n  };\n\n  self._receiver.onping = function onping(data, flags) {\n    flags = flags || {};\n\n    self.pong(data, {\n      mask: !self._isServer,\n      binary: flags.binary === true\n    }, true);\n\n    self.emit('ping', data, flags);\n  };\n\n  self._receiver.onpong = function onpong(data, flags) {\n    self.emit('pong', data, flags || {});\n  };\n\n  self._receiver.onclose = function onclose(code, data, flags) {\n    flags = flags || {};\n\n    self._closeReceived = true;\n    self.close(code, data);\n  };\n\n  self._receiver.onerror = function onerror(reason, errorCode) {\n    // close the connection when the receiver reports a HyBi error code\n    self.close(typeof errorCode !== 'undefined' ? errorCode : 1002, '');\n    self.emit('error', reason, errorCode);\n  };\n\n  // finalize the client\n  this._sender = new SenderClass(socket, this.extensions);\n  this._sender.on('error', function onerror(error) {\n    self.close(1002, '');\n    self.emit('error', error);\n  });\n\n  this.readyState = WebSocket.OPEN;\n  this.emit('open');\n\n  ultron.on('data', dataHandler);\n}\n\nfunction startQueue(instance) {\n  instance._queue = instance._queue || [];\n}\n\nfunction executeQueueSends(instance) {\n  var queue = instance._queue;\n  if (typeof queue === 'undefined') return;\n\n  delete instance._queue;\n  for (var i = 0, l = queue.length; i < l; ++i) {\n    queue[i]();\n  }\n}\n\nfunction sendStream(instance, stream, options, cb) {\n  stream.on('data', function incoming(data) {\n    if (instance.readyState !== WebSocket.OPEN) {\n      if (typeof cb === 'function') cb(new Error('not opened'));\n      else {\n        delete instance._queue;\n        instance.emit('error', new Error('not opened'));\n      }\n      return;\n    }\n\n    options.fin = false;\n    instance._sender.send(data, options);\n  });\n\n  stream.on('end', function end() {\n    if (instance.readyState !== WebSocket.OPEN) {\n      if (typeof cb === 'function') cb(new Error('not opened'));\n      else {\n        delete instance._queue;\n        instance.emit('error', new Error('not opened'));\n      }\n      return;\n    }\n\n    options.fin = true;\n    instance._sender.send(null, options);\n\n    if (typeof cb === 'function') cb(null);\n  });\n}\n\nfunction cleanupWebsocketResources(error) {\n  if (this.readyState === WebSocket.CLOSED) return;\n\n  var emitClose = this.readyState !== WebSocket.CONNECTING;\n  this.readyState = WebSocket.CLOSED;\n\n  clearTimeout(this._closeTimer);\n  this._closeTimer = null;\n\n  if (emitClose) {\n    this.emit('close', this._closeCode || 1000, this._closeMessage || '');\n  }\n\n  if (this._socket) {\n    if (this._ultron) this._ultron.destroy();\n    this._socket.on('error', function onerror() {\n      try { this.destroy(); }\n      catch (e) {}\n    });\n\n    try {\n      if (!error) this._socket.end();\n      else this._socket.destroy();\n    } catch (e) { /* Ignore termination errors */ }\n\n    this._socket = null;\n    this._ultron = null;\n  }\n\n  if (this._sender) {\n    this._sender.removeAllListeners();\n    this._sender = null;\n  }\n\n  if (this._receiver) {\n    this._receiver.cleanup();\n    this._receiver = null;\n  }\n\n  this.removeAllListeners();\n  this.on('error', function onerror() {}); // catch all errors after this\n  delete this._queue;\n}\n\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar shortid = __webpack_require__(7);\r\nexports.default = shortid;\r\n//# sourceMappingURL=random.js.map\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar ConnectionImpl = (function () {\r\n    function ConnectionImpl(settings) {\r\n        this.messageHandlers = {};\r\n        this.ids = 1;\r\n        this.registry = callback_registry_1.default();\r\n        this._connected = false;\r\n        this._settings = settings;\r\n        this._logger = settings.logger;\r\n    }\r\n    ConnectionImpl.prototype.init = function (transport, protocol) {\r\n        this._protocol = protocol;\r\n        this._transport = transport;\r\n        this._transport.onConnectedChanged(this.handleConnectionChanged.bind(this));\r\n        this._transport.onMessage(this.handleTransportMessage.bind(this));\r\n    };\r\n    ConnectionImpl.prototype.send = function (product, type, message, id, options) {\r\n        if (this._transport.isObjectBasedTransport) {\r\n            var msg = this._protocol.createObjectMessage(product, type, message, id);\r\n            return this._transport.sendObject(msg, product, type, options);\r\n        }\r\n        else {\r\n            var strMessage = this._protocol.createStringMessage(product, type, message, id);\r\n            return this._transport.send(strMessage, product, type, options);\r\n        }\r\n    };\r\n    ConnectionImpl.prototype.on = function (product, type, messageHandler) {\r\n        type = type.toLowerCase();\r\n        if (this.messageHandlers[type] === undefined) {\r\n            this.messageHandlers[type] = {};\r\n        }\r\n        var id = this.ids++;\r\n        this.messageHandlers[type][id] = messageHandler;\r\n        return {\r\n            type: type,\r\n            id: id,\r\n        };\r\n    };\r\n    ConnectionImpl.prototype.off = function (info) {\r\n        delete this.messageHandlers[info.type.toLowerCase()][info.id];\r\n    };\r\n    Object.defineProperty(ConnectionImpl.prototype, \"isConnected\", {\r\n        get: function () {\r\n            return this._connected;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ConnectionImpl.prototype.connected = function (callback) {\r\n        if (this._connected) {\r\n            callback(this._settings.ws || this._settings.http);\r\n        }\r\n        return this.registry.add(\"connected\", callback);\r\n    };\r\n    ConnectionImpl.prototype.disconnected = function (callback) {\r\n        return this.registry.add(\"disconnected\", callback);\r\n    };\r\n    ConnectionImpl.prototype.login = function (authRequest) {\r\n        this._transport.open();\r\n        return this._protocol.login(authRequest);\r\n    };\r\n    ConnectionImpl.prototype.logout = function () {\r\n        this._protocol.logout();\r\n        this._transport.close();\r\n    };\r\n    ConnectionImpl.prototype.loggedIn = function (callback) {\r\n        return this._protocol.loggedIn(callback);\r\n    };\r\n    Object.defineProperty(ConnectionImpl.prototype, \"protocolVersion\", {\r\n        get: function () {\r\n            return this._settings.protocolVersion || 1;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ConnectionImpl.prototype.toAPI = function () {\r\n        var that = this;\r\n        return {\r\n            send: that.send.bind(that),\r\n            on: that.on.bind(that),\r\n            off: that.off.bind(that),\r\n            login: that.login.bind(that),\r\n            logout: that.logout.bind(that),\r\n            loggedIn: that.loggedIn.bind(that),\r\n            connected: that.connected.bind(that),\r\n            disconnected: that.disconnected.bind(that),\r\n            get protocolVersion() {\r\n                return that.protocolVersion;\r\n            }\r\n        };\r\n    };\r\n    ConnectionImpl.prototype.distributeMessage = function (message, type) {\r\n        var _this = this;\r\n        var handlers = this.messageHandlers[type.toLowerCase()];\r\n        if (handlers !== undefined) {\r\n            Object.keys(handlers).forEach(function (handlerId) {\r\n                var handler = handlers[handlerId];\r\n                if (handler !== undefined) {\r\n                    try {\r\n                        handler(message);\r\n                    }\r\n                    catch (error) {\r\n                        _this._logger.error(\"Message handler failed with \" + error.stack);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n    ConnectionImpl.prototype.handleConnectionChanged = function (connected) {\r\n        if (this._connected === connected) {\r\n            return;\r\n        }\r\n        this._connected = connected;\r\n        if (connected) {\r\n            this.registry.execute(\"connected\");\r\n        }\r\n        else {\r\n            this.registry.execute(\"disconnected\");\r\n        }\r\n    };\r\n    ConnectionImpl.prototype.handleTransportMessage = function (msg) {\r\n        var msgObj;\r\n        if (typeof msg === \"string\") {\r\n            msgObj = this._protocol.processStringMessage(msg);\r\n        }\r\n        else {\r\n            msgObj = this._protocol.processObjectMessage(msg);\r\n        }\r\n        this.distributeMessage(msgObj.msg, msgObj.msgType);\r\n    };\r\n    return ConnectionImpl;\r\n}());\r\nexports.default = ConnectionImpl;\r\n//# sourceMappingURL=connection.js.map\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.GW_MESSAGE_CREATE_CONTEXT = \"create-context\";\r\nexports.GW_MESSAGE_ACTIVITY_CREATED = \"created\";\r\nexports.GW_MESSAGE_ACTIVITY_DESTROYED = \"destroyed\";\r\nexports.GW_MESSAGE_CONTEXT_CREATED = \"context-created\";\r\nexports.GW_MESSAGE_CONTEXT_ADDED = \"context-added\";\r\nexports.GW_MESSAGE_SUBSCRIBE_CONTEXT = \"subscribe-context\";\r\nexports.GW_MESSAGE_SUBSCRIBED_CONTEXT = \"subscribed-context\";\r\nexports.GW_MESSAGE_UNSUBSCRIBE_CONTEXT = \"unsubscribe-context\";\r\nexports.GW_MESSAGE_DESTROY_CONTEXT = \"destroy-context\";\r\nexports.GW_MESSAGE_CONTEXT_DESTROYED = \"context-destroyed\";\r\nexports.GW_MESSAGE_UPDATE_CONTEXT = \"update-context\";\r\nexports.GW_MESSAGE_CONTEXT_UPDATED = \"context-updated\";\r\nexports.GW_MESSAGE_JOINED_ACTIVITY = \"joined\";\r\n//# sourceMappingURL=gw3Messages.js.map\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar connection = {\r\n    protocolVersion: -1,\r\n    send: function (product, type, message, id, options) {\r\n        return Promise.resolve(undefined);\r\n    },\r\n    on: function (product, type, messageHandler) {\r\n        return { type: \"1\", id: 1 };\r\n    },\r\n    off: function (info) {\r\n    },\r\n    login: function (message) {\r\n        return undefined;\r\n    },\r\n    logout: function () {\r\n    },\r\n    loggedIn: function (callback) {\r\n        return undefined;\r\n    },\r\n    connected: function (callback) {\r\n        return undefined;\r\n    },\r\n    disconnected: function (callback) {\r\n        return undefined;\r\n    },\r\n};\r\nexports.default = connection;\r\n//# sourceMappingURL=dummyConnection.js.map\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(26);\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(27);\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(32);\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar main_1 = __webpack_require__(110);\r\nvar main_2 = __webpack_require__(79);\r\nvar main_3 = __webpack_require__(95);\r\nvar main_4 = __webpack_require__(61);\r\nvar config_1 = __webpack_require__(77);\r\nvar dummyConnection_1 = __webpack_require__(26);\r\nvar timer_1 = __webpack_require__(113);\r\nvar utils_1 = __webpack_require__(11);\r\nvar dummyConnection_2 = __webpack_require__(26);\r\nvar main_5 = __webpack_require__(92);\r\nvar contextMessageReplaySpec_1 = __webpack_require__(10);\r\nvar main_6 = __webpack_require__(76);\r\nvar GlueCore = function (userConfig, ext) {\r\n    var gdVersion = -1;\r\n    var hc;\r\n    var glue42gd;\r\n    if (typeof window !== \"undefined\") {\r\n        gdVersion = utils_1.default.getGDMajorVersion();\r\n        if (gdVersion === 2) {\r\n            hc = window.htmlContainer;\r\n        }\r\n        else if (gdVersion >= 3) {\r\n            glue42gd = window.glue42gd;\r\n        }\r\n    }\r\n    var glueInitTimer = timer_1.default();\r\n    userConfig = userConfig || {};\r\n    ext = ext || {};\r\n    var internalConfig = config_1.default(userConfig, ext, hc, glue42gd, gdVersion);\r\n    var _connection;\r\n    var _agm;\r\n    var _logger;\r\n    var _rootMetrics;\r\n    var _metrics;\r\n    var _contexts;\r\n    var _channels;\r\n    var libs = {};\r\n    function registerLib(name, inner, t) {\r\n        inner.initStartTime = t.startTime;\r\n        if (inner.ready) {\r\n            inner.ready().then(function () {\r\n                inner.initTime = t.stop();\r\n                inner.initEndTime = t.endTime;\r\n            });\r\n        }\r\n        else {\r\n            inner.initTime = t.stop();\r\n            inner.initEndTime = t.endTime;\r\n        }\r\n        libs[name] = inner;\r\n        GlueCore[name] = inner;\r\n    }\r\n    function setupConnection() {\r\n        var initTimer = timer_1.default();\r\n        internalConfig.connection.logger = _logger.subLogger(\"connection\");\r\n        _connection = main_2.default(internalConfig.connection);\r\n        var authPromise = Promise.resolve(internalConfig.auth);\r\n        if (internalConfig.connection && !internalConfig.auth) {\r\n            var protocolVersion = internalConfig.connection.protocolVersion;\r\n            if (!protocolVersion || protocolVersion === 1) {\r\n                registerLib(\"connection\", _connection, initTimer);\r\n                return Promise.resolve({});\r\n            }\r\n            if (protocolVersion === 2) {\r\n                return Promise.reject(\"You need to provide auth information\");\r\n            }\r\n            if (protocolVersion === 3) {\r\n                if (glue42gd) {\r\n                    authPromise = glue42gd.getGWToken().then(function (token) {\r\n                        return {\r\n                            gatewayToken: token\r\n                        };\r\n                    });\r\n                }\r\n                else {\r\n                    authPromise = Promise.reject(\"You need to provide auth information\");\r\n                }\r\n            }\r\n        }\r\n        return authPromise\r\n            .then(function (authConfig) {\r\n            var authRequest;\r\n            if (typeof authConfig === \"string\" || typeof authConfig === \"number\") {\r\n                authRequest = {\r\n                    token: authConfig\r\n                };\r\n            }\r\n            else if (Object.prototype.toString.call(authConfig) === \"[object Object]\") {\r\n                authRequest = authConfig;\r\n            }\r\n            else {\r\n                throw new Error(\"Invalid auth object - \" + JSON.stringify(authConfig));\r\n            }\r\n            return authRequest;\r\n        })\r\n            .then(function (authRequest) {\r\n            return _connection.login(authRequest);\r\n        })\r\n            .then(function (identity) {\r\n            if (identity) {\r\n                if (identity.machine) {\r\n                    internalConfig.agm.instance.machine = identity.machine;\r\n                }\r\n                if (identity.user) {\r\n                    internalConfig.agm.instance.user = identity.user;\r\n                }\r\n            }\r\n            registerLib(\"connection\", _connection, initTimer);\r\n            return internalConfig;\r\n        })\r\n            .catch(function () {\r\n            if (_connection) {\r\n                _connection.logout();\r\n            }\r\n            return internalConfig;\r\n        });\r\n    }\r\n    function setupLogger() {\r\n        var initTimer = timer_1.default();\r\n        var loggerConfig = {\r\n            identity: internalConfig.identity,\r\n            getConnection: function () {\r\n                return _connection || dummyConnection_1.default;\r\n            },\r\n            publish: internalConfig.logger.publish || \"off\",\r\n            console: internalConfig.logger.console || \"info\",\r\n            metrics: (internalConfig.metrics && internalConfig.logger.metrics) || \"off\"\r\n        };\r\n        _logger = main_3.default(loggerConfig);\r\n        registerLib(\"logger\", _logger, initTimer);\r\n        return Promise.resolve(undefined);\r\n    }\r\n    function setupMetrics() {\r\n        if (internalConfig.metrics) {\r\n            var initTimer = timer_1.default();\r\n            _rootMetrics = main_1.default({\r\n                identity: internalConfig.metrics.identity,\r\n                connection: internalConfig.metrics ? _connection : dummyConnection_1.default,\r\n                logger: _logger.subLogger(\"metrics\")\r\n            });\r\n            _metrics = _rootMetrics.subSystem(\"App\");\r\n            var reportingSystem_1 = _metrics.subSystem(\"reporting\");\r\n            var def_1 = {\r\n                name: \"features\",\r\n                conflation: 1,\r\n            };\r\n            var _featureMetric_1;\r\n            _metrics.featureMetric = function (name, action, payload) {\r\n                if (typeof name === \"undefined\" || name === \"\") {\r\n                    throw new Error(\"name is mandatory\");\r\n                }\r\n                else if (typeof action === \"undefined\" || action === \"\") {\r\n                    throw new Error(\"action is mandatory\");\r\n                }\r\n                else if (typeof payload === \"undefined\" || payload === \"\") {\r\n                    throw new Error(\"payload is mandatory\");\r\n                }\r\n                if (!_featureMetric_1) {\r\n                    _featureMetric_1 = reportingSystem_1.objectMetric(def_1, { name: name, action: action, payload: payload });\r\n                }\r\n                else {\r\n                    _featureMetric_1.update({\r\n                        name: name,\r\n                        action: action,\r\n                        payload: payload\r\n                    });\r\n                }\r\n            };\r\n            _logger.metricsLevel(\"warn\", _metrics.parent.subSystem(\"LogEvents\"));\r\n            registerLib(\"metrics\", _metrics, initTimer);\r\n        }\r\n        return Promise.resolve(undefined);\r\n    }\r\n    function setupAGM() {\r\n        var initTimer = timer_1.default();\r\n        var agmConfig = {\r\n            instance: internalConfig.agm.instance,\r\n            connection: _connection,\r\n            logger: _logger.subLogger(\"agm\"),\r\n            forceGW: internalConfig.connection && internalConfig.connection.force,\r\n            gdVersion: gdVersion,\r\n        };\r\n        return new Promise(function (resolve, reject) {\r\n            main_4.default(agmConfig)\r\n                .then(function (agmLib) {\r\n                _agm = agmLib;\r\n                registerLib(\"agm\", _agm, initTimer);\r\n                resolve(internalConfig);\r\n            })\r\n                .catch(function (err) {\r\n                return reject(err);\r\n            });\r\n        });\r\n    }\r\n    function setupContexts() {\r\n        var hasActivities = (internalConfig.activities && dummyConnection_2.default.protocolVersion === 3);\r\n        var needsContexts = internalConfig.contexts || hasActivities;\r\n        if (needsContexts) {\r\n            var initTimer = timer_1.default();\r\n            _contexts = new main_5.ContextsModule({\r\n                connection: _connection,\r\n                logger: _logger.subLogger(\"contexts\"),\r\n                gdMajorVersion: gdVersion\r\n            });\r\n            registerLib(\"contexts\", _contexts, initTimer);\r\n            return _contexts;\r\n        }\r\n        else {\r\n            var replayer = dummyConnection_2.default.replayer;\r\n            if (replayer) {\r\n                replayer.drain(contextMessageReplaySpec_1.ContextMessageReplaySpec.name, null);\r\n            }\r\n        }\r\n    }\r\n    function setupChannels() {\r\n        var initTimer = timer_1.default();\r\n        _channels = main_6.factory(_contexts, _agm);\r\n        registerLib(\"channels\", _channels, initTimer);\r\n        return Promise.resolve(undefined);\r\n    }\r\n    function setupExternalLibs(externalLibs) {\r\n        try {\r\n            externalLibs.forEach(function (lib) {\r\n                setupExternalLib(lib.name, lib.create);\r\n            });\r\n            return Promise.resolve();\r\n        }\r\n        catch (e) {\r\n            return Promise.reject(e);\r\n        }\r\n    }\r\n    function setupExternalLib(name, createCallback) {\r\n        var initTimer = timer_1.default();\r\n        var lib = createCallback(libs);\r\n        if (lib) {\r\n            registerLib(name, lib, initTimer);\r\n        }\r\n    }\r\n    function waitForLibs() {\r\n        var libsReadyPromises = Object.keys(libs).map(function (key) {\r\n            var lib = libs[key];\r\n            return lib.ready ?\r\n                lib.ready() : Promise.resolve();\r\n        });\r\n        return Promise.all(libsReadyPromises);\r\n    }\r\n    function constructGlueObject() {\r\n        var feedbackFunc = function () {\r\n            if (!_agm) {\r\n                return;\r\n            }\r\n            _agm.invoke(\"T42.ACS.Feedback\", {}, \"best\");\r\n        };\r\n        var info = { glueVersion: internalConfig.version };\r\n        glueInitTimer.stop();\r\n        var glue = {\r\n            feedback: feedbackFunc,\r\n            info: info,\r\n            version: internalConfig.version,\r\n            userConfig: userConfig,\r\n            done: function () {\r\n                _connection.logout();\r\n                return Promise.resolve();\r\n            }\r\n        };\r\n        glue.performance = {\r\n            get browser() {\r\n                return window.performance.timing.toJSON();\r\n            },\r\n            get memory() {\r\n                return window.performance.memory;\r\n            },\r\n            get initTimes() {\r\n                var result = Object.keys(glue)\r\n                    .filter(function (key) {\r\n                    if (key === \"initTimes\") {\r\n                        return false;\r\n                    }\r\n                    return glue[key].initTime;\r\n                })\r\n                    .map(function (key) {\r\n                    return {\r\n                        name: key,\r\n                        time: glue[key].initTime,\r\n                        startTime: glue[key].initStartTime,\r\n                        endTime: glue[key].initEndTime\r\n                    };\r\n                });\r\n                result.push({\r\n                    name: \"glue\",\r\n                    startTime: glueInitTimer.startTime,\r\n                    endTime: glueInitTimer.endTime,\r\n                    time: glueInitTimer.period\r\n                });\r\n                return result;\r\n            }\r\n        };\r\n        Object.keys(libs).forEach(function (key) {\r\n            var lib = libs[key];\r\n            glue[key] = lib;\r\n            info[key] = lib.version;\r\n        });\r\n        if (hc && hc.perfDataNeeded && hc.updatePerfData) {\r\n            var delay = hc.perfDataDelay || 100;\r\n            setTimeout(function () {\r\n                hc.updatePerfData(glue.performance);\r\n            }, delay);\r\n        }\r\n        glue.config = {};\r\n        if (ext.enrichGlue) {\r\n            ext.enrichGlue(glue);\r\n        }\r\n        Object.keys(internalConfig).forEach(function (k) {\r\n            glue.config[k] = internalConfig[k];\r\n        });\r\n        if (ext.extOptions) {\r\n            Object.keys(ext.extOptions).forEach(function (k) {\r\n                glue.config[k] = ext.extOptions[k];\r\n            });\r\n        }\r\n        return glue;\r\n    }\r\n    return setupLogger()\r\n        .then(setupConnection)\r\n        .then(function () { return Promise.all([setupMetrics(), setupAGM(), setupContexts()]); })\r\n        .then(function () { return setupChannels(); })\r\n        .then(function () {\r\n        return setupExternalLibs(internalConfig.libs || []);\r\n    })\r\n        .then(waitForLibs)\r\n        .then(constructGlueObject)\r\n        .catch(function (err) {\r\n        return Promise.reject({\r\n            err: err,\r\n            libs: libs\r\n        });\r\n    });\r\n};\r\nexports.default = GlueCore;\r\n//# sourceMappingURL=glue.js.map\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * bufferutil: WebSocket buffer utils\n * Copyright(c) 2015 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nmodule.exports.BufferUtil = {\n  merge: function(mergedBuffer, buffers) {\n    var offset = 0;\n\n    for (var i = 0, l = buffers.length; i < l; ++i) {\n      var buf = buffers[i];\n      buf.copy(mergedBuffer, offset);\n      offset += buf.length;\n    }\n  },\n  mask: function(source, mask, output, offset, length) {\n    var maskNum = mask.readUInt32LE(0, true);\n    var i = 0;\n\n    for (; i < length - 3; i += 4) {\n      var num = maskNum ^ source.readUInt32LE(i, true);\n      if (num < 0) num = 4294967296 + num;\n      output.writeUInt32LE(num, offset + i, true);\n    }\n\n    switch (length % 4) {\n      case 3: output[offset + i + 2] = source[i + 2] ^ mask[2];\n      case 2: output[offset + i + 1] = source[i + 1] ^ mask[1];\n      case 1: output[offset + i] = source[i] ^ mask[0];\n    }\n  },\n  unmask: function(data, mask) {\n    var maskNum = mask.readUInt32LE(0, true);\n    var length = data.length;\n    var i = 0;\n\n    for (; i < length - 3; i += 4) {\n      var num = maskNum ^ data.readUInt32LE(i, true);\n      if (num < 0) num = 4294967296 + num;\n      data.writeUInt32LE(num, i, true);\n    }\n\n    switch (length % 4) {\n      case 3: data[i + 2] = data[i + 2] ^ mask[2];\n      case 2: data[i + 1] = data[i + 1] ^ mask[1];\n      case 1: data[i] = data[i] ^ mask[0];\n    }\n  }\n};\n\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\ntry {\n  module.exports = __webpack_require__(15)('bufferutil');\n} catch (e) {\n  module.exports = __webpack_require__(31);\n}\n\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports) {\n\n/**\n * Secure random string generator with custom alphabet.\n *\n * Alphabet must contain 256 symbols or less. Otherwise, the generator\n * will not be secure.\n *\n * @param {generator} random The random bytes generator.\n * @param {string} alphabet Symbols to be used in new random string.\n * @param {size} size The number of symbols in new random string.\n *\n * @return {string} Random string.\n *\n * @example\n * const format = require('nanoid/format')\n *\n * function random (size) {\n *   const result = []\n *   for (let i = 0; i < size; i++) {\n *     result.push(randomByte())\n *   }\n *   return result\n * }\n *\n * format(random, \"abcdef\", 5) //=> \"fbaef\"\n *\n * @name format\n * @function\n */\nmodule.exports = function (random, alphabet, size) {\n  var mask = (2 << Math.log(alphabet.length - 1) / Math.LN2) - 1\n  var step = Math.ceil(1.6 * mask * size / alphabet.length)\n\n  var id = ''\n  while (true) {\n    var bytes = random(step)\n    for (var i = 0; i < step; i++) {\n      var byte = bytes[i] & mask\n      if (alphabet[byte]) {\n        id += alphabet[byte]\n        if (id.length === size) return id\n      }\n    }\n  }\n}\n\n/**\n * @callback generator\n * @param {number} bytes The number of bytes to generate.\n * @return {number[]} Random bytes.\n */\n\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar crypto = __webpack_require__(12)\n\nif (crypto.randomFillSync) {\n  module.exports = function (bytes) {\n    return crypto.randomFillSync(Buffer.allocUnsafe(bytes))\n  }\n} else {\n  module.exports = crypto.randomBytes\n}\n\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar generate = __webpack_require__(36);\nvar alphabet = __webpack_require__(4);\n\n// Ignore all milliseconds before a certain time to reduce the size of the date entropy without sacrificing uniqueness.\n// This number should be updated every year or so to keep the generated id short.\n// To regenerate `new Date() - 0` and bump the version. Always bump the version!\nvar REDUCE_TIME = 1459707606518;\n\n// don't change unless we change the algos or REDUCE_TIME\n// must be an integer and less than 16\nvar version = 6;\n\n// Counter is used when shortid is called multiple times in one second.\nvar counter;\n\n// Remember the last time shortid was called in case counter is needed.\nvar previousSeconds;\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction build(clusterWorkerId) {\n    var str = '';\n\n    var seconds = Math.floor((Date.now() - REDUCE_TIME) * 0.001);\n\n    if (seconds === previousSeconds) {\n        counter++;\n    } else {\n        counter = 0;\n        previousSeconds = seconds;\n    }\n\n    str = str + generate(version);\n    str = str + generate(clusterWorkerId);\n    if (counter > 0) {\n        str = str + generate(counter);\n    }\n    str = str + generate(seconds);\n    return str;\n}\n\nmodule.exports = build;\n\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar alphabet = __webpack_require__(4);\nvar random = __webpack_require__(39);\nvar format = __webpack_require__(33);\n\nfunction generate(number) {\n    var loopCounter = 0;\n    var done;\n\n    var str = '';\n\n    while (!done) {\n        str = str + format(random, alphabet.get(), 1);\n        done = number < (Math.pow(16, loopCounter + 1 ) );\n        loopCounter++;\n    }\n    return str;\n}\n\nmodule.exports = generate;\n\n\n/***/ }),\n/* 37 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar alphabet = __webpack_require__(4);\nvar build = __webpack_require__(35);\nvar isValid = __webpack_require__(38);\n\n// if you are using cluster or multiple servers use this to make each instance\n// has a unique value for worker\n// Note: I don't know if this is automatically set when using third\n// party cluster solutions such as pm2.\nvar clusterWorkerId = __webpack_require__(41) || 0;\n\n/**\n * Set the seed.\n * Highly recommended if you don't want people to try to figure out your id schema.\n * exposed as shortid.seed(int)\n * @param seed Integer value to seed the random alphabet.  ALWAYS USE THE SAME SEED or you might get overlaps.\n */\nfunction seed(seedValue) {\n    alphabet.seed(seedValue);\n    return module.exports;\n}\n\n/**\n * Set the cluster worker or machine id\n * exposed as shortid.worker(int)\n * @param workerId worker must be positive integer.  Number less than 16 is recommended.\n * returns shortid module so it can be chained.\n */\nfunction worker(workerId) {\n    clusterWorkerId = workerId;\n    return module.exports;\n}\n\n/**\n *\n * sets new characters to use in the alphabet\n * returns the shuffled alphabet\n */\nfunction characters(newCharacters) {\n    if (newCharacters !== undefined) {\n        alphabet.characters(newCharacters);\n    }\n\n    return alphabet.shuffled();\n}\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction generate() {\n  return build(clusterWorkerId);\n}\n\n// Export all other functions as properties of the generate function\nmodule.exports = generate;\nmodule.exports.generate = generate;\nmodule.exports.seed = seed;\nmodule.exports.worker = worker;\nmodule.exports.characters = characters;\nmodule.exports.isValid = isValid;\n\n\n/***/ }),\n/* 38 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar alphabet = __webpack_require__(4);\n\nfunction isShortId(id) {\n    if (!id || typeof id !== 'string' || id.length < 6 ) {\n        return false;\n    }\n\n    var nonAlphabetic = new RegExp('[^' +\n      alphabet.get().replace(/[|\\\\{}()[\\]^$+*?.-]/g, '\\\\$&') +\n    ']');\n    return !nonAlphabetic.test(id);\n}\n\nmodule.exports = isShortId;\n\n\n/***/ }),\n/* 39 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(34);\n\n\n/***/ }),\n/* 40 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n// Found this seed-based random generator somewhere\n// Based on The Central Randomizer 1.3 (C) 1997 by Paul Houle (houle@msc.cornell.edu)\n\nvar seed = 1;\n\n/**\n * return a random number based on a seed\n * @param seed\n * @returns {number}\n */\nfunction getNextValue() {\n    seed = (seed * 9301 + 49297) % 233280;\n    return seed/(233280.0);\n}\n\nfunction setSeed(_seed_) {\n    seed = _seed_;\n}\n\nmodule.exports = {\n    nextValue: getNextValue,\n    seed: setSeed\n};\n\n\n/***/ }),\n/* 41 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar cluster = __webpack_require__(114);\n\nvar clusterId = 0;\nif (!cluster.isMaster && cluster.worker) {\n    clusterId = cluster.worker.id;\n}\nmodule.exports = parseInt(__webpack_require__.i({\"NODE_ENV\":\"production\"}).NODE_UNIQUE_ID || clusterId, 10);\n\n\n/***/ }),\n/* 42 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * An auto incrementing id which we can use to create \"unique\" Ultron instances\n * so we can track the event emitters that are added through the Ultron\n * interface.\n *\n * @type {Number}\n * @private\n */\nvar id = 0;\n\n/**\n * Ultron is high-intelligence robot. It gathers intelligence so it can start improving\n * upon his rudimentary design. It will learn from your EventEmitting patterns\n * and exterminate them.\n *\n * @constructor\n * @param {EventEmitter} ee EventEmitter instance we need to wrap.\n * @api public\n */\nfunction Ultron(ee) {\n  if (!(this instanceof Ultron)) return new Ultron(ee);\n\n  this.id = id++;\n  this.ee = ee;\n}\n\n/**\n * Register a new EventListener for the given event.\n *\n * @param {String} event Name of the event.\n * @param {Functon} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @returns {Ultron}\n * @api public\n */\nUltron.prototype.on = function on(event, fn, context) {\n  fn.__ultron = this.id;\n  this.ee.on(event, fn, context);\n\n  return this;\n};\n/**\n * Add an EventListener that's only called once.\n *\n * @param {String} event Name of the event.\n * @param {Function} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @returns {Ultron}\n * @api public\n */\nUltron.prototype.once = function once(event, fn, context) {\n  fn.__ultron = this.id;\n  this.ee.once(event, fn, context);\n\n  return this;\n};\n\n/**\n * Remove the listeners we assigned for the given event.\n *\n * @returns {Ultron}\n * @api public\n */\nUltron.prototype.remove = function remove() {\n  var args = arguments\n    , event;\n\n  //\n  // When no event names are provided we assume that we need to clear all the\n  // events that were assigned through us.\n  //\n  if (args.length === 1 && 'string' === typeof args[0]) {\n    args = args[0].split(/[, ]+/);\n  } else if (!args.length) {\n    args = [];\n\n    for (event in this.ee._events) {\n      if (has.call(this.ee._events, event)) args.push(event);\n    }\n  }\n\n  for (var i = 0; i < args.length; i++) {\n    var listeners = this.ee.listeners(args[i]);\n\n    for (var j = 0; j < listeners.length; j++) {\n      event = listeners[j];\n\n      //\n      // Once listeners have a `listener` property that stores the real listener\n      // in the EventEmitter that ships with Node.js.\n      //\n      if (event.listener) {\n        if (event.listener.__ultron !== this.id) continue;\n        delete event.listener.__ultron;\n      } else {\n        if (event.__ultron !== this.id) continue;\n        delete event.__ultron;\n      }\n\n      this.ee.removeListener(args[i], event);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Destroy the Ultron instance, remove all listeners and release all references.\n *\n * @returns {Boolean}\n * @api public\n */\nUltron.prototype.destroy = function destroy() {\n  if (!this.ee) return false;\n\n  this.remove();\n  this.ee = null;\n\n  return true;\n};\n\n//\n// Expose the module.\n//\nmodule.exports = Ultron;\n\n\n/***/ }),\n/* 43 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * UTF-8 validate: UTF-8 validation for WebSockets.\n * Copyright(c) 2015 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nmodule.exports.Validation = {\n  isValidUTF8: function(buffer) {\n    return true;\n  }\n};\n\n\n/***/ }),\n/* 44 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\ntry {\n  module.exports = __webpack_require__(15)('validation');\n} catch (e) {\n  module.exports = __webpack_require__(43);\n}\n\n\n/***/ }),\n/* 45 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar WS = module.exports = __webpack_require__(22);\n\nWS.Server = __webpack_require__(52);\nWS.Sender = __webpack_require__(21);\nWS.Receiver = __webpack_require__(20);\n\n/**\n * Create a new WebSocket server.\n *\n * @param {Object} options Server options\n * @param {Function} fn Optional connection listener.\n * @returns {WS.Server}\n * @api public\n */\nWS.createServer = function createServer(options, fn) {\n  var server = new WS.Server(options);\n\n  if (typeof fn === 'function') {\n    server.on('connection', fn);\n  }\n\n  return server;\n};\n\n/**\n * Create a new WebSocket connection.\n *\n * @param {String} address The URL/address we need to connect to.\n * @param {Function} fn Open listener.\n * @returns {WS}\n * @api public\n */\nWS.connect = WS.createConnection = function connect(address, fn) {\n  var client = new WS(address);\n\n  if (typeof fn === 'function') {\n    client.on('open', fn);\n  }\n\n  return client;\n};\n\n\n/***/ }),\n/* 46 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar util = __webpack_require__(3);\n\nfunction BufferPool(initialSize, growStrategy, shrinkStrategy) {\n  if (typeof initialSize === 'function') {\n    shrinkStrategy = growStrategy;\n    growStrategy = initialSize;\n    initialSize = 0;\n  }\n  else if (typeof initialSize === 'undefined') {\n    initialSize = 0;\n  }\n  this._growStrategy = (growStrategy || function(db, size) {\n    return db.used + size;\n  }).bind(null, this);\n  this._shrinkStrategy = (shrinkStrategy || function(db) {\n    return initialSize;\n  }).bind(null, this);\n  this._buffer = initialSize ? new Buffer(initialSize) : null;\n  this._offset = 0;\n  this._used = 0;\n  this._changeFactor = 0;\n  this.__defineGetter__('size', function(){\n    return this._buffer == null ? 0 : this._buffer.length;\n  });\n  this.__defineGetter__('used', function(){\n    return this._used;\n  });\n}\n\nBufferPool.prototype.get = function(length) {\n  if (this._buffer == null || this._offset + length > this._buffer.length) {\n    var newBuf = new Buffer(this._growStrategy(length));\n    this._buffer = newBuf;\n    this._offset = 0;\n  }\n  this._used += length;\n  var buf = this._buffer.slice(this._offset, this._offset + length);\n  this._offset += length;\n  return buf;\n}\n\nBufferPool.prototype.reset = function(forceNewBuffer) {\n  var len = this._shrinkStrategy();\n  if (len < this.size) this._changeFactor -= 1;\n  if (forceNewBuffer || this._changeFactor < -2) {\n    this._changeFactor = 0;\n    this._buffer = len ? new Buffer(len) : null;\n  }\n  this._offset = 0;\n  this._used = 0;\n}\n\nmodule.exports = BufferPool;\n\n\n/***/ }),\n/* 47 */\n/***/ (function(module, exports) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nmodule.exports.BufferUtil = {\n  merge: function(mergedBuffer, buffers) {\n    var offset = 0;\n    for (var i = 0, l = buffers.length; i < l; ++i) {\n      var buf = buffers[i];\n      buf.copy(mergedBuffer, offset);\n      offset += buf.length;\n    }\n  },\n  mask: function(source, mask, output, offset, length) {\n    var maskNum = mask.readUInt32LE(0, true);\n    var i = 0;\n    for (; i < length - 3; i += 4) {\n      var num = maskNum ^ source.readUInt32LE(i, true);\n      if (num < 0) num = 4294967296 + num;\n      output.writeUInt32LE(num, offset + i, true);\n    }\n    switch (length % 4) {\n      case 3: output[offset + i + 2] = source[i + 2] ^ mask[2];\n      case 2: output[offset + i + 1] = source[i + 1] ^ mask[1];\n      case 1: output[offset + i] = source[i] ^ mask[0];\n      case 0:;\n    }\n  },\n  unmask: function(data, mask) {\n    var maskNum = mask.readUInt32LE(0, true);\n    var length = data.length;\n    var i = 0;\n    for (; i < length - 3; i += 4) {\n      var num = maskNum ^ data.readUInt32LE(i, true);\n      if (num < 0) num = 4294967296 + num;\n      data.writeUInt32LE(num, i, true);\n    }\n    switch (length % 4) {\n      case 3: data[i + 2] = data[i + 2] ^ mask[2];\n      case 2: data[i + 1] = data[i + 1] ^ mask[1];\n      case 1: data[i] = data[i] ^ mask[0];\n      case 0:;\n    }\n  }\n}\n\n\n/***/ }),\n/* 48 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar util = __webpack_require__(3);\n\n/**\n * State constants\n */\n\nvar EMPTY = 0\n  , BODY = 1;\nvar BINARYLENGTH = 2\n  , BINARYBODY = 3;\n\n/**\n * Hixie Receiver implementation\n */\n\nfunction Receiver () {\n  this.state = EMPTY;\n  this.buffers = [];\n  this.messageEnd = -1;\n  this.spanLength = 0;\n  this.dead = false;\n\n  this.onerror = function() {};\n  this.ontext = function() {};\n  this.onbinary = function() {};\n  this.onclose = function() {};\n  this.onping = function() {};\n  this.onpong = function() {};\n}\n\nmodule.exports = Receiver;\n\n/**\n * Add new data to the parser.\n *\n * @api public\n */\n\nReceiver.prototype.add = function(data) {\n  var self = this;\n  function doAdd() {\n    if (self.state === EMPTY) {\n      if (data.length == 2 && data[0] == 0xFF && data[1] == 0x00) {\n        self.reset();\n        self.onclose();\n        return;\n      }\n      if (data[0] === 0x80) {\n        self.messageEnd = 0;\n        self.state = BINARYLENGTH;\n        data = data.slice(1);\n      } else {\n\n      if (data[0] !== 0x00) {\n        self.error('payload must start with 0x00 byte', true);\n        return;\n      }\n      data = data.slice(1);\n      self.state = BODY;\n\n      }\n    }\n    if (self.state === BINARYLENGTH) {\n      var i = 0;\n      while ((i < data.length) && (data[i] & 0x80)) {\n        self.messageEnd = 128 * self.messageEnd + (data[i] & 0x7f);\n        ++i;\n      }\n      if (i < data.length) {\n        self.messageEnd = 128 * self.messageEnd + (data[i] & 0x7f);\n        self.state = BINARYBODY;\n        ++i;\n      }\n      if (i > 0)\n        data = data.slice(i);\n    }\n    if (self.state === BINARYBODY) {\n      var dataleft = self.messageEnd - self.spanLength;\n      if (data.length >= dataleft) {\n        // consume the whole buffer to finish the frame\n        self.buffers.push(data);\n        self.spanLength += dataleft;\n        self.messageEnd = dataleft;\n        return self.parse();\n      }\n      // frame's not done even if we consume it all\n      self.buffers.push(data);\n      self.spanLength += data.length;\n      return;\n    }\n    self.buffers.push(data);\n    if ((self.messageEnd = bufferIndex(data, 0xFF)) != -1) {\n      self.spanLength += self.messageEnd;\n      return self.parse();\n    }\n    else self.spanLength += data.length;\n  }\n  while(data) data = doAdd();\n};\n\n/**\n * Releases all resources used by the receiver.\n *\n * @api public\n */\n\nReceiver.prototype.cleanup = function() {\n  this.dead = true;\n  this.state = EMPTY;\n  this.buffers = [];\n};\n\n/**\n * Process buffered data.\n *\n * @api public\n */\n\nReceiver.prototype.parse = function() {\n  var output = new Buffer(this.spanLength);\n  var outputIndex = 0;\n  for (var bi = 0, bl = this.buffers.length; bi < bl - 1; ++bi) {\n    var buffer = this.buffers[bi];\n    buffer.copy(output, outputIndex);\n    outputIndex += buffer.length;\n  }\n  var lastBuffer = this.buffers[this.buffers.length - 1];\n  if (this.messageEnd > 0) lastBuffer.copy(output, outputIndex, 0, this.messageEnd);\n  if (this.state !== BODY) --this.messageEnd;\n  var tail = null;\n  if (this.messageEnd < lastBuffer.length - 1) {\n    tail = lastBuffer.slice(this.messageEnd + 1);\n  }\n  this.reset();\n  this.ontext(output.toString('utf8'));\n  return tail;\n};\n\n/**\n * Handles an error\n *\n * @api private\n */\n\nReceiver.prototype.error = function (reason, terminate) {\n  this.reset();\n  this.onerror(reason, terminate);\n  return this;\n};\n\n/**\n * Reset parser state\n *\n * @api private\n */\n\nReceiver.prototype.reset = function (reason) {\n  if (this.dead) return;\n  this.state = EMPTY;\n  this.buffers = [];\n  this.messageEnd = -1;\n  this.spanLength = 0;\n};\n\n/**\n * Internal api\n */\n\nfunction bufferIndex(buffer, byte) {\n  for (var i = 0, l = buffer.length; i < l; ++i) {\n    if (buffer[i] === byte) return i;\n  }\n  return -1;\n}\n\n\n/***/ }),\n/* 49 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar events = __webpack_require__(6)\n  , util = __webpack_require__(3)\n  , EventEmitter = events.EventEmitter;\n\n/**\n * Hixie Sender implementation\n */\n\nfunction Sender(socket) {\n  events.EventEmitter.call(this);\n\n  this.socket = socket;\n  this.continuationFrame = false;\n  this.isClosed = false;\n}\n\nmodule.exports = Sender;\n\n/**\n * Inherits from EventEmitter.\n */\n\nutil.inherits(Sender, events.EventEmitter);\n\n/**\n * Frames and writes data.\n *\n * @api public\n */\n\nSender.prototype.send = function(data, options, cb) {\n  if (this.isClosed) return;\n\n  var isString = typeof data == 'string'\n    , length = isString ? Buffer.byteLength(data) : data.length\n    , lengthbytes = (length > 127) ? 2 : 1 // assume less than 2**14 bytes\n    , writeStartMarker = this.continuationFrame == false\n    , writeEndMarker = !options || !(typeof options.fin != 'undefined' && !options.fin)\n    , buffer = new Buffer((writeStartMarker ? ((options && options.binary) ? (1 + lengthbytes) : 1) : 0) + length + ((writeEndMarker && !(options && options.binary)) ? 1 : 0))\n    , offset = writeStartMarker ? 1 : 0;\n\n  if (writeStartMarker) {\n    if (options && options.binary) {\n      buffer.write('\\x80', 'binary');\n      // assume length less than 2**14 bytes\n      if (lengthbytes > 1)\n        buffer.write(String.fromCharCode(128+length/128), offset++, 'binary');\n      buffer.write(String.fromCharCode(length&0x7f), offset++, 'binary');\n    } else\n      buffer.write('\\x00', 'binary');\n  }\n\n  if (isString) buffer.write(data, offset, 'utf8');\n  else data.copy(buffer, offset, 0);\n\n  if (writeEndMarker) {\n    if (options && options.binary) {\n      // sending binary, not writing end marker\n    } else\n      buffer.write('\\xff', offset + length, 'binary');\n    this.continuationFrame = false;\n  }\n  else this.continuationFrame = true;\n\n  try {\n    this.socket.write(buffer, 'binary', cb);\n  } catch (e) {\n    this.error(e.toString());\n  }\n};\n\n/**\n * Sends a close instruction to the remote party.\n *\n * @api public\n */\n\nSender.prototype.close = function(code, data, mask, cb) {\n  if (this.isClosed) return;\n  this.isClosed = true;\n  try {\n    if (this.continuationFrame) this.socket.write(new Buffer([0xff], 'binary'));\n    this.socket.write(new Buffer([0xff, 0x00]), 'binary', cb);\n  } catch (e) {\n    this.error(e.toString());\n  }\n};\n\n/**\n * Sends a ping message to the remote party. Not available for hixie.\n *\n * @api public\n */\n\nSender.prototype.ping = function(data, options) {};\n\n/**\n * Sends a pong message to the remote party. Not available for hixie.\n *\n * @api public\n */\n\nSender.prototype.pong = function(data, options) {};\n\n/**\n * Handles an error\n *\n * @api private\n */\n\nSender.prototype.error = function (reason) {\n  this.emit('error', reason);\n  return this;\n};\n\n\n/***/ }),\n/* 50 */\n/***/ (function(module, exports) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n \nmodule.exports.Validation = {\n  isValidUTF8: function(buffer) {\n    return true;\n  }\n};\n\n\n\n/***/ }),\n/* 51 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\ntry {\n  module.exports = __webpack_require__(44);\n} catch (e) {\n  module.exports = __webpack_require__(50);\n}\n\n\n/***/ }),\n/* 52 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar util = __webpack_require__(3)\n  , events = __webpack_require__(6)\n  , http = __webpack_require__(28)\n  , crypto = __webpack_require__(12)\n  , Options = __webpack_require__(16)\n  , WebSocket = __webpack_require__(22)\n  , Extensions = __webpack_require__(19)\n  , PerMessageDeflate = __webpack_require__(5)\n  , tls = __webpack_require__(118)\n  , url = __webpack_require__(29);\n\n/**\n * WebSocket Server implementation\n */\n\nfunction WebSocketServer(options, callback) {\n  events.EventEmitter.call(this);\n\n  options = new Options({\n    host: '0.0.0.0',\n    port: null,\n    server: null,\n    verifyClient: null,\n    handleProtocols: null,\n    path: null,\n    noServer: false,\n    disableHixie: false,\n    clientTracking: true,\n    perMessageDeflate: true\n  }).merge(options);\n\n  if (!options.isDefinedAndNonNull('port') && !options.isDefinedAndNonNull('server') && !options.value.noServer) {\n    throw new TypeError('`port` or a `server` must be provided');\n  }\n\n  var self = this;\n\n  if (options.isDefinedAndNonNull('port')) {\n    this._server = http.createServer(function (req, res) {\n      res.writeHead(200, {'Content-Type': 'text/plain'});\n      res.end('Not implemented');\n    });\n    this._server.listen(options.value.port, options.value.host, callback);\n    this._closeServer = function() { if (self._server) self._server.close(); };\n  }\n  else if (options.value.server) {\n    this._server = options.value.server;\n    if (options.value.path) {\n      // take note of the path, to avoid collisions when multiple websocket servers are\n      // listening on the same http server\n      if (this._server._webSocketPaths && options.value.server._webSocketPaths[options.value.path]) {\n        throw new Error('two instances of WebSocketServer cannot listen on the same http server path');\n      }\n      if (typeof this._server._webSocketPaths !== 'object') {\n        this._server._webSocketPaths = {};\n      }\n      this._server._webSocketPaths[options.value.path] = 1;\n    }\n  }\n  if (this._server) this._server.once('listening', function() { self.emit('listening'); });\n\n  if (typeof this._server != 'undefined') {\n    this._server.on('error', function(error) {\n      self.emit('error', error)\n    });\n    this._server.on('upgrade', function(req, socket, upgradeHead) {\n      //copy upgradeHead to avoid retention of large slab buffers used in node core\n      var head = new Buffer(upgradeHead.length);\n      upgradeHead.copy(head);\n\n      self.handleUpgrade(req, socket, head, function(client) {\n        self.emit('connection'+req.url, client);\n        self.emit('connection', client);\n      });\n    });\n  }\n\n  this.options = options.value;\n  this.path = options.value.path;\n  this.clients = [];\n}\n\n/**\n * Inherits from EventEmitter.\n */\n\nutil.inherits(WebSocketServer, events.EventEmitter);\n\n/**\n * Immediately shuts down the connection.\n *\n * @api public\n */\n\nWebSocketServer.prototype.close = function() {\n  // terminate all associated clients\n  var error = null;\n  try {\n    for (var i = 0, l = this.clients.length; i < l; ++i) {\n      this.clients[i].terminate();\n    }\n  }\n  catch (e) {\n    error = e;\n  }\n\n  // remove path descriptor, if any\n  if (this.path && this._server._webSocketPaths) {\n    delete this._server._webSocketPaths[this.path];\n    if (Object.keys(this._server._webSocketPaths).length == 0) {\n      delete this._server._webSocketPaths;\n    }\n  }\n\n  // close the http server if it was internally created\n  try {\n    if (typeof this._closeServer !== 'undefined') {\n      this._closeServer();\n    }\n  }\n  finally {\n    delete this._server;\n  }\n  if (error) throw error;\n}\n\n/**\n * Handle a HTTP Upgrade request.\n *\n * @api public\n */\n\nWebSocketServer.prototype.handleUpgrade = function(req, socket, upgradeHead, cb) {\n  // check for wrong path\n  if (this.options.path) {\n    var u = url.parse(req.url);\n    if (u && u.pathname !== this.options.path) return;\n  }\n\n  if (typeof req.headers.upgrade === 'undefined' || req.headers.upgrade.toLowerCase() !== 'websocket') {\n    abortConnection(socket, 400, 'Bad Request');\n    return;\n  }\n\n  if (req.headers['sec-websocket-key1']) handleHixieUpgrade.apply(this, arguments);\n  else handleHybiUpgrade.apply(this, arguments);\n}\n\nmodule.exports = WebSocketServer;\n\n/**\n * Entirely private apis,\n * which may or may not be bound to a sepcific WebSocket instance.\n */\n\nfunction handleHybiUpgrade(req, socket, upgradeHead, cb) {\n  // handle premature socket errors\n  var errorHandler = function() {\n    try { socket.destroy(); } catch (e) {}\n  }\n  socket.on('error', errorHandler);\n\n  // verify key presence\n  if (!req.headers['sec-websocket-key']) {\n    abortConnection(socket, 400, 'Bad Request');\n    return;\n  }\n\n  // verify version\n  var version = parseInt(req.headers['sec-websocket-version']);\n  if ([8, 13].indexOf(version) === -1) {\n    abortConnection(socket, 400, 'Bad Request');\n    return;\n  }\n\n  // verify protocol\n  var protocols = req.headers['sec-websocket-protocol'];\n\n  // verify client\n  var origin = version < 13 ?\n    req.headers['sec-websocket-origin'] :\n    req.headers['origin'];\n\n  // handle extensions offer\n  var extensionsOffer = Extensions.parse(req.headers['sec-websocket-extensions']);\n\n  // handler to call when the connection sequence completes\n  var self = this;\n  var completeHybiUpgrade2 = function(protocol) {\n\n    // calc key\n    var key = req.headers['sec-websocket-key'];\n    var shasum = crypto.createHash('sha1');\n    shasum.update(key + \"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\");\n    key = shasum.digest('base64');\n\n    var headers = [\n        'HTTP/1.1 101 Switching Protocols'\n      , 'Upgrade: websocket'\n      , 'Connection: Upgrade'\n      , 'Sec-WebSocket-Accept: ' + key\n    ];\n\n    if (typeof protocol != 'undefined') {\n      headers.push('Sec-WebSocket-Protocol: ' + protocol);\n    }\n\n    var extensions = {};\n    try {\n      extensions = acceptExtensions.call(self, extensionsOffer);\n    } catch (err) {\n      abortConnection(socket, 400, 'Bad Request');\n      return;\n    }\n\n    if (Object.keys(extensions).length) {\n      var serverExtensions = {};\n      Object.keys(extensions).forEach(function(token) {\n        serverExtensions[token] = [extensions[token].params]\n      });\n      headers.push('Sec-WebSocket-Extensions: ' + Extensions.format(serverExtensions));\n    }\n\n    // allows external modification/inspection of handshake headers\n    self.emit('headers', headers);\n\n    socket.setTimeout(0);\n    socket.setNoDelay(true);\n    try {\n      socket.write(headers.concat('', '').join('\\r\\n'));\n    }\n    catch (e) {\n      // if the upgrade write fails, shut the connection down hard\n      try { socket.destroy(); } catch (e) {}\n      return;\n    }\n\n    var client = new WebSocket([req, socket, upgradeHead], {\n      protocolVersion: version,\n      protocol: protocol,\n      extensions: extensions\n    });\n\n    if (self.options.clientTracking) {\n      self.clients.push(client);\n      client.on('close', function() {\n        var index = self.clients.indexOf(client);\n        if (index != -1) {\n          self.clients.splice(index, 1);\n        }\n      });\n    }\n\n    // signal upgrade complete\n    socket.removeListener('error', errorHandler);\n    cb(client);\n  }\n\n  // optionally call external protocol selection handler before\n  // calling completeHybiUpgrade2\n  var completeHybiUpgrade1 = function() {\n    // choose from the sub-protocols\n    if (typeof self.options.handleProtocols == 'function') {\n        var protList = (protocols || \"\").split(/, */);\n        var callbackCalled = false;\n        var res = self.options.handleProtocols(protList, function(result, protocol) {\n          callbackCalled = true;\n          if (!result) abortConnection(socket, 401, 'Unauthorized');\n          else completeHybiUpgrade2(protocol);\n        });\n        if (!callbackCalled) {\n            // the handleProtocols handler never called our callback\n            abortConnection(socket, 501, 'Could not process protocols');\n        }\n        return;\n    } else {\n        if (typeof protocols !== 'undefined') {\n            completeHybiUpgrade2(protocols.split(/, */)[0]);\n        }\n        else {\n            completeHybiUpgrade2();\n        }\n    }\n  }\n\n  // optionally call external client verification handler\n  if (typeof this.options.verifyClient == 'function') {\n    var info = {\n      origin: origin,\n      secure: typeof req.connection.authorized !== 'undefined' || typeof req.connection.encrypted !== 'undefined',\n      req: req\n    };\n    if (this.options.verifyClient.length == 2) {\n      this.options.verifyClient(info, function(result, code, name) {\n        if (typeof code === 'undefined') code = 401;\n        if (typeof name === 'undefined') name = http.STATUS_CODES[code];\n\n        if (!result) abortConnection(socket, code, name);\n        else completeHybiUpgrade1();\n      });\n      return;\n    }\n    else if (!this.options.verifyClient(info)) {\n      abortConnection(socket, 401, 'Unauthorized');\n      return;\n    }\n  }\n\n  completeHybiUpgrade1();\n}\n\nfunction handleHixieUpgrade(req, socket, upgradeHead, cb) {\n  // handle premature socket errors\n  var errorHandler = function() {\n    try { socket.destroy(); } catch (e) {}\n  }\n  socket.on('error', errorHandler);\n\n  // bail if options prevent hixie\n  if (this.options.disableHixie) {\n    abortConnection(socket, 401, 'Hixie support disabled');\n    return;\n  }\n\n  // verify key presence\n  if (!req.headers['sec-websocket-key2']) {\n    abortConnection(socket, 400, 'Bad Request');\n    return;\n  }\n\n  var origin = req.headers['origin']\n    , self = this;\n\n  // setup handshake completion to run after client has been verified\n  var onClientVerified = function() {\n    var wshost;\n    if (!req.headers['x-forwarded-host'])\n        wshost = req.headers.host;\n    else\n        wshost = req.headers['x-forwarded-host'];\n    var location = ((req.headers['x-forwarded-proto'] === 'https' || socket.encrypted) ? 'wss' : 'ws') + '://' + wshost + req.url\n      , protocol = req.headers['sec-websocket-protocol'];\n\n    // handshake completion code to run once nonce has been successfully retrieved\n    var completeHandshake = function(nonce, rest) {\n      // calculate key\n      var k1 = req.headers['sec-websocket-key1']\n        , k2 = req.headers['sec-websocket-key2']\n        , md5 = crypto.createHash('md5');\n\n      [k1, k2].forEach(function (k) {\n        var n = parseInt(k.replace(/[^\\d]/g, ''))\n          , spaces = k.replace(/[^ ]/g, '').length;\n        if (spaces === 0 || n % spaces !== 0){\n          abortConnection(socket, 400, 'Bad Request');\n          return;\n        }\n        n /= spaces;\n        md5.update(String.fromCharCode(\n          n >> 24 & 0xFF,\n          n >> 16 & 0xFF,\n          n >> 8  & 0xFF,\n          n       & 0xFF));\n      });\n      md5.update(nonce.toString('binary'));\n\n      var headers = [\n          'HTTP/1.1 101 Switching Protocols'\n        , 'Upgrade: WebSocket'\n        , 'Connection: Upgrade'\n        , 'Sec-WebSocket-Location: ' + location\n      ];\n      if (typeof protocol != 'undefined') headers.push('Sec-WebSocket-Protocol: ' + protocol);\n      if (typeof origin != 'undefined') headers.push('Sec-WebSocket-Origin: ' + origin);\n\n      socket.setTimeout(0);\n      socket.setNoDelay(true);\n      try {\n        // merge header and hash buffer\n        var headerBuffer = new Buffer(headers.concat('', '').join('\\r\\n'));\n        var hashBuffer = new Buffer(md5.digest('binary'), 'binary');\n        var handshakeBuffer = new Buffer(headerBuffer.length + hashBuffer.length);\n        headerBuffer.copy(handshakeBuffer, 0);\n        hashBuffer.copy(handshakeBuffer, headerBuffer.length);\n\n        // do a single write, which - upon success - causes a new client websocket to be setup\n        socket.write(handshakeBuffer, 'binary', function(err) {\n          if (err) return; // do not create client if an error happens\n          var client = new WebSocket([req, socket, rest], {\n            protocolVersion: 'hixie-76',\n            protocol: protocol\n          });\n          if (self.options.clientTracking) {\n            self.clients.push(client);\n            client.on('close', function() {\n              var index = self.clients.indexOf(client);\n              if (index != -1) {\n                self.clients.splice(index, 1);\n              }\n            });\n          }\n\n          // signal upgrade complete\n          socket.removeListener('error', errorHandler);\n          cb(client);\n        });\n      }\n      catch (e) {\n        try { socket.destroy(); } catch (e) {}\n        return;\n      }\n    }\n\n    // retrieve nonce\n    var nonceLength = 8;\n    if (upgradeHead && upgradeHead.length >= nonceLength) {\n      var nonce = upgradeHead.slice(0, nonceLength);\n      var rest = upgradeHead.length > nonceLength ? upgradeHead.slice(nonceLength) : null;\n      completeHandshake.call(self, nonce, rest);\n    }\n    else {\n      // nonce not present in upgradeHead, so we must wait for enough data\n      // data to arrive before continuing\n      var nonce = new Buffer(nonceLength);\n      upgradeHead.copy(nonce, 0);\n      var received = upgradeHead.length;\n      var rest = null;\n      var handler = function (data) {\n        var toRead = Math.min(data.length, nonceLength - received);\n        if (toRead === 0) return;\n        data.copy(nonce, received, 0, toRead);\n        received += toRead;\n        if (received == nonceLength) {\n          socket.removeListener('data', handler);\n          if (toRead < data.length) rest = data.slice(toRead);\n          completeHandshake.call(self, nonce, rest);\n        }\n      }\n      socket.on('data', handler);\n    }\n  }\n\n  // verify client\n  if (typeof this.options.verifyClient == 'function') {\n    var info = {\n      origin: origin,\n      secure: typeof req.connection.authorized !== 'undefined' || typeof req.connection.encrypted !== 'undefined',\n      req: req\n    };\n    if (this.options.verifyClient.length == 2) {\n      var self = this;\n      this.options.verifyClient(info, function(result, code, name) {\n        if (typeof code === 'undefined') code = 401;\n        if (typeof name === 'undefined') name = http.STATUS_CODES[code];\n\n        if (!result) abortConnection(socket, code, name);\n        else onClientVerified.apply(self);\n      });\n      return;\n    }\n    else if (!this.options.verifyClient(info)) {\n      abortConnection(socket, 401, 'Unauthorized');\n      return;\n    }\n  }\n\n  // no client verification required\n  onClientVerified();\n}\n\nfunction acceptExtensions(offer) {\n  var extensions = {};\n  var options = this.options.perMessageDeflate;\n  if (options && offer[PerMessageDeflate.extensionName]) {\n    var perMessageDeflate = new PerMessageDeflate(options !== true ? options : {}, true);\n    perMessageDeflate.accept(offer[PerMessageDeflate.extensionName]);\n    extensions[PerMessageDeflate.extensionName] = perMessageDeflate;\n  }\n  return extensions;\n}\n\nfunction abortConnection(socket, code, name) {\n  try {\n    var response = [\n      'HTTP/1.1 ' + code + ' ' + name,\n      'Content-type: text/html'\n    ];\n    socket.write(response.concat('', '').join('\\r\\n'));\n  }\n  catch (e) { /* ignore errors - we've aborted this connection */ }\n  finally {\n    // ensure that an early aborted connection is shut down completely\n    try { socket.destroy(); } catch (e) {}\n  }\n}\n\n\n/***/ }),\n/* 53 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar client_1 = __webpack_require__(54);\r\nvar server_1 = __webpack_require__(70);\r\nvar AGMImpl = (function () {\r\n    function AGMImpl(protocol, clientRepository, serverRepository, instance, configuration) {\r\n        this.protocol = protocol;\r\n        this.clientRepository = clientRepository;\r\n        this.serverRepository = serverRepository;\r\n        this.instance = instance;\r\n        this.configuration = configuration;\r\n        this.client = new client_1.default(protocol, clientRepository, instance, configuration);\r\n        this.server = new server_1.default(protocol, serverRepository, instance, configuration);\r\n    }\r\n    AGMImpl.prototype.serverRemoved = function (callback) {\r\n        return this.client.serverRemoved(callback);\r\n    };\r\n    AGMImpl.prototype.serverAdded = function (callback) {\r\n        return this.client.serverAdded(callback);\r\n    };\r\n    AGMImpl.prototype.serverMethodRemoved = function (callback) {\r\n        return this.client.serverMethodRemoved(callback);\r\n    };\r\n    AGMImpl.prototype.serverMethodAdded = function (callback) {\r\n        return this.client.serverMethodAdded(callback);\r\n    };\r\n    AGMImpl.prototype.methodRemoved = function (callback) {\r\n        return this.client.methodRemoved(callback);\r\n    };\r\n    AGMImpl.prototype.methodAdded = function (callback) {\r\n        return this.client.methodAdded(callback);\r\n    };\r\n    AGMImpl.prototype.methodsForInstance = function (instance) {\r\n        return this.client.methodsForInstance(instance);\r\n    };\r\n    AGMImpl.prototype.methods = function (methodFilter) {\r\n        return this.client.methods(methodFilter);\r\n    };\r\n    AGMImpl.prototype.servers = function (methodFilter) {\r\n        return this.client.servers(methodFilter);\r\n    };\r\n    AGMImpl.prototype.subscribe = function (method, options, successCallback, errorCallback) {\r\n        return this.client.subscribe(method, options, successCallback, errorCallback);\r\n    };\r\n    AGMImpl.prototype.createStream = function (streamDef, callbacks, successCallback, errorCallback) {\r\n        return this.server.createStream(streamDef, callbacks, successCallback, errorCallback);\r\n    };\r\n    AGMImpl.prototype.unregister = function (methodFilter) {\r\n        return this.server.unregister(methodFilter);\r\n    };\r\n    AGMImpl.prototype.registerAsync = function (methodDefinition, callback) {\r\n        return this.server.registerAsync(methodDefinition, callback);\r\n    };\r\n    AGMImpl.prototype.register = function (methodDefinition, callback) {\r\n        return this.server.register(methodDefinition, callback);\r\n    };\r\n    AGMImpl.prototype.invoke = function (methodFilter, argumentObj, target, additionalOptions, success, error) {\r\n        return this.client.invoke(methodFilter, argumentObj, target, additionalOptions, success, error);\r\n    };\r\n    AGMImpl.prototype.updateInstance = function (newInstance) {\r\n        if (this.instance.machine === undefined) {\r\n            this.instance.machine = newInstance.MachineName || newInstance.machine;\r\n        }\r\n        if (this.instance.user === undefined) {\r\n            this.instance.user = newInstance.UserName || newInstance.user;\r\n        }\r\n        if (this.instance.environment === undefined) {\r\n            this.instance.environment = newInstance.Environment || newInstance.environment;\r\n        }\r\n        if (this.instance.region === undefined) {\r\n            this.instance.region = newInstance.Region || newInstance.region;\r\n        }\r\n    };\r\n    return AGMImpl;\r\n}());\r\nexports.default = AGMImpl;\r\n//# sourceMappingURL=agm.js.map\n\n/***/ }),\n/* 54 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar invoke_1 = __webpack_require__(55);\r\nvar promisify_1 = __webpack_require__(8);\r\nvar Client = (function () {\r\n    function Client(protocol, repo, instance, configuration) {\r\n        this.protocol = protocol;\r\n        this.repo = repo;\r\n        this.instance = instance;\r\n        this.configuration = configuration;\r\n        this.clientInvocations = new invoke_1.default(protocol);\r\n    }\r\n    Client.prototype.subscribe = function (method, options, successCallback, errorCallback) {\r\n        var _this = this;\r\n        var callProtocolSubscribe = function (targetServers, stream, successProxy, errorProxy) {\r\n            _this.protocol.client.subscribe(stream, options.arguments, targetServers, { methodResponseTimeout: options.waitTimeoutMs }, successProxy, errorProxy);\r\n        };\r\n        var promise = new Promise(function (resolve, reject) {\r\n            var successProxy = function (sub) {\r\n                resolve(sub);\r\n            };\r\n            var errorProxy = function (err) {\r\n                reject(err);\r\n            };\r\n            var methodDef;\r\n            if (typeof method === \"string\") {\r\n                methodDef = { name: method };\r\n            }\r\n            else {\r\n                methodDef = method;\r\n            }\r\n            if (options === undefined) {\r\n                options = {};\r\n            }\r\n            var target = options.target;\r\n            if (target === undefined) {\r\n                target = \"best\";\r\n            }\r\n            if (typeof target === \"string\" && target !== \"all\" && target !== \"best\") {\r\n                reject({ message: '\"' + target + '\" is not a valid target. Valid targets are \"all\", \"best\", or an instance.' });\r\n            }\r\n            if (options.methodResponseTimeout === undefined) {\r\n                options.methodResponseTimeout = options.method_response_timeout;\r\n                if (options.methodResponseTimeout === undefined) {\r\n                    options.methodResponseTimeout = _this.configuration.methodResponseTimeout;\r\n                }\r\n            }\r\n            if (options.waitTimeoutMs === undefined) {\r\n                options.waitTimeoutMs = options.wait_for_method_timeout;\r\n                if (options.waitTimeoutMs === undefined) {\r\n                    options.waitTimeoutMs = _this.configuration.waitTimeoutMs;\r\n                }\r\n            }\r\n            var delayStep = 500;\r\n            var delayTillNow = 0;\r\n            var currentServers = _this.getServerMethodsByFilterAndTarget(methodDef, target);\r\n            if (currentServers.length > 0) {\r\n                callProtocolSubscribe(currentServers, currentServers[0].methods[0], successProxy, errorProxy);\r\n            }\r\n            else {\r\n                var retry_1 = function () {\r\n                    delayTillNow += delayStep;\r\n                    currentServers = _this.getServerMethodsByFilterAndTarget(methodDef, target);\r\n                    if (currentServers.length > 0) {\r\n                        var streamInfo = currentServers[0].methods[0];\r\n                        callProtocolSubscribe(currentServers, streamInfo, successProxy, errorProxy);\r\n                    }\r\n                    else if (delayTillNow >= options.waitTimeoutMs) {\r\n                        var def = typeof method === \"string\" ? { name: method } : method;\r\n                        var info = {\r\n                            id: undefined,\r\n                            info: def,\r\n                            getInfoForUser: function () {\r\n                                return methodDef;\r\n                            },\r\n                            protocolState: undefined,\r\n                        };\r\n                        callProtocolSubscribe(currentServers, info, successProxy, errorProxy);\r\n                    }\r\n                    else {\r\n                        setTimeout(retry_1, delayStep);\r\n                    }\r\n                };\r\n                setTimeout(retry_1, delayStep);\r\n            }\r\n        });\r\n        return promisify_1.default(promise, successCallback, errorCallback);\r\n    };\r\n    Client.prototype.servers = function (methodFilter) {\r\n        return this.getServers(methodFilter).map(function (serverMethodMap) {\r\n            return serverMethodMap.server.getInfoForUser();\r\n        });\r\n    };\r\n    Client.prototype.methods = function (methodFilter) {\r\n        return this.getMethods(methodFilter).map(function (m) {\r\n            return m.getInfoForUser();\r\n        });\r\n    };\r\n    Client.prototype.methodsForInstance = function (instance) {\r\n        return this.getMethodsForInstance(instance).map(function (m) {\r\n            return m.getInfoForUser();\r\n        });\r\n    };\r\n    Client.prototype.methodAdded = function (callback) {\r\n        return this.repo.onMethodAdded(function (method) {\r\n            callback(method.getInfoForUser());\r\n        });\r\n    };\r\n    Client.prototype.methodRemoved = function (callback) {\r\n        return this.repo.onMethodRemoved(function (method) {\r\n            callback(method.getInfoForUser());\r\n        });\r\n    };\r\n    Client.prototype.serverAdded = function (callback) {\r\n        return this.repo.onServerAdded(function (server) {\r\n            callback(server.getInfoForUser());\r\n        });\r\n    };\r\n    Client.prototype.serverRemoved = function (callback) {\r\n        return this.repo.onServerRemoved(function (server, reason) {\r\n            callback(server.getInfoForUser(), reason);\r\n        });\r\n    };\r\n    Client.prototype.serverMethodAdded = function (callback) {\r\n        return this.repo.onServerMethodAdded(function (server, method) {\r\n            callback({ server: server.getInfoForUser(), method: method.getInfoForUser() });\r\n        });\r\n    };\r\n    Client.prototype.serverMethodRemoved = function (callback) {\r\n        return this.repo.onServerMethodRemoved(function (server, method) {\r\n            callback({ server: server.getInfoForUser(), method: method.getInfoForUser() });\r\n        });\r\n    };\r\n    Client.prototype.invoke = function (methodFilter, argumentObj, target, additionalOptions, success, error) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            var successProxy = function (args) {\r\n                resolve(args);\r\n            };\r\n            var errorProxy = function (err) {\r\n                reject(err);\r\n            };\r\n            if (!argumentObj) {\r\n                argumentObj = {};\r\n            }\r\n            if (!target) {\r\n                target = \"best\";\r\n            }\r\n            if (typeof target === \"string\" && target !== \"all\" && target !== \"best\") {\r\n                reject({ message: '\"' + target + '\" is not a valid target. Valid targets are \"all\" and \"best\".' });\r\n            }\r\n            if (!additionalOptions) {\r\n                additionalOptions = {};\r\n            }\r\n            if (additionalOptions.methodResponseTimeoutMs === undefined) {\r\n                additionalOptions.methodResponseTimeoutMs = additionalOptions.method_response_timeout;\r\n                if (additionalOptions.methodResponseTimeoutMs === undefined) {\r\n                    additionalOptions.methodResponseTimeoutMs = _this.configuration.methodResponseTimeout;\r\n                }\r\n            }\r\n            if (additionalOptions.waitTimeoutMs === undefined) {\r\n                additionalOptions.waitTimeoutMs = additionalOptions.wait_for_method_timeout;\r\n                if (additionalOptions.waitTimeoutMs === undefined) {\r\n                    additionalOptions.waitTimeoutMs = _this.configuration.waitTimeoutMs;\r\n                }\r\n            }\r\n            if (additionalOptions.waitTimeoutMs !== undefined && typeof additionalOptions.waitTimeoutMs !== \"number\") {\r\n                reject({ message: '\"' + additionalOptions.waitTimeoutMs + '\" is not a valid number for \\'waitTimeoutMs\\'' });\r\n                return;\r\n            }\r\n            if (typeof argumentObj !== \"object\") {\r\n                reject({ message: \"The method arguments must be an object.\" });\r\n                return;\r\n            }\r\n            if (typeof methodFilter === \"string\") {\r\n                methodFilter = { name: methodFilter };\r\n            }\r\n            var serversMethodMap = _this.getServerMethodsByFilterAndTarget(methodFilter, target);\r\n            if (serversMethodMap.length === 0) {\r\n                _this.invokeUnExisting(methodFilter, argumentObj, target, additionalOptions, successProxy, errorProxy);\r\n            }\r\n            else if (serversMethodMap.length === 1) {\r\n                var serverMethodPair = serversMethodMap[0];\r\n                _this.clientInvocations.invoke(serverMethodPair.methods[0], argumentObj, serverMethodPair.server, additionalOptions, successProxy, errorProxy);\r\n            }\r\n            else {\r\n                _this.invokeOnAll(serversMethodMap, argumentObj, additionalOptions, successProxy, errorProxy);\r\n            }\r\n        });\r\n        return promisify_1.default(promise, success, error);\r\n    };\r\n    Client.prototype.invokeUnExisting = function (methodFilter, argumentObj, target, additionalOptions, success, error) {\r\n        var _this = this;\r\n        var callError = function () {\r\n            error({\r\n                method: methodFilter,\r\n                called_with: argumentObj,\r\n                message: \"Can not find a method matching \" + JSON.stringify(methodFilter) + \" with server filter \" + JSON.stringify(target),\r\n                executed_by: undefined,\r\n                returned: undefined,\r\n                status: undefined,\r\n            });\r\n        };\r\n        if (additionalOptions.waitTimeoutMs === 0) {\r\n            callError();\r\n        }\r\n        else {\r\n            var delayStep_1 = 500;\r\n            var delayTillNow_1 = 0;\r\n            var retry_2 = function () {\r\n                delayTillNow_1 += delayStep_1;\r\n                var serversMethodMap = _this.getServerMethodsByFilterAndTarget(methodFilter, target);\r\n                if (serversMethodMap.length > 0) {\r\n                    _this.invoke(methodFilter, argumentObj, target, additionalOptions, success, error);\r\n                }\r\n                else if (delayTillNow_1 >= additionalOptions.waitTimeoutMs) {\r\n                    callError();\r\n                }\r\n                else {\r\n                    setTimeout(retry_2, delayStep_1);\r\n                }\r\n            };\r\n            setTimeout(retry_2, delayStep_1);\r\n        }\r\n    };\r\n    Client.prototype.invokeOnAll = function (serverMethodsMap, argumentObj, additionalOptions, success, error) {\r\n        var _this = this;\r\n        var successes = [];\r\n        var errors = [];\r\n        var successCallback = function (result) {\r\n            successes.push(result);\r\n            sendResponse();\r\n        };\r\n        var errorCallback = function (err) {\r\n            errors.push(err);\r\n            sendResponse();\r\n        };\r\n        var sendResponse = function () {\r\n            if (successes.length + errors.length < serverMethodsMap.length) {\r\n                return;\r\n            }\r\n            if (successes.length !== 0) {\r\n                var result_1 = successes.reduce(function (obj, invResult) {\r\n                    obj.method = invResult.method;\r\n                    obj.called_with = invResult.called_with;\r\n                    obj.returned = invResult.returned;\r\n                    obj.all_return_values.push({\r\n                        executed_by: invResult.executed_by,\r\n                        returned: invResult.returned,\r\n                        called_with: invResult.called_with,\r\n                        method: invResult.method,\r\n                        message: undefined,\r\n                        status: undefined,\r\n                    });\r\n                    obj.executed_by = invResult.executed_by;\r\n                    return obj;\r\n                }, { all_return_values: [] });\r\n                if (errors.length !== 0) {\r\n                    result_1.all_errors = [];\r\n                    errors.forEach(function (obj) {\r\n                        result_1.all_errors.push({\r\n                            name: obj.method.name,\r\n                            message: obj.message,\r\n                        });\r\n                    });\r\n                }\r\n                success(result_1);\r\n            }\r\n            else if (errors.length !== 0) {\r\n                error(errors.reduce(function (obj, currentError) {\r\n                    obj.method = currentError.method;\r\n                    obj.called_with = currentError.called_with;\r\n                    obj.message = currentError.message;\r\n                    obj.all_errors.push({\r\n                        executed_by: currentError.executed_by,\r\n                        message: currentError.message,\r\n                    });\r\n                    return obj;\r\n                }, { all_errors: [] }));\r\n            }\r\n        };\r\n        serverMethodsMap.forEach(function (serverMethodsPair) {\r\n            _this.clientInvocations.invoke(serverMethodsPair.methods[0], argumentObj, serverMethodsPair.server, additionalOptions, successCallback, errorCallback);\r\n        });\r\n    };\r\n    Client.prototype.filterByTarget = function (target, serverMethodMap) {\r\n        var _this = this;\r\n        var targetServerMethod = [];\r\n        if (typeof target === \"string\") {\r\n            if (target === \"all\") {\r\n                targetServerMethod = serverMethodMap;\r\n            }\r\n            else if (target === \"best\") {\r\n                var matchingMachine = serverMethodMap.filter(function (serverMethodPair) {\r\n                    var serverInfo = serverMethodPair.server.info;\r\n                    return serverInfo.machine === _this.instance.machine;\r\n                })[0];\r\n                if (matchingMachine) {\r\n                    return [matchingMachine];\r\n                }\r\n                targetServerMethod = serverMethodMap[0] !== undefined ? [serverMethodMap[0]] : [];\r\n            }\r\n        }\r\n        else {\r\n            if (!Array.isArray(target)) {\r\n                target = [target];\r\n            }\r\n            if (Array.isArray(target)) {\r\n                targetServerMethod = target.reduce(function (matches, filter) {\r\n                    var myMatches = serverMethodMap.filter(function (serverMethodPair) {\r\n                        return _this.instanceMatch(filter, serverMethodPair.server.info);\r\n                    });\r\n                    return matches.concat(myMatches);\r\n                }, []);\r\n            }\r\n        }\r\n        return targetServerMethod;\r\n    };\r\n    Client.prototype.instanceMatch = function (instanceFilter, instanceDefinition) {\r\n        return this.containsProps(instanceFilter, instanceDefinition);\r\n    };\r\n    Client.prototype.methodMatch = function (methodFilter, methodDefinition) {\r\n        return this.containsProps(methodFilter, methodDefinition);\r\n    };\r\n    Client.prototype.containsProps = function (filter, object) {\r\n        return Object.keys(filter).reduce(function (match, prop) {\r\n            if (!filter[prop] || typeof filter[prop] === \"function\") {\r\n                return match;\r\n            }\r\n            if (filter[prop].constructor === RegExp) {\r\n                if (!filter[prop].test(object[prop])) {\r\n                    return false;\r\n                }\r\n                else {\r\n                    return match;\r\n                }\r\n            }\r\n            else {\r\n                if (String(filter[prop]).toLowerCase() !== String(object[prop]).toLowerCase()) {\r\n                    return false;\r\n                }\r\n                else {\r\n                    return match;\r\n                }\r\n            }\r\n        }, true);\r\n    };\r\n    Client.prototype.getMethods = function (methodFilter) {\r\n        var _this = this;\r\n        if (methodFilter === undefined) {\r\n            return this.repo.getMethods();\r\n        }\r\n        if (typeof methodFilter === \"string\") {\r\n            methodFilter = { name: methodFilter };\r\n        }\r\n        return this.repo.getMethods().filter(function (method) {\r\n            return _this.methodMatch(methodFilter, method.info);\r\n        });\r\n    };\r\n    Client.prototype.getMethodsForInstance = function (instanceFilter) {\r\n        var _this = this;\r\n        var allServers = this.repo.getServers();\r\n        var matchingServers = allServers.filter(function (server) {\r\n            return _this.instanceMatch(instanceFilter, server.info);\r\n        });\r\n        if (matchingServers.length === 0) {\r\n            return [];\r\n        }\r\n        var resultMethodsObject = {};\r\n        if (matchingServers.length === 1) {\r\n            resultMethodsObject = matchingServers[0].methods;\r\n        }\r\n        else {\r\n            matchingServers.forEach(function (server) {\r\n                Object.keys(server.methods).forEach(function (methodKey) {\r\n                    var method = server.methods[methodKey];\r\n                    resultMethodsObject[method.id] = method;\r\n                });\r\n            });\r\n        }\r\n        return Object.keys(resultMethodsObject)\r\n            .map(function (key) {\r\n            return resultMethodsObject[key];\r\n        });\r\n    };\r\n    Client.prototype.getServers = function (methodFilter) {\r\n        var _this = this;\r\n        var servers = this.repo.getServers();\r\n        if (methodFilter === undefined) {\r\n            return servers.map(function (server) {\r\n                return { server: server };\r\n            });\r\n        }\r\n        var methods = this.getMethods(methodFilter);\r\n        if (methods === undefined) {\r\n            return [];\r\n        }\r\n        return servers.reduce(function (prev, current) {\r\n            var methodsForServer = _this.repo.getServerMethodsById(current.id);\r\n            var matchingMethods = methodsForServer.filter(function (method) {\r\n                return _this.methodMatch(methodFilter, method.info);\r\n            });\r\n            if (matchingMethods.length > 0) {\r\n                prev.push({ server: current, methods: matchingMethods });\r\n            }\r\n            return prev;\r\n        }, []);\r\n    };\r\n    Client.prototype.getServerMethodsByFilterAndTarget = function (methodFilter, target) {\r\n        var serversMethodMap = this.getServers(methodFilter);\r\n        return this.filterByTarget(target, serversMethodMap);\r\n    };\r\n    return Client;\r\n}());\r\nexports.default = Client;\r\n//# sourceMappingURL=client.js.map\n\n/***/ }),\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar random_1 = __webpack_require__(23);\r\nvar ClientInvocations = (function () {\r\n    function ClientInvocations(_protocol) {\r\n        var _this = this;\r\n        this._protocol = _protocol;\r\n        this._pendingCallbacks = {};\r\n        _protocol.client.onInvocationResult(function (invocationId, executedBy, status, result, resultMessage) { return _this.processInvocationResult(invocationId, executedBy, status, result, resultMessage); });\r\n    }\r\n    ClientInvocations.prototype.invoke = function (method, argumentsObj, target, stuff, success, error) {\r\n        var invocationId = random_1.default();\r\n        this.registerInvocation(invocationId, {\r\n            method: method,\r\n            calledWith: argumentsObj,\r\n        }, success, error, stuff.methodResponseTimeoutMs);\r\n        this._protocol.client.invoke(invocationId, method, argumentsObj, target, stuff);\r\n    };\r\n    ClientInvocations.prototype.registerInvocation = function (invocationId, invocationInfo, success, error, timeout) {\r\n        var _this = this;\r\n        this._pendingCallbacks[invocationId] = { invocationInfo: invocationInfo, success: success, error: error };\r\n        setTimeout(function () {\r\n            if (_this._pendingCallbacks[invocationId] === undefined) {\r\n                return;\r\n            }\r\n            error({\r\n                method: invocationInfo.method.getInfoForUser(),\r\n                called_with: invocationInfo.calledWith,\r\n                executed_by: undefined,\r\n                status: undefined,\r\n                returned: undefined,\r\n                message: \"Invocation timeout (\" + timeout + \" ms) reached\",\r\n            });\r\n            delete _this._pendingCallbacks[invocationId];\r\n        }, timeout);\r\n    };\r\n    ClientInvocations.prototype.processInvocationResult = function (invocationId, executedBy, status, result, resultMessage) {\r\n        var callback = this._pendingCallbacks[invocationId];\r\n        if (callback === undefined) {\r\n            return;\r\n        }\r\n        if (status === 0 && typeof callback.success === \"function\") {\r\n            callback.success({\r\n                method: callback.invocationInfo.method.getInfoForUser(),\r\n                called_with: callback.invocationInfo.calledWith,\r\n                executed_by: executedBy,\r\n                returned: result,\r\n                message: resultMessage,\r\n                status: status,\r\n            });\r\n        }\r\n        else if (typeof callback.error === \"function\") {\r\n            callback.error({\r\n                method: callback.invocationInfo.method.getInfoForUser(),\r\n                called_with: callback.invocationInfo.calledWith,\r\n                executed_by: executedBy,\r\n                message: resultMessage,\r\n                status: status,\r\n                returned: result,\r\n            });\r\n        }\r\n        delete this._pendingCallbacks[invocationId];\r\n    };\r\n    return ClientInvocations;\r\n}());\r\nexports.default = ClientInvocations;\r\n//# sourceMappingURL=invoke.js.map\n\n/***/ }),\n/* 56 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar ClientRepository = (function () {\r\n    function ClientRepository() {\r\n        this.servers = {};\r\n        this.methodsCount = {};\r\n        this.callbacks = callback_registry_1.default();\r\n    }\r\n    ClientRepository.prototype.addServer = function (info, serverId) {\r\n        var _this = this;\r\n        var current = this.servers[serverId];\r\n        if (current) {\r\n            return current.id;\r\n        }\r\n        var serverEntry = {\r\n            id: serverId,\r\n            info: info,\r\n            methods: {},\r\n            getInfoForUser: function () {\r\n                var serverInfo = _this.createUserServerInfo(serverEntry.info);\r\n                serverInfo.getMethods = function () {\r\n                    return _this.getServerMethodsById(serverEntry.id).map(function (m) {\r\n                        return m.getInfoForUser();\r\n                    });\r\n                };\r\n                serverInfo.getStreams = function () {\r\n                    return _this.getServerMethodsById(serverEntry.id)\r\n                        .filter(function (method) {\r\n                        return method.info.supportsStreaming;\r\n                    })\r\n                        .map(function (m) {\r\n                        return m.getInfoForUser();\r\n                    });\r\n                };\r\n                return serverInfo;\r\n            },\r\n        };\r\n        this.servers[serverId] = serverEntry;\r\n        this.callbacks.execute(\"onServerAdded\", serverEntry);\r\n        return serverId;\r\n    };\r\n    ClientRepository.prototype.removeServerById = function (id, reason) {\r\n        var _this = this;\r\n        var server = this.servers[id];\r\n        Object.keys(server.methods).forEach(function (methodId) {\r\n            _this.removeServerMethod(id, methodId);\r\n        });\r\n        delete this.servers[id];\r\n        this.callbacks.execute(\"onServerRemoved\", server, reason);\r\n    };\r\n    ClientRepository.prototype.addServerMethod = function (serverId, method, protocolState) {\r\n        if (!protocolState) {\r\n            protocolState = {};\r\n        }\r\n        var server = this.servers[serverId];\r\n        if (!server) {\r\n            throw new Error(\"server does not exists\");\r\n        }\r\n        var methodId = this.createMethodId(method);\r\n        if (server.methods[methodId]) {\r\n            return;\r\n        }\r\n        var that = this;\r\n        var methodEntity = {\r\n            id: methodId,\r\n            info: method,\r\n            getInfoForUser: function () {\r\n                var result = that.createUserMethodInfo(methodEntity.info);\r\n                result.getServers = function () {\r\n                    return that.getServersByMethod(methodId);\r\n                };\r\n                return result;\r\n            },\r\n            protocolState: protocolState,\r\n        };\r\n        server.methods[methodId] = methodEntity;\r\n        if (!this.methodsCount[methodId]) {\r\n            this.methodsCount[methodId] = 0;\r\n            this.callbacks.execute(\"onMethodAdded\", methodEntity);\r\n        }\r\n        this.methodsCount[methodId] = this.methodsCount[methodId] + 1;\r\n        this.callbacks.execute(\"onServerMethodAdded\", server, methodEntity);\r\n    };\r\n    ClientRepository.prototype.createMethodId = function (methodInfo) {\r\n        var accepts = methodInfo.accepts !== undefined ? methodInfo.accepts : \"\";\r\n        var returns = methodInfo.returns !== undefined ? methodInfo.returns : \"\";\r\n        return (methodInfo.name + accepts + returns).toLowerCase();\r\n    };\r\n    ClientRepository.prototype.removeServerMethod = function (serverId, methodId) {\r\n        var server = this.servers[serverId];\r\n        if (!server) {\r\n            throw new Error(\"server does not exists\");\r\n        }\r\n        var method = server.methods[methodId];\r\n        delete server.methods[methodId];\r\n        this.methodsCount[methodId] = this.methodsCount[methodId] - 1;\r\n        if (this.methodsCount[methodId] === 0) {\r\n            this.callbacks.execute(\"onMethodRemoved\", method);\r\n        }\r\n        this.callbacks.execute(\"onServerMethodRemoved\", server, method);\r\n    };\r\n    ClientRepository.prototype.getMethods = function () {\r\n        var _this = this;\r\n        var allMethods = {};\r\n        Object.keys(this.servers).forEach(function (serverId) {\r\n            var server = _this.servers[serverId];\r\n            Object.keys(server.methods).forEach(function (methodId) {\r\n                var method = server.methods[methodId];\r\n                allMethods[method.id] = method;\r\n            });\r\n        });\r\n        var methodsAsArray = Object.keys(allMethods).map(function (id) {\r\n            return allMethods[id];\r\n        });\r\n        return methodsAsArray;\r\n    };\r\n    ClientRepository.prototype.getServers = function () {\r\n        var _this = this;\r\n        var allServers = [];\r\n        Object.keys(this.servers).forEach(function (serverId) {\r\n            var server = _this.servers[serverId];\r\n            allServers.push(server);\r\n        });\r\n        return allServers;\r\n    };\r\n    ClientRepository.prototype.getServerMethodsById = function (serverId) {\r\n        var server = this.servers[serverId];\r\n        return Object.keys(server.methods).map(function (id) {\r\n            return server.methods[id];\r\n        });\r\n    };\r\n    ClientRepository.prototype.onServerAdded = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onServerAdded\", callback);\r\n        this.getServers().forEach(function (server) {\r\n            callback(server);\r\n        });\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.onMethodAdded = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onMethodAdded\", callback);\r\n        this.getMethods().forEach(function (method) {\r\n            callback(method);\r\n        });\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.onServerMethodAdded = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onServerMethodAdded\", callback);\r\n        this.getServers().forEach(function (server) {\r\n            var methods = server.methods;\r\n            Object.keys(methods).forEach(function (methodId) {\r\n                callback(server, methods[methodId]);\r\n            });\r\n        });\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.onMethodRemoved = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onMethodRemoved\", callback);\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.onServerRemoved = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onServerRemoved\", callback);\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.onServerMethodRemoved = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onServerMethodRemoved\", callback);\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.getServerById = function (id) {\r\n        return this.servers[id];\r\n    };\r\n    ClientRepository.prototype.reset = function () {\r\n        this.servers = {};\r\n        this.methodsCount = {};\r\n    };\r\n    ClientRepository.prototype.createUserServerInfo = function (serverInfo) {\r\n        return {\r\n            machine: serverInfo.machine,\r\n            pid: serverInfo.pid,\r\n            user: serverInfo.user,\r\n            application: serverInfo.application,\r\n            environment: serverInfo.environment,\r\n            region: serverInfo.region,\r\n            instance: serverInfo.instance,\r\n            windowId: serverInfo.windowId,\r\n            peerId: serverInfo.peerId,\r\n        };\r\n    };\r\n    ClientRepository.prototype.createUserMethodInfo = function (methodInfo) {\r\n        var result = {\r\n            name: methodInfo.name,\r\n            accepts: methodInfo.accepts,\r\n            returns: methodInfo.returns,\r\n            description: methodInfo.description,\r\n            displayName: methodInfo.displayName,\r\n            objectTypes: methodInfo.objectTypes,\r\n            supportsStreaming: methodInfo.supportsStreaming,\r\n        };\r\n        result.object_types = methodInfo.objectTypes;\r\n        result.display_name = methodInfo.objectTypes;\r\n        result.version = methodInfo.objectTypes;\r\n        return result;\r\n    };\r\n    ClientRepository.prototype.getServersByMethod = function (id) {\r\n        var _this = this;\r\n        var allServers = [];\r\n        Object.keys(this.servers).forEach(function (serverId) {\r\n            var server = _this.servers[serverId];\r\n            Object.keys(server.methods).forEach(function (methodId) {\r\n                if (methodId === id) {\r\n                    allServers.push(server.getInfoForUser());\r\n                }\r\n            });\r\n        });\r\n        return allServers;\r\n    };\r\n    return ClientRepository;\r\n}());\r\nexports.default = ClientRepository;\r\n//# sourceMappingURL=repository.js.map\n\n/***/ }),\n/* 57 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar promisify_1 = __webpack_require__(8);\r\nvar NativeAGM = (function () {\r\n    function NativeAGM(instance, helpers, agmFacade) {\r\n        this.instance = instance;\r\n        this.helpers = helpers;\r\n        this.agmFacade = agmFacade;\r\n        this.protocolVersion = this.agmFacade.protocolVersion;\r\n    }\r\n    NativeAGM.prototype.register = function (name, handler) {\r\n        var methodInfoAsObject = this.helpers.stringToObject(name, \"name\");\r\n        this.helpers.validateMethodInfo(methodInfoAsObject);\r\n        if (this.protocolVersion && this.protocolVersion >= 3) {\r\n            this.agmFacade.register(JSON.stringify(methodInfoAsObject), handler, true);\r\n        }\r\n        else {\r\n            this.agmFacade.register(JSON.stringify(methodInfoAsObject), function (arg, caller) {\r\n                var methodResult = handler(JSON.parse(arg), caller);\r\n                return JSON.stringify(methodResult);\r\n            });\r\n        }\r\n    };\r\n    NativeAGM.prototype.registerAsync = function (name, handler) {\r\n        if (!this.agmFacade.registerAsync) {\r\n            throw new Error(\"not supported in that version of HtmlContainer\");\r\n        }\r\n        var methodInfoAsObject = this.helpers.stringToObject(name, \"name\");\r\n        this.helpers.validateMethodInfo(methodInfoAsObject);\r\n        this.agmFacade.registerAsync(methodInfoAsObject, function (args, instance, tracker) {\r\n            handler(args, instance, function (successArgs) {\r\n                tracker.success(successArgs);\r\n            }, function (error) {\r\n                tracker.error(error);\r\n            });\r\n        });\r\n    };\r\n    NativeAGM.prototype.unregister = function (definition) {\r\n        this.agmFacade.unregister(JSON.stringify(this.helpers.stringToObject(definition, \"name\")));\r\n    };\r\n    NativeAGM.prototype.invoke = function (method, argumentObj, target, options, success, error) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (argumentObj === undefined) {\r\n                argumentObj = {};\r\n            }\r\n            if (typeof argumentObj !== \"object\") {\r\n                reject({ message: \"The method arguments must be an object.\" });\r\n            }\r\n            if (options === undefined) {\r\n                options = {};\r\n            }\r\n            target = _this.helpers.targetArgToObject(target);\r\n            if (_this.agmFacade.invoke2) {\r\n                _this.agmFacade.invoke2(JSON.stringify(_this.helpers.stringToObject(method, \"name\")), argumentObj, JSON.stringify(target), JSON.stringify(options), function (a) {\r\n                    resolve(a);\r\n                }, function (err) {\r\n                    reject(err);\r\n                });\r\n            }\r\n            else {\r\n                var successProxy = void 0;\r\n                var errorProxy = void 0;\r\n                successProxy = function (args) {\r\n                    var parsed = JSON.parse(args);\r\n                    resolve(parsed);\r\n                };\r\n                errorProxy = function (args) {\r\n                    var parsed = JSON.parse(args);\r\n                    reject(parsed);\r\n                };\r\n                _this.agmFacade.invoke(JSON.stringify(_this.helpers.stringToObject(method, \"name\")), JSON.stringify(argumentObj), JSON.stringify(target), JSON.stringify(options), successProxy, errorProxy);\r\n            }\r\n        });\r\n        return promisify_1.default(promise, success, error);\r\n    };\r\n    NativeAGM.prototype.createStream = function (methodDefinition, options, successCallback, errorCallback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (typeof methodDefinition === \"string\") {\r\n                methodDefinition = {\r\n                    name: methodDefinition,\r\n                    getServers: function () { return []; },\r\n                };\r\n            }\r\n            if (!options) {\r\n                options = {\r\n                    subscriptionRequestHandler: undefined,\r\n                    subscriptionAddedHandler: undefined,\r\n                    subscriptionRemovedHandler: undefined,\r\n                };\r\n            }\r\n            _this.agmFacade.createStream2(JSON.stringify(methodDefinition), options.subscriptionRequestHandler, options.subscriptionAddedHandler, options.subscriptionRemovedHandler, function (stream) {\r\n                resolve(stream);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n        return promisify_1.default(promise, successCallback, errorCallback);\r\n    };\r\n    NativeAGM.prototype.subscribe = function (methodDefinition, parameters, successCallback, errorCallback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (typeof methodDefinition === \"undefined\") {\r\n                reject(\"method definition param is required\");\r\n            }\r\n            if (parameters === undefined) {\r\n                parameters = {};\r\n            }\r\n            parameters.args = JSON.stringify(parameters.arguments || {});\r\n            parameters.target = _this.helpers.targetArgToObject(parameters.target);\r\n            var name;\r\n            if (typeof methodDefinition === \"string\") {\r\n                name = methodDefinition;\r\n            }\r\n            else {\r\n                name = methodDefinition.name;\r\n            }\r\n            _this.agmFacade.subscribe2(name, JSON.stringify(parameters), function (sub) {\r\n                resolve(sub);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n        return promisify_1.default(promise, successCallback, errorCallback);\r\n    };\r\n    NativeAGM.prototype.servers = function (filter) {\r\n        var _this = this;\r\n        var jsonResult = this.agmFacade.servers(JSON.stringify(this.helpers.stringToObject(filter, \"name\")));\r\n        var parsedResult = this.helpers.agmParse(jsonResult);\r\n        return parsedResult.map(function (server) {\r\n            return _this.transformServerObject(server);\r\n        });\r\n    };\r\n    NativeAGM.prototype.methods = function (filter) {\r\n        var _this = this;\r\n        var jsonResult = this.agmFacade.methods(JSON.stringify(this.helpers.stringToObject(filter, \"name\")));\r\n        var parsedResult = this.helpers.agmParse(jsonResult);\r\n        return parsedResult.map(function (method) {\r\n            return _this.transformMethodObject(method);\r\n        });\r\n    };\r\n    NativeAGM.prototype.methodAdded = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.methodAdded(function (method) {\r\n            if (subscribed) {\r\n                callback(_this.transformMethodObject(method));\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.methodRemoved = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.methodRemoved(function (method) {\r\n            if (subscribed) {\r\n                callback(_this.transformMethodObject(method));\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.serverAdded = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.serverAdded(function (server) {\r\n            if (subscribed) {\r\n                callback(_this.transformServerObject(server));\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.serverRemoved = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.serverRemoved(function (server) {\r\n            if (subscribed) {\r\n                callback(_this.transformServerObject(server));\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.serverMethodAdded = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.serverMethodAdded(function (info) {\r\n            if (subscribed) {\r\n                callback({\r\n                    server: _this.transformServerObject(info.server),\r\n                    method: _this.transformMethodObject(info.method),\r\n                });\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.serverMethodRemoved = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.serverMethodRemoved(function (info) {\r\n            if (subscribed) {\r\n                callback({\r\n                    server: _this.transformServerObject(info.server),\r\n                    method: _this.transformMethodObject(info.method),\r\n                });\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.methodsForInstance = function (server) {\r\n        var jsonResult = this.agmFacade.methodsForInstance(JSON.stringify(server));\r\n        var methods = this.helpers.agmParse(jsonResult);\r\n        return methods.map(this.transformMethodObject);\r\n    };\r\n    NativeAGM.prototype.transformMethodObject = function (method) {\r\n        var _this = this;\r\n        if (!method) {\r\n            return undefined;\r\n        }\r\n        if (!method.displayName) {\r\n            method.displayName = method.display_name;\r\n        }\r\n        if (!method.objectTypes) {\r\n            method.objectTypes = method.object_types;\r\n        }\r\n        method.getServers = function () {\r\n            return _this.servers(method.name);\r\n        };\r\n        return method;\r\n    };\r\n    NativeAGM.prototype.transformServerObject = function (server) {\r\n        var _this = this;\r\n        if (!server) {\r\n            return undefined;\r\n        }\r\n        server.getMethods = function () {\r\n            return _this.methodsForInstance(server);\r\n        };\r\n        server.getStreams = function () {\r\n            return _this.methodsForInstance(server).filter(function (method) {\r\n                return method.supportsStreaming;\r\n            });\r\n        };\r\n        return server;\r\n    };\r\n    return NativeAGM;\r\n}());\r\nexports.NativeAGM = NativeAGM;\r\n//# sourceMappingURL=agm.js.map\n\n/***/ }),\n/* 58 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Helpers = (function () {\r\n    function Helpers(facade) {\r\n        this.facade = facade;\r\n        this.dateTimeIdentifier = facade.jsonValueDatePrefix;\r\n        this.lenOfIdentifier = this.dateTimeIdentifier.length;\r\n    }\r\n    Helpers.prototype.agmParse = function (str) {\r\n        var _this = this;\r\n        return JSON.parse(str, function (k, v) {\r\n            if (typeof v !== \"string\") {\r\n                return v;\r\n            }\r\n            if (v[0] !== _this.dateTimeIdentifier[0]) {\r\n                return v;\r\n            }\r\n            if (v.indexOf(_this.dateTimeIdentifier) !== 0) {\r\n                return v;\r\n            }\r\n            var unixTimestampMs = v.substr(_this.lenOfIdentifier);\r\n            return new Date(parseFloat(unixTimestampMs));\r\n        });\r\n    };\r\n    Helpers.prototype.targetArgToObject = function (target) {\r\n        var _this = this;\r\n        target = target || \"best\";\r\n        if (typeof target === \"string\") {\r\n            if (target !== \"all\" && target !== \"best\") {\r\n                throw new Error(target + \" is not a valid target. Valid targets are 'all' and 'best'\");\r\n            }\r\n            return { target: target };\r\n        }\r\n        else {\r\n            if (!Array.isArray(target)) {\r\n                target = [target];\r\n            }\r\n            target = target.map(function (e) {\r\n                return _this.convertInstanceToRegex(e);\r\n            });\r\n            return { serverFilter: target };\r\n        }\r\n    };\r\n    Helpers.prototype.convertInstanceToRegex = function (instance) {\r\n        var instanceConverted = {};\r\n        Object.keys(instance).forEach(function (key) {\r\n            var propValue = instance[key];\r\n            instanceConverted[key] = propValue;\r\n            if (typeof propValue === \"undefined\" || propValue === null) {\r\n                return;\r\n            }\r\n            if (typeof propValue === \"string\" && propValue !== \"\") {\r\n                instanceConverted[key] = \"^\" + instance[key] + \"$\";\r\n            }\r\n            else if (instance[key].constructor === RegExp) {\r\n                instanceConverted[key] = instance[key].source;\r\n            }\r\n            else {\r\n                instanceConverted[key] = instance[key];\r\n            }\r\n        });\r\n        return instanceConverted;\r\n    };\r\n    Helpers.prototype.validateMethodInfo = function (methodInfo) {\r\n        if (typeof methodInfo === \"undefined\") {\r\n            throw Error(\"methodInfo is required argument\");\r\n        }\r\n        if (!methodInfo.name) {\r\n            throw Error(\"methodInfo object must contain name property\");\r\n        }\r\n        if (methodInfo.objectTypes) {\r\n            methodInfo.object_types = methodInfo.objectTypes;\r\n        }\r\n        if (methodInfo.displayName) {\r\n            methodInfo.display_name = methodInfo.displayName;\r\n        }\r\n    };\r\n    Helpers.prototype.stringToObject = function (param, stringPropName) {\r\n        if (typeof param === \"string\") {\r\n            var obj = {};\r\n            obj[stringPropName] = param;\r\n            return obj;\r\n        }\r\n        return param;\r\n    };\r\n    return Helpers;\r\n}());\r\nexports.Helpers = Helpers;\r\n//# sourceMappingURL=helpers.js.map\n\n/***/ }),\n/* 59 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar agm_1 = __webpack_require__(57);\r\nvar helpers_1 = __webpack_require__(58);\r\nfunction default_1(configuration) {\r\n    var facade = window.htmlContainer.jsAgmFacade;\r\n    var cfgAsString = createConfig(configuration);\r\n    return new Promise(function (resolve, reject) {\r\n        var successInit = function (instance) {\r\n            var nativeAGM = new agm_1.NativeAGM(instance, new helpers_1.Helpers(facade), facade);\r\n            nativeAGM.create_stream = nativeAGM.createStream;\r\n            nativeAGM.methods_for_instance = nativeAGM.methodsForInstance;\r\n            nativeAGM.method_added = nativeAGM.methodAdded;\r\n            nativeAGM.method_removed = nativeAGM.methodRemoved;\r\n            nativeAGM.server_added = nativeAGM.serverAdded;\r\n            nativeAGM.server_removed = nativeAGM.serverRemoved;\r\n            nativeAGM.server_method_added = nativeAGM.serverMethodAdded;\r\n            nativeAGM.server_method_removed = nativeAGM.serverMethodRemoved;\r\n            resolve(nativeAGM);\r\n        };\r\n        if (facade.protocolVersion && facade.protocolVersion >= 5 && facade.initAsync) {\r\n            facade.initAsync(cfgAsString, successInit, function (err) {\r\n                reject(err);\r\n            });\r\n        }\r\n        else {\r\n            var instance = facade.init(cfgAsString);\r\n            successInit(instance);\r\n        }\r\n    });\r\n}\r\nexports.default = default_1;\r\nvar createConfig = function (configuration) {\r\n    if (configuration !== undefined && configuration.metrics !== undefined) {\r\n        configuration.metrics.metricsIdentity = configuration.metrics.identity;\r\n        var metricsConfig = {\r\n            metricsIdentity: configuration.metrics.metricsIdentity,\r\n            path: configuration.metrics.path,\r\n        };\r\n        configuration.metrics = metricsConfig;\r\n    }\r\n    delete configuration.logger;\r\n    return JSON.stringify(configuration);\r\n};\r\n//# sourceMappingURL=native.js.map\n\n/***/ }),\n/* 60 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar random_1 = __webpack_require__(23);\r\nfunction createOwnInstance(userSubmittedProperties, resolvedIdentity, peerId) {\r\n    var document = global.document || global.process;\r\n    var instance = {\r\n        application: document.title + random_1.default(),\r\n        pid: Math.floor(Math.random() * 10000000000),\r\n    };\r\n    instance.peerId = peerId;\r\n    if (typeof userSubmittedProperties === \"object\") {\r\n        if (userSubmittedProperties.application !== undefined) {\r\n            instance.application = userSubmittedProperties.application;\r\n        }\r\n        instance.machine = userSubmittedProperties.machine;\r\n        instance.user = userSubmittedProperties.user;\r\n        instance.environment = userSubmittedProperties.environment;\r\n        instance.region = userSubmittedProperties.region;\r\n    }\r\n    if (typeof resolvedIdentity !== \"undefined\") {\r\n        instance.user = resolvedIdentity.user;\r\n        instance.instance = resolvedIdentity.instance;\r\n        instance.application = resolvedIdentity.application;\r\n        instance.pid = resolvedIdentity.process;\r\n        instance.machine = resolvedIdentity.machine;\r\n        instance.environment = resolvedIdentity.environment;\r\n        instance.region = resolvedIdentity.region;\r\n        instance.windowId = resolvedIdentity.windowId;\r\n    }\r\n    return instance;\r\n}\r\nexports.createOwnInstance = createOwnInstance;\r\n//# sourceMappingURL=instance.js.map\n\n/***/ }),\n/* 61 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar instance_1 = __webpack_require__(60);\r\nvar native_1 = __webpack_require__(59);\r\nvar factory_1 = __webpack_require__(64);\r\nvar agm_1 = __webpack_require__(53);\r\nvar repository_1 = __webpack_require__(56);\r\nvar repository_2 = __webpack_require__(68);\r\nexports.default = (function (configuration) {\r\n    if (!configuration.forceGW && configuration.gdVersion === 2) {\r\n        return native_1.default(configuration);\r\n    }\r\n    if (typeof configuration === \"undefined\") {\r\n        throw new Error(\"configuration is required\");\r\n    }\r\n    if (typeof configuration.connection === \"undefined\") {\r\n        throw new Error(\"configuration.connections is required\");\r\n    }\r\n    var connection = configuration.connection;\r\n    if (typeof configuration.methodResponseTimeout !== \"number\") {\r\n        configuration.methodResponseTimeout = 3000;\r\n    }\r\n    if (typeof configuration.waitTimeoutMs !== \"number\") {\r\n        configuration.waitTimeoutMs = 3000;\r\n    }\r\n    var myIdentity = connection.resolvedIdentity;\r\n    var myInstance = instance_1.createOwnInstance(configuration.instance, myIdentity, connection.peerId);\r\n    var clientRepository = new repository_1.default();\r\n    var serverRepository = new repository_2.default();\r\n    var protocolPromise;\r\n    var agmImpl;\r\n    if (connection.protocolVersion === 3) {\r\n        protocolPromise = factory_1.default(myInstance, connection, clientRepository, serverRepository, configuration, function () { return agmImpl; });\r\n    }\r\n    else {\r\n        throw new Error(\"agm protocol version \" + connection.protocolVersion + \" not supported\");\r\n    }\r\n    return new Promise(function (resolve, reject) {\r\n        protocolPromise.then(function (protocol) {\r\n            agmImpl = new agm_1.default(protocol, clientRepository, serverRepository, myInstance, configuration);\r\n            resolve(agmImpl);\r\n        }).catch(function (err) {\r\n            reject(err);\r\n        });\r\n    });\r\n});\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 62 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar STATUS_AWAITING_ACCEPT = \"awaitingAccept\";\r\nvar STATUS_SUBSCRIBED = \"subscribed\";\r\nvar ERR_MSG_SUB_FAILED = \"Subscription failed.\";\r\nvar ERR_MSG_SUB_REJECTED = \"Subscription rejected.\";\r\nvar ON_CLOSE_MSG_SERVER_INIT = \"ServerInitiated\";\r\nvar ON_CLOSE_MSG_CLIENT_INIT = \"ClientInitiated\";\r\nvar ClientStreaming = (function () {\r\n    function ClientStreaming(instance, session, repository, logger) {\r\n        var _this = this;\r\n        this.instance = instance;\r\n        this.session = session;\r\n        this.repository = repository;\r\n        this.logger = logger;\r\n        this.subscriptionsList = {};\r\n        this.subscriptionIdToLocalKeyMap = {};\r\n        this.nextSubLocalKey = 0;\r\n        this.handleErrorSubscribing = function (errorResponse) {\r\n            var tag = errorResponse._tag;\r\n            var subLocalKey = tag.subLocalKey;\r\n            var pendingSub = _this.subscriptionsList[subLocalKey];\r\n            if (typeof pendingSub !== \"object\") {\r\n                return;\r\n            }\r\n            pendingSub.trackedServers = pendingSub.trackedServers.filter(function (server) {\r\n                return server.serverId !== tag.serverId;\r\n            });\r\n            if (pendingSub.trackedServers.length <= 0) {\r\n                clearTimeout(pendingSub.timeoutId);\r\n                if (pendingSub.status === STATUS_AWAITING_ACCEPT) {\r\n                    var reason = (typeof errorResponse.reason === \"string\" && errorResponse.reason !== \"\") ?\r\n                        ' Publisher said \"' + errorResponse.reason + '\".' :\r\n                        \" No reason given.\";\r\n                    var callArgs = typeof pendingSub.arguments === \"object\" ?\r\n                        JSON.stringify(pendingSub.arguments) :\r\n                        \"{}\";\r\n                    pendingSub.error({\r\n                        message: ERR_MSG_SUB_REJECTED + reason + \" Called with:\" + callArgs,\r\n                        called_with: pendingSub.arguments,\r\n                        method: pendingSub.method.getInfoForUser(),\r\n                    });\r\n                }\r\n                else if (pendingSub.status === STATUS_SUBSCRIBED) {\r\n                    _this.callOnClosedHandlers(pendingSub);\r\n                }\r\n                delete _this.subscriptionsList[subLocalKey];\r\n            }\r\n        };\r\n        this.handleSubscribed = function (msg) {\r\n            var subLocalKey = msg._tag.subLocalKey;\r\n            var pendingSub = _this.subscriptionsList[subLocalKey];\r\n            if (typeof pendingSub !== \"object\") {\r\n                return;\r\n            }\r\n            var serverId = msg._tag.serverId;\r\n            var acceptingServer = pendingSub.trackedServers\r\n                .filter(function (server) {\r\n                return server.serverId === serverId;\r\n            })[0];\r\n            if (typeof acceptingServer !== \"object\") {\r\n                return;\r\n            }\r\n            acceptingServer.subscriptionId = msg.subscription_id;\r\n            _this.subscriptionIdToLocalKeyMap[msg.subscription_id] = subLocalKey;\r\n            var isFirstResponse = (pendingSub.status === STATUS_AWAITING_ACCEPT);\r\n            pendingSub.status = STATUS_SUBSCRIBED;\r\n            var that = _this;\r\n            if (isFirstResponse) {\r\n                pendingSub.success({\r\n                    onData: function (dataCallback) {\r\n                        if (typeof dataCallback !== \"function\") {\r\n                            throw new TypeError(\"The data callback must be a function.\");\r\n                        }\r\n                        pendingSub.handlers.onData.push(dataCallback);\r\n                        if (pendingSub.handlers.onData.length === 1 && pendingSub.queued.data.length > 0) {\r\n                            pendingSub.queued.data.forEach(function (dataItem) {\r\n                                dataCallback(dataItem);\r\n                            });\r\n                        }\r\n                    },\r\n                    onClosed: function (closedCallback) {\r\n                        if (typeof closedCallback !== \"function\") {\r\n                            throw new TypeError(\"The callback must be a function.\");\r\n                        }\r\n                        pendingSub.handlers.onClosed.push(closedCallback);\r\n                    },\r\n                    onFailed: function () {\r\n                    },\r\n                    close: function () { return that.closeSubscription(subLocalKey); },\r\n                    requestArguments: pendingSub.arguments,\r\n                    serverInstance: that.repository.getServerById(serverId).getInfoForUser(),\r\n                    stream: pendingSub.method.info,\r\n                });\r\n            }\r\n        };\r\n        this.handleEventData = function (msg) {\r\n            var subLocalKey = _this.subscriptionIdToLocalKeyMap[msg.subscription_id];\r\n            if (typeof subLocalKey === \"undefined\") {\r\n                return;\r\n            }\r\n            var subscription = _this.subscriptionsList[subLocalKey];\r\n            if (typeof subscription !== \"object\") {\r\n                return;\r\n            }\r\n            var trackedServersFound = subscription.trackedServers.filter(function (server) {\r\n                return server.subscriptionId === msg.subscription_id;\r\n            });\r\n            if (trackedServersFound.length !== 1) {\r\n                return;\r\n            }\r\n            var isPrivateData = msg.oob && msg.snapshot;\r\n            var sendingServerId = trackedServersFound[0].serverId;\r\n            var receivedStreamData = function () {\r\n                return {\r\n                    data: msg.data,\r\n                    server: _this.repository.getServerById(sendingServerId).getInfoForUser(),\r\n                    requestArguments: subscription.arguments || {},\r\n                    message: null,\r\n                    private: isPrivateData,\r\n                };\r\n            };\r\n            var onDataHandlers = subscription.handlers.onData;\r\n            var queuedData = subscription.queued.data;\r\n            if (onDataHandlers.length > 0) {\r\n                onDataHandlers.forEach(function (callback) {\r\n                    if (typeof callback === \"function\") {\r\n                        callback(receivedStreamData());\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                queuedData.push(receivedStreamData());\r\n            }\r\n        };\r\n        this.handleSubscriptionCancelled = function (msg) {\r\n            var subLocalKey = _this.subscriptionIdToLocalKeyMap[msg.subscription_id];\r\n            if (typeof subLocalKey === \"undefined\") {\r\n                return;\r\n            }\r\n            var subscription = _this.subscriptionsList[subLocalKey];\r\n            if (typeof subscription !== \"object\") {\r\n                return;\r\n            }\r\n            var expectedNewLength = subscription.trackedServers.length - 1;\r\n            subscription.trackedServers = subscription.trackedServers.filter(function (server) {\r\n                if (server.subscriptionId === msg.subscription_id) {\r\n                    subscription.queued.closers.push(server.serverId);\r\n                    return false;\r\n                }\r\n                else {\r\n                    return true;\r\n                }\r\n            });\r\n            if (subscription.trackedServers.length !== expectedNewLength) {\r\n                return;\r\n            }\r\n            if (subscription.trackedServers.length <= 0) {\r\n                clearTimeout(subscription.timeoutId);\r\n                _this.callOnClosedHandlers(subscription);\r\n                delete _this.subscriptionsList[subLocalKey];\r\n            }\r\n            delete _this.subscriptionIdToLocalKeyMap[msg.subscription_id];\r\n        };\r\n        session.on(\"subscribed\", this.handleSubscribed);\r\n        session.on(\"event\", this.handleEventData);\r\n        session.on(\"subscription-cancelled\", this.handleSubscriptionCancelled);\r\n    }\r\n    ClientStreaming.prototype.subscribe = function (streamingMethod, argumentObj, targetServers, stuff, success, error) {\r\n        var _this = this;\r\n        if (targetServers.length === 0) {\r\n            error({\r\n                method: streamingMethod.getInfoForUser(),\r\n                called_with: argumentObj,\r\n                message: ERR_MSG_SUB_FAILED + \" No available servers matched the target params.\",\r\n            });\r\n            return;\r\n        }\r\n        var subLocalKey = this.getNextSubscriptionLocalKey();\r\n        var pendingSub = this.registerSubscription(subLocalKey, streamingMethod, argumentObj, success, error, stuff.methodResponseTimeout);\r\n        if (typeof pendingSub !== \"object\") {\r\n            error({\r\n                method: streamingMethod.getInfoForUser(),\r\n                called_with: argumentObj,\r\n                message: ERR_MSG_SUB_FAILED + \" Unable to register the user callbacks.\",\r\n            });\r\n            return;\r\n        }\r\n        targetServers.forEach(function (target) {\r\n            var serverId = target.server.id;\r\n            pendingSub.trackedServers.push({\r\n                serverId: serverId,\r\n                subscriptionId: undefined,\r\n            });\r\n            var msg = {\r\n                type: \"subscribe\",\r\n                server_id: serverId,\r\n                method_id: streamingMethod.protocolState.id,\r\n                arguments_kv: argumentObj,\r\n            };\r\n            _this.session.send(msg, { serverId: serverId, subLocalKey: subLocalKey })\r\n                .then(function (m) { return _this.handleSubscribed(m); })\r\n                .catch(function (err) { return _this.handleErrorSubscribing(err); });\r\n        });\r\n    };\r\n    ClientStreaming.prototype.getNextSubscriptionLocalKey = function () {\r\n        var current = this.nextSubLocalKey;\r\n        this.nextSubLocalKey += 1;\r\n        return current;\r\n    };\r\n    ClientStreaming.prototype.registerSubscription = function (subLocalKey, method, args, success, error, timeout) {\r\n        var _this = this;\r\n        this.subscriptionsList[subLocalKey] = {\r\n            status: STATUS_AWAITING_ACCEPT,\r\n            method: method,\r\n            arguments: args,\r\n            success: success,\r\n            error: error,\r\n            trackedServers: [],\r\n            handlers: {\r\n                onData: [],\r\n                onClosed: [],\r\n            },\r\n            queued: {\r\n                data: [],\r\n                closers: [],\r\n            },\r\n            timeoutId: undefined,\r\n        };\r\n        this.subscriptionsList[subLocalKey].timeoutId = setTimeout(function () {\r\n            if (_this.subscriptionsList[subLocalKey] === undefined) {\r\n                return;\r\n            }\r\n            var pendingSub = _this.subscriptionsList[subLocalKey];\r\n            if (pendingSub.status === STATUS_AWAITING_ACCEPT) {\r\n                error({\r\n                    method: method.getInfoForUser(),\r\n                    called_with: args,\r\n                    message: ERR_MSG_SUB_FAILED + \" Subscription attempt timed out after \" + timeout + \" ms.\",\r\n                });\r\n                delete _this.subscriptionsList[subLocalKey];\r\n            }\r\n            else if (pendingSub.status === STATUS_SUBSCRIBED && pendingSub.trackedServers.length > 0) {\r\n                pendingSub.trackedServers = pendingSub.trackedServers.filter(function (server) {\r\n                    return (typeof server.subscriptionId !== \"undefined\");\r\n                });\r\n                delete pendingSub.timeoutId;\r\n                if (pendingSub.trackedServers.length <= 0) {\r\n                    _this.callOnClosedHandlers(pendingSub);\r\n                    delete _this.subscriptionsList[subLocalKey];\r\n                }\r\n            }\r\n        }, timeout);\r\n        return this.subscriptionsList[subLocalKey];\r\n    };\r\n    ClientStreaming.prototype.callOnClosedHandlers = function (subscription, reason) {\r\n        var closersCount = subscription.queued.closers.length;\r\n        var closingServerId = (closersCount > 0) ? subscription.queued.closers[closersCount - 1] : null;\r\n        var closingServer = null;\r\n        if (typeof closingServerId === \"number\") {\r\n            closingServer = this.repository.getServerById(closingServerId).getInfoForUser();\r\n        }\r\n        subscription.handlers.onClosed.forEach(function (callback) {\r\n            if (typeof callback !== \"function\") {\r\n                return;\r\n            }\r\n            callback({\r\n                message: reason || ON_CLOSE_MSG_SERVER_INIT,\r\n                requestArguments: subscription.arguments,\r\n                server: closingServer,\r\n                stream: subscription.method,\r\n            });\r\n        });\r\n    };\r\n    ClientStreaming.prototype.closeSubscription = function (subLocalKey) {\r\n        var _this = this;\r\n        var subscription = this.subscriptionsList[subLocalKey];\r\n        if (typeof subscription !== \"object\") {\r\n            return;\r\n        }\r\n        subscription.trackedServers.forEach(function (server) {\r\n            if (typeof server.subscriptionId === \"undefined\") {\r\n                return;\r\n            }\r\n            _this.session.sendFireAndForget({\r\n                type: \"unsubscribe\",\r\n                subscription_id: server.subscriptionId,\r\n                reason_uri: \"\",\r\n                reason: ON_CLOSE_MSG_CLIENT_INIT,\r\n            });\r\n            delete _this.subscriptionIdToLocalKeyMap[server.subscriptionId];\r\n        });\r\n        subscription.trackedServers = [];\r\n        this.callOnClosedHandlers(subscription, ON_CLOSE_MSG_CLIENT_INIT);\r\n        delete this.subscriptionsList[subLocalKey];\r\n    };\r\n    return ClientStreaming;\r\n}());\r\nexports.default = ClientStreaming;\r\n//# sourceMappingURL=client-streaming.js.map\n\n/***/ }),\n/* 63 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar client_streaming_1 = __webpack_require__(62);\r\nvar ClientProtocol = (function () {\r\n    function ClientProtocol(instance, session, repository, logger) {\r\n        var _this = this;\r\n        this.instance = instance;\r\n        this.session = session;\r\n        this.repository = repository;\r\n        this.logger = logger;\r\n        this.callbacks = callback_registry_1.default();\r\n        session.on(\"peer-added\", function (msg) { return _this.handlePeerAdded(msg); });\r\n        session.on(\"peer-removed\", function (msg) { return _this.handlePeerRemoved(msg); });\r\n        session.on(\"methods-added\", function (msg) { return _this.handleMethodsAddedMessage(msg); });\r\n        session.on(\"methods-removed\", function (msg) { return _this.handleMethodsRemovedMessage(msg); });\r\n        this.streaming = new client_streaming_1.default(instance, session, repository, logger);\r\n    }\r\n    ClientProtocol.prototype.subscribe = function (stream, args, targetServers, options, success, error) {\r\n        this.streaming.subscribe(stream, args, targetServers, options, success, error);\r\n    };\r\n    ClientProtocol.prototype.invoke = function (id, method, args, target) {\r\n        var _this = this;\r\n        var serverId = target.id;\r\n        var methodId = method.protocolState.id;\r\n        var msg = {\r\n            type: \"call\",\r\n            server_id: serverId,\r\n            method_id: methodId,\r\n            arguments_kv: args,\r\n        };\r\n        this.session.send(msg, { invocationId: id, serverId: serverId })\r\n            .then(function (m) { return _this.handleResultMessage(m); })\r\n            .catch(function (err) { return _this.handleInvocationError(err); });\r\n    };\r\n    ClientProtocol.prototype.onInvocationResult = function (callback) {\r\n        this.callbacks.add(\"onResult\", callback);\r\n    };\r\n    ClientProtocol.prototype.handlePeerAdded = function (msg) {\r\n        var newPeerId = msg.new_peer_id;\r\n        var remoteId = msg.identity;\r\n        var pid = Number(remoteId.process);\r\n        var serverInfo = {\r\n            machine: remoteId.machine,\r\n            pid: isNaN(pid) ? remoteId.process : pid,\r\n            instance: remoteId.instance,\r\n            application: remoteId.application,\r\n            environment: remoteId.environment,\r\n            region: remoteId.region,\r\n            user: remoteId.user,\r\n            windowId: remoteId.windowId,\r\n            peerId: newPeerId,\r\n        };\r\n        this.repository.addServer(serverInfo, newPeerId);\r\n    };\r\n    ClientProtocol.prototype.handlePeerRemoved = function (msg) {\r\n        var removedPeerId = msg.removed_id;\r\n        var reason = msg.reason;\r\n        this.repository.removeServerById(removedPeerId, reason);\r\n    };\r\n    ClientProtocol.prototype.handleMethodsAddedMessage = function (msg) {\r\n        var _this = this;\r\n        var serverId = msg.server_id;\r\n        var methods = msg.methods;\r\n        methods.forEach(function (method) {\r\n            var methodInfo = {\r\n                name: method.name,\r\n                displayName: method.display_name,\r\n                description: method.description,\r\n                version: method.version,\r\n                objectTypes: method.object_types,\r\n                accepts: method.input_signature,\r\n                returns: method.result_signature,\r\n                supportsStreaming: typeof method.flags !== \"undefined\" ? method.flags.streaming : false,\r\n            };\r\n            _this.repository.addServerMethod(serverId, methodInfo, { id: method.id });\r\n        });\r\n    };\r\n    ClientProtocol.prototype.handleMethodsRemovedMessage = function (msg) {\r\n        var _this = this;\r\n        var serverId = msg.server_id;\r\n        var methodIdList = msg.methods;\r\n        var server = this.repository.getServerById(serverId);\r\n        var serverMethodKeys = Object.keys(server.methods);\r\n        serverMethodKeys.forEach(function (methodKey) {\r\n            var method = server.methods[methodKey];\r\n            if (methodIdList.indexOf(method.protocolState.id) > -1) {\r\n                _this.repository.removeServerMethod(serverId, methodKey);\r\n            }\r\n        });\r\n    };\r\n    ClientProtocol.prototype.handleResultMessage = function (msg) {\r\n        var invocationId = msg._tag.invocationId;\r\n        var result = msg.result;\r\n        var serverId = msg._tag.serverId;\r\n        var server = this.repository.getServerById(serverId);\r\n        this.callbacks.execute(\"onResult\", invocationId, server.getInfoForUser(), 0, result, \"\");\r\n    };\r\n    ClientProtocol.prototype.handleInvocationError = function (msg) {\r\n        this.logger.debug(\"handle invocation error \" + JSON.stringify(msg));\r\n        var invocationId = msg._tag.invocationId;\r\n        var serverId = msg._tag.serverId;\r\n        var server = this.repository.getServerById(serverId);\r\n        var message = msg.reason;\r\n        var context = msg.context;\r\n        this.callbacks.execute(\"onResult\", invocationId, server.getInfoForUser(), 1, context, message);\r\n    };\r\n    return ClientProtocol;\r\n}());\r\nexports.default = ClientProtocol;\r\n//# sourceMappingURL=client.js.map\n\n/***/ }),\n/* 64 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar server_1 = __webpack_require__(66);\r\nvar client_1 = __webpack_require__(63);\r\nfunction default_1(instance, connection, clientRepository, serverRepository, libConfig, getAGM) {\r\n    var logger = libConfig.logger.subLogger(\"gw3-protocol\");\r\n    var resolveReadyPromise;\r\n    var readyPromise = new Promise(function (resolve) {\r\n        resolveReadyPromise = resolve;\r\n    });\r\n    var session = connection.domain(\"agm\", logger.subLogger(\"domain\"), [\"subscribed\"]);\r\n    var server = new server_1.default(instance, session, clientRepository, serverRepository, logger.subLogger(\"server\"));\r\n    var client = new client_1.default(instance, session, clientRepository, logger.subLogger(\"client\"));\r\n    function handleReconnect() {\r\n        logger.info(\"reconnected - will replay registered methods and subscriptions\");\r\n        clientRepository.reset();\r\n        clientRepository.addServer(instance, connection.peerId);\r\n        var registeredMethods = serverRepository.getList();\r\n        serverRepository.reset();\r\n        registeredMethods.forEach(function (method) {\r\n            var def = method.definition;\r\n            if (method.theFunction.userCallback) {\r\n                getAGM().register(def, method.theFunction.userCallback);\r\n            }\r\n            else if (method.theFunction.userCallbackAsync) {\r\n                getAGM().registerAsync(def, method.theFunction.userCallbackAsync);\r\n            }\r\n        });\r\n    }\r\n    function handleInitialJoin() {\r\n        clientRepository.addServer(instance, connection.peerId);\r\n        resolveReadyPromise({\r\n            client: client,\r\n            server: server,\r\n        });\r\n        resolveReadyPromise = undefined;\r\n    }\r\n    session.onJoined(function (reconnect) {\r\n        if (reconnect) {\r\n            handleReconnect();\r\n        }\r\n        else {\r\n            handleInitialJoin();\r\n        }\r\n    });\r\n    session.join();\r\n    return readyPromise;\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=factory.js.map\n\n/***/ }),\n/* 65 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar SUBSCRIPTION_REQUEST = \"onSubscriptionRequest\";\r\nvar SUBSCRIPTION_ADDED = \"onSubscriptionAdded\";\r\nvar SUBSCRIPTION_REMOVED = \"onSubscriptionRemoved\";\r\nvar ServerStreaming = (function () {\r\n    function ServerStreaming(instance, session, repository, serverRepository, logger) {\r\n        var _this = this;\r\n        this.instance = instance;\r\n        this.session = session;\r\n        this.repository = repository;\r\n        this.serverRepository = serverRepository;\r\n        this.logger = logger;\r\n        this.ERR_URI_SUBSCRIPTION_FAILED = \"com.tick42.agm.errors.subscription.failure\";\r\n        this.callbacks = callback_registry_1.default();\r\n        this.nextStreamId = 0;\r\n        session.on(\"add-interest\", function (msg) { _this.handleAddInterest(msg); });\r\n        session.on(\"remove-interest\", function (msg) { _this.handleRemoveInterest(msg); });\r\n    }\r\n    ServerStreaming.prototype.acceptRequestOnBranch = function (requestContext, streamingMethod, branch) {\r\n        if (typeof branch !== \"string\") {\r\n            branch = \"\";\r\n        }\r\n        if (typeof streamingMethod.protocolState.subscriptionsMap !== \"object\") {\r\n            throw new TypeError(\"The streaming method is missing its subscriptions.\");\r\n        }\r\n        if (!Array.isArray(streamingMethod.protocolState.branchKeyToStreamIdMap)) {\r\n            throw new TypeError(\"The streaming method is missing its branches.\");\r\n        }\r\n        var streamId = this.getStreamId(streamingMethod, branch);\r\n        var key = requestContext.msg.subscription_id;\r\n        var subscription = {\r\n            id: key,\r\n            arguments: requestContext.arguments,\r\n            instance: requestContext.instance,\r\n            branchKey: branch,\r\n            streamId: streamId,\r\n            subscribeMsg: requestContext.msg,\r\n        };\r\n        streamingMethod.protocolState.subscriptionsMap[key] = subscription;\r\n        this.session.sendFireAndForget({\r\n            type: \"accepted\",\r\n            subscription_id: key,\r\n            stream_id: streamId,\r\n        });\r\n        this.callbacks.execute(SUBSCRIPTION_ADDED, subscription, streamingMethod);\r\n    };\r\n    ServerStreaming.prototype.rejectRequest = function (requestContext, streamingMethod, reason) {\r\n        if (typeof reason !== \"string\") {\r\n            reason = \"\";\r\n        }\r\n        this.sendSubscriptionFailed(\"Subscription rejected by user. \" + reason, requestContext.msg.subscription_id);\r\n    };\r\n    ServerStreaming.prototype.pushData = function (streamingMethod, data, branches) {\r\n        var _this = this;\r\n        if (typeof streamingMethod !== \"object\" || !Array.isArray(streamingMethod.protocolState.branchKeyToStreamIdMap)) {\r\n            return;\r\n        }\r\n        if (typeof data !== \"object\") {\r\n            throw new Error(\"Invalid arguments. Data must be an object.\");\r\n        }\r\n        if (typeof branches === \"string\") {\r\n            branches = [branches];\r\n        }\r\n        else if (!Array.isArray(branches) || branches.length <= 0) {\r\n            branches = null;\r\n        }\r\n        var streamIdList = streamingMethod.protocolState.branchKeyToStreamIdMap\r\n            .filter(function (br) {\r\n            return (branches === null || (Boolean(br) && typeof br.key === \"string\" && branches.indexOf(br.key) >= 0));\r\n        }).map(function (br) {\r\n            return br.streamId;\r\n        });\r\n        streamIdList.forEach(function (streamId) {\r\n            var publishMessage = {\r\n                type: \"publish\",\r\n                stream_id: streamId,\r\n                data: data,\r\n            };\r\n            _this.session.sendFireAndForget(publishMessage);\r\n        });\r\n    };\r\n    ServerStreaming.prototype.pushDataToSingle = function (method, subscription, data) {\r\n        if (typeof data !== \"object\") {\r\n            throw new Error(\"Invalid arguments. Data must be an object.\");\r\n        }\r\n        var postMessage = {\r\n            type: \"post\",\r\n            subscription_id: subscription.id,\r\n            data: data,\r\n        };\r\n        this.session.sendFireAndForget(postMessage);\r\n    };\r\n    ServerStreaming.prototype.closeSingleSubscription = function (streamingMethod, subscription) {\r\n        delete streamingMethod.protocolState.subscriptionsMap[subscription.id];\r\n        var dropSubscriptionMessage = {\r\n            type: \"drop-subscription\",\r\n            subscription_id: subscription.id,\r\n            reason: \"Server dropping a single subscription\",\r\n        };\r\n        this.session.sendFireAndForget(dropSubscriptionMessage);\r\n        var subscriber = subscription.instance;\r\n        this.callbacks.execute(SUBSCRIPTION_REMOVED, subscription, streamingMethod);\r\n    };\r\n    ServerStreaming.prototype.closeMultipleSubscriptions = function (streamingMethod, branchKey) {\r\n        var _this = this;\r\n        if (typeof streamingMethod !== \"object\" || typeof streamingMethod.protocolState.subscriptionsMap !== \"object\") {\r\n            return;\r\n        }\r\n        var subscriptionsToClose = Object.keys(streamingMethod.protocolState.subscriptionsMap)\r\n            .map(function (key) {\r\n            return streamingMethod.protocolState.subscriptionsMap[key];\r\n        });\r\n        if (typeof branchKey === \"string\") {\r\n            subscriptionsToClose = subscriptionsToClose.filter(function (sub) {\r\n                return sub.branchKey === branchKey;\r\n            });\r\n        }\r\n        subscriptionsToClose.forEach(function (subscription) {\r\n            delete streamingMethod.protocolState.subscriptionsMap[subscription.id];\r\n            var drop = {\r\n                type: \"drop-subscription\",\r\n                subscription_id: subscription.id,\r\n                reason: \"Server dropping all subscriptions on stream_id: \" + subscription.streamId,\r\n            };\r\n            _this.session.sendFireAndForget(drop);\r\n        });\r\n    };\r\n    ServerStreaming.prototype.getSubscriptionList = function (streamingMethod, branchKey) {\r\n        if (typeof streamingMethod !== \"object\") {\r\n            return [];\r\n        }\r\n        var subscriptions = [];\r\n        var allSubscriptions = Object.keys(streamingMethod.protocolState.subscriptionsMap)\r\n            .map(function (key) {\r\n            return streamingMethod.protocolState.subscriptionsMap[key];\r\n        });\r\n        if (typeof branchKey !== \"string\") {\r\n            subscriptions = allSubscriptions;\r\n        }\r\n        else {\r\n            subscriptions = allSubscriptions.filter(function (sub) {\r\n                return sub.branchKey === branchKey;\r\n            });\r\n        }\r\n        return subscriptions;\r\n    };\r\n    ServerStreaming.prototype.getBranchList = function (streamingMethod) {\r\n        if (typeof streamingMethod !== \"object\") {\r\n            return [];\r\n        }\r\n        var allSubscriptions = Object.keys(streamingMethod.protocolState.subscriptionsMap)\r\n            .map(function (key) {\r\n            return streamingMethod.protocolState.subscriptionsMap[key];\r\n        });\r\n        var keysWithDuplicates = allSubscriptions.map(function (sub) {\r\n            var result = null;\r\n            if (typeof sub === \"object\" && typeof sub.branchKey === \"string\") {\r\n                result = sub.branchKey;\r\n            }\r\n            return result;\r\n        });\r\n        var seen = [];\r\n        var branchArray = keysWithDuplicates.filter(function (bKey) {\r\n            if (bKey === null || seen.indexOf(bKey) >= 0) {\r\n                return false;\r\n            }\r\n            seen.push(bKey);\r\n            return true;\r\n        });\r\n        return branchArray;\r\n    };\r\n    ServerStreaming.prototype.onSubAdded = function (callback) {\r\n        this.onSubscriptionLifetimeEvent(SUBSCRIPTION_ADDED, callback);\r\n    };\r\n    ServerStreaming.prototype.onSubRequest = function (callback) {\r\n        this.onSubscriptionLifetimeEvent(SUBSCRIPTION_REQUEST, callback);\r\n    };\r\n    ServerStreaming.prototype.onSubRemoved = function (callback) {\r\n        this.onSubscriptionLifetimeEvent(SUBSCRIPTION_REMOVED, callback);\r\n    };\r\n    ServerStreaming.prototype.handleRemoveInterest = function (msg) {\r\n        var streamingMethod = this.serverRepository.getById(msg.method_id);\r\n        if (typeof msg.subscription_id !== \"string\" ||\r\n            typeof streamingMethod !== \"object\" ||\r\n            typeof streamingMethod.protocolState.subscriptionsMap[msg.subscription_id] !== \"object\") {\r\n            return;\r\n        }\r\n        var subscription = streamingMethod.protocolState.subscriptionsMap[msg.subscription_id];\r\n        delete streamingMethod.protocolState.subscriptionsMap[msg.subscription_id];\r\n        this.callbacks.execute(SUBSCRIPTION_REMOVED, subscription, streamingMethod);\r\n    };\r\n    ServerStreaming.prototype.onSubscriptionLifetimeEvent = function (eventName, handlerFunc) {\r\n        this.callbacks.add(eventName, handlerFunc);\r\n    };\r\n    ServerStreaming.prototype.getNextStreamId = function () {\r\n        return this.nextStreamId++ + \"\";\r\n    };\r\n    ServerStreaming.prototype.handleAddInterest = function (msg) {\r\n        var caller = this.repository.getServerById(msg.caller_id);\r\n        var instance = (typeof caller.getInfoForUser === \"function\") ? caller.getInfoForUser() : null;\r\n        var requestContext = {\r\n            msg: msg,\r\n            arguments: msg.arguments_kv || {},\r\n            instance: instance,\r\n        };\r\n        var streamingMethod = this.serverRepository.getById(msg.method_id);\r\n        if (streamingMethod === undefined) {\r\n            var errorMsg = \"No method with id \" + msg.method_id + \" on this server.\";\r\n            this.sendSubscriptionFailed(errorMsg, msg.subscription_id);\r\n            return;\r\n        }\r\n        if (streamingMethod.protocolState.subscriptionsMap &&\r\n            streamingMethod.protocolState.subscriptionsMap[msg.subscription_id]) {\r\n            this.sendSubscriptionFailed(\"A subscription with id \" + msg.subscription_id + \" already exists.\", msg.subscription_id);\r\n            return;\r\n        }\r\n        this.callbacks.execute(SUBSCRIPTION_REQUEST, requestContext, streamingMethod);\r\n    };\r\n    ServerStreaming.prototype.sendSubscriptionFailed = function (reason, subscriptionId) {\r\n        var errorMessage = {\r\n            type: \"error\",\r\n            reason_uri: this.ERR_URI_SUBSCRIPTION_FAILED,\r\n            reason: reason,\r\n            request_id: subscriptionId,\r\n        };\r\n        this.session.sendFireAndForget(errorMessage);\r\n    };\r\n    ServerStreaming.prototype.getStreamId = function (streamingMethod, branchKey) {\r\n        if (typeof branchKey !== \"string\") {\r\n            branchKey = \"\";\r\n        }\r\n        var needleBranch = streamingMethod.protocolState.branchKeyToStreamIdMap.filter(function (branch) {\r\n            return branch.key === branchKey;\r\n        })[0];\r\n        var streamId = (needleBranch ? needleBranch.streamId : undefined);\r\n        if (typeof streamId !== \"string\" || streamId === \"\") {\r\n            streamId = this.getNextStreamId();\r\n            streamingMethod.protocolState.branchKeyToStreamIdMap.push({ key: branchKey, streamId: streamId });\r\n        }\r\n        return streamId;\r\n    };\r\n    return ServerStreaming;\r\n}());\r\nexports.default = ServerStreaming;\r\n//# sourceMappingURL=server-streaming.js.map\n\n/***/ }),\n/* 66 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar server_streaming_1 = __webpack_require__(65);\r\nvar ServerProtocol = (function () {\r\n    function ServerProtocol(instance, session, clientRepository, serverRepository, logger) {\r\n        var _this = this;\r\n        this.session = session;\r\n        this.clientRepository = clientRepository;\r\n        this.serverRepository = serverRepository;\r\n        this.logger = logger;\r\n        this.callbacks = callback_registry_1.default();\r\n        this.streaming = new server_streaming_1.default(instance, session, clientRepository, serverRepository, logger);\r\n        this.session.on(\"invoke\", function (msg) { return _this.handleInvokeMessage(msg); });\r\n    }\r\n    ServerProtocol.prototype.createStream = function (repoMethod, success, error) {\r\n        var isStreaming = true;\r\n        repoMethod.protocolState.subscriptionsMap = {};\r\n        repoMethod.protocolState.branchKeyToStreamIdMap = [];\r\n        this.register(repoMethod, success, error, isStreaming);\r\n    };\r\n    ServerProtocol.prototype.register = function (repoMethod, success, error, isStreaming) {\r\n        var _this = this;\r\n        var methodDef = repoMethod.definition;\r\n        repoMethod.protocolState.registrationCallbacks = {\r\n            success: success,\r\n            fail: error,\r\n        };\r\n        var flags = { streaming: isStreaming || false };\r\n        this.logger.debug('registering method \"' + methodDef.name + '\"');\r\n        var registerMsg = {\r\n            type: \"register\",\r\n            methods: [{\r\n                    id: repoMethod.repoId,\r\n                    name: methodDef.name,\r\n                    display_name: methodDef.displayName,\r\n                    description: methodDef.description,\r\n                    version: methodDef.version,\r\n                    flags: flags,\r\n                    object_types: methodDef.objectTypes || methodDef.object_types,\r\n                    input_signature: methodDef.accepts,\r\n                    result_signature: methodDef.returns,\r\n                    restrictions: undefined,\r\n                }],\r\n        };\r\n        this.session.send(registerMsg, { methodId: repoMethod.repoId })\r\n            .then(function (msg) { return _this.handleRegisteredMessage(msg); })\r\n            .catch(function (err) { return _this.handleErrorRegister(err); });\r\n    };\r\n    ServerProtocol.prototype.onInvoked = function (callback) {\r\n        this.callbacks.add(\"onInvoked\", callback);\r\n    };\r\n    ServerProtocol.prototype.methodInvocationResult = function (method, invocationId, err, result) {\r\n        var msg;\r\n        if (err) {\r\n            msg = {\r\n                type: \"error\",\r\n                request_id: invocationId,\r\n                reason_uri: \"agm.errors.client_error\",\r\n                reason: err,\r\n                context: result,\r\n                peer_id: undefined,\r\n            };\r\n        }\r\n        else {\r\n            msg = {\r\n                type: \"yield\",\r\n                invocation_id: invocationId,\r\n                peer_id: this.session.peerId,\r\n                result: result,\r\n                request_id: undefined,\r\n            };\r\n        }\r\n        this.session.sendFireAndForget(msg);\r\n    };\r\n    ServerProtocol.prototype.unregister = function (method) {\r\n        var msg = {\r\n            type: \"unregister\",\r\n            methods: [method.repoId],\r\n        };\r\n        this.session.send(msg);\r\n    };\r\n    ServerProtocol.prototype.getBranchList = function (method) {\r\n        return this.streaming.getBranchList(method);\r\n    };\r\n    ServerProtocol.prototype.getSubscriptionList = function (method, branchKey) {\r\n        return this.streaming.getSubscriptionList(method, branchKey);\r\n    };\r\n    ServerProtocol.prototype.closeAllSubscriptions = function (method, branchKey) {\r\n        this.streaming.closeMultipleSubscriptions(method, branchKey);\r\n    };\r\n    ServerProtocol.prototype.pushData = function (method, data, branches) {\r\n        this.streaming.pushData(method, data, branches);\r\n    };\r\n    ServerProtocol.prototype.pushDataToSingle = function (method, subscription, data) {\r\n        this.streaming.pushDataToSingle(method, subscription, data);\r\n    };\r\n    ServerProtocol.prototype.closeSingleSubscription = function (method, subscription) {\r\n        this.streaming.closeSingleSubscription(method, subscription);\r\n    };\r\n    ServerProtocol.prototype.acceptRequestOnBranch = function (requestContext, method, branch) {\r\n        this.streaming.acceptRequestOnBranch(requestContext, method, branch);\r\n    };\r\n    ServerProtocol.prototype.rejectRequest = function (requestContext, method, reason) {\r\n        this.streaming.rejectRequest(requestContext, method, reason);\r\n    };\r\n    ServerProtocol.prototype.onSubRequest = function (callback) {\r\n        this.streaming.onSubRequest(callback);\r\n    };\r\n    ServerProtocol.prototype.onSubAdded = function (callback) {\r\n        this.streaming.onSubAdded(callback);\r\n    };\r\n    ServerProtocol.prototype.onSubRemoved = function (callback) {\r\n        this.streaming.onSubRemoved(callback);\r\n    };\r\n    ServerProtocol.prototype.handleRegisteredMessage = function (msg) {\r\n        var methodId = msg._tag.methodId;\r\n        var repoMethod = this.serverRepository.getById(methodId);\r\n        if (repoMethod && repoMethod.protocolState.registrationCallbacks) {\r\n            this.logger.debug(\"registered method \" + repoMethod.definition.name + \" with id \" + methodId);\r\n            repoMethod.protocolState.registrationCallbacks.success();\r\n        }\r\n    };\r\n    ServerProtocol.prototype.handleErrorRegister = function (msg) {\r\n        this.logger.warn(JSON.stringify(msg));\r\n        var methodId = msg._tag.methodId;\r\n        var repoMethod = this.serverRepository.getById(methodId);\r\n        if (repoMethod && repoMethod.protocolState.registrationCallbacks) {\r\n            this.logger.debug(\"failed to register method \" + repoMethod.definition.name + \" with id \" + methodId);\r\n            repoMethod.protocolState.registrationCallbacks.fail();\r\n        }\r\n    };\r\n    ServerProtocol.prototype.handleInvokeMessage = function (msg) {\r\n        var invocationId = msg.invocation_id;\r\n        var callerId = msg.caller_id;\r\n        var methodId = msg.method_id;\r\n        var args = msg.arguments_kv;\r\n        this.logger.debug('received invocation for method id \"' + methodId + '\" from peer ' + callerId);\r\n        var methodList = this.serverRepository.getList();\r\n        var method = methodList.filter(function (m) {\r\n            return m.repoId === methodId;\r\n        })[0];\r\n        if (method === undefined) {\r\n            return;\r\n        }\r\n        var client = this.clientRepository.getServerById(callerId);\r\n        var invocationArgs = { args: args, instance: client.getInfoForUser() };\r\n        this.callbacks.execute(\"onInvoked\", method, invocationId, invocationArgs);\r\n    };\r\n    return ServerProtocol;\r\n}());\r\nexports.default = ServerProtocol;\r\n//# sourceMappingURL=server.js.map\n\n/***/ }),\n/* 67 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar subscription_1 = __webpack_require__(9);\r\nvar ServerBranch = (function () {\r\n    function ServerBranch(key, protocol, repoMethod) {\r\n        this.key = key;\r\n        this.protocol = protocol;\r\n        this.repoMethod = repoMethod;\r\n    }\r\n    ServerBranch.prototype.subscriptions = function () {\r\n        var _this = this;\r\n        var subList = this.protocol.server.getSubscriptionList(this.repoMethod, this.key);\r\n        return subList.map(function (sub) {\r\n            return new subscription_1.default(_this.protocol, _this.repoMethod, sub);\r\n        });\r\n    };\r\n    ServerBranch.prototype.close = function () {\r\n        this.protocol.server.closeAllSubscriptions(this.repoMethod, this.key);\r\n    };\r\n    ServerBranch.prototype.push = function (data) {\r\n        this.protocol.server.pushData(this.repoMethod, data, [this.key]);\r\n    };\r\n    return ServerBranch;\r\n}());\r\nexports.default = ServerBranch;\r\n//# sourceMappingURL=branch.js.map\n\n/***/ }),\n/* 68 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ServerRepository = (function () {\r\n    function ServerRepository() {\r\n        this.nextId = 0;\r\n        this.methods = [];\r\n    }\r\n    ServerRepository.prototype.add = function (method) {\r\n        if (typeof method !== \"object\") {\r\n            return;\r\n        }\r\n        if (method.repoId !== undefined) {\r\n            return;\r\n        }\r\n        method.repoId = String(this.nextId);\r\n        this.nextId += 1;\r\n        this.methods.push(method);\r\n        return method;\r\n    };\r\n    ServerRepository.prototype.remove = function (repoId) {\r\n        if (typeof repoId !== \"string\") {\r\n            return new TypeError(\"Expecting a string\");\r\n        }\r\n        this.methods = this.methods.filter(function (m) {\r\n            return m.repoId !== repoId;\r\n        });\r\n    };\r\n    ServerRepository.prototype.getById = function (id) {\r\n        if (typeof id !== \"string\") {\r\n            return undefined;\r\n        }\r\n        return this.methods.filter(function (m) {\r\n            return m.repoId === id;\r\n        })[0];\r\n    };\r\n    ServerRepository.prototype.getList = function () {\r\n        return this.methods.map(function (m) { return m; });\r\n    };\r\n    ServerRepository.prototype.length = function () {\r\n        return this.methods.length;\r\n    };\r\n    ServerRepository.prototype.reset = function () {\r\n        this.methods = [];\r\n    };\r\n    return ServerRepository;\r\n}());\r\nexports.default = ServerRepository;\r\n//# sourceMappingURL=repository.js.map\n\n/***/ }),\n/* 69 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Request = (function () {\r\n    function Request(protocol, repoMethod, requestContext) {\r\n        this.protocol = protocol;\r\n        this.repoMethod = repoMethod;\r\n        this.requestContext = requestContext;\r\n        this.arguments = requestContext.arguments;\r\n        this.instance = requestContext.instance;\r\n    }\r\n    Request.prototype.accept = function () {\r\n        this.protocol.server.acceptRequestOnBranch(this.requestContext, this.repoMethod, \"\");\r\n    };\r\n    Request.prototype.acceptOnBranch = function (branch) {\r\n        this.protocol.server.acceptRequestOnBranch(this.requestContext, this.repoMethod, branch);\r\n    };\r\n    Request.prototype.reject = function (reason) {\r\n        this.protocol.server.rejectRequest(this.requestContext, this.repoMethod, reason);\r\n    };\r\n    return Request;\r\n}());\r\nexports.default = Request;\r\n//# sourceMappingURL=request.js.map\n\n/***/ }),\n/* 70 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar promisify_1 = __webpack_require__(8);\r\nvar streaming_1 = __webpack_require__(72);\r\nvar stream_1 = __webpack_require__(71);\r\nvar Server = (function () {\r\n    function Server(protocol, serverRepository, instance, configuration) {\r\n        this.protocol = protocol;\r\n        this.serverRepository = serverRepository;\r\n        this.instance = instance;\r\n        this.configuration = configuration;\r\n        this.invocations = 0;\r\n        this.streaming = new streaming_1.default(protocol, this);\r\n        this.protocol.server.onInvoked(this.onMethodInvoked.bind(this));\r\n    }\r\n    Server.prototype.register = function (methodDefinition, callback) {\r\n        var wrappedCallbackFunction = function (context, resultCallback) {\r\n            try {\r\n                var result = callback(context.args, context.instance);\r\n                resultCallback(null, result);\r\n            }\r\n            catch (e) {\r\n                resultCallback(e, e);\r\n            }\r\n        };\r\n        wrappedCallbackFunction.userCallback = callback;\r\n        this.registerCore(methodDefinition, wrappedCallbackFunction);\r\n    };\r\n    Server.prototype.registerAsync = function (methodDefinition, callback) {\r\n        var wrappedCallback = function (context, resultCallback) {\r\n            try {\r\n                callback(context.args, context.instance, function (result) {\r\n                    resultCallback(null, result);\r\n                }, function (e) {\r\n                    resultCallback(e, e);\r\n                });\r\n            }\r\n            catch (e) {\r\n                resultCallback(e, null);\r\n            }\r\n        };\r\n        wrappedCallback.userCallbackAsync = callback;\r\n        this.registerCore(methodDefinition, wrappedCallback);\r\n    };\r\n    Server.prototype.createStream = function (streamDef, callbacks, successCallback, errorCallback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (typeof streamDef === \"string\") {\r\n                if (streamDef === \"\") {\r\n                    reject(\"Invalid stream name - can not be empty\");\r\n                }\r\n                streamDef = { name: streamDef };\r\n            }\r\n            streamDef.supportsStreaming = true;\r\n            if (!callbacks) {\r\n                callbacks = {};\r\n            }\r\n            if (typeof callbacks.subscriptionRequestHandler !== \"function\") {\r\n                callbacks.subscriptionRequestHandler = function (request) {\r\n                    request.accept();\r\n                };\r\n            }\r\n            var repoMethod = {\r\n                definition: streamDef,\r\n                streamCallbacks: callbacks,\r\n                protocolState: {},\r\n            };\r\n            _this.serverRepository.add(repoMethod);\r\n            _this.protocol.server.createStream(repoMethod, function () {\r\n                var streamFrontObject = new stream_1.default(_this.protocol, repoMethod, _this);\r\n                repoMethod.stream = streamFrontObject;\r\n                resolve(streamFrontObject);\r\n            }, function (err) {\r\n                _this.serverRepository.remove(repoMethod.repoId);\r\n                reject(err);\r\n            });\r\n        });\r\n        return promisify_1.default(promise, successCallback, errorCallback);\r\n    };\r\n    Server.prototype.unregister = function (methodFilter) {\r\n        var _this = this;\r\n        if (typeof methodFilter === \"string\") {\r\n            methodFilter = { name: methodFilter };\r\n        }\r\n        var methodsToBeRemoved = this.serverRepository.getList().filter(function (method) {\r\n            return _this.containsProps(methodFilter, method.definition);\r\n        });\r\n        methodsToBeRemoved.forEach(function (method) {\r\n            _this.serverRepository.remove(method.repoId);\r\n            _this.protocol.server.unregister(method);\r\n        });\r\n    };\r\n    Server.prototype.registerCore = function (methodDefinition, theFunction) {\r\n        var _this = this;\r\n        if (typeof methodDefinition === \"string\") {\r\n            methodDefinition = { name: methodDefinition };\r\n        }\r\n        var repoMethod = this.serverRepository.add({\r\n            definition: methodDefinition,\r\n            theFunction: theFunction,\r\n            protocolState: {},\r\n        });\r\n        this.protocol.server.register(repoMethod, function () { }, function () {\r\n            _this.serverRepository.remove(repoMethod.repoId);\r\n        });\r\n    };\r\n    Server.prototype.containsProps = function (filter, object) {\r\n        var match = true;\r\n        Object.keys(filter).forEach(function (prop) {\r\n            if (filter[prop] !== object[prop]) {\r\n                match = false;\r\n            }\r\n        });\r\n        return match;\r\n    };\r\n    Server.prototype.onMethodInvoked = function (methodToExecute, invocationId, invocationArgs) {\r\n        var _this = this;\r\n        if (!methodToExecute) {\r\n            return;\r\n        }\r\n        methodToExecute.theFunction(invocationArgs, function (err, result) {\r\n            if (err) {\r\n                if (typeof err.message === \"string\") {\r\n                    err = err.message;\r\n                }\r\n                else if (typeof err !== \"string\") {\r\n                    err = \"<>\";\r\n                }\r\n            }\r\n            if (!result || typeof result !== \"object\" || result.constructor === Array) {\r\n                result = { _result: result };\r\n            }\r\n            _this.protocol.server.methodInvocationResult(methodToExecute, invocationId, err, result);\r\n        });\r\n    };\r\n    return Server;\r\n}());\r\nexports.default = Server;\r\n//# sourceMappingURL=server.js.map\n\n/***/ }),\n/* 71 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar subscription_1 = __webpack_require__(9);\r\nvar branch_1 = __webpack_require__(67);\r\nvar ServerStream = (function () {\r\n    function ServerStream(protocol, repoMethod, server) {\r\n        this.protocol = protocol;\r\n        this.repoMethod = repoMethod;\r\n        this.server = server;\r\n        this.def = repoMethod.definition;\r\n    }\r\n    Object.defineProperty(ServerStream.prototype, \"name\", {\r\n        get: function () { return this.def.name; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ServerStream.prototype.branches = function (key) {\r\n        var _this = this;\r\n        var bList = this.protocol.server.getBranchList(this.repoMethod);\r\n        if (key) {\r\n            if (bList.indexOf(key) > -1) {\r\n                return new branch_1.default(key, this.protocol, this.repoMethod);\r\n            }\r\n            return undefined;\r\n        }\r\n        else {\r\n            return bList.map(function (branchKey) {\r\n                return new branch_1.default(branchKey, _this.protocol, _this.repoMethod);\r\n            });\r\n        }\r\n    };\r\n    ServerStream.prototype.subscriptions = function () {\r\n        var _this = this;\r\n        var subList = this.protocol.server.getSubscriptionList(this.repoMethod);\r\n        return subList.map(function (sub) {\r\n            return new subscription_1.default(_this.protocol, _this.repoMethod, sub);\r\n        });\r\n    };\r\n    Object.defineProperty(ServerStream.prototype, \"definition\", {\r\n        get: function () {\r\n            var def2 = this.def;\r\n            return {\r\n                accepts: def2.accepts,\r\n                description: def2.description,\r\n                displayName: def2.displayName,\r\n                name: def2.name,\r\n                objectTypes: def2.objectTypes,\r\n                returns: def2.returns,\r\n                supportsStreaming: def2.supportsStreaming,\r\n            };\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ServerStream.prototype.close = function () {\r\n        this.protocol.server.closeAllSubscriptions(this.repoMethod);\r\n        this.server.unregister(this.repoMethod.definition);\r\n    };\r\n    ServerStream.prototype.push = function (data, branches) {\r\n        if (typeof branches !== \"string\" && !Array.isArray(branches) && branches !== undefined) {\r\n            throw new Error(\"invalid branches should be string or string array\");\r\n        }\r\n        if (typeof data !== \"object\") {\r\n            throw new Error(\"Invalid arguments. Data must be an object.\");\r\n        }\r\n        this.protocol.server.pushData(this.repoMethod, data, branches);\r\n    };\r\n    return ServerStream;\r\n}());\r\nexports.default = ServerStream;\r\n//# sourceMappingURL=stream.js.map\n\n/***/ }),\n/* 72 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar subscription_1 = __webpack_require__(9);\r\nvar request_1 = __webpack_require__(69);\r\nvar ServerStreaming = (function () {\r\n    function ServerStreaming(protocol, server) {\r\n        var _this = this;\r\n        this.protocol = protocol;\r\n        this.server = server;\r\n        protocol.server.onSubRequest(function (rc, rm) { return _this.handleSubRequest(rc, rm); });\r\n        protocol.server.onSubAdded(function (sub, rm) { return _this.handleSubAdded(sub, rm); });\r\n        protocol.server.onSubRemoved(function (sub, rm) { return _this.handleSubRemoved(sub, rm); });\r\n    }\r\n    ServerStreaming.prototype.handleSubRequest = function (requestContext, repoMethod) {\r\n        if (!(repoMethod &&\r\n            repoMethod.streamCallbacks &&\r\n            typeof repoMethod.streamCallbacks.subscriptionRequestHandler === \"function\")) {\r\n            return;\r\n        }\r\n        var request = new request_1.default(this.protocol, repoMethod, requestContext);\r\n        repoMethod.streamCallbacks.subscriptionRequestHandler(request);\r\n    };\r\n    ServerStreaming.prototype.handleSubAdded = function (subscription, repoMethod) {\r\n        if (!(repoMethod &&\r\n            repoMethod.streamCallbacks &&\r\n            typeof repoMethod.streamCallbacks.subscriptionAddedHandler === \"function\")) {\r\n            return;\r\n        }\r\n        var sub = new subscription_1.default(this.protocol, repoMethod, subscription);\r\n        repoMethod.streamCallbacks.subscriptionAddedHandler(sub);\r\n    };\r\n    ServerStreaming.prototype.handleSubRemoved = function (subscription, repoMethod) {\r\n        if (!(repoMethod &&\r\n            repoMethod.streamCallbacks &&\r\n            typeof repoMethod.streamCallbacks.subscriptionRemovedHandler === \"function\")) {\r\n            return;\r\n        }\r\n        var sub = new subscription_1.default(this.protocol, repoMethod, subscription);\r\n        repoMethod.streamCallbacks.subscriptionRemovedHandler(sub);\r\n    };\r\n    return ServerStreaming;\r\n}());\r\nexports.default = ServerStreaming;\r\n//# sourceMappingURL=streaming.js.map\n\n/***/ }),\n/* 73 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction setupAGM(agm, channels) {\r\n    var windowId;\r\n    if (typeof window !== \"undefined\") {\r\n        if (window.htmlContainer) {\r\n            windowId = window.htmlContainer.windowId;\r\n        }\r\n        else if (window.glue42gd) {\r\n            windowId = window.glue42gd.windowId;\r\n        }\r\n    }\r\n    if (!windowId) {\r\n        return;\r\n    }\r\n    agm.invoke(\"T42.Channels.Announce\", { swId: windowId, instance: agm.instance.instance });\r\n    agm.register(\"T42.Channels.Command\", function (args) {\r\n        var command = args.command;\r\n        if (!command) {\r\n            throw new Error('missing command argument');\r\n        }\r\n        if (command === 'join') {\r\n            var id = args.channel;\r\n            if (!id) {\r\n                throw new Error('missing argument id');\r\n            }\r\n            channels.join(id);\r\n            return;\r\n        }\r\n        if (command === 'leave') {\r\n            channels.leave();\r\n            return;\r\n        }\r\n        if (command === 'get') {\r\n            var id = channels.current();\r\n            return { id: id };\r\n        }\r\n        throw new Error(\"unknown command \" + command);\r\n    });\r\n}\r\nexports.setupAGM = setupAGM;\r\n//# sourceMappingURL=agm.js.map\n\n/***/ }),\n/* 74 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar ChannelsImpl = (function () {\r\n    function ChannelsImpl(shared) {\r\n        this.shared = shared;\r\n        this.subsKey = \"subs\";\r\n        this.changedKey = \"changed\";\r\n        this.registry = callback_registry_1.default();\r\n        this.shared.subscribe(this.handler.bind(this));\r\n    }\r\n    ChannelsImpl.prototype.current = function () {\r\n        return this.currentContext;\r\n    };\r\n    ChannelsImpl.prototype.subscribe = function (callback) {\r\n        return this.registry.add(this.subsKey, callback);\r\n    };\r\n    ChannelsImpl.prototype.publish = function (data) {\r\n        if (!this.currentContext) {\r\n            throw new Error(\"not joined to any channel\");\r\n        }\r\n        return this.shared.update(this.currentContext, { data: data });\r\n    };\r\n    ChannelsImpl.prototype.join = function (id) {\r\n        this.currentContext = id;\r\n        this.registry.execute(this.changedKey, id);\r\n        return this.shared.switchChannel(id);\r\n    };\r\n    ChannelsImpl.prototype.leave = function () {\r\n        this.currentContext = undefined;\r\n        this.registry.execute(this.changedKey, undefined);\r\n        return this.shared.unsubscribe();\r\n    };\r\n    ChannelsImpl.prototype.all = function () {\r\n        return this.shared.all();\r\n    };\r\n    ChannelsImpl.prototype.changed = function (callback) {\r\n        this.registry.add(this.changedKey, callback);\r\n    };\r\n    ChannelsImpl.prototype.meta = function (name, meta) {\r\n        throw new Error(\"Method not implemented.\");\r\n    };\r\n    ChannelsImpl.prototype.add = function (info) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var context;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!info) {\r\n                            throw new Error(\"info argument can not be undefined\");\r\n                        }\r\n                        if (!info.name) {\r\n                            throw new Error(\"info.name is missing\");\r\n                        }\r\n                        context = {\r\n                            name: info.name,\r\n                            meta: info.meta || {},\r\n                            data: info.data || {}\r\n                        };\r\n                        return [4, this.shared.add(info.name, context)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2, context];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ChannelsImpl.prototype.remove = function (id) {\r\n        throw new Error(\"Method not implemented.\");\r\n    };\r\n    ChannelsImpl.prototype.onChannelAdded = function (cb) {\r\n        throw new Error(\"Method not implemented.\");\r\n    };\r\n    ChannelsImpl.prototype.onChannelRemoved = function (cb) {\r\n        throw new Error(\"Method not implemented.\");\r\n    };\r\n    ChannelsImpl.prototype.apps = function (channelId) {\r\n        throw new Error(\"Method not implemented.\");\r\n    };\r\n    ChannelsImpl.prototype.handler = function (context) {\r\n        this.registry.execute(this.subsKey, context.data, context);\r\n    };\r\n    return ChannelsImpl;\r\n}());\r\nexports.ChannelsImpl = ChannelsImpl;\r\n//# sourceMappingURL=channels.js.map\n\n/***/ }),\n/* 75 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CONTEXT_PREFIX = \"___channel___\";\r\nvar SharedContextSubscriber = (function () {\r\n    function SharedContextSubscriber(contexts) {\r\n        this.contexts = contexts;\r\n        this.unsubscribeFunc = undefined;\r\n        this.current = undefined;\r\n    }\r\n    SharedContextSubscriber.prototype.subscribe = function (callback) {\r\n        this.callback = callback;\r\n    };\r\n    SharedContextSubscriber.prototype.switchChannel = function (name) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var sharedContextName, _a;\r\n            var _this = this;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        this.unsubscribe();\r\n                        this.current = name;\r\n                        sharedContextName = this.createContextName(name);\r\n                        _a = this;\r\n                        return [4, this.contexts.subscribe(sharedContextName, function (data) {\r\n                                if (_this.callback) {\r\n                                    _this.callback(data);\r\n                                }\r\n                            })];\r\n                    case 1:\r\n                        _a.unsubscribeFunc = _b.sent();\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    SharedContextSubscriber.prototype.unsubscribe = function () {\r\n        if (this.unsubscribeFunc) {\r\n            this.unsubscribeFunc();\r\n        }\r\n        return Promise.resolve();\r\n    };\r\n    SharedContextSubscriber.prototype.add = function (id, data) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var name;\r\n            return __generator(this, function (_a) {\r\n                name = this.createContextName(id);\r\n                return [2, this.contexts.set(name, data)];\r\n            });\r\n        });\r\n    };\r\n    SharedContextSubscriber.prototype.all = function () {\r\n        var allContexts = this.contexts.all();\r\n        var channels = allContexts.filter(function (c) { return c.startsWith(CONTEXT_PREFIX); });\r\n        var ids = channels.map(function (c) { return c.substr(CONTEXT_PREFIX.length); });\r\n        return Promise.resolve(ids);\r\n    };\r\n    SharedContextSubscriber.prototype.update = function (id, data) {\r\n        var name = this.createContextName(id);\r\n        return this.contexts.update(name, data);\r\n    };\r\n    SharedContextSubscriber.prototype.createContextName = function (id) {\r\n        return CONTEXT_PREFIX + id;\r\n    };\r\n    return SharedContextSubscriber;\r\n}());\r\nexports.SharedContextSubscriber = SharedContextSubscriber;\r\n//# sourceMappingURL=contexts.js.map\n\n/***/ }),\n/* 76 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar agm_1 = __webpack_require__(73);\r\nvar contexts_1 = __webpack_require__(75);\r\nvar channels_1 = __webpack_require__(74);\r\nfunction factory(contexts, agm) {\r\n    var sharedContexts = new contexts_1.SharedContextSubscriber(contexts);\r\n    var channels = new channels_1.ChannelsImpl(sharedContexts);\r\n    agm_1.setupAGM(agm, channels);\r\n    return {\r\n        subscribe: channels.subscribe.bind(channels),\r\n        publish: channels.publish.bind(channels),\r\n        all: channels.all.bind(channels),\r\n        current: channels.current.bind(channels),\r\n        join: channels.join.bind(channels),\r\n        leave: channels.leave.bind(channels),\r\n        add: channels.add.bind(channels),\r\n        changed: channels.changed.bind(channels),\r\n        ready: function () { return contexts.ready(); }\r\n    };\r\n}\r\nexports.factory = factory;\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 77 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar shortid_1 = __webpack_require__(7);\r\nvar utils_1 = __webpack_require__(11);\r\nvar contextMessageReplaySpec_1 = __webpack_require__(10);\r\nvar pjson = __webpack_require__(13);\r\nfunction default_1(configuration, ext, hc, glue42gd, gdVersion) {\r\n    if (typeof window !== \"undefined\") {\r\n        global = global || window;\r\n    }\r\n    global = global || {};\r\n    var uid = shortid_1.generate();\r\n    var masterConfig = global.GLUE_CONFIG || {};\r\n    var dynamicDefaults = global.GLUE_DEFAULT_CONFIG || {};\r\n    var hardDefaults = getHardDefaults();\r\n    var metricsIdentity = {\r\n        system: getConfigProp(\"metrics\", \"system\"),\r\n        service: getConfigProp(\"metrics\", \"service\"),\r\n        instance: getConfigProp(\"metrics\", \"instance\")\r\n    };\r\n    function getMetrics() {\r\n        return ifNotFalse(getConfigProp(\"metrics\"), {\r\n            identity: metricsIdentity\r\n        });\r\n    }\r\n    function getGateway() {\r\n        var force = getConfigProp(\"gateway\", \"force\");\r\n        var gw = hc === undefined || force;\r\n        if (gw) {\r\n            var gwConfig = getConfigProp(\"gateway\");\r\n            var protocolVersion = getConfigProp(\"gateway\", \"protocolVersion\");\r\n            var reconnectInterval = getConfigProp(\"gateway\", \"reconnectInterval\");\r\n            var reconnectAttempts = getConfigProp(\"gateway\", \"reconnectAttempts\");\r\n            var ws = gwConfig.ws;\r\n            var http = gwConfig.http;\r\n            var inproc = gwConfig.inproc;\r\n            if (!ws && !http && !inproc) {\r\n                if (utils_1.default.isNode() || (\"WebSocket\" in window && window.WebSocket.CLOSING === 2)) {\r\n                    ws = getConfigProp(\"gateway\", \"ws\");\r\n                }\r\n                else {\r\n                    http = getConfigProp(\"gateway\", \"http\");\r\n                }\r\n            }\r\n            var windowId = void 0;\r\n            var pid = void 0;\r\n            if (hc) {\r\n                windowId = hc.windowId;\r\n            }\r\n            else if (typeof glue42gd !== \"undefined\") {\r\n                windowId = glue42gd.windowId;\r\n                pid = glue42gd.pid;\r\n            }\r\n            else if (utils_1.default.isNode()) {\r\n                pid = process.pid;\r\n            }\r\n            var replaySpecs = getConfigProp(\"gateway\", \"replaySpecs\") || [];\r\n            replaySpecs.push(contextMessageReplaySpec_1.ContextMessageReplaySpec);\r\n            return {\r\n                identity: {\r\n                    application: getApplication(),\r\n                    windowId: windowId,\r\n                    process: pid,\r\n                },\r\n                reconnectInterval: reconnectInterval,\r\n                ws: ws,\r\n                http: http,\r\n                gw: inproc,\r\n                protocolVersion: protocolVersion,\r\n                reconnectAttempts: reconnectAttempts,\r\n                force: true,\r\n                replaySpecs: replaySpecs,\r\n                gdVersion: gdVersion,\r\n            };\r\n        }\r\n        return { gdVersion: gdVersion };\r\n    }\r\n    function getLogger() {\r\n        return getConfigProp(\"logger\");\r\n    }\r\n    function getAgm() {\r\n        return ifNotFalse(configuration.agm, {\r\n            instance: {\r\n                application: getApplication()\r\n            }\r\n        });\r\n    }\r\n    function getContexts() {\r\n        return true;\r\n    }\r\n    function getApplication() {\r\n        return getConfigProp(\"application\");\r\n    }\r\n    function getAuth() {\r\n        return getConfigProp(\"auth\");\r\n    }\r\n    function getHardDefaults() {\r\n        function getMetricsDefaults() {\r\n            var documentTitle = typeof document !== \"undefined\" ? document.title : \"unknown\";\r\n            documentTitle = documentTitle || \"none\";\r\n            if (typeof hc === \"undefined\") {\r\n                return {\r\n                    system: \"Connect.Browser\",\r\n                    service: configuration.application || documentTitle,\r\n                    instance: \"~\" + uid\r\n                };\r\n            }\r\n            if (typeof hc.metricsFacade.getIdentity !== \"undefined\") {\r\n                var identity = hc.metricsFacade.getIdentity();\r\n                return {\r\n                    system: identity.system,\r\n                    service: identity.service,\r\n                    instance: identity.instance\r\n                };\r\n            }\r\n            return {\r\n                system: \"HtmlContainer.\" + hc.containerName,\r\n                service: \"JS.\" + hc.browserWindowName,\r\n                instance: \"~\" + hc.machineName\r\n            };\r\n        }\r\n        function getGatewayDefaults() {\r\n            var defaultProtocol = 3;\r\n            var gatewayURL = \"localhost:8385\";\r\n            var defaultWs = \"ws://\" + gatewayURL;\r\n            var defaultHttp = \"http://\" + gatewayURL;\r\n            if (glue42gd) {\r\n                defaultProtocol = 3;\r\n                defaultWs = glue42gd.gwURL;\r\n            }\r\n            return {\r\n                ws: defaultWs,\r\n                http: defaultHttp,\r\n                protocolVersion: defaultProtocol,\r\n                reconnectInterval: 1000\r\n            };\r\n        }\r\n        function getDefaultApplicationName() {\r\n            if (hc) {\r\n                return hc.containerName + \".\" + hc.browserWindowName;\r\n            }\r\n            if (glue42gd) {\r\n                return glue42gd.appName;\r\n            }\r\n            if (typeof window !== \"undefined\" && typeof document !== \"undefined\") {\r\n                return (window.agm_application || document.title) + uid;\r\n            }\r\n            else {\r\n                return \"NodeJS\" + uid;\r\n            }\r\n        }\r\n        function getDefaultLogger() {\r\n            return {\r\n                publish: \"off\",\r\n                console: \"info\",\r\n                metrics: \"off\",\r\n            };\r\n        }\r\n        return {\r\n            application: getDefaultApplicationName(),\r\n            metrics: getMetricsDefaults(),\r\n            agm: {},\r\n            gateway: getGatewayDefaults(),\r\n            logger: getDefaultLogger(),\r\n        };\r\n    }\r\n    function getConfigProp(prop1, prop2) {\r\n        var masterConfigProp1 = masterConfig[prop1];\r\n        var userProp1 = configuration[prop1];\r\n        var dynamicDefaultsProp1 = dynamicDefaults[prop1];\r\n        var hardDefaultsProp1 = hardDefaults[prop1];\r\n        if (prop2) {\r\n            if (masterConfigProp1 && masterConfigProp1[prop2] !== undefined) {\r\n                return masterConfigProp1[prop2];\r\n            }\r\n            if (userProp1 && userProp1[prop2] !== undefined) {\r\n                return userProp1[prop2];\r\n            }\r\n            if (dynamicDefaultsProp1 && dynamicDefaultsProp1[prop2] !== undefined) {\r\n                return dynamicDefaultsProp1[prop2];\r\n            }\r\n            if (hardDefaultsProp1 && hardDefaultsProp1[prop2] !== undefined) {\r\n                return hardDefaultsProp1[prop2];\r\n            }\r\n        }\r\n        else {\r\n            if (masterConfigProp1 !== undefined) {\r\n                return masterConfigProp1;\r\n            }\r\n            if (userProp1 !== undefined) {\r\n                return userProp1;\r\n            }\r\n            if (dynamicDefaultsProp1 !== undefined) {\r\n                return dynamicDefaultsProp1;\r\n            }\r\n            if (hardDefaultsProp1 !== undefined) {\r\n                return hardDefaultsProp1;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    function ifNotFalse(what, then) {\r\n        if (typeof what === \"boolean\" && !what) {\r\n            return undefined;\r\n        }\r\n        else {\r\n            return then;\r\n        }\r\n    }\r\n    return {\r\n        identity: metricsIdentity,\r\n        application: getApplication(),\r\n        auth: getAuth(),\r\n        logger: getLogger(),\r\n        connection: getGateway(),\r\n        metrics: getMetrics(),\r\n        agm: getAgm(),\r\n        contexts: getContexts(),\r\n        version: ext.version || pjson.version,\r\n        libs: ext.libs\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=config.js.map\n\n/***/ }),\n/* 78 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar connection_1 = __webpack_require__(24);\r\nvar messageReplayer_1 = __webpack_require__(80);\r\nvar GW3ConnectionImpl = (function (_super) {\r\n    __extends(GW3ConnectionImpl, _super);\r\n    function GW3ConnectionImpl(settings) {\r\n        var _this = _super.call(this, settings) || this;\r\n        if (settings.replaySpecs &&\r\n            settings.replaySpecs.length) {\r\n            _this.replayer = new messageReplayer_1.MessageReplayerImpl(settings.replaySpecs);\r\n        }\r\n        return _this;\r\n    }\r\n    GW3ConnectionImpl.prototype.init = function (transport, protocol) {\r\n        _super.prototype.init.call(this, transport, protocol);\r\n        if (this.replayer) {\r\n            this.replayer.init(this);\r\n        }\r\n        this.gw3Protocol = protocol;\r\n    };\r\n    GW3ConnectionImpl.prototype.toAPI = function () {\r\n        var that = this;\r\n        var superAPI = _super.prototype.toAPI.call(this);\r\n        return {\r\n            domain: that.domain.bind(that),\r\n            get peerId() { return that.peerId; },\r\n            get token() { return that.token; },\r\n            get info() { return that.info; },\r\n            get resolvedIdentity() { return that.resolvedIdentity; },\r\n            get availableDomains() { return that.availableDomains; },\r\n            get gatewayToken() { return that.gatewayToken; },\r\n            get replayer() { return that.replayer; },\r\n            on: superAPI.on,\r\n            send: superAPI.send,\r\n            off: superAPI.off,\r\n            login: superAPI.login,\r\n            logout: superAPI.logout,\r\n            loggedIn: superAPI.loggedIn,\r\n            connected: superAPI.connected,\r\n            disconnected: superAPI.disconnected,\r\n            authToken: that.authToken.bind(that),\r\n            get protocolVersion() { return superAPI.protocolVersion; },\r\n        };\r\n    };\r\n    GW3ConnectionImpl.prototype.domain = function (domain, logger, successMessages, errorMessages) {\r\n        return this.gw3Protocol.domain(domain, logger, successMessages, errorMessages);\r\n    };\r\n    GW3ConnectionImpl.prototype.authToken = function () {\r\n        return this.gw3Protocol.authToken();\r\n    };\r\n    return GW3ConnectionImpl;\r\n}(connection_1.default));\r\nexports.default = GW3ConnectionImpl;\r\n//# sourceMappingURL=gw3Connection.js.map\n\n/***/ }),\n/* 79 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar connection_1 = __webpack_require__(24);\r\nvar gw3_1 = __webpack_require__(81);\r\nvar hc_1 = __webpack_require__(83);\r\nvar ws_1 = __webpack_require__(86);\r\nvar gw3Connection_1 = __webpack_require__(78);\r\nvar hc_2 = __webpack_require__(84);\r\nvar inproc_1 = __webpack_require__(85);\r\nexports.default = (function (settings) {\r\n    settings = settings || {};\r\n    settings.reconnectAttempts = settings.reconnectAttempts || 10;\r\n    settings.reconnectInterval = settings.reconnectInterval || 500;\r\n    var connection = new connection_1.default(settings);\r\n    var logger = settings.logger;\r\n    if (!logger) {\r\n        throw new Error(\"please pass a logger object\");\r\n    }\r\n    var protocol = new hc_1.default();\r\n    var transport = new hc_2.default();\r\n    var outsideHC = settings.gdVersion !== 2 || settings.force;\r\n    if (outsideHC) {\r\n        if (settings.gw && settings.gw.facade && settings.gw.token && settings.protocolVersion === 3) {\r\n            transport = new inproc_1.default(settings.gw.token, settings.gw.facade, logger.subLogger(\"inproc\"));\r\n        }\r\n        else if (settings.ws !== undefined) {\r\n            transport = new ws_1.default(settings, logger.subLogger(\"ws\"));\r\n        }\r\n        else {\r\n            throw new Error(\"No connection information specified\");\r\n        }\r\n        if (settings.protocolVersion === 3) {\r\n            var gw3Connection = new gw3Connection_1.default(settings);\r\n            var gw3Port = gw3_1.default(gw3Connection, settings, logger.subLogger(\"gw3\"));\r\n            gw3Connection.init(transport, gw3Port);\r\n            return gw3Connection.toAPI();\r\n        }\r\n        else {\r\n            throw new Error(\"protocolVersion 3 or greater supported\");\r\n        }\r\n    }\r\n    connection.init(transport, protocol);\r\n    return connection.toAPI();\r\n});\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 80 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar MessageReplayerImpl = (function () {\r\n    function MessageReplayerImpl(specs) {\r\n        this.specsNames = [];\r\n        this.messages = {};\r\n        this.subs = {};\r\n        this.subsRefCount = {};\r\n        this.specs = {};\r\n        for (var _i = 0, specs_1 = specs; _i < specs_1.length; _i++) {\r\n            var spec = specs_1[_i];\r\n            this.specs[spec.name] = spec;\r\n            this.specsNames.push(spec.name);\r\n        }\r\n    }\r\n    MessageReplayerImpl.prototype.init = function (connection) {\r\n        var _this = this;\r\n        this.connection = connection;\r\n        for (var _i = 0, _a = this.specsNames; _i < _a.length; _i++) {\r\n            var name_1 = _a[_i];\r\n            var _loop_1 = function (type) {\r\n                var refCount = this_1.subsRefCount[type];\r\n                if (!refCount) {\r\n                    refCount = 0;\r\n                }\r\n                refCount += 1;\r\n                this_1.subsRefCount[type] = refCount;\r\n                if (refCount > 1) {\r\n                    return \"continue\";\r\n                }\r\n                var sub = connection.on(\"glue-core\", type, function (msg) { return _this.processMessage(type, msg); });\r\n                this_1.subs[type] = sub;\r\n            };\r\n            var this_1 = this;\r\n            for (var _b = 0, _c = this.specs[name_1].types; _b < _c.length; _b++) {\r\n                var type = _c[_b];\r\n                _loop_1(type);\r\n            }\r\n        }\r\n    };\r\n    MessageReplayerImpl.prototype.processMessage = function (type, msg) {\r\n        if (this.isDone || !msg) {\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = this.specsNames; _i < _a.length; _i++) {\r\n            var name_2 = _a[_i];\r\n            if (this.specs[name_2].types.indexOf(type) !== -1) {\r\n                var messages = this.messages[name_2] || [];\r\n                this.messages[name_2] = messages;\r\n                messages.push(msg);\r\n            }\r\n        }\r\n    };\r\n    MessageReplayerImpl.prototype.drain = function (name, callback) {\r\n        if (callback) {\r\n            (this.messages[name] || []).forEach(callback);\r\n        }\r\n        delete this.messages[name];\r\n        for (var _i = 0, _a = this.specs[name].types; _i < _a.length; _i++) {\r\n            var type = _a[_i];\r\n            this.subsRefCount[type] -= 1;\r\n            if (this.subsRefCount[type] <= 0) {\r\n                this.connection.off(this.subs[type]);\r\n                delete this.subs[type];\r\n                delete this.subsRefCount[type];\r\n            }\r\n        }\r\n        delete this.specs[name];\r\n        if (!this.specs.length) {\r\n            this.isDone = true;\r\n        }\r\n    };\r\n    return MessageReplayerImpl;\r\n}());\r\nexports.MessageReplayerImpl = MessageReplayerImpl;\r\n//# sourceMappingURL=messageReplayer.js.map\n\n/***/ }),\n/* 81 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gw3Domain_1 = __webpack_require__(82);\r\nvar callback_registry_1 = __webpack_require__(1);\r\nfunction default_1(connection, settings, logger) {\r\n    var datePrefix = \"#T42_DATE#\";\r\n    var datePrefixLen = datePrefix.length;\r\n    var dateMinLen = datePrefixLen + 1;\r\n    var datePrefixFirstChar = datePrefix[0];\r\n    var registry = callback_registry_1.default();\r\n    var globalDomain;\r\n    var isLoggedIn = false;\r\n    var shouldTryLogin = true;\r\n    var initialLogin = true;\r\n    var initialLoginAttempts = 3;\r\n    var initialLoginAttemptsInterval = 500;\r\n    var pingTimer;\r\n    var sessions = [];\r\n    var loginConfig;\r\n    connection.disconnected(handleDisconnected.bind(this));\r\n    ping();\r\n    function processStringMessage(message) {\r\n        var msg = JSON.parse(message, function (key, value) {\r\n            if (typeof value !== \"string\") {\r\n                return value;\r\n            }\r\n            if (value.length < dateMinLen) {\r\n                return value;\r\n            }\r\n            if (value[0] !== datePrefixFirstChar) {\r\n                return value;\r\n            }\r\n            if (value.substring(0, datePrefixLen) !== datePrefix) {\r\n                return value;\r\n            }\r\n            try {\r\n                var milliseconds = parseInt(value.substring(datePrefixLen, value.length), 10);\r\n                if (isNaN(milliseconds)) {\r\n                    return value;\r\n                }\r\n                return new Date(milliseconds);\r\n            }\r\n            catch (ex) {\r\n                return value;\r\n            }\r\n        });\r\n        return {\r\n            msg: msg,\r\n            msgType: msg.type,\r\n        };\r\n    }\r\n    function createStringMessage(product, type, message, id) {\r\n        var oldToJson = Date.prototype.toJSON;\r\n        try {\r\n            Date.prototype.toJSON = function () {\r\n                return datePrefix + this.getTime();\r\n            };\r\n            var result = JSON.stringify(message);\r\n            return result;\r\n        }\r\n        finally {\r\n            Date.prototype.toJSON = oldToJson;\r\n        }\r\n    }\r\n    function processObjectMessage(message) {\r\n        if (!message.type) {\r\n            throw new Error(\"Object should have type property\");\r\n        }\r\n        return {\r\n            msg: message,\r\n            msgType: message.type,\r\n        };\r\n    }\r\n    function createObjectMessage(product, type, message, id) {\r\n        return message;\r\n    }\r\n    function login(config) {\r\n        logger.debug(\"logging in...\");\r\n        loginConfig = config;\r\n        if (!loginConfig) {\r\n            loginConfig = { username: \"\", password: \"\" };\r\n        }\r\n        shouldTryLogin = true;\r\n        return new Promise(function (resolve, reject) {\r\n            var authentication = {};\r\n            connection.gatewayToken = config.gatewayToken;\r\n            if (connection.gatewayToken) {\r\n                authentication.method = \"gateway-token\";\r\n                authentication.token = connection.gatewayToken;\r\n            }\r\n            else if (config.token) {\r\n                authentication.method = \"access-token\";\r\n                authentication.token = config.token;\r\n            }\r\n            else if (config.username) {\r\n                authentication.method = \"secret\";\r\n                authentication.login = config.username;\r\n                authentication.secret = config.password;\r\n            }\r\n            else {\r\n                throw new Error(\"invalid auth message\" + JSON.stringify(config));\r\n            }\r\n            var helloMsg = {\r\n                type: \"hello\",\r\n                identity: settings.identity,\r\n                authentication: authentication,\r\n            };\r\n            globalDomain = gw3Domain_1.default(\"global\", connection, logger, [\r\n                \"welcome\",\r\n                \"token\"\r\n            ]);\r\n            var sendOptions = { skipPeerId: true };\r\n            if (initialLogin) {\r\n                sendOptions.retryInterval = settings.reconnectInterval;\r\n                sendOptions.maxRetries = settings.reconnectAttempts;\r\n            }\r\n            globalDomain.send(helloMsg, undefined, sendOptions)\r\n                .then(function (msg) {\r\n                initialLogin = false;\r\n                logger.debug(\"login successful with PeerId \" + msg.peer_id);\r\n                connection.peerId = msg.peer_id;\r\n                connection.resolvedIdentity = msg.resolved_identity;\r\n                connection.availableDomains = msg.available_domains;\r\n                if (msg.options) {\r\n                    connection.token = msg.options.access_token;\r\n                    connection.info = msg.options.info;\r\n                }\r\n                setLoggedIn(true);\r\n                resolve(msg.resolved_identity);\r\n            })\r\n                .catch(function (err) {\r\n                logger.error(\"error sending hello message - \" + err);\r\n                reject(err);\r\n            });\r\n        });\r\n    }\r\n    function logout() {\r\n        logger.debug(\"logging out...\");\r\n        shouldTryLogin = false;\r\n        if (pingTimer) {\r\n            clearTimeout(pingTimer);\r\n        }\r\n        sessions.forEach(function (session) {\r\n            session.leave();\r\n        });\r\n    }\r\n    function loggedIn(callback) {\r\n        if (isLoggedIn) {\r\n            callback();\r\n        }\r\n        return registry.add(\"onLoggedIn\", callback);\r\n    }\r\n    function domain(domainName, domainLogger, successMessages, errorMessages) {\r\n        var session = sessions.filter(function (s) { return s.domain === domainName; })[0];\r\n        if (!session) {\r\n            session = gw3Domain_1.default(domainName, connection, domainLogger, successMessages, errorMessages);\r\n            sessions.push(session);\r\n        }\r\n        return session;\r\n    }\r\n    function handleDisconnected() {\r\n        setLoggedIn(false);\r\n        var tryToLogin = shouldTryLogin;\r\n        if (tryToLogin && initialLogin) {\r\n            if (initialLoginAttempts <= 0) {\r\n                return;\r\n            }\r\n            initialLoginAttempts--;\r\n        }\r\n        logger.debug(\"disconnected - will try new login?\" + shouldTryLogin);\r\n        if (shouldTryLogin) {\r\n            connection.login(loginConfig)\r\n                .catch(function () {\r\n                setTimeout(handleDisconnected, 1000);\r\n            });\r\n        }\r\n    }\r\n    function setLoggedIn(value) {\r\n        isLoggedIn = value;\r\n        if (isLoggedIn) {\r\n            registry.execute(\"onLoggedIn\");\r\n        }\r\n    }\r\n    function ping() {\r\n        if (!shouldTryLogin) {\r\n            return;\r\n        }\r\n        if (isLoggedIn) {\r\n            connection.send(\"\", \"\", { type: \"ping\" });\r\n        }\r\n        pingTimer = setTimeout(ping, 30 * 1000);\r\n    }\r\n    function authToken() {\r\n        var createTokenReq = {\r\n            type: \"create-token\"\r\n        };\r\n        return globalDomain.send(createTokenReq)\r\n            .then(function (res) {\r\n            return res.token;\r\n        });\r\n    }\r\n    return {\r\n        processStringMessage: processStringMessage,\r\n        createStringMessage: createStringMessage,\r\n        createObjectMessage: createObjectMessage,\r\n        processObjectMessage: processObjectMessage,\r\n        login: login,\r\n        logout: logout,\r\n        loggedIn: loggedIn,\r\n        domain: domain,\r\n        authToken: authToken,\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=gw3.js.map\n\n/***/ }),\n/* 82 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callbackRegistry = __webpack_require__(1);\r\nvar shortid_1 = __webpack_require__(7);\r\nfunction default_1(domain, connection, logger, successMessages, errorMessages) {\r\n    if (domain == null) {\r\n        domain = \"global\";\r\n    }\r\n    var isJoined = false;\r\n    var tryReconnecting = false;\r\n    var _latestOptions;\r\n    var _connectionOn = false;\r\n    var callbacks = callbackRegistry();\r\n    connection.disconnected(handleConnectionDisconnected);\r\n    connection.loggedIn(handleConnectionLoggedIn);\r\n    connection.on(domain, \"success\", function (msg) { return handleSuccessMessage(msg); });\r\n    connection.on(domain, \"error\", function (msg) { return handleErrorMessage(msg); });\r\n    connection.on(domain, \"result\", function (msg) { return handleSuccessMessage(msg); });\r\n    if (successMessages) {\r\n        successMessages.forEach(function (sm) {\r\n            connection.on(domain, sm, function (msg) { return handleSuccessMessage(msg); });\r\n        });\r\n    }\r\n    if (errorMessages) {\r\n        errorMessages.forEach(function (sm) {\r\n            connection.on(domain, sm, function (msg) { return handleErrorMessage(msg); });\r\n        });\r\n    }\r\n    var requestsMap = {};\r\n    function join(options) {\r\n        _latestOptions = options;\r\n        return new Promise(function (resolve, reject) {\r\n            if (isJoined) {\r\n                resolve();\r\n                return;\r\n            }\r\n            var joinPromise;\r\n            if (domain === \"global\") {\r\n                joinPromise = _connectionOn ? Promise.resolve({}) : Promise.reject(\"not connected to gateway\");\r\n            }\r\n            else {\r\n                logger.debug(\"joining \" + domain);\r\n                var joinMsg = {\r\n                    type: \"join\",\r\n                    destination: domain,\r\n                    domain: \"global\",\r\n                    options: options,\r\n                };\r\n                joinPromise = send(joinMsg);\r\n            }\r\n            joinPromise\r\n                .then(function () {\r\n                handleJoined();\r\n                resolve();\r\n            })\r\n                .catch(function (err) {\r\n                logger.debug(\"error joining \" + domain + \" domain: \" + JSON.stringify(err));\r\n                reject(err);\r\n            });\r\n        });\r\n    }\r\n    function leave() {\r\n        if (domain === \"global\") {\r\n            return;\r\n        }\r\n        logger.debug(\"stopping session \" + domain + \"...\");\r\n        var leaveMsg = {\r\n            type: \"leave\",\r\n            destination: domain,\r\n            domain: \"global\",\r\n        };\r\n        send(leaveMsg).then(function () {\r\n            isJoined = false;\r\n            callbacks.execute(\"onLeft\");\r\n        });\r\n    }\r\n    function handleJoined() {\r\n        logger.debug(\"did join \" + domain);\r\n        isJoined = true;\r\n        var wasReconnect = tryReconnecting;\r\n        tryReconnecting = false;\r\n        callbacks.execute(\"onJoined\", wasReconnect);\r\n    }\r\n    function handleConnectionDisconnected() {\r\n        _connectionOn = false;\r\n        logger.warn(\"connection is down\");\r\n        isJoined = false;\r\n        tryReconnecting = true;\r\n        callbacks.execute(\"onLeft\", { disconnected: true });\r\n    }\r\n    function handleConnectionLoggedIn() {\r\n        _connectionOn = true;\r\n        if (tryReconnecting) {\r\n            logger.info(\"connection is now up - trying to reconnect...\");\r\n            join(_latestOptions);\r\n        }\r\n    }\r\n    function onJoined(callback) {\r\n        if (isJoined) {\r\n            callback(false);\r\n        }\r\n        return callbacks.add(\"onJoined\", callback);\r\n    }\r\n    function onLeft(callback) {\r\n        if (!isJoined) {\r\n            callback();\r\n        }\r\n        return callbacks.add(\"onLeft\", callback);\r\n    }\r\n    function handleErrorMessage(msg) {\r\n        if (domain !== msg.domain) {\r\n            return;\r\n        }\r\n        var requestId = msg.request_id;\r\n        var entry = requestsMap[requestId];\r\n        if (!entry) {\r\n            return;\r\n        }\r\n        entry.error(msg);\r\n    }\r\n    function handleSuccessMessage(msg) {\r\n        if (msg.domain !== domain) {\r\n            return;\r\n        }\r\n        var requestId = msg.request_id;\r\n        var entry = requestsMap[requestId];\r\n        if (!entry) {\r\n            return;\r\n        }\r\n        entry.success(msg);\r\n    }\r\n    function getNextRequestId() {\r\n        return shortid_1.generate();\r\n    }\r\n    function send(msg, tag, options) {\r\n        options = options || {};\r\n        msg.request_id = msg.request_id || getNextRequestId();\r\n        msg.domain = msg.domain || domain;\r\n        if (!options.skipPeerId) {\r\n            msg.peer_id = connection.peerId;\r\n        }\r\n        var requestId = msg.request_id;\r\n        return new Promise(function (resolve, reject) {\r\n            requestsMap[requestId] = {\r\n                success: function (successMsg) {\r\n                    delete requestsMap[requestId];\r\n                    successMsg._tag = tag;\r\n                    resolve(successMsg);\r\n                },\r\n                error: function (errorMsg) {\r\n                    logger.warn(\"GW error - \" + JSON.stringify(errorMsg) + \" for request \" + JSON.stringify(msg));\r\n                    delete requestsMap[requestId];\r\n                    errorMsg._tag = tag;\r\n                    reject(errorMsg);\r\n                },\r\n            };\r\n            connection\r\n                .send(domain, domain, msg, undefined, options)\r\n                .catch(function (err) {\r\n                requestsMap[requestId].error({ err: err });\r\n            });\r\n        });\r\n    }\r\n    function sendFireAndForget(msg) {\r\n        msg.request_id = msg.request_id ? msg.request_id : getNextRequestId();\r\n        msg.domain = msg.domain || domain;\r\n        msg.peer_id = connection.peerId;\r\n        connection.send(domain, domain, msg);\r\n    }\r\n    return {\r\n        join: join,\r\n        leave: leave,\r\n        onJoined: onJoined,\r\n        onLeft: onLeft,\r\n        send: send,\r\n        sendFireAndForget: sendFireAndForget,\r\n        on: function (type, callback) {\r\n            connection.on(domain, type, function (msg) {\r\n                if (msg.domain !== domain) {\r\n                    return;\r\n                }\r\n                try {\r\n                    callback(msg);\r\n                }\r\n                catch (e) {\r\n                    logger.error(\"Callback  failed: \" + e + \" \\n msg was: \" + JSON.stringify(msg));\r\n                }\r\n            });\r\n        },\r\n        loggedIn: function (callback) { return connection.loggedIn(callback); },\r\n        connected: function (callback) { return connection.connected(callback); },\r\n        disconnected: function (callback) { return connection.disconnected(callback); },\r\n        get peerId() {\r\n            return connection.peerId;\r\n        },\r\n        get domain() {\r\n            return domain;\r\n        },\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=gw3Domain.js.map\n\n/***/ }),\n/* 83 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar HCProtocol = (function () {\r\n    function HCProtocol() {\r\n    }\r\n    HCProtocol.prototype.processStringMessage = function (message) {\r\n        var messageObj = JSON.parse(message);\r\n        return {\r\n            msg: messageObj,\r\n            msgType: messageObj.type,\r\n        };\r\n    };\r\n    HCProtocol.prototype.createStringMessage = function (product, type, message, id) {\r\n        return JSON.stringify(message);\r\n    };\r\n    HCProtocol.prototype.login = function (message) {\r\n        return Promise.resolve({ application: undefined });\r\n    };\r\n    HCProtocol.prototype.logout = function () {\r\n    };\r\n    HCProtocol.prototype.loggedIn = function (callback) {\r\n        callback();\r\n        return function () {\r\n        };\r\n    };\r\n    HCProtocol.prototype.processObjectMessage = function (message) {\r\n        throw new Error(\"not supported\");\r\n    };\r\n    HCProtocol.prototype.createObjectMessage = function (product, type, message, id) {\r\n        throw new Error(\"not supported\");\r\n    };\r\n    return HCProtocol;\r\n}());\r\nexports.default = HCProtocol;\r\n//# sourceMappingURL=hc.js.map\n\n/***/ }),\n/* 84 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar HCTransport = (function () {\r\n    function HCTransport() {\r\n        this.connectionId = Math.floor(1e10 * Math.random()).toString();\r\n    }\r\n    HCTransport.prototype.send = function (message, product, type) {\r\n        if (product === \"metrics\") {\r\n            window.htmlContainer.metricsFacade.send(type, message);\r\n        }\r\n        else if (product === \"log\") {\r\n            window.htmlContainer.loggingFacade.send(type, message);\r\n        }\r\n        return Promise.resolve(undefined);\r\n    };\r\n    HCTransport.prototype.onConnectedChanged = function (callback) {\r\n        callback(true);\r\n    };\r\n    HCTransport.prototype.onMessage = function (callback) {\r\n    };\r\n    HCTransport.prototype.close = function () {\r\n    };\r\n    HCTransport.prototype.open = function () {\r\n    };\r\n    return HCTransport;\r\n}());\r\nexports.default = HCTransport;\r\n//# sourceMappingURL=hc.js.map\n\n/***/ }),\n/* 85 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar Inproc = (function () {\r\n    function Inproc(token, gw, logger) {\r\n        this.registry = callback_registry_1.default();\r\n        this.gw = gw;\r\n        this.gwToken = token;\r\n        this.logger = logger;\r\n        this.connectToken = this.gw.connect(this.gwToken, this.messageHandler.bind(this));\r\n    }\r\n    Object.defineProperty(Inproc.prototype, \"isObjectBasedTransport\", {\r\n        get: function () {\r\n            return true;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Inproc.prototype.sendObject = function (msg) {\r\n        this.logger.debug(JSON.stringify(msg));\r\n        this.gw.send(this.connectToken, msg);\r\n        return Promise.resolve(undefined);\r\n    };\r\n    Inproc.prototype.send = function (msg, product, type) {\r\n        return Promise.reject(\"not supported\");\r\n    };\r\n    Inproc.prototype.onMessage = function (callback) {\r\n        return this.registry.add(\"onMessage\", callback);\r\n    };\r\n    Inproc.prototype.onConnectedChanged = function (callback) {\r\n        callback(true);\r\n    };\r\n    Inproc.prototype.close = function () {\r\n    };\r\n    Inproc.prototype.open = function () {\r\n    };\r\n    Inproc.prototype.messageHandler = function (msg) {\r\n        if (this.logger.consoleLevel() === \"trace\") {\r\n            this.logger.debug(JSON.stringify(msg));\r\n        }\r\n        this.registry.execute(\"onMessage\", msg);\r\n    };\r\n    return Inproc;\r\n}());\r\nexports.default = Inproc;\r\n//# sourceMappingURL=inproc.js.map\n\n/***/ }),\n/* 86 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar utils_1 = __webpack_require__(11);\r\nvar WebSocket = utils_1.default.isNode() ? __webpack_require__(45) : window.WebSocket;\r\nvar WS = (function () {\r\n    function WS(settings, logger) {\r\n        this._running = true;\r\n        this._initied = false;\r\n        this._registry = callback_registry_1.default();\r\n        this._settings = settings;\r\n        this._logger = logger;\r\n    }\r\n    WS.prototype.onMessage = function (callback) {\r\n        return this._registry.add(\"onMessage\", callback);\r\n    };\r\n    WS.prototype.send = function (msg, product, type, options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            options = options || {};\r\n            _this.waitForSocketConnection(function () {\r\n                try {\r\n                    _this._ws.send(msg);\r\n                    resolve();\r\n                }\r\n                catch (e) {\r\n                    reject(e);\r\n                }\r\n            }, reject, options.maxRetries, options.retryInterval);\r\n        });\r\n    };\r\n    WS.prototype.open = function () {\r\n        this._running = true;\r\n    };\r\n    WS.prototype.close = function () {\r\n        this._running = false;\r\n        this._ws.close();\r\n    };\r\n    WS.prototype.onConnectedChanged = function (callback) {\r\n        return this._registry.add(\"onConnectedChanged\", callback);\r\n    };\r\n    WS.prototype.initiateSocket = function () {\r\n        var _this = this;\r\n        this._logger.debug(\"initiating _ws to \" + this._settings.ws + \"...\");\r\n        this._ws = new WebSocket(this._settings.ws);\r\n        this._ws.onerror = function (err) {\r\n            _this.notifyStatusChanged(false, err);\r\n        };\r\n        this._ws.onclose = function () {\r\n            _this._logger.debug(\"_ws closed\");\r\n            _this.notifyStatusChanged(false);\r\n        };\r\n        this._ws.onopen = function () {\r\n            _this._logger.debug(\"_ws opened\");\r\n            _this.notifyStatusChanged(true);\r\n        };\r\n        this._ws.onmessage = function (message) {\r\n            _this._registry.execute(\"onMessage\", message.data);\r\n        };\r\n    };\r\n    WS.prototype.waitForSocketConnection = function (callback, failed, retriesLeft, retryInterval) {\r\n        var _this = this;\r\n        if (!callback) {\r\n            callback = function () { };\r\n        }\r\n        if (!failed) {\r\n            failed = function () { };\r\n        }\r\n        if (retryInterval === undefined) {\r\n            retryInterval = this._settings.reconnectInterval;\r\n        }\r\n        if (retriesLeft !== undefined) {\r\n            if (retriesLeft === 0) {\r\n                failed(\"wait for socket on \" + this._settings.ws + \" failed - no more retries left\");\r\n                return;\r\n            }\r\n            this._logger.debug(\"will retry \" + retriesLeft + \" more times (every \" + retryInterval + \" ms)\");\r\n        }\r\n        if (!this._running) {\r\n            failed(\"wait for socket on \" + this._settings.ws + \" failed - socket closed by user\");\r\n            return;\r\n        }\r\n        if (!this._ws || this._ws.readyState > 1) {\r\n            this.initiateSocket();\r\n        }\r\n        else if (this._ws.readyState === 1) {\r\n            return callback();\r\n        }\r\n        setTimeout(function () {\r\n            var retries = retriesLeft === undefined ? undefined : retriesLeft - 1;\r\n            _this.waitForSocketConnection(callback, failed, retries, retryInterval);\r\n        }, retryInterval);\r\n    };\r\n    WS.prototype.notifyStatusChanged = function (status, reason) {\r\n        this._registry.execute(\"onConnectedChanged\", status, reason);\r\n    };\r\n    return WS;\r\n}());\r\nexports.default = WS;\r\n//# sourceMappingURL=ws.js.map\n\n/***/ }),\n/* 87 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gw3ContextData_1 = __webpack_require__(88);\r\nvar helpers_1 = __webpack_require__(91);\r\nvar msg = __webpack_require__(25);\r\nvar contextMessageReplaySpec_1 = __webpack_require__(10);\r\nvar GW3Bridge = (function () {\r\n    function GW3Bridge(config) {\r\n        var _this = this;\r\n        this._contextNameToData = {};\r\n        this._gw3Subscriptions = [];\r\n        this._nextCallbackSubscriptionNumber = 0;\r\n        this._contextNameToId = {};\r\n        this._contextIdToName = {};\r\n        this._connection = config.connection;\r\n        this._logger = config.logger;\r\n        this._gw3Session = this._connection.domain(\"global\", this._logger, [\r\n            msg.GW_MESSAGE_CONTEXT_CREATED,\r\n            msg.GW_MESSAGE_SUBSCRIBED_CONTEXT,\r\n            msg.GW_MESSAGE_CONTEXT_DESTROYED,\r\n            msg.GW_MESSAGE_CONTEXT_UPDATED,\r\n        ]);\r\n        this.subscribeToContextCreatedMessages();\r\n        this.subscribeToContextUpdatedMessages();\r\n        this.subscribeToContextDestroyedMessages();\r\n        this._connection.replayer.drain(contextMessageReplaySpec_1.ContextMessageReplaySpec.name, function (message) {\r\n            var type = message.type;\r\n            if (!type) {\r\n                return;\r\n            }\r\n            if (type === msg.GW_MESSAGE_CONTEXT_CREATED ||\r\n                type === msg.GW_MESSAGE_CONTEXT_ADDED ||\r\n                type === msg.GW_MESSAGE_ACTIVITY_CREATED) {\r\n                _this.handleContextCreatedMessage(message);\r\n            }\r\n            else if (type === msg.GW_MESSAGE_SUBSCRIBED_CONTEXT ||\r\n                type === msg.GW_MESSAGE_CONTEXT_UPDATED ||\r\n                type === msg.GW_MESSAGE_JOINED_ACTIVITY) {\r\n                _this.handleContextUpdatedMessage(message);\r\n            }\r\n            else if (type === msg.GW_MESSAGE_CONTEXT_DESTROYED ||\r\n                type === msg.GW_MESSAGE_ACTIVITY_DESTROYED) {\r\n                _this.handleContextDestroyedMessage(message);\r\n            }\r\n        });\r\n    }\r\n    GW3Bridge.prototype.dispose = function () {\r\n        for (var _i = 0, _a = this._gw3Subscriptions; _i < _a.length; _i++) {\r\n            var sub = _a[_i];\r\n            this._connection.off(sub);\r\n        }\r\n        this._gw3Subscriptions.length = 0;\r\n        for (var contextName in this._contextNameToData) {\r\n            if (this._contextNameToId.hasOwnProperty(contextName)) {\r\n                delete this._contextNameToData[contextName];\r\n            }\r\n        }\r\n    };\r\n    GW3Bridge.prototype.createContext = function (name, data) {\r\n        var _this = this;\r\n        return this._gw3Session\r\n            .send({\r\n            type: msg.GW_MESSAGE_CREATE_CONTEXT,\r\n            domain: \"global\",\r\n            name: name,\r\n            data: data,\r\n            lifetime: \"retained\",\r\n        })\r\n            .then(function (createContextMsg) {\r\n            _this._contextNameToId[name] = createContextMsg.context_id;\r\n            if (!_this._contextIdToName[createContextMsg.context_id]) {\r\n                _this._contextIdToName[createContextMsg.context_id] = name;\r\n                var contextData = _this._contextNameToData[name] || new gw3ContextData_1.GW3ContextData(createContextMsg.context_id, name, true, null);\r\n                contextData.isAnnounced = true;\r\n                contextData.name = name;\r\n                contextData.contextId = createContextMsg.context_id;\r\n                _this._contextNameToData[name] = contextData;\r\n                contextData.context = createContextMsg.data;\r\n                contextData.sentExplicitSubscription = true;\r\n                if (contextData.context) {\r\n                    _this.invokeUpdateCallbacks(contextData, contextData.context);\r\n                }\r\n                return _this.update(name, data).then(function () { return createContextMsg.context_id; });\r\n            }\r\n            return createContextMsg.context_id;\r\n        });\r\n    };\r\n    GW3Bridge.prototype.all = function () {\r\n        var _this = this;\r\n        return Object.keys(this._contextNameToData)\r\n            .filter(function (name) { return _this._contextNameToData[name].isAnnounced; });\r\n    };\r\n    GW3Bridge.prototype.update = function (name, delta) {\r\n        var _this = this;\r\n        var contextData = this._contextNameToData[name];\r\n        if (!contextData || !contextData.isAnnounced) {\r\n            return this.createContext(name, delta);\r\n        }\r\n        var calculatedDelta = this.calculateContextDelta(contextData.context, delta);\r\n        if (!Object.keys(calculatedDelta.added).length\r\n            && !Object.keys(calculatedDelta.updated).length\r\n            && !calculatedDelta.removed.length) {\r\n            return Promise.resolve();\r\n        }\r\n        return this._gw3Session\r\n            .send({\r\n            type: msg.GW_MESSAGE_UPDATE_CONTEXT,\r\n            domain: \"global\",\r\n            context_id: contextData.contextId,\r\n            delta: calculatedDelta,\r\n        })\r\n            .then(function () {\r\n            _this.handleUpdated(contextData, calculatedDelta);\r\n        });\r\n    };\r\n    GW3Bridge.prototype.set = function (name, data) {\r\n        var _this = this;\r\n        var contextData = this._contextNameToData[name];\r\n        if (!contextData || !contextData.isAnnounced) {\r\n            return this.createContext(name, data);\r\n        }\r\n        return this._gw3Session\r\n            .send({\r\n            type: msg.GW_MESSAGE_UPDATE_CONTEXT,\r\n            domain: \"global\",\r\n            context_id: contextData.contextId,\r\n            delta: { reset: data },\r\n        })\r\n            .then(function () {\r\n            _this.handleUpdated(contextData, { reset: data, added: {}, removed: [], updated: {} });\r\n        });\r\n    };\r\n    GW3Bridge.prototype.get = function (name) {\r\n        var _this = this;\r\n        var contextData = this._contextNameToData[name];\r\n        if (!contextData || !contextData.isAnnounced) {\r\n            return new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\r\n                var _this = this;\r\n                return __generator(this, function (_a) {\r\n                    this.subscribe(name, function (data, un) {\r\n                        _this.unsubscribe(un);\r\n                        resolve(data);\r\n                    });\r\n                    return [2];\r\n                });\r\n            }); });\r\n        }\r\n        else {\r\n            return Promise.resolve(contextData.context);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribe = function (name, callback) {\r\n        var thisCallbackSubscriptionNumber = this._nextCallbackSubscriptionNumber;\r\n        this._nextCallbackSubscriptionNumber += 1;\r\n        var contextData = this._contextNameToData[name];\r\n        if (!contextData ||\r\n            !contextData.isAnnounced) {\r\n            contextData = contextData || new gw3ContextData_1.GW3ContextData(undefined, name, false, undefined);\r\n            this._contextNameToData[name] = contextData;\r\n            contextData.updateCallbacks[thisCallbackSubscriptionNumber] = callback;\r\n            return Promise.resolve(thisCallbackSubscriptionNumber);\r\n        }\r\n        var hadCallbacks = contextData.hasCallbacks();\r\n        contextData.updateCallbacks[thisCallbackSubscriptionNumber] = callback;\r\n        if (!hadCallbacks) {\r\n            if (!contextData.joinedActivity) {\r\n                if (contextData.context &&\r\n                    contextData.sentExplicitSubscription) {\r\n                    callback(contextData.context, thisCallbackSubscriptionNumber);\r\n                    return Promise.resolve(thisCallbackSubscriptionNumber);\r\n                }\r\n                return this.sendSubscribe(contextData)\r\n                    .then(function () { return thisCallbackSubscriptionNumber; });\r\n            }\r\n            else {\r\n                callback(contextData.context, thisCallbackSubscriptionNumber);\r\n                return Promise.resolve(thisCallbackSubscriptionNumber);\r\n            }\r\n        }\r\n        else {\r\n            callback(contextData.context, thisCallbackSubscriptionNumber);\r\n            return Promise.resolve(thisCallbackSubscriptionNumber);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.unsubscribe = function (subscriptionKey) {\r\n        for (var _i = 0, _a = Object.keys(this._contextNameToData); _i < _a.length; _i++) {\r\n            var name_1 = _a[_i];\r\n            var contextId = this._contextNameToId[name_1];\r\n            var contextData = this._contextNameToData[name_1];\r\n            if (!contextData) {\r\n                return;\r\n            }\r\n            var hadCallbacks = contextData.hasCallbacks();\r\n            delete contextData.updateCallbacks[subscriptionKey];\r\n            if (contextData.isAnnounced &&\r\n                hadCallbacks &&\r\n                !contextData.hasCallbacks() &&\r\n                contextData.sentExplicitSubscription) {\r\n                this.sendUnsubscribe(contextData);\r\n            }\r\n            if (!contextData.isAnnounced &&\r\n                !contextData.hasCallbacks()) {\r\n                delete this._contextNameToData[name_1];\r\n            }\r\n        }\r\n    };\r\n    GW3Bridge.prototype.handleUpdated = function (contextData, delta) {\r\n        var oldContext = contextData.context;\r\n        contextData.context = helpers_1.applyContextDelta(contextData.context, delta);\r\n        if (this._contextNameToData[contextData.name] === contextData &&\r\n            !helpers_1.deepEqual(oldContext, contextData.context)) {\r\n            this.invokeUpdateCallbacks(contextData, contextData.context);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribeToContextCreatedMessages = function () {\r\n        var createdMessageTypes = [\r\n            msg.GW_MESSAGE_CONTEXT_ADDED,\r\n            msg.GW_MESSAGE_CONTEXT_CREATED,\r\n            msg.GW_MESSAGE_ACTIVITY_CREATED,\r\n        ];\r\n        for (var _i = 0, createdMessageTypes_1 = createdMessageTypes; _i < createdMessageTypes_1.length; _i++) {\r\n            var createdMessageType = createdMessageTypes_1[_i];\r\n            var sub = this._connection.on(\"js-contexts\", createdMessageType, this.handleContextCreatedMessage.bind(this));\r\n            this._gw3Subscriptions.push(sub);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.handleContextCreatedMessage = function (contextCreatedMsg) {\r\n        var createdMessageType = contextCreatedMsg.type;\r\n        if (createdMessageType === msg.GW_MESSAGE_ACTIVITY_CREATED) {\r\n            this._contextNameToId[contextCreatedMsg.activity_id] = contextCreatedMsg.context_id;\r\n            this._contextIdToName[contextCreatedMsg.context_id] = contextCreatedMsg.activity_id;\r\n        }\r\n        else if (createdMessageType === msg.GW_MESSAGE_CONTEXT_ADDED) {\r\n            this._contextNameToId[contextCreatedMsg.name] = contextCreatedMsg.context_id;\r\n            this._contextIdToName[contextCreatedMsg.context_id] = contextCreatedMsg.name;\r\n        }\r\n        else if (createdMessageType === msg.GW_MESSAGE_CONTEXT_CREATED) {\r\n        }\r\n        var name = this._contextIdToName[contextCreatedMsg.context_id];\r\n        if (!name) {\r\n            throw new Error(\"Received created event for context with unknown name: \" + contextCreatedMsg.context_id);\r\n        }\r\n        if (!this._contextNameToId[name]) {\r\n            throw new Error(\"Received created event for context with unknown id: \" + contextCreatedMsg.context_id);\r\n        }\r\n        var contextData = this._contextNameToData[name];\r\n        if (contextData) {\r\n            if (contextData.isAnnounced) {\r\n                return;\r\n            }\r\n            else {\r\n                if (!contextData.hasCallbacks()) {\r\n                    throw new Error(\"Assertion failure: contextData.hasCallbacks()\");\r\n                }\r\n                contextData.isAnnounced = true;\r\n                contextData.contextId = contextCreatedMsg.context_id;\r\n                contextData.activityId = contextCreatedMsg.activity_id;\r\n                if (!contextData.sentExplicitSubscription) {\r\n                    this.sendSubscribe(contextData);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this._contextNameToData[name] = contextData =\r\n                new gw3ContextData_1.GW3ContextData(contextCreatedMsg.context_id, name, true, contextCreatedMsg.activity_id);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribeToContextUpdatedMessages = function () {\r\n        var updatedMessageTypes = [\r\n            msg.GW_MESSAGE_CONTEXT_UPDATED,\r\n            msg.GW_MESSAGE_SUBSCRIBED_CONTEXT,\r\n            msg.GW_MESSAGE_JOINED_ACTIVITY,\r\n        ];\r\n        for (var _i = 0, updatedMessageTypes_1 = updatedMessageTypes; _i < updatedMessageTypes_1.length; _i++) {\r\n            var updatedMessageType = updatedMessageTypes_1[_i];\r\n            var sub = this._connection.on(\"js-contexts\", updatedMessageType, this.handleContextUpdatedMessage.bind(this));\r\n            this._gw3Subscriptions.push(sub);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.handleContextUpdatedMessage = function (contextUpdatedMsg) {\r\n        var updatedMessageType = contextUpdatedMsg.type;\r\n        var contextId = contextUpdatedMsg.context_id;\r\n        var contextData = this._contextNameToData[this._contextIdToName[contextId]];\r\n        var justSeen = !contextData || !contextData.isAnnounced;\r\n        if (updatedMessageType === msg.GW_MESSAGE_JOINED_ACTIVITY) {\r\n            if (!contextData) {\r\n                contextData = new gw3ContextData_1.GW3ContextData(contextId, contextUpdatedMsg.activity_id, true, contextUpdatedMsg.activity_id);\r\n                this._contextNameToData[contextUpdatedMsg.activity_id] = contextData;\r\n                this._contextIdToName[contextId] = contextUpdatedMsg.activity_id;\r\n                this._contextNameToId[contextUpdatedMsg.activity_id] = contextId;\r\n            }\r\n            else {\r\n                contextData.contextId = contextId;\r\n                contextData.isAnnounced = true;\r\n                contextData.activityId = contextUpdatedMsg.activity_id;\r\n            }\r\n            contextData.joinedActivity = true;\r\n        }\r\n        else {\r\n            if (!contextData || !contextData.isAnnounced) {\r\n                if (updatedMessageType === msg.GW_MESSAGE_SUBSCRIBED_CONTEXT) {\r\n                    contextData = contextData || new gw3ContextData_1.GW3ContextData(contextId, contextUpdatedMsg.name, true, null);\r\n                    contextData.sentExplicitSubscription = true;\r\n                    this._contextNameToData[contextUpdatedMsg.name] = contextData;\r\n                    this._contextIdToName[contextId] = contextUpdatedMsg.name;\r\n                    this._contextNameToId[contextUpdatedMsg.name] = contextId;\r\n                }\r\n                else {\r\n                    this._logger.error(\"Received 'update' for unknown context: \" + contextId);\r\n                }\r\n                return;\r\n            }\r\n        }\r\n        var oldContext = contextData.context;\r\n        if (updatedMessageType === msg.GW_MESSAGE_SUBSCRIBED_CONTEXT) {\r\n            contextData.context = contextUpdatedMsg.data || {};\r\n        }\r\n        else if (updatedMessageType === msg.GW_MESSAGE_JOINED_ACTIVITY) {\r\n            contextData.context = contextUpdatedMsg.context_snapshot || {};\r\n        }\r\n        else if (updatedMessageType === msg.GW_MESSAGE_CONTEXT_UPDATED) {\r\n            contextData.context = helpers_1.applyContextDelta(contextData.context, contextUpdatedMsg.delta);\r\n        }\r\n        else {\r\n            throw new Error(\"Unrecognized context update message \" + updatedMessageType);\r\n        }\r\n        if (justSeen ||\r\n            !helpers_1.deepEqual(contextData.context, oldContext) ||\r\n            updatedMessageType === msg.GW_MESSAGE_SUBSCRIBED_CONTEXT) {\r\n            this.invokeUpdateCallbacks(contextData, contextData.context);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.invokeUpdateCallbacks = function (contextData, data) {\r\n        for (var updateCallbackIndex in contextData.updateCallbacks) {\r\n            if (contextData.updateCallbacks.hasOwnProperty(updateCallbackIndex)) {\r\n                try {\r\n                    var updateCallback = contextData.updateCallbacks[updateCallbackIndex];\r\n                    updateCallback(helpers_1.deepClone(data), parseInt(updateCallbackIndex));\r\n                }\r\n                catch (err) {\r\n                    this._logger.debug(\"Callback error: \" + JSON.stringify(err));\r\n                }\r\n            }\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribeToContextDestroyedMessages = function () {\r\n        var destroyedMessageTypes = [\r\n            msg.GW_MESSAGE_CONTEXT_DESTROYED,\r\n            msg.GW_MESSAGE_ACTIVITY_DESTROYED,\r\n        ];\r\n        for (var _i = 0, destroyedMessageTypes_1 = destroyedMessageTypes; _i < destroyedMessageTypes_1.length; _i++) {\r\n            var destroyedMessageType = destroyedMessageTypes_1[_i];\r\n            var sub = this._connection.on(\"js-contexts\", destroyedMessageType, this.handleContextDestroyedMessage.bind(this));\r\n            this._gw3Subscriptions.push(sub);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.handleContextDestroyedMessage = function (destroyedMsg) {\r\n        var destroyedMessageType = destroyedMsg.type;\r\n        var contextId;\r\n        var name;\r\n        if (destroyedMessageType === msg.GW_MESSAGE_ACTIVITY_DESTROYED) {\r\n            name = destroyedMsg.activity_id;\r\n            contextId = this._contextNameToId[name];\r\n            if (!contextId) {\r\n                this._logger.error(\"Received 'destroyed' for unknown activity: \" + destroyedMsg.activity_id);\r\n                return;\r\n            }\r\n        }\r\n        else {\r\n            contextId = destroyedMsg.context_id;\r\n            name = this._contextIdToName[contextId];\r\n            if (!name) {\r\n                this._logger.error(\"Received 'destroyed' for unknown context: \" + destroyedMsg.context_id);\r\n                return;\r\n            }\r\n        }\r\n        delete this._contextIdToName[contextId];\r\n        delete this._contextNameToId[name];\r\n        var contextData = this._contextNameToData[name];\r\n        delete this._contextNameToData[name];\r\n        if (!contextData || !contextData.isAnnounced) {\r\n            this._logger.error(\"Received 'destroyed' for unknown context: \" + contextId);\r\n            return;\r\n        }\r\n    };\r\n    GW3Bridge.prototype.sendSubscribe = function (contextData) {\r\n        contextData.sentExplicitSubscription = true;\r\n        return this._gw3Session\r\n            .send({\r\n            type: msg.GW_MESSAGE_SUBSCRIBE_CONTEXT,\r\n            domain: \"global\",\r\n            context_id: contextData.contextId,\r\n        }).then(function (_) { return undefined; });\r\n    };\r\n    GW3Bridge.prototype.sendUnsubscribe = function (contextData) {\r\n        contextData.sentExplicitSubscription = false;\r\n        return this._gw3Session\r\n            .send({\r\n            type: msg.GW_MESSAGE_UNSUBSCRIBE_CONTEXT,\r\n            domain: \"global\",\r\n            context_id: contextData.contextId,\r\n        }).then(function (_) { return undefined; });\r\n    };\r\n    GW3Bridge.prototype.calculateContextDelta = function (from, to) {\r\n        var delta = { added: {}, updated: {}, removed: [], reset: null };\r\n        if (from) {\r\n            for (var _i = 0, _a = Object.keys(from); _i < _a.length; _i++) {\r\n                var x = _a[_i];\r\n                if (Object.keys(to).indexOf(x) !== -1\r\n                    && to[x] !== null\r\n                    && !helpers_1.deepEqual(from[x], to[x])) {\r\n                    delta.updated[x] = to[x];\r\n                }\r\n            }\r\n        }\r\n        for (var _b = 0, _c = Object.keys(to); _b < _c.length; _b++) {\r\n            var x = _c[_b];\r\n            if (!from || (Object.keys(from).indexOf(x) === -1)) {\r\n                if (to[x] !== null) {\r\n                    delta.added[x] = to[x];\r\n                }\r\n            }\r\n            else if (to[x] === null) {\r\n                delta.removed.push(x);\r\n            }\r\n        }\r\n        return delta;\r\n    };\r\n    return GW3Bridge;\r\n}());\r\nexports.GW3Bridge = GW3Bridge;\r\n//# sourceMappingURL=gw3Bridge.js.map\n\n/***/ }),\n/* 88 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar GW3ContextData = (function () {\r\n    function GW3ContextData(contextId, name, isAnnounced, activityId) {\r\n        this.updateCallbacks = {};\r\n        this.contextId = contextId;\r\n        this.name = name;\r\n        this.isAnnounced = isAnnounced;\r\n        this.activityId = activityId;\r\n        this.context = {};\r\n    }\r\n    GW3ContextData.prototype.hasCallbacks = function () {\r\n        return Object.keys(this.updateCallbacks).length > 0;\r\n    };\r\n    GW3ContextData.prototype.getState = function () {\r\n        if (this.isAnnounced && this.hasCallbacks()) {\r\n            return 3;\r\n        }\r\n        if (this.isAnnounced) {\r\n            return 2;\r\n        }\r\n        if (this.hasCallbacks()) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    return GW3ContextData;\r\n}());\r\nexports.GW3ContextData = GW3ContextData;\r\n//# sourceMappingURL=gw3ContextData.js.map\n\n/***/ }),\n/* 89 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar HCBridge = (function () {\r\n    function HCBridge(config) {\r\n        this._facade = window.htmlContainer.sharedContextFacade;\r\n    }\r\n    HCBridge.prototype.all = function () {\r\n        var allObj = this._facade.all();\r\n        if (!allObj || !allObj.keys) {\r\n            return [];\r\n        }\r\n        return allObj.keys;\r\n    };\r\n    HCBridge.prototype.update = function (name, delta) {\r\n        this._facade.update(name, delta);\r\n        return Promise.resolve();\r\n    };\r\n    HCBridge.prototype.set = function (name, data) {\r\n        this._facade.set(name, data);\r\n        return Promise.resolve();\r\n    };\r\n    HCBridge.prototype.subscribe = function (name, callback) {\r\n        var snapshot = null;\r\n        var key = this._facade.subscribe(name, function (data) {\r\n            if (!key) {\r\n                snapshot = data;\r\n                return;\r\n            }\r\n            if (snapshot) {\r\n                callback(snapshot, key);\r\n                snapshot = null;\r\n            }\r\n            callback(data, key);\r\n        });\r\n        if (snapshot) {\r\n            callback(snapshot, key);\r\n            snapshot = null;\r\n        }\r\n        return Promise.resolve(key);\r\n    };\r\n    HCBridge.prototype.get = function (name) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                this.subscribe(name, function (data, un) {\r\n                    _this.unsubscribe(un);\r\n                    resolve(data);\r\n                });\r\n                return [2];\r\n            });\r\n        }); });\r\n    };\r\n    HCBridge.prototype.unsubscribe = function (key) {\r\n        this._facade.unsubscribe(key);\r\n    };\r\n    return HCBridge;\r\n}());\r\nexports.HCBridge = HCBridge;\r\n//# sourceMappingURL=hcBridge.js.map\n\n/***/ }),\n/* 90 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gw3Bridge_1 = __webpack_require__(87);\r\nvar hcBridge_1 = __webpack_require__(89);\r\nvar ContextsModule = (function () {\r\n    function ContextsModule(config) {\r\n        this.config = config;\r\n        try {\r\n            if (config.gdMajorVersion === 2) {\r\n                var hc = window.htmlContainer;\r\n                if (!hc.sharedContextFacade) {\r\n                    throw new Error(\"Your version of HtmlContainer does not support contexts.\"\r\n                        + \" Get version 1.46.0.0 or later to have that feature.\");\r\n                }\r\n                this._bridge = new hcBridge_1.HCBridge(config);\r\n            }\r\n            else if (config.connection.protocolVersion === 3) {\r\n                this._bridge = new gw3Bridge_1.GW3Bridge(config);\r\n            }\r\n            else {\r\n                throw new Error(\"To use the Contexts library you must run in the\"\r\n                    + \" HTML Container or using a connection to Gateway v3.\");\r\n            }\r\n        }\r\n        catch (err) {\r\n            throw err;\r\n        }\r\n    }\r\n    ContextsModule.prototype.all = function () {\r\n        return this._bridge.all();\r\n    };\r\n    ContextsModule.prototype.update = function (name, delta) {\r\n        this.checkName(name);\r\n        return this._bridge.update(name, delta);\r\n    };\r\n    ContextsModule.prototype.set = function (name, data) {\r\n        this.checkName(name);\r\n        return this._bridge.set(name, data);\r\n    };\r\n    ContextsModule.prototype.subscribe = function (name, callback) {\r\n        var _this = this;\r\n        this.checkName(name);\r\n        return this._bridge\r\n            .subscribe(name, function (data, key) { return callback(data, function () { return _this._bridge.unsubscribe(key); }); })\r\n            .then(function (key) {\r\n            return function () {\r\n                _this._bridge.unsubscribe(key);\r\n            };\r\n        });\r\n    };\r\n    ContextsModule.prototype.get = function (name) {\r\n        return this._bridge.get(name);\r\n    };\r\n    ContextsModule.prototype.ready = function () {\r\n        return Promise.resolve(this);\r\n    };\r\n    ContextsModule.prototype.checkName = function (name) {\r\n        if (typeof name !== \"string\" ||\r\n            name == \"\") {\r\n            throw new Error(\"'name' must be non-empty string, got '\" + name + \"'\");\r\n        }\r\n    };\r\n    return ContextsModule;\r\n}());\r\nexports.ContextsModule = ContextsModule;\r\n//# sourceMappingURL=contextsModule.js.map\n\n/***/ }),\n/* 91 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction applyContextDelta(context, delta) {\r\n    if (delta) {\r\n        if (delta.reset) {\r\n            context = __assign({}, delta.reset);\r\n            return context;\r\n        }\r\n        context = deepClone(context, null);\r\n        var added_1 = delta.added;\r\n        var updated_1 = delta.updated;\r\n        var removed = delta.removed;\r\n        if (added_1) {\r\n            Object.keys(added_1).forEach(function (key) {\r\n                context[key] = added_1[key];\r\n            });\r\n        }\r\n        if (updated_1) {\r\n            Object.keys(updated_1).forEach(function (key) {\r\n                mergeObjectsProperties(key, context, updated_1);\r\n            });\r\n        }\r\n        if (removed) {\r\n            removed.forEach(function (key) {\r\n                delete context[key];\r\n            });\r\n        }\r\n    }\r\n    return context;\r\n}\r\nexports.applyContextDelta = applyContextDelta;\r\nfunction deepClone(obj, hash) {\r\n    hash = hash || new WeakMap();\r\n    if (Object(obj) !== obj) {\r\n        return obj;\r\n    }\r\n    if (obj instanceof Set) {\r\n        return new Set(obj);\r\n    }\r\n    if (hash.has(obj)) {\r\n        return hash.get(obj);\r\n    }\r\n    var result = obj instanceof Date ? new Date(obj)\r\n        : obj instanceof RegExp ? new RegExp(obj.source, obj.flags)\r\n            : obj.constructor ? new obj.constructor()\r\n                : Object.create(null);\r\n    hash.set(obj, result);\r\n    if (obj instanceof Map) {\r\n        Array.from(obj, function (_a) {\r\n            var key = _a[0], val = _a[1];\r\n            return result.set(key, deepClone(val, hash));\r\n        });\r\n    }\r\n    return Object.assign.apply(Object, [result].concat(Object.keys(obj).map(function (key) {\r\n        var _a;\r\n        return (_a = {}, _a[key] = deepClone(obj[key], hash), _a);\r\n    })));\r\n}\r\nexports.deepClone = deepClone;\r\nvar mergeObjectsProperties = function (key, what, withWhat) {\r\n    var right = withWhat[key];\r\n    if (right === undefined) {\r\n        return what;\r\n    }\r\n    var left = what[key];\r\n    if (!left || !right) {\r\n        what[key] = right;\r\n        return what;\r\n    }\r\n    if (typeof left === \"string\" ||\r\n        typeof left === \"number\" ||\r\n        typeof left === \"boolean\" ||\r\n        typeof right === \"string\" ||\r\n        typeof right === \"number\" ||\r\n        typeof right === \"boolean\" ||\r\n        Array.isArray(left) ||\r\n        Array.isArray(right)) {\r\n        what[key] = right;\r\n        return what;\r\n    }\r\n    what[key] = Object.assign({}, left, right);\r\n    return what;\r\n};\r\nfunction deepEqual(x, y) {\r\n    if (x === y) {\r\n        return true;\r\n    }\r\n    if (!(x instanceof Object) || !(y instanceof Object)) {\r\n        return false;\r\n    }\r\n    if (x.constructor !== y.constructor) {\r\n        return false;\r\n    }\r\n    for (var p in x) {\r\n        if (!x.hasOwnProperty(p)) {\r\n            continue;\r\n        }\r\n        if (!y.hasOwnProperty(p)) {\r\n            return false;\r\n        }\r\n        if (x[p] === y[p]) {\r\n            continue;\r\n        }\r\n        if (typeof (x[p]) !== \"object\") {\r\n            return false;\r\n        }\r\n        if (!deepEqual(x[p], y[p])) {\r\n            return false;\r\n        }\r\n    }\r\n    for (var p in y) {\r\n        if (y.hasOwnProperty(p) && !x.hasOwnProperty(p)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nexports.deepEqual = deepEqual;\r\n//# sourceMappingURL=helpers.js.map\n\n/***/ }),\n/* 92 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar contextsModule_1 = __webpack_require__(90);\r\nexports.ContextsModule = contextsModule_1.ContextsModule;\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 93 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LogLevel = (function () {\r\n    function LogLevel() {\r\n    }\r\n    LogLevel.canPublish = function (level, restriction) {\r\n        var levelIdx = LogLevel.order.indexOf(level);\r\n        var restrictionIdx = LogLevel.order.indexOf(restriction);\r\n        return levelIdx >= restrictionIdx;\r\n    };\r\n    LogLevel.off = \"off\";\r\n    LogLevel.trace = \"trace\";\r\n    LogLevel.debug = \"debug\";\r\n    LogLevel.info = \"info\";\r\n    LogLevel.warn = \"warn\";\r\n    LogLevel.error = \"error\";\r\n    LogLevel.order = [LogLevel.trace, LogLevel.debug, LogLevel.info, LogLevel.warn, LogLevel.error, LogLevel.off];\r\n    return LogLevel;\r\n}());\r\nexports.default = LogLevel;\r\n//# sourceMappingURL=levels.js.map\n\n/***/ }),\n/* 94 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar levels_1 = __webpack_require__(93);\r\nvar LoggerImpl = (function () {\r\n    function LoggerImpl(name, parent, metricSystem) {\r\n        this._subloggers = [];\r\n        this._name = name;\r\n        this._parent = parent;\r\n        if (parent) {\r\n            this._path = parent.path + \".\" + name;\r\n        }\r\n        else {\r\n            this._path = name;\r\n        }\r\n        this._loggerFullName = \"[\" + this._path + \"]\";\r\n        if (typeof metricSystem !== \"undefined\") {\r\n            this.metricsLevel(\"warn\", metricSystem.subSystem(name));\r\n        }\r\n    }\r\n    Object.defineProperty(LoggerImpl.prototype, \"name\", {\r\n        get: function () {\r\n            return this._name;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LoggerImpl.prototype, \"path\", {\r\n        get: function () {\r\n            return this._path;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LoggerImpl.prototype.subLogger = function (name) {\r\n        var existingSub = this._subloggers.filter(function (subLogger) {\r\n            return subLogger.name === name;\r\n        })[0];\r\n        if (existingSub !== undefined) {\r\n            return existingSub;\r\n        }\r\n        Object.keys(this).forEach(function (key) {\r\n            if (key === name) {\r\n                throw new Error(\"This sub logger name is not allowed.\");\r\n            }\r\n        });\r\n        var sub = new LoggerImpl(name, this);\r\n        this._subloggers.push(sub);\r\n        return sub;\r\n    };\r\n    LoggerImpl.prototype.publishLevel = function (level) {\r\n        if (level !== null && level !== undefined) {\r\n            this._publishLevel = level;\r\n        }\r\n        return this._publishLevel || this._parent.publishLevel();\r\n    };\r\n    LoggerImpl.prototype.consoleLevel = function (level) {\r\n        if (level !== null && level !== undefined) {\r\n            this._consoleLevel = level;\r\n        }\r\n        return this._consoleLevel || this._parent.consoleLevel();\r\n    };\r\n    LoggerImpl.prototype.metricsLevel = function (level, metricsSystem) {\r\n        if (level !== null && level !== undefined) {\r\n            this._metricLevel = level;\r\n        }\r\n        if (metricsSystem !== undefined) {\r\n            if (typeof metricsSystem === \"object\" && typeof metricsSystem.objectMetric === \"function\") {\r\n                this._metricSystem = metricsSystem;\r\n            }\r\n            else {\r\n                throw new Error(\"Please specify metric system\");\r\n            }\r\n        }\r\n        return this._metricLevel || this._parent.metricsLevel();\r\n    };\r\n    LoggerImpl.prototype.log = function (message, level) {\r\n        this.publishMessage(level || levels_1.default.info, message);\r\n    };\r\n    LoggerImpl.prototype.trace = function (message) {\r\n        this.log(message, levels_1.default.trace);\r\n    };\r\n    LoggerImpl.prototype.debug = function (message) {\r\n        this.log(message, levels_1.default.debug);\r\n    };\r\n    LoggerImpl.prototype.info = function (message) {\r\n        this.log(message, levels_1.default.info);\r\n    };\r\n    LoggerImpl.prototype.warn = function (message) {\r\n        this.log(message, levels_1.default.warn);\r\n    };\r\n    LoggerImpl.prototype.error = function (message) {\r\n        this.log(message, levels_1.default.error);\r\n    };\r\n    LoggerImpl.prototype.toAPIObject = function () {\r\n        var that = this;\r\n        return {\r\n            name: this.name,\r\n            subLogger: this.subLogger.bind(that),\r\n            publishLevel: this.publishLevel.bind(that),\r\n            consoleLevel: this.consoleLevel.bind(that),\r\n            metricsLevel: this.metricsLevel.bind(that),\r\n            log: this.log.bind(that),\r\n            trace: this.trace.bind(that),\r\n            debug: this.debug.bind(that),\r\n            info: this.info.bind(that),\r\n            warn: this.warn.bind(that),\r\n            error: this.error.bind(that),\r\n        };\r\n    };\r\n    LoggerImpl.prototype.publishMessage = function (level, message) {\r\n        var loggerName = this._loggerFullName;\r\n        if (level === levels_1.default.error) {\r\n            var e = new Error();\r\n            if (e.stack) {\r\n                message = message + \"\\n\" +\r\n                    (e.stack.split(\"\\n\").slice(3).join(\"\\n\"));\r\n            }\r\n        }\r\n        if (levels_1.default.canPublish(level, this.consoleLevel())) {\r\n            var toPrint = loggerName + \": \" + message;\r\n            switch (level) {\r\n                case levels_1.default.trace:\r\n                    console.trace(toPrint);\r\n                    break;\r\n                case levels_1.default.debug:\r\n                    if (console.debug) {\r\n                        console.debug(toPrint);\r\n                    }\r\n                    else {\r\n                        console.log(toPrint);\r\n                    }\r\n                    break;\r\n                case levels_1.default.info:\r\n                    console.info(toPrint);\r\n                    break;\r\n                case levels_1.default.warn:\r\n                    console.warn(toPrint);\r\n                    break;\r\n                case levels_1.default.error:\r\n                    console.error(toPrint);\r\n                    break;\r\n            }\r\n        }\r\n        if (levels_1.default.canPublish(level, this.publishLevel())) {\r\n            LoggerImpl.GetConnection().send(\"log\", \"LogMessage\", {\r\n                instance: LoggerImpl.Instance,\r\n                level: levels_1.default.order.indexOf(level),\r\n                logger: loggerName,\r\n                message: message,\r\n            });\r\n        }\r\n        if (levels_1.default.canPublish(level, this.metricsLevel())) {\r\n            if (this._metricSystem !== undefined) {\r\n                this._metricSystem.objectMetric(\"LogMessage\", {\r\n                    Level: level,\r\n                    Logger: loggerName,\r\n                    Message: message,\r\n                    Time: new Date(),\r\n                });\r\n                if (level === levels_1.default.error) {\r\n                    this._metricSystem.setState(100, message);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return LoggerImpl;\r\n}());\r\nexports.default = LoggerImpl;\r\n//# sourceMappingURL=logger.js.map\n\n/***/ }),\n/* 95 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar logger_1 = __webpack_require__(94);\r\nexports.default = (function (settings) {\r\n    var identity = settings.identity;\r\n    if (!identity) {\r\n        throw new Error(\"identity is missing\");\r\n    }\r\n    var identityStr = identity.system + \"\\\\\" + identity.service + \"\\\\\" + identity.instance;\r\n    logger_1.default.Instance = identityStr;\r\n    logger_1.default.GetConnection = settings.getConnection;\r\n    var mainLogger = new logger_1.default(\"main\");\r\n    mainLogger.publishLevel(settings.publish || \"off\");\r\n    mainLogger.consoleLevel(settings.console || \"info\");\r\n    mainLogger.metricsLevel(settings.metrics || \"off\");\r\n    var apiLogger = mainLogger.toAPIObject();\r\n    return apiLogger;\r\n});\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 96 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar glue_1 = __webpack_require__(30);\r\nvar pjson = __webpack_require__(13);\r\nif (typeof window !== \"undefined\") {\r\n    window.GlueCore = glue_1.default;\r\n}\r\nglue_1.default.default = glue_1.default;\r\nglue_1.default.version = pjson.version;\r\nmodule.exports = glue_1.default;\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 97 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction addressMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var conflation = definition.conflation;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.ADDRESS;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = addressMetric;\r\n//# sourceMappingURL=address.js.map\n\n/***/ }),\n/* 98 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction countMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || 0;\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.COUNT;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    function incrementBy(num) {\r\n        update(_value + num);\r\n    }\r\n    function increment() {\r\n        incrementBy(1);\r\n    }\r\n    function decrement() {\r\n        incrementBy(-1);\r\n    }\r\n    function decrementBy(num) {\r\n        incrementBy(num * -1);\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get path() {\r\n            return _path;\r\n        },\r\n        get value() {\r\n            return _value;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n        incrementBy: incrementBy,\r\n        increment: increment,\r\n        decrement: decrement,\r\n        decrementBy: decrementBy,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = countMetric;\r\n//# sourceMappingURL=count.js.map\n\n/***/ }),\n/* 99 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction numberMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _path = parent.path.slice(0);\r\n    var _value = value || 0;\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.NUMBER;\r\n    _path.push(parent.name);\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    function incrementBy(num) {\r\n        update(_value + num);\r\n    }\r\n    function increment() {\r\n        incrementBy(1);\r\n    }\r\n    function decrement() {\r\n        incrementBy(-1);\r\n    }\r\n    function decrementBy(num) {\r\n        incrementBy(num * -1);\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        type: type,\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n        incrementBy: incrementBy,\r\n        increment: increment,\r\n        decrement: decrement,\r\n        decrementBy: decrementBy,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = numberMetric;\r\n//# sourceMappingURL=number.js.map\n\n/***/ }),\n/* 100 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar metric_types_1 = __webpack_require__(0);\r\nvar helpers_1 = __webpack_require__(2);\r\nfunction objectMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.OBJECT;\r\n    function update(newValue) {\r\n        mergeValues(newValue);\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    function mergeValues(values) {\r\n        return Object.keys(_value).forEach(function (k) {\r\n            if (typeof values[k] !== \"undefined\") {\r\n                _value[k] = values[k];\r\n            }\r\n        });\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = objectMetric;\r\n//# sourceMappingURL=object.js.map\n\n/***/ }),\n/* 101 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction rateMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.RATE;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = rateMetric;\r\n//# sourceMappingURL=rate.js.map\n\n/***/ }),\n/* 102 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction statisticsMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.STATISTICS;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = statisticsMetric;\r\n//# sourceMappingURL=statistics.js.map\n\n/***/ }),\n/* 103 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction stringMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.STRING;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        type: type,\r\n        update: update,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = stringMetric;\r\n//# sourceMappingURL=string.js.map\n\n/***/ }),\n/* 104 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction timespanMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.TIMESPAN;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function start() {\r\n        update(true);\r\n    }\r\n    function stop() {\r\n        update(false);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        start: start,\r\n        stop: stop,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = timespanMetric;\r\n//# sourceMappingURL=timespan.js.map\n\n/***/ }),\n/* 105 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction timestampMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.TIMESTAMP;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function now() {\r\n        update(new Date());\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        now: now,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = timestampMetric;\r\n//# sourceMappingURL=timestamp.js.map\n\n/***/ }),\n/* 106 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar serializer_1 = __webpack_require__(107);\r\nfunction default_1(connection, config) {\r\n    var DEFAULT_HEARTBEAT_INTERVAL = 3000;\r\n    if (!connection || typeof connection !== \"object\") {\r\n        throw new Error(\"Connection is required parameter\");\r\n    }\r\n    var _connection = connection;\r\n    var heartbeatInterval = config.heartbeatInterval || DEFAULT_HEARTBEAT_INTERVAL;\r\n    var send = function (type, message) {\r\n        _connection.send(\"metrics\", type, message);\r\n    };\r\n    function sendFull(repo) {\r\n        if (!repo.root) {\r\n            return;\r\n        }\r\n        if (repo.root.subSystems.length === 0) {\r\n            return;\r\n        }\r\n        sendFullSystem(repo.root);\r\n    }\r\n    function sendFullSystem(system) {\r\n        createSystem(system);\r\n        system.subSystems.forEach(function (sub) {\r\n            sendFullSystem(sub);\r\n        });\r\n        system.metrics.forEach(function (metric) {\r\n            createMetric(metric);\r\n        });\r\n    }\r\n    function heartbeat(repo) {\r\n        send(\"HeartbeatMetrics\", {\r\n            publishingInterval: heartbeatInterval,\r\n            instance: repo.instance,\r\n        });\r\n    }\r\n    function createSystem(system) {\r\n        if (system.parent !== undefined) {\r\n            send(\"CreateMetricSystem\", {\r\n                id: system.id,\r\n                instance: system.repo.instance,\r\n                definition: {\r\n                    name: system.name,\r\n                    description: system.description,\r\n                    path: system.path,\r\n                },\r\n            });\r\n        }\r\n    }\r\n    function updateSystem(system, state) {\r\n        send(\"UpdateMetricSystem\", {\r\n            id: system.id,\r\n            instance: system.repo.instance,\r\n            state: state,\r\n        });\r\n    }\r\n    function createMetric(metric) {\r\n        send(\"CreateMetric\", serializer_1.default(metric));\r\n    }\r\n    function updateMetric(metric) {\r\n        send(\"UpdateMetric\", serializer_1.default(metric));\r\n    }\r\n    function init(repo) {\r\n        heartbeat(repo);\r\n        _connection.on(\"metrics\", \"MetricsSnapshotRequest\", function (instanceInfo) {\r\n            if (instanceInfo.Instance !== repo.instance) {\r\n                return;\r\n            }\r\n            sendFull(repo);\r\n        });\r\n        if (typeof window !== \"undefined\" && typeof window.htmlContainer === \"undefined\") {\r\n            setInterval(function () {\r\n                heartbeat(repo);\r\n            }, heartbeatInterval);\r\n        }\r\n    }\r\n    var me = {\r\n        createSystem: createSystem,\r\n        updateSystem: updateSystem,\r\n        createMetric: createMetric,\r\n        updateMetric: updateMetric,\r\n        init: init,\r\n    };\r\n    return me;\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=gw1.js.map\n\n/***/ }),\n/* 107 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction metricToMessage(metric) {\r\n    var definition = getMetricDefinition(metric.name, metric.value, metric.path, metric.type, metric.description, metric.period, metric.resolution, metric.conflation);\r\n    function getMetricDefinition(name, value, path, type, description, period, resolution, conflation) {\r\n        var _definition = {\r\n            name: name,\r\n            description: description,\r\n            type: type ? type : getTypeFromValue(value),\r\n            path: path,\r\n            resolution: resolution,\r\n            period: period,\r\n            conflation: conflation,\r\n        };\r\n        if (_definition.type === metric_types_1.default.OBJECT) {\r\n            _definition.Composite = Object.keys(value).reduce(function (arr, key) {\r\n                var val = value[key];\r\n                arr.push(getMetricDefinition(key, val, path));\r\n                return arr;\r\n            }, []);\r\n        }\r\n        return _definition;\r\n    }\r\n    function serializeValue(value, _metric) {\r\n        if (value && value.constructor === Date) {\r\n            return {\r\n                value: {\r\n                    type: _valueTypes.indexOf(\"date\"),\r\n                    value: value.valueOf(),\r\n                    isArray: false,\r\n                },\r\n            };\r\n        }\r\n        if (typeof value === \"object\") {\r\n            return {\r\n                CompositeValue: Object.keys(value).reduce(function (arr, key) {\r\n                    var val = serializeValue(value[key]);\r\n                    val.InnerMetricName = key;\r\n                    arr.push(val);\r\n                    return arr;\r\n                }, []),\r\n            };\r\n        }\r\n        var valueType = _metric ? _metric.getValueType() : undefined;\r\n        valueType = valueType || _valueTypes.indexOf(typeof value);\r\n        return {\r\n            value: {\r\n                type: valueType,\r\n                value: value,\r\n                isArray: false,\r\n            },\r\n        };\r\n    }\r\n    function getTypeFromValue(value) {\r\n        var typeAsString = value.constructor === Date ? \"timestamp\" : typeof value;\r\n        switch (typeAsString) {\r\n            case \"string\":\r\n                return metric_types_1.default.STRING;\r\n            case \"number\":\r\n                return metric_types_1.default.NUMBER;\r\n            case \"timestamp\":\r\n                return metric_types_1.default.TIMESTAMP;\r\n            case \"object\":\r\n                return metric_types_1.default.OBJECT;\r\n        }\r\n        return 0;\r\n    }\r\n    var _valueTypes = [\r\n        \"boolean\",\r\n        \"int\",\r\n        \"number\",\r\n        \"long\",\r\n        \"string\",\r\n        \"date\",\r\n        \"object\",\r\n    ];\r\n    return {\r\n        id: metric.id,\r\n        instance: metric.repo.instance,\r\n        definition: definition,\r\n        value: serializeValue(metric.value, metric),\r\n    };\r\n}\r\nexports.default = metricToMessage;\r\n//# sourceMappingURL=serializer.js.map\n\n/***/ }),\n/* 108 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar serializer_1 = __webpack_require__(109);\r\nfunction default_1(connection, config) {\r\n    if (!connection || typeof connection !== \"object\") {\r\n        throw new Error(\"Connection is required parameter\");\r\n    }\r\n    var joinPromise;\r\n    var session;\r\n    var init = function (repo) {\r\n        var resolveReadyPromise;\r\n        joinPromise = new Promise(function (resolve) {\r\n            resolveReadyPromise = resolve;\r\n        });\r\n        session = connection.domain(\"metrics\", config.logger);\r\n        session.onJoined(function (reconnect) {\r\n            if (!reconnect) {\r\n                resolveReadyPromise();\r\n                resolveReadyPromise = undefined;\r\n            }\r\n            var rootStateMetric = {\r\n                name: \"/State\",\r\n                type: \"object\",\r\n                composite: {\r\n                    Description: {\r\n                        type: \"string\",\r\n                        description: \"\",\r\n                    },\r\n                    Value: {\r\n                        type: \"number\",\r\n                        description: \"\",\r\n                    },\r\n                },\r\n                description: \"System state\",\r\n                context: {},\r\n            };\r\n            var defineRootMetricsMsg = {\r\n                type: \"define\",\r\n                metrics: [rootStateMetric],\r\n            };\r\n            session.send(defineRootMetricsMsg);\r\n            if (reconnect) {\r\n                replayRepo(repo);\r\n            }\r\n        });\r\n        session.join(config.identity);\r\n    };\r\n    var replayRepo = function (repo) {\r\n        replaySystem(repo.root);\r\n    };\r\n    var replaySystem = function (system) {\r\n        createSystem(system);\r\n        system.metrics.forEach(function (m) {\r\n            createMetric(m);\r\n        });\r\n        system.subSystems.forEach(function (ss) {\r\n            replaySystem(ss);\r\n        });\r\n    };\r\n    var createSystem = function (system) {\r\n        if (system.parent === undefined) {\r\n            return;\r\n        }\r\n        joinPromise.then(function () {\r\n            var metric = {\r\n                name: serializer_1.normalizeMetricName(system.path.join(\"/\") + \"/\" + system.name + \"/State\"),\r\n                type: \"object\",\r\n                composite: {\r\n                    Description: {\r\n                        type: \"string\",\r\n                        description: \"\",\r\n                    },\r\n                    Value: {\r\n                        type: \"number\",\r\n                        description: \"\",\r\n                    },\r\n                },\r\n                description: \"System state\",\r\n                context: {},\r\n            };\r\n            var createMetricsMsg = {\r\n                type: \"define\",\r\n                metrics: [metric],\r\n            };\r\n            session.send(createMetricsMsg);\r\n        });\r\n    };\r\n    var updateSystem = function (system, state) {\r\n        joinPromise.then(function () {\r\n            var shadowedUpdateMetric = {\r\n                type: \"publish\",\r\n                values: [{\r\n                        name: serializer_1.normalizeMetricName(system.path.join(\"/\") + \"/\" + system.name + \"/State\"),\r\n                        value: {\r\n                            Description: state.description,\r\n                            Value: state.state,\r\n                        },\r\n                        timestamp: Date.now(),\r\n                    }],\r\n            };\r\n            session.send(shadowedUpdateMetric);\r\n            var stateObj = serializer_1.composeMsgForRootStateMetric(system);\r\n            var rootMetric = {\r\n                type: \"publish\",\r\n                peer_id: connection.peerId,\r\n                values: [{\r\n                        name: \"/State\",\r\n                        value: {\r\n                            Description: stateObj.description,\r\n                            Value: stateObj.value,\r\n                        },\r\n                        timestamp: Date.now(),\r\n                    }],\r\n            };\r\n            session.send(rootMetric);\r\n        });\r\n    };\r\n    var createMetric = function (metric) {\r\n        joinPromise.then(function () {\r\n            var m = serializer_1.serializeMetric(metric);\r\n            var createMetricsMsg = {\r\n                type: \"define\",\r\n                metrics: [m],\r\n            };\r\n            session.send(createMetricsMsg);\r\n            if (typeof metric.value !== \"undefined\") {\r\n                updateMetric(metric);\r\n            }\r\n        });\r\n    };\r\n    var updateMetric = function (metric) {\r\n        joinPromise.then(function () {\r\n            var value = serializer_1.getMetricValueByType(metric);\r\n            var publishMetricsMsg = {\r\n                type: \"publish\",\r\n                values: [{\r\n                        name: serializer_1.normalizeMetricName(metric.path.join(\"/\") + \"/\" + metric.name),\r\n                        value: value,\r\n                        timestamp: Date.now(),\r\n                    }],\r\n            };\r\n            session.send(publishMetricsMsg);\r\n        });\r\n    };\r\n    return {\r\n        init: init,\r\n        createSystem: createSystem,\r\n        updateSystem: updateSystem,\r\n        createMetric: createMetric,\r\n        updateMetric: updateMetric,\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=gw3.js.map\n\n/***/ }),\n/* 109 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction getMetricTypeByValue(metric) {\r\n    if ((metric.value && metric.value.constructor === Date) || metric.type === metric_types_1.default.TIMESPAN || metric.type === metric_types_1.default.TIMESTAMP) {\r\n        return \"timestamp\";\r\n    }\r\n    else if (typeof metric.value === \"number\") {\r\n        return \"number\";\r\n    }\r\n    else if (typeof metric.value === \"string\" || metric.type === metric_types_1.default.STRING || metric.type === metric_types_1.default.RATE) {\r\n        return \"string\";\r\n    }\r\n    else if (typeof metric.value === \"object\") {\r\n        return \"object\";\r\n    }\r\n}\r\nfunction getTypeByValue(value) {\r\n    if (value.constructor === Date) {\r\n        return \"timestamp\";\r\n    }\r\n    else if (typeof value === \"number\") {\r\n        return \"number\";\r\n    }\r\n    else if (typeof value === \"string\") {\r\n        return \"string\";\r\n    }\r\n    else if (typeof value === \"object\") {\r\n        return \"object\";\r\n    }\r\n    else {\r\n        return \"string\";\r\n    }\r\n}\r\nfunction serializeMetric(metric) {\r\n    var serializedMetrics = {};\r\n    var type = getMetricTypeByValue(metric);\r\n    if (type === \"object\") {\r\n        var values = Object.keys(metric.value).reduce(function (memo, key) {\r\n            var innerType = getTypeByValue(metric.value[key]);\r\n            if (innerType === \"object\") {\r\n                var composite = defineNestedComposite(metric.value[key]);\r\n                memo[key] = {\r\n                    type: \"object\",\r\n                    description: \"\",\r\n                    context: {},\r\n                    composite: composite,\r\n                };\r\n            }\r\n            else {\r\n                memo[key] = {\r\n                    type: innerType,\r\n                    description: \"\",\r\n                    context: {},\r\n                };\r\n            }\r\n            return memo;\r\n        }, {});\r\n        serializedMetrics.composite = values;\r\n    }\r\n    serializedMetrics.name = normalizeMetricName(metric.path.join(\"/\") + \"/\" + metric.name);\r\n    serializedMetrics.type = type;\r\n    serializedMetrics.description = metric.description;\r\n    serializedMetrics.context = {};\r\n    return serializedMetrics;\r\n}\r\nexports.serializeMetric = serializeMetric;\r\nfunction defineNestedComposite(values) {\r\n    return Object.keys(values).reduce(function (memo, key) {\r\n        var type = getTypeByValue(values[key]);\r\n        if (type === \"object\") {\r\n            memo[key] = {\r\n                type: \"object\",\r\n                description: \"\",\r\n                context: {},\r\n                composite: defineNestedComposite(values[key]),\r\n            };\r\n        }\r\n        else {\r\n            memo[key] = {\r\n                type: type,\r\n                description: \"\",\r\n                context: {},\r\n            };\r\n        }\r\n        return memo;\r\n    }, {});\r\n}\r\nfunction normalizeMetricName(name) {\r\n    if (typeof name !== \"undefined\" && name.length > 0 && name[0] !== \"/\") {\r\n        return \"/\" + name;\r\n    }\r\n    else {\r\n        return name;\r\n    }\r\n}\r\nexports.normalizeMetricName = normalizeMetricName;\r\nfunction getMetricValueByType(metric) {\r\n    var type = getMetricTypeByValue(metric);\r\n    if (type === \"timestamp\") {\r\n        return Date.now();\r\n    }\r\n    else {\r\n        return publishNestedComposite(metric.value);\r\n    }\r\n}\r\nexports.getMetricValueByType = getMetricValueByType;\r\nfunction publishNestedComposite(values) {\r\n    if (typeof values !== \"object\") {\r\n        return values;\r\n    }\r\n    return Object.keys(values).reduce(function (memo, key) {\r\n        var value = values[key];\r\n        if (typeof value === \"object\" && value.constructor !== Date) {\r\n            memo[key] = publishNestedComposite(value);\r\n        }\r\n        else if (value.constructor === Date) {\r\n            memo[key] = new Date(value).getTime();\r\n        }\r\n        else if (value.constructor === Boolean) {\r\n            memo[key] = value.toString();\r\n        }\r\n        else {\r\n            memo[key] = value;\r\n        }\r\n        return memo;\r\n    }, {});\r\n}\r\nfunction flatten(arr) {\r\n    return arr.reduce(function (flat, toFlatten) {\r\n        return flat.concat(Array.isArray(toFlatten) ? flatten(toFlatten) : toFlatten);\r\n    }, []);\r\n}\r\nfunction getHighestState(arr) {\r\n    return arr.sort(function (a, b) {\r\n        return b.state - a.state;\r\n    })[0];\r\n}\r\nfunction aggregateDescription(arr) {\r\n    var msg = \"\";\r\n    arr.forEach(function (m, idx, a) {\r\n        var path = m.path.join(\".\");\r\n        if (idx === a.length - 1) {\r\n            msg += path + \".\" + m.name + \": \" + m.description;\r\n        }\r\n        else {\r\n            msg += path + \".\" + m.name + \": \" + m.description + \",\";\r\n        }\r\n    });\r\n    if (msg.length > 100) {\r\n        return msg.slice(0, 100) + \"...\";\r\n    }\r\n    else {\r\n        return msg;\r\n    }\r\n}\r\nfunction composeMsgForRootStateMetric(system) {\r\n    var aggregatedState = system.root.getAggregateState();\r\n    var merged = flatten(aggregatedState);\r\n    var highestState = getHighestState(merged);\r\n    var aggregateDesc = aggregateDescription(merged);\r\n    return {\r\n        description: aggregateDesc,\r\n        value: highestState.state,\r\n    };\r\n}\r\nexports.composeMsgForRootStateMetric = composeMsgForRootStateMetric;\r\n//# sourceMappingURL=serializer.js.map\n\n/***/ }),\n/* 110 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gw3_1 = __webpack_require__(108);\r\nvar gw1_1 = __webpack_require__(106);\r\nvar repository_1 = __webpack_require__(111);\r\nexports.default = (function (settings) {\r\n    var options = {\r\n        connection: settings.connection,\r\n        identity: settings.identity,\r\n        logger: settings.logger,\r\n        heartbeatInterval: settings.heartbeatInterval,\r\n        settings: {},\r\n        clickStream: settings.clickStream,\r\n    };\r\n    if (!options.connection || typeof options.connection !== \"object\") {\r\n        throw new Error(\"Connection is required parameter\");\r\n    }\r\n    var _protocol;\r\n    if (options.connection.protocolVersion === 3) {\r\n        _protocol = gw3_1.default(options.connection, settings);\r\n    }\r\n    else {\r\n        _protocol = gw1_1.default(options.connection, settings);\r\n    }\r\n    var repo = repository_1.default(options, _protocol);\r\n    var rootSystem = repo.root;\r\n    return rootSystem;\r\n});\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 111 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar system_1 = __webpack_require__(112);\r\nfunction repository(options, protocol) {\r\n    if (!options.identity) {\r\n        throw new Error(\"Identity missing from metrics configuration\");\r\n    }\r\n    if (!options.identity.service || typeof options.identity.service !== \"string\") {\r\n        throw new Error(\"Service missing or invalid in metrics identity configuration\");\r\n    }\r\n    if (!options.identity.system || typeof options.identity.system !== \"string\") {\r\n        throw new Error(\"System missing or invalid in metrics identity configuration\");\r\n    }\r\n    if (!options.identity.instance || typeof options.identity.instance !== \"string\") {\r\n        throw new Error(\"Instance missing or invalid in metrics identity configuration\");\r\n    }\r\n    var identity = options.identity;\r\n    var instance = options.identity.system + \"/\" + options.identity.service + \"/\" + options.identity.instance;\r\n    function _initSystemMetrics(rootSystem, useClickStream) {\r\n        if (typeof navigator !== \"undefined\") {\r\n            rootSystem.stringMetric(\"UserAgent\", navigator.userAgent);\r\n        }\r\n        if (useClickStream && typeof document !== \"undefined\") {\r\n            var clickStream_1 = rootSystem.subSystem(\"ClickStream\");\r\n            var documentClickHandler = function (e) {\r\n                if (!e.target) {\r\n                    return;\r\n                }\r\n                var target = e.target;\r\n                clickStream_1.objectMetric(\"LastBrowserEvent\", {\r\n                    type: \"click\",\r\n                    timestamp: new Date(),\r\n                    target: {\r\n                        className: e.target ? target.className : \"\",\r\n                        id: target.id,\r\n                        type: \"<\" + target.tagName.toLowerCase() + \">\",\r\n                        href: target.href || \"\",\r\n                    },\r\n                });\r\n            };\r\n            clickStream_1.objectMetric(\"Page\", {\r\n                title: document.title,\r\n                page: window.location.href,\r\n            });\r\n            if (document.addEventListener) {\r\n                document.addEventListener(\"click\", documentClickHandler);\r\n            }\r\n            else {\r\n                document.attachEvent(\"onclick\", documentClickHandler);\r\n            }\r\n        }\r\n        var startTime = rootSystem.stringMetric(\"StartTime\", (new Date()).toString());\r\n        var urlMetric = rootSystem.stringMetric(\"StartURL\", \"\");\r\n        var appNameMetric = rootSystem.stringMetric(\"AppName\", \"\");\r\n        if (typeof window !== \"undefined\") {\r\n            if (typeof window.location !== \"undefined\") {\r\n                var startUrl = window.location.href;\r\n                urlMetric.update(startUrl);\r\n            }\r\n            if (typeof window.glue42gd !== \"undefined\") {\r\n                appNameMetric.update(window.glue42gd.appName);\r\n            }\r\n        }\r\n    }\r\n    var me = {\r\n        identity: identity,\r\n        instance: instance,\r\n        get root() {\r\n            return _root;\r\n        },\r\n    };\r\n    protocol.init(me);\r\n    var _root = system_1.default(\"\", me, protocol);\r\n    _initSystemMetrics(_root, options.clickStream || options.clickStream === undefined);\r\n    return me;\r\n}\r\nexports.default = repository;\r\n//# sourceMappingURL=repository.js.map\n\n/***/ }),\n/* 112 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar address_1 = __webpack_require__(97);\r\nvar count_1 = __webpack_require__(98);\r\nvar number_1 = __webpack_require__(99);\r\nvar object_1 = __webpack_require__(100);\r\nvar rate_1 = __webpack_require__(101);\r\nvar statistics_1 = __webpack_require__(102);\r\nvar string_1 = __webpack_require__(103);\r\nvar timespan_1 = __webpack_require__(104);\r\nvar timestamp_1 = __webpack_require__(105);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction system(name, repo, protocol, parent, description) {\r\n    if (!repo) {\r\n        throw new Error(\"Repository is required\");\r\n    }\r\n    if (!protocol) {\r\n        throw new Error(\"Transport is required\");\r\n    }\r\n    var _transport = protocol;\r\n    var _name = name;\r\n    var _description = description || \"\";\r\n    var _repo = repo;\r\n    var _parent = parent;\r\n    var _path = _buildPath(parent);\r\n    var _state = {};\r\n    var id = _arrayToString(_path, \"/\") + name;\r\n    var identity = repo.identity;\r\n    var root = repo.root;\r\n    var _subSystems = [];\r\n    var _metrics = [];\r\n    function subSystem(nameSystem, descriptionSystem) {\r\n        if (!nameSystem || nameSystem.length === 0) {\r\n            throw new Error(\"name is required\");\r\n        }\r\n        var match = _subSystems.filter(function (s) { return s.name === nameSystem; });\r\n        if (match.length > 0) {\r\n            return match[0];\r\n        }\r\n        var _system = system(nameSystem, _repo, _transport, me, descriptionSystem);\r\n        _subSystems.push(_system);\r\n        return _system;\r\n    }\r\n    function setState(state, stateDescription) {\r\n        _state = { state: state, description: stateDescription };\r\n        _transport.updateSystem(me, _state);\r\n    }\r\n    function stringMetric(definition, value) {\r\n        return _getOrCreateMetric.call(me, definition, metric_types_1.default.STRING, value, function (metricDef) { return string_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function numberMetric(definition, value) {\r\n        return _getOrCreateMetric.call(me, definition, metric_types_1.default.NUMBER, value, function (metricDef) { return number_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function countMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.COUNT, value, function (metricDef) { return count_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function addressMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.ADDRESS, value, function (metricDef) { return address_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function objectMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.OBJECT, value, function (metricDef) { return object_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function timespanMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.TIMESPAN, value, function (metricDef) { return timespan_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function timestampMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.TIMESTAMP, value, function (metricDef) { return timestamp_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function rateMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.RATE, value, function (metricDef) { return rate_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function statisticsMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.STATISTICS, value, function (metricDef) { return statistics_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function _unionToMetricDef(def) {\r\n        var metricDefinition = {};\r\n        if (typeof def === \"string\") {\r\n            metricDefinition.name = def;\r\n        }\r\n        else {\r\n            metricDefinition = def;\r\n        }\r\n        if (metricDefinition.name === undefined) {\r\n            throw new Error(\"Metric name is required\");\r\n        }\r\n        return metricDefinition;\r\n    }\r\n    function _getOrCreateMetric(definition, expectedType, value, createMetric) {\r\n        var metricDefinition = _unionToMetricDef(definition);\r\n        var matching = _metrics.filter(function (shadowedMetric) { return shadowedMetric.name === metricDefinition.name; });\r\n        if (matching.length > 0) {\r\n            var existing = matching[0];\r\n            if (existing.type !== expectedType) {\r\n                throw new Error(\"A metric named \" + metricDefinition.name + \" is already defined with different type.\");\r\n            }\r\n            if (typeof value !== \"undefined\") {\r\n                existing.update(value);\r\n            }\r\n            return existing;\r\n        }\r\n        var metric = createMetric(metricDefinition);\r\n        _metrics.push(metric);\r\n        return metric;\r\n    }\r\n    function _buildPath(shadowedSystem) {\r\n        if (!shadowedSystem || !shadowedSystem.parent) {\r\n            return [];\r\n        }\r\n        var path = _buildPath(shadowedSystem.parent);\r\n        path.push(shadowedSystem.name);\r\n        return path;\r\n    }\r\n    function _arrayToString(path, separator) {\r\n        return ((path && path.length > 0) ? path.join(separator) : \"\");\r\n    }\r\n    function getAggregateState() {\r\n        var aggState = [];\r\n        if (Object.keys(_state).length > 0) {\r\n            aggState.push({\r\n                name: _name,\r\n                path: _path,\r\n                state: _state.state,\r\n                description: _state.description,\r\n            });\r\n        }\r\n        _subSystems.forEach(function (shadowedSubSystem) {\r\n            var result = shadowedSubSystem.getAggregateState();\r\n            if (result.length > 0) {\r\n                aggState.push.apply(aggState, result);\r\n            }\r\n        });\r\n        return aggState;\r\n    }\r\n    var me = {\r\n        get name() {\r\n            return _name;\r\n        },\r\n        get description() {\r\n            return _description;\r\n        },\r\n        get repo() {\r\n            return _repo;\r\n        },\r\n        get parent() {\r\n            return _parent;\r\n        },\r\n        path: _path,\r\n        id: id,\r\n        identity: identity,\r\n        root: root,\r\n        get subSystems() {\r\n            return _subSystems;\r\n        },\r\n        get metrics() {\r\n            return _metrics;\r\n        },\r\n        subSystem: subSystem,\r\n        getState: function () {\r\n            return _state;\r\n        },\r\n        setState: setState,\r\n        stringMetric: stringMetric,\r\n        statisticsMetric: statisticsMetric,\r\n        rateMetric: rateMetric,\r\n        timestampMetric: timestampMetric,\r\n        timespanMetric: timespanMetric,\r\n        objectMetric: objectMetric,\r\n        addressMetric: addressMetric,\r\n        countMetric: countMetric,\r\n        numberMetric: numberMetric,\r\n        getAggregateState: getAggregateState,\r\n    };\r\n    _transport.createSystem(me);\r\n    return me;\r\n}\r\nexports.default = system;\r\n//# sourceMappingURL=system.js.map\n\n/***/ }),\n/* 113 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction default_1() {\r\n    function now() {\r\n        return new Date().getTime();\r\n    }\r\n    var startTime = now();\r\n    var endTime;\r\n    var period;\r\n    function stop() {\r\n        endTime = now();\r\n        period = now() - startTime;\r\n        return period;\r\n    }\r\n    return {\r\n        get startTime() {\r\n            return startTime;\r\n        },\r\n        get endTime() {\r\n            return endTime;\r\n        },\r\n        get period() {\r\n            return period;\r\n        },\r\n        stop: stop\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=timer.js.map\n\n/***/ }),\n/* 114 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(12);\n\n/***/ }),\n/* 115 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(28);\n\n/***/ }),\n/* 116 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(29);\n\n/***/ }),\n/* 117 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(30);\n\n/***/ }),\n/* 118 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(31);\n\n/***/ }),\n/* 119 */\n/***/ (function(module, exports) {\n\nmodule.exports = __webpack_require__(34);\n\n/***/ })\n/******/ ]);\n});\n//# sourceMappingURL=tick42-glue-core.js.map\n\n/***/ }),\n/* 49 */\n/***/ (function(module, exports) {\n\nvar isFunction = function isFunction (arg) {return !!(arg && arg.constructor && arg.call && arg.apply);}\r\nvar nextTick = function nextTick (cb) { setTimeout(cb, 0); };\r\n\r\nmodule.exports = function (promise, successCallback, errorCallback) {\r\n    'use strict';\r\n    if (!isFunction(successCallback) && !isFunction(errorCallback)) {\r\n        return promise;\r\n    }\r\n\r\n    if (!isFunction(successCallback)) {\r\n        successCallback = function () {};\r\n    } else if (!isFunction(errorCallback)) {\r\n        errorCallback = function () {};        \r\n    }\r\n\r\n    promise.then(successCallback, errorCallback);\r\n}\r\n\n\n/***/ }),\n/* 50 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar promiseExtensions_1 = __webpack_require__(8);\r\nvar activityManagementAPI_1 = __webpack_require__(51);\r\nvar activityAGM_1 = __webpack_require__(9);\r\n/**\r\n * The entry points of activities API - accessible from glue.activities\r\n *\r\n * @module activities\r\n */\r\nvar ActivityAPI = /** @class */ (function () {\r\n    function ActivityAPI(manager, my) {\r\n        this._mgr = manager;\r\n        this._my = my;\r\n        this.all = new activityManagementAPI_1.ActivityManagementAPI(manager, my);\r\n    }\r\n    /**\r\n     * The entry point for your activity code.\r\n     *\r\n     * @function ready\r\n     * @returns {Promise<module:activities>} A promise for activity API\r\n     */\r\n    ActivityAPI.prototype.ready = function (callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            _this._mgr.ready()\r\n                .then(function () {\r\n                resolve(_this);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    Object.defineProperty(ActivityAPI.prototype, \"my\", {\r\n        /**\r\n         * A lightweight, single activity oriented subset of the API which should be used by most activity applications\r\n         *\r\n         * @var {module:my} my\r\n         */\r\n        get: function () {\r\n            return this._my;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityAPI.prototype, \"aware\", {\r\n        /**\r\n         * True if the current window is activity aware - meaning that the window has been created as\r\n         * an activity participant - either a helper or an independent window.\r\n         * Check this after the API is ready.\r\n         *\r\n         * @var {bool} aware\r\n         */\r\n        get: function () {\r\n            return this._my.window !== undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityAPI.prototype, \"inActivity\", {\r\n        /**\r\n         * Returns true if the current window is activity aware and is currently participating in activity\r\n         *\r\n         * @var {bool} inActivity\r\n         */\r\n        get: function () {\r\n            return this.aware && this._my.activity !== undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityAPI.prototype, \"agm\", {\r\n        /**\r\n         * Defines an Activity-specific version of the AGM API which:\r\n         * * restricts method registrations to activity-only windows\r\n         * * restricts method discovery and invocation to activity-only methods, unless you explicitly specify otherwise\r\n         * Other than that, the API is pretty much the same.\r\n         *\r\n         * @var  {module:activityAGM} agm\r\n         *\r\n         */\r\n        get: function () {\r\n            if (!this.aware) {\r\n                // no agm if not activity aware\r\n                return undefined;\r\n            }\r\n            if (!this.inActivity) {\r\n                // if we're not in activity no\r\n                return new activityAGM_1.ActivityAGM(null);\r\n            }\r\n            return this._my.activity.agm;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Returns a list of frame colors that can be used as activity frame colors\r\n     *\r\n     * @returns {string[]}\r\n     */\r\n    ActivityAPI.prototype.getAvailableFrameColors = function () {\r\n        var frameColors;\r\n        var hc = window.htmlContainer;\r\n        if (hc) {\r\n            frameColors = hc.getFrameColors();\r\n        }\r\n        frameColors = frameColors || [];\r\n        return frameColors;\r\n    };\r\n    return ActivityAPI;\r\n}());\r\nexports.ActivityAPI = ActivityAPI;\r\n//# sourceMappingURL=activityAPI.js.map\n\n/***/ }),\n/* 51 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar util = __webpack_require__(0);\r\nvar ActivityManagementAPI = /** @class */ (function () {\r\n    function ActivityManagementAPI(manager, my) {\r\n        this._m = manager;\r\n        this._my = my;\r\n        this.activityTypes = {\r\n            get: this._getActivityTypesWrapper.bind(this),\r\n            register: this._m.registerActivityType.bind(this._m),\r\n            unregister: this._m.unregisterActivityType.bind(this._m),\r\n            subscribe: this._m.subscribeActivityTypeEvents.bind(this._m),\r\n            unsubscribe: undefined,\r\n            initiate: this._m.initiate.bind(this._m)\r\n        };\r\n        this.windowTypes = {\r\n            get: this._getWindowTypesWrapper.bind(this),\r\n            registerFactory: this._m.registerWindowFactory.bind(this._m),\r\n            unregisterFactory: this._m.unregisterWindowFactory.bind(this._m),\r\n            subscribe: this._m.subscribeWindowTypeEvents.bind(this._m),\r\n            unsubscribe: undefined\r\n        };\r\n        this.windows = {\r\n            get: this._m.getWindows.bind(this._m),\r\n            subscribe: this._m.subscribeWindowEvents.bind(this._m),\r\n            announce: this._m.announceWindow.bind(this._m),\r\n            unsubscribe: undefined,\r\n            create: this._m.createWindow.bind(this._m)\r\n        };\r\n        this.instances = {\r\n            get: this._m.getActivities.bind(this._m),\r\n            subscribe: this._m.subscribeActivityEvents.bind(this._m),\r\n            unsubscribe: undefined\r\n        };\r\n    }\r\n    ActivityManagementAPI.prototype.onAttached = function (callback) {\r\n        this._m.subscribeActivitiesAttached(callback);\r\n    };\r\n    ActivityManagementAPI.prototype.onDetached = function (callback) {\r\n        this._m.subscribeActivitiesDetached(callback);\r\n    };\r\n    ActivityManagementAPI.prototype.onActivityFrameColorChanged = function (callback) {\r\n        this._m.subscribeActivityFrameColorChanged(callback);\r\n    };\r\n    ActivityManagementAPI.prototype._getActivityTypesWrapper = function (name) {\r\n        if (util.isUndefined(name)) {\r\n            return this._m.getActivityTypes();\r\n        }\r\n        return this._m.getActivityType(name);\r\n    };\r\n    ActivityManagementAPI.prototype._getWindowTypesWrapper = function (name) {\r\n        if (util.isUndefined(name)) {\r\n            return this._m.getWindowTypes();\r\n        }\r\n        return this._m.getWindowType(name);\r\n    };\r\n    return ActivityManagementAPI;\r\n}());\r\nexports.ActivityManagementAPI = ActivityManagementAPI;\r\n//# sourceMappingURL=activityManagementAPI.js.map\n\n/***/ }),\n/* 52 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar entityEvent_1 = __webpack_require__(2);\r\nvar logger_1 = __webpack_require__(4);\r\nvar util = __webpack_require__(0);\r\n/**\r\n * A lightweight, single activity oriented subset of the API which should be used by most activity applications.\r\n * Provides access to the activity of your application (my.activity) and shortcuts to the most commonly used methods\r\n * (e.g. my.createWindow is a shortcut for my.activity.createWindow)\r\n *\r\n * @module my\r\n */\r\nvar ActivityMy = /** @class */ (function () {\r\n    function ActivityMy(manager, windows) {\r\n        var _this = this;\r\n        this._myAttached = [];\r\n        this._myDetached = [];\r\n        this._myAttachedTo = [];\r\n        this._myDetachedFrom = [];\r\n        this._myActivityFrameColorChanged = [];\r\n        this._myActivityJoinedCallbacks = [];\r\n        this._myActivityRemovedCallbacks = [];\r\n        this._myContextUpdateCallbacks = [];\r\n        this._logger = logger_1.Logger.Get(this);\r\n        this._m = manager;\r\n        manager.ready()\r\n            .then(function (am) {\r\n            // Subscribe for events for driving \"my\" logic\r\n            am.subscribeActivityContextChanged(_this._subscribeMyContextChanged.bind(_this));\r\n            am.subscribeWindowEvents(_this._subscribeMyWindowEvent.bind(_this));\r\n            am.subscribeActivitiesAttached(_this._subscribeActivitiesAttached.bind(_this));\r\n            am.subscribeActivitiesDetached(_this._subscribeActivitiesDetached.bind(_this));\r\n            if (windows) {\r\n                windows.onWindowFrameColorChanged(_this._subscribeWindowFrameColorChanged.bind(_this));\r\n            }\r\n        });\r\n    }\r\n    Object.defineProperty(ActivityMy.prototype, \"window\", {\r\n        /**\r\n         * The current activity window; can be undefined (if the window is not part of any activity)\r\n         *\r\n         * @var {Window} window\r\n         */\r\n        get: function () {\r\n            if (util.isUndefinedOrNull(this._w)) {\r\n                var announcedWindows = this._m.announcedWindows;\r\n                if (announcedWindows.length > 0) {\r\n                    this._w = announcedWindows[0];\r\n                }\r\n            }\r\n            return this._w;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityMy.prototype, \"activity\", {\r\n        /**\r\n         * The current activity that the application participates in.\r\n         * Can be undefined (if currently not part of any activity)\r\n         *\r\n         * @var {module:activity} activity\r\n         */\r\n        get: function () {\r\n            var myWin = this.window;\r\n            if (util.isUndefinedOrNull(myWin)) {\r\n                return undefined;\r\n            }\r\n            return myWin.activity;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Creates a new window and joins it to the activity\r\n     *\r\n     * @function createWindow\r\n     * @param {string| windowDefinition} windowType The type of the window to be created\r\n     * @returns {Promise<module:activityWindow>}\r\n     */\r\n    ActivityMy.prototype.createWindow = function (windowType) {\r\n        return this._m.createWindow(this.activity, windowType);\r\n    };\r\n    /**\r\n     * Creates a stacked set of windows and joins them to the\r\n     *\r\n     * @function createStackedWindows\r\n     * @param {string[] | windowDefinition[]} windowTypes The types of the windows to be created\r\n     * @param {number} timeout\r\n     * @returns {Promise<module:activityWindow[]>}\r\n     */\r\n    ActivityMy.prototype.createStackedWindows = function (windowTypes, timeout) {\r\n        return this._m.createStackedWindows(this.activity, windowTypes, timeout);\r\n    };\r\n    Object.defineProperty(ActivityMy.prototype, \"context\", {\r\n        /**\r\n         * The current activity context. To update use my.updateContext, to replace my.setContext\r\n         *\r\n         * @var {object} context\r\n         */\r\n        get: function () {\r\n            var activity = this.activity;\r\n            if (util.isUndefined(activity)) {\r\n                return {};\r\n            }\r\n            return activity.context;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Updates activity context using the properties from the context argument.\r\n     * If old context is {a:1, b:2, c:3} and invoking updateContext({b:3, c:null}) will result a context\r\n     * be {a:1, b:3}\r\n     *\r\n     * @function updateContext\r\n     * @param {object} context\r\n     * @return {Promise<object>}\r\n     */\r\n    ActivityMy.prototype.updateContext = function (context, callback) {\r\n        var activity = this.activity;\r\n        if (util.isUndefined(activity)) {\r\n            return new Promise(function (resolve, reject) {\r\n                reject(\"Not in activity\");\r\n            });\r\n        }\r\n        return activity.updateContext(context, callback);\r\n    };\r\n    /**\r\n     * Replaces the activity context with a new one.\r\n     *\r\n     * @function setContext\r\n     * @param {object} context   The new context\r\n     * @returns {Promise<Object>}\r\n     */\r\n    ActivityMy.prototype.setContext = function (context, callback) {\r\n        var activity = this.activity;\r\n        if (util.isUndefined(activity)) {\r\n            return new Promise(function (resolve, reject) {\r\n                reject(\"Not in activity\");\r\n            });\r\n        }\r\n        return activity.setContext(context, callback);\r\n    };\r\n    ActivityMy.prototype.onActivityJoined = function (callback) {\r\n        this._myActivityJoinedCallbacks.push(callback);\r\n        // replay joined event\r\n        var myWin = this.window;\r\n        if (!util.isUndefinedOrNull(myWin) && !util.isUndefinedOrNull(myWin.activity)) {\r\n            callback(myWin.activity);\r\n        }\r\n    };\r\n    ActivityMy.prototype.onActivityLeft = function (callback) {\r\n        this._myActivityRemovedCallbacks.push(callback);\r\n    };\r\n    /**\r\n     * Subscribe for context updates\r\n     *\r\n     * @function onContextChanged\r\n     * @param {contextChangedHandler} callback Handler function that will receive context related events\r\n     */\r\n    ActivityMy.prototype.onContextChanged = function (callback) {\r\n        this._myContextUpdateCallbacks.push(callback);\r\n        // publish initial event\r\n        var myWin = this.window;\r\n        if (util.isUndefinedOrNull(myWin)) {\r\n            return;\r\n        }\r\n        var activity = myWin.activity;\r\n        if (util.isUndefinedOrNull(activity)) {\r\n            return;\r\n        }\r\n        // NB: either the callback is added before the activity is recorded in the API, or\r\n        // the activity is recorded before the callback\r\n        // in the former case, when the activity is seen, the callback will be invoked in _notifyMyContextChanged\r\n        // in the latter, the callback will be invoked here\r\n        // in both cases, the callback will be invoked at least once as soon as an activity is recorded\r\n        // see \"long analysis for callback behavior in GW3: several cases\" for full explanation\r\n        callback(activity.context, activity.context, [], activity);\r\n    };\r\n    ActivityMy.prototype.clone = function (options, callback) {\r\n        var act = this.activity;\r\n        return this._m.clone(act, options, callback);\r\n    };\r\n    ActivityMy.prototype.attach = function (activity, tag) {\r\n        var activityId;\r\n        if (typeof activity === \"string\") {\r\n            activityId = activity;\r\n        }\r\n        else {\r\n            activityId = activity.id;\r\n        }\r\n        return this._m.attachActivities(activityId, this.activity.id, tag);\r\n    };\r\n    ActivityMy.prototype.onActivityAttached = function (callback) {\r\n        this._myAttached.push(callback);\r\n    };\r\n    ActivityMy.prototype.onActivityDetached = function (callback) {\r\n        this._myDetached.push(callback);\r\n    };\r\n    ActivityMy.prototype.onAttachedToActivity = function (callback) {\r\n        this._myAttachedTo.push(callback);\r\n    };\r\n    ActivityMy.prototype.onDetachedFromActivity = function (callback) {\r\n        this._myDetachedFrom.push(callback);\r\n    };\r\n    Object.defineProperty(ActivityMy.prototype, \"attached\", {\r\n        get: function () {\r\n            if (!this.activity) {\r\n                return [];\r\n            }\r\n            return this.activity.attached;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ActivityMy.prototype.setFrameColor = function (color, callback) {\r\n        if (this.activity) {\r\n            return this.activity.setFrameColor(color, callback);\r\n        }\r\n        else {\r\n            return Promise.resolve(null);\r\n        }\r\n    };\r\n    ActivityMy.prototype.getFrameColor = function () {\r\n        if (this.activity) {\r\n            return this.activity.getFrameColor();\r\n        }\r\n        return \"\";\r\n    };\r\n    ActivityMy.prototype.onFrameColorChanged = function (callback) {\r\n        this._myActivityFrameColorChanged.push(callback);\r\n    };\r\n    ActivityMy.prototype._subscribeMyContextChanged = function (activity, context, delta, removed) {\r\n        var myWin = this.window;\r\n        if (util.isUndefinedOrNull(myWin)) {\r\n            return;\r\n        }\r\n        var myActivity = myWin.activity;\r\n        if (util.isUndefinedOrNull(myActivity)) {\r\n            return;\r\n        }\r\n        // ignore events not related to my activity\r\n        if (activity.id !== myActivity.id) {\r\n            return;\r\n        }\r\n        this._notifyMyContextChanged(activity, context, delta, removed);\r\n    };\r\n    ActivityMy.prototype._subscribeMyWindowEvent = function (activity, window, event) {\r\n        if (util.isUndefinedOrNull(this.window)) {\r\n            return;\r\n        }\r\n        // ignore events not related to my window\r\n        if (this.window.id !== window.id) {\r\n            return;\r\n        }\r\n        if (event === entityEvent_1.EntityEventType.ActivityWindowJoinedActivity) {\r\n            this._notifyMyWindowEvent(activity, this._myActivityJoinedCallbacks);\r\n            // NB: tick42-contexts doesn't raise automatically an update event on join if the snapshot matches\r\n            // the currently recorded data\r\n            // revisited: however, it is pushing an update on subscribe() (which is performed by js-activity)\r\n            // long analysis for callback behavior in GW3: several cases\r\n            // 1 client calls onContextChanged before joined-activity arrives\r\n            // then callback is pushed but onContextChanged callback call is skipped\r\n            //    1-1 js-activity handles joined-activity first; it calls js-context subscribe\r\n            //    1-1-1 js-context has not seen the activity so far so it doesn't invoke an update\r\n            //    however, js-context then handles joined-activity and raises an update\r\n            //    1-1-2 js-context has seen the activity, so it raises an update\r\n            //    js-context then handles joined-activity and doesn't raise a second update unless the received snapshot is\r\n            //    different from the last seen context value (can this even happen?)\r\n            //    1-2 js-context handles joined-activity first\r\n            //    since js-activity is not subscribed, whether it raises an update or not, it's not propagated\r\n            //    js-activity then handles joined-activity, performs a subscribe and js-context raises an update\r\n            // 2 joined-activity arrives, whatever updates are raised by js-activity's subscribe() or js-context's\r\n            // message handler are not propagated since the callback is not pushed, client then calls onContextChanged,\r\n            // and the callback is called inside that\r\n            // also, the callback cannot be invoked first in 1 then 2 or first 2 then 1\r\n            // => in all cases, a callback is called exactly once as soon as (it's subscribed && the activity is joined)\r\n            // (in 1-1-2 it *might* be possible to be called twice, first with a slightly out of date context,\r\n            // then with the joined-activity snapshot, see \"different from the last seen context value\", but it's unlikely,\r\n            // and not a real issue anyway)\r\n            // in the HC case, however, case 1 doesn't work since js-context doesn't raise updates on subscribe() nor\r\n            // joining the activity (#deleteme TODO LATER MINOR: verify), so we need to raise it ourselves\r\n            // 2017-09-08: final revisit (@vnikolov)\r\n            // since SBGW_D-163 allows automatic subscription to contexts of pre-existing activities, 1-1-2 no longer works\r\n            // (we might have already seen the latest state before joined-activity so no update will be raised)\r\n            // for this reason I'm invoking notifyMyContextChanged unconditionally - so we might have multiple\r\n            // invocations; if this turns into a problem we might add a guard inside notifyMyContextChanged that\r\n            // checks we're not raising it twice with the same context value\r\n            //\r\n            // we might also get a duplicate raise if the sender of an update is also subscribed to the context\r\n            // if (this._m.usingHc) {\r\n            this._notifyMyContextChanged(activity, activity.context, null, null);\r\n            // }\r\n            // #deleteme TODO LATER MAJOR: what about the cases when we're not watching foreign activity contexts?\r\n        }\r\n        else if (event === entityEvent_1.EntityEventType.ActivityWindowLeftActivity) {\r\n            this._notifyMyWindowEvent(activity, this._myActivityRemovedCallbacks);\r\n            // #deleteme TODO LATER MINOR: should we send null update here?\r\n        }\r\n    };\r\n    ActivityMy.prototype._notifyMyWindowEvent = function (activity, callbackStore) {\r\n        var _this = this;\r\n        callbackStore.forEach(function (element) {\r\n            try {\r\n                element(activity, event);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._notifyMyContextChanged = function (activity, context, delta, removed) {\r\n        var _this = this;\r\n        delta = delta || {};\r\n        removed = removed || [];\r\n        this._myContextUpdateCallbacks.forEach(function (element) {\r\n            try {\r\n                element(context, delta, removed, activity);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._notifyAttached = function (state) {\r\n        var _this = this;\r\n        this._myAttached.forEach(function (cb) {\r\n            try {\r\n                cb(state);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._notifyDetached = function (state) {\r\n        var _this = this;\r\n        this._myDetached.forEach(function (cb) {\r\n            try {\r\n                cb(state);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._notifyAttachedTo = function (state) {\r\n        var _this = this;\r\n        this._myAttachedTo.forEach(function (cb) {\r\n            try {\r\n                cb(_this.activity, state);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._notifyDetachedFrom = function (detached, existing, state) {\r\n        var _this = this;\r\n        this._myDetachedFrom.forEach(function (cb) {\r\n            try {\r\n                cb(detached, existing, state);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._subscribeActivitiesAttached = function (newAct, state) {\r\n        var myWin = this.window;\r\n        if (util.isUndefinedOrNull(myWin)) {\r\n            return;\r\n        }\r\n        var myActivity = myWin.activity;\r\n        if (util.isUndefinedOrNull(myActivity)) {\r\n            return;\r\n        }\r\n        // ignore events not related to my activity\r\n        if (newAct.id !== myActivity.id) {\r\n            return;\r\n        }\r\n        if (state.windowIds.indexOf(myWin.id) >= 0) {\r\n            this._notifyAttachedTo(state);\r\n            return;\r\n        }\r\n        this._notifyAttached(state);\r\n    };\r\n    ActivityMy.prototype._subscribeActivitiesDetached = function (newAct, oldAct, state) {\r\n        var myWin = this.window;\r\n        if (util.isUndefinedOrNull(myWin)) {\r\n            return;\r\n        }\r\n        var myActivity = myWin.activity;\r\n        if (util.isUndefinedOrNull(myActivity)) {\r\n            return;\r\n        }\r\n        // ignore events not related to my activity\r\n        if (oldAct.id === myActivity.id) {\r\n            this._notifyDetached(state);\r\n        }\r\n        if (newAct.id === myActivity.id) {\r\n            this._notifyDetachedFrom(newAct, oldAct, state);\r\n        }\r\n    };\r\n    ActivityMy.prototype._subscribeWindowFrameColorChanged = function (window) {\r\n        var act = this.activity;\r\n        if (!act) {\r\n            return;\r\n        }\r\n        if (!act.owner) {\r\n            return;\r\n        }\r\n        if (act.owner.underlyingWindow.id === window.id) {\r\n            this._myActivityFrameColorChanged.forEach(function (callback) {\r\n                callback(window.frameColor);\r\n            });\r\n        }\r\n    };\r\n    return ActivityMy;\r\n}());\r\nexports.default = ActivityMy;\r\n//# sourceMappingURL=activityMyAPI.js.map\n\n/***/ }),\n/* 53 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gw3Bridge_1 = __webpack_require__(54);\r\nvar hcBridge_1 = __webpack_require__(14);\r\nvar activityMyAPI_1 = __webpack_require__(52);\r\nvar activityManager_1 = __webpack_require__(55);\r\nvar activityAPI_1 = __webpack_require__(50);\r\nvar activityAGM_1 = __webpack_require__(9);\r\nvar logger_1 = __webpack_require__(4);\r\nvar util = __webpack_require__(0);\r\nvar promiseExtensions_1 = __webpack_require__(8);\r\n/**\r\n * Activity context update handler - used when we want to subscribe for context changes in a specific activity\r\n *\r\n * @callback contextChangedHandler\r\n * @param {Object} context The full context of the activity after the update\r\n * @param {Object} delta The delta (contains the added/removed keys at top level)\r\n * @param {string[]} removed  Array of keys that were removed from context\r\n * @param {module:activity} activity The activity instance that owns the context\r\n *\r\n */\r\n/**\r\n * @callback windowEventHandler Handler for ActivityWindow events - e.g window joined to activity, window removed from\r\n * activity\r\n * @param {module:activity} activity\r\n * @param {module:activityWindow} window\r\n * @param {string} event 'joined' or 'removed'\r\n */\r\n/**\r\n * @callback activityStatusChangeHandler Handler for activity status changed events\r\n * @param {module:activity} activity\r\n * @param {activityStatus} newStatus\r\n * @param {activityStatus} oldStatus\r\n *\r\n */\r\n/**\r\n * @typedef {Object} windowDefinition\r\n * @property {string} type\r\n * @property {string} name\r\n * @property {Object} arguments\r\n */\r\n/**\r\n * @typedef {Object} bounds\r\n * @param {number} top\r\n * @param {number} left\r\n * @param {number} width\r\n * @param {number} height\r\n *\r\n */\r\n/**\r\n * @typedef {Object} agmInstance\r\n * @param {string} application\r\n * @param {string} pid\r\n * @param {string} machine\r\n * @param {string} user\r\n * @param {string} environment\r\n * @param {string} region\r\n */\r\n// Factory function for activity API\r\nvar ActivityModule = /** @class */ (function () {\r\n    function ActivityModule(config) {\r\n        var _this = this;\r\n        if (!config) {\r\n            throw new Error(\"config can not be null\");\r\n        }\r\n        // set log level\r\n        if (!util.isUndefined(config.logLevel)) {\r\n            logger_1.Logger.Level = config.logLevel;\r\n        }\r\n        if (!util.isUndefinedOrNull(config.logger)) {\r\n            logger_1.Logger.GlueLogger = config.logger;\r\n        }\r\n        // choose the correct bridge\r\n        var bridge;\r\n        this._isUsingHCImplementation = config.gdMajorVersion === 2;\r\n        this._isUsingGW3Implementation = ActivityModule.checkIsUsingGW3Implementation(config.connection);\r\n        if (this._isUsingHCImplementation) {\r\n            bridge = new hcBridge_1.default(undefined, config.windows, config.appManagerGetter, config.mode, config.typesToTrack);\r\n        }\r\n        else if (this._isUsingGW3Implementation) {\r\n            bridge = new gw3Bridge_1.default(config.connection, config.logger, config.contexts, config);\r\n        }\r\n        else {\r\n            throw new Error(\"Unable to instantiate activity bridge implementation\");\r\n        }\r\n        if (!bridge) {\r\n            throw new Error(\"A bridge to native activity is needed to create activity lib.\");\r\n        }\r\n        activityAGM_1.ActivityAGM.AGM = config.agm;\r\n        var activityManager = new activityManager_1.default(bridge, !config.disableAutoAnnounce, config.windows);\r\n        var my = new activityMyAPI_1.default(activityManager, config.windows);\r\n        this._api = new activityAPI_1.ActivityAPI(activityManager, my);\r\n        this._readyPromise = activityManager.ready().then(function (_) { return _this; });\r\n    }\r\n    ActivityModule.checkIsUsingGW3Implementation = function (connection) {\r\n        return connection.protocolVersion === 3;\r\n    };\r\n    Object.defineProperty(ActivityModule.prototype, \"api\", {\r\n        get: function () {\r\n            return this._api;\r\n        },\r\n        set: function (value) {\r\n            this._api = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityModule.prototype, \"isUsingHCImplementation\", {\r\n        get: function () {\r\n            return this._isUsingHCImplementation;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityModule.prototype, \"isUsingGW3Implementation\", {\r\n        get: function () {\r\n            return this._isUsingGW3Implementation;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ActivityModule.prototype.ready = function (callback) {\r\n        return promiseExtensions_1.nodeify(this._readyPromise, callback);\r\n    };\r\n    return ActivityModule;\r\n}());\r\nexports.ActivityModule = ActivityModule;\r\n//# sourceMappingURL=activityModule.js.map\n\n/***/ }),\n/* 54 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityType_1 = __webpack_require__(10);\r\nvar windowType_1 = __webpack_require__(18);\r\nvar entityEvent_1 = __webpack_require__(2);\r\nvar activity_1 = __webpack_require__(16);\r\nvar activityWindow_1 = __webpack_require__(17);\r\nvar activityStatus_1 = __webpack_require__(15);\r\nvar gwMessageSuccess = \"success\";\r\nvar gwMmessageError = \"error\";\r\nvar gwMessageAddActivityTypes = \"add-types\";\r\nvar gwMmessageActivityTypesAdded = \"types-added\";\r\nvar gwMessageRemoveActivityTypes = \"remove-types\";\r\nvar gwMessageActivityTypesRemoved = \"types-removed\";\r\nvar gwMessageActivityCreated = \"created\";\r\nvar gwMessageActivityDestroyed = \"destroyed\";\r\nvar gwMessageActivityInitiated = \"initiated\";\r\nvar gwMmessageJoinActivity = \"join-activity\";\r\nvar gwMessageJoinedActivity = \"joined\";\r\nvar gwMessageActivityJoined = \"activity-joined\";\r\nvar gwMessageLeaveActivity = \"leave-activity\";\r\nvar gwMessageActivityLeft = \"left\";\r\nvar gwNmessageMergeActivities = \"merge\";\r\nvar gwMessageSplitActivities = \"split\";\r\nvar gwMessageChildrenChanged = \"children-changed\";\r\nvar gwMessageAddPeerFactories = \"add-peer-factories\";\r\nvar gwMessagePeerFactoriesAdded = \"peer-factories-added\";\r\nvar gwMessageRemovePeerFactories = \"remove-peer-factories\";\r\nvar gwMessagePeerFactoriesRemoved = \"peer-factories-removed\";\r\nvar gwMessageCreateActivity = \"create\";\r\nvar gwMessageCreatePeer = \"create-peer\";\r\nvar gwMessagePeerRequested = \"peer-requested\";\r\nvar gwMessageReady = \"ready\";\r\nvar gwMessagePeerCreated = \"peer-created\";\r\nvar gwMessageDestroyActivity = \"destroy\";\r\nvar gwMessageDisposePeer = \"dispose-peer\";\r\nvar GW3Bridge = /** @class */ (function () {\r\n    function GW3Bridge(connection, logger, contexts, config) {\r\n        var _this = this;\r\n        // callbacks\r\n        this._activityChangeCallbacks = [];\r\n        this._activityTypeStatusChangeCallbacks = [];\r\n        this._activityWindowChangeCallbacks = [];\r\n        this._windowTypeStatusChangeCallbacks = [];\r\n        // state tracking\r\n        this._peerIdAndFactoryIdToPeerType = {};\r\n        this._peerFactoriesRegisteredByUs = {};\r\n        this._gw3Subscriptions = [];\r\n        this._contextSubscriptions = {};\r\n        this._activityTypesInitiatedFromMe = {};\r\n        this._config = config;\r\n        this._connection = connection;\r\n        this._logger = logger;\r\n        this._contexts = contexts;\r\n        this._sessionJoinedPromise = new Promise(function (resolve /*, reject */) {\r\n            _this._sessionJoinedPromiseResolve = resolve;\r\n        });\r\n        this._activityJoinedPromise = new Promise(function (resolve /*, reject */) {\r\n            _this._activityJoinedPromiseResolve = resolve;\r\n        });\r\n        if (!this._config.activityId) {\r\n            this._activityJoinedPromiseResolve({});\r\n        }\r\n        this._gw3Session = connection.domain(\"activity\", logger.subLogger(\"session:com.tick42.activity\"), [\"joined\", \"initiated\", \"peer-created\"]);\r\n    }\r\n    GW3Bridge.activityTypeGwMessageEntityToActivityType = function (entity, description) {\r\n        var nameToWindowType = function (windowName) {\r\n            return new windowType_1.default(windowName, undefined);\r\n        };\r\n        return new activityType_1.default(entity.name, entity.owner_type && nameToWindowType(entity.owner_type), entity.helper_types && entity.helper_types.map(nameToWindowType), description);\r\n    };\r\n    GW3Bridge.peerFactoryGwMessageEntityToWindowType = function (entity) {\r\n        return new windowType_1.default(entity.peer_type, \r\n        /* #deleteme TODO: review - appmanager configuration? */ function (_) { return undefined; });\r\n    };\r\n    GW3Bridge.activityGwMessageToActivity = function (msg, status) {\r\n        var ownerId = msg.owner !== undefined ? msg.owner.peer_id : undefined;\r\n        return new activity_1.default(msg.activity_id, msg.activity_type, status, msg.context_snapshot, ownerId);\r\n    };\r\n    GW3Bridge.activityToActivityStatusChangeEvent = function (act) {\r\n        return new entityEvent_1.EntityEvent(act, new entityEvent_1.ActivityStatusChangeEventContext(act.status, undefined));\r\n    };\r\n    Object.defineProperty(GW3Bridge.prototype, \"bridgeType\", {\r\n        get: function () {\r\n            return \"GW3\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    GW3Bridge.prototype.init = function () {\r\n        var _this = this;\r\n        // activity types\r\n        this.forwardActivityTypeMessagesToStatusEventHandlers();\r\n        // activities\r\n        this.subscribe(gwMessageActivityCreated, this.handleActivityCreatedMessage);\r\n        this.subscribe(gwMessageActivityDestroyed, this.handleActivityDestroyedMessage);\r\n        this.forwardActivityMessagesToStatusEventHandlers();\r\n        this.forwardActivityCreatedAndJoinedActivityToActivityWindowEventHandlers();\r\n        // window types / peer factories\r\n        // NB: this forward must happen before the handlePeerFactoriesRemoved subscription\r\n        // since the latter clears state which is used by peerFactoryIdAndOwnerIdToWindowType\r\n        this.forwardPeerFactoryMessagesToStatusEventHandlers();\r\n        this.forwardPeerFactoryMessagesToPeerFactoryRequests();\r\n        this.subscribe(gwMessagePeerFactoriesAdded, this.handlePeerFactoriesAdded);\r\n        this.subscribe(gwMessagePeerFactoriesRemoved, this.handlePeerFactoriesRemoved);\r\n        // activity windows\r\n        this.forwardActivityWindowMessagesToEventHandlers();\r\n        //\r\n        this.subscribe(gwMessageDisposePeer, \r\n        /*(msg)*/ function () {\r\n            if (_this._config.disposeRequestHandling === \"dispose\") {\r\n                _this.dispose();\r\n                return;\r\n            }\r\n            // #deleteme TODO: review - maybe leave activity before dying?\r\n            if (_this._config.disposeRequestHandling === \"exit\") {\r\n                if (typeof window !== \"undefined\" &&\r\n                    typeof window.close === \"function\") {\r\n                    window.close();\r\n                    return;\r\n                }\r\n                if (typeof process !== \"undefined\" &&\r\n                    typeof process.exit === \"function\") {\r\n                    process.exit();\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n        // #deleteme TODO: logging\r\n        // start domain join handshake\r\n        this._gw3Session.onJoined(function () {\r\n            if (_this._config.mode === \"trackMyOnly\" ||\r\n                _this._config.mode === \"trackMyTypeAndInitiatedFromMe\") {\r\n                _this._sessionJoinedPromiseResolve(_this);\r\n            }\r\n            else {\r\n                _this._gw3Session\r\n                    .send({\r\n                    type: \"subscribe\",\r\n                    activity_types: (_this._config.mode === \"trackAll\" ? [] :\r\n                        _this._config.mode === \"trackTypes\" ? _this._config.typesToTrack : [])\r\n                })\r\n                    .then(function () {\r\n                    _this._sessionJoinedPromiseResolve(_this);\r\n                });\r\n            }\r\n        });\r\n        this._gw3Session.join();\r\n    };\r\n    GW3Bridge.prototype.dispose = function () {\r\n        var _this = this;\r\n        this._gw3Subscriptions.forEach(function (sub) { return sub && _this._connection.off(sub); });\r\n        this._gw3Subscriptions.length = 0;\r\n        // #deleteme todo review\r\n        // this._contexts.dispose();\r\n    };\r\n    // ActivityBridge interface\r\n    GW3Bridge.prototype.ready = function () {\r\n        return Promise.all([this._sessionJoinedPromise, this._activityJoinedPromise]);\r\n    };\r\n    GW3Bridge.prototype.initReady = function () {\r\n        return this._sessionJoinedPromise;\r\n    };\r\n    GW3Bridge.prototype.onActivityTypeStatusChange = function (callback) {\r\n        this._activityTypeStatusChangeCallbacks.push(callback);\r\n    };\r\n    GW3Bridge.prototype.registerActivityType = function (activityTypeName, ownerWindow, helperWindows, config, description) {\r\n        var _this = this;\r\n        var entity = {};\r\n        entity.name = activityTypeName;\r\n        var toActivityPeerConfig = function (windowDefinition) { return ({ type: windowDefinition.type, name: windowDefinition.name, configuration: windowDefinition }); };\r\n        entity.owner_type = toActivityPeerConfig(ownerWindow);\r\n        entity.helper_types = helperWindows.map(toActivityPeerConfig);\r\n        return this._gw3Session\r\n            .send({\r\n            type: gwMessageAddActivityTypes,\r\n            types: [entity]\r\n        })\r\n            .then(function () {\r\n            var activityType = GW3Bridge.activityTypeGwMessageEntityToActivityType(entity, description);\r\n            _this.invokeCallbacks(_this._activityTypeStatusChangeCallbacks, new entityEvent_1.EntityEvent(activityType, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added)), gwMessageAddActivityTypes);\r\n            return activityType;\r\n        });\r\n    };\r\n    GW3Bridge.prototype.unregisterActivityType = function (activityTypeName) {\r\n        var _this = this;\r\n        return this._gw3Session\r\n            .send({\r\n            type: gwMessageRemoveActivityTypes,\r\n            types: [activityTypeName]\r\n        })\r\n            .then(function () {\r\n            var activityType = new activityType_1.default(activityTypeName, undefined, undefined, undefined);\r\n            _this.invokeCallbacks(_this._activityTypeStatusChangeCallbacks, new entityEvent_1.EntityEvent(activityType, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Removed)), gwMessageAddActivityTypes);\r\n        });\r\n    };\r\n    GW3Bridge.prototype.onWindowTypeStatusChange = function (callback) {\r\n        this._windowTypeStatusChangeCallbacks.push(callback);\r\n    };\r\n    // NB: in GW3, peer factories have ids separate from the ids of the peers they create\r\n    // in this implementation we keep the two equal for simplicity\r\n    // NB: we assume only one peer will register a peer factory for a given type; otherwise the\r\n    // add/remove window types event logic will get messy\r\n    GW3Bridge.prototype.registerWindowFactory = function (windowType, factory, parameters) {\r\n        var _this = this;\r\n        if (this._peerFactoriesRegisteredByUs[windowType]) {\r\n            return Promise.reject(new Error(\"Factory for windowType \" + windowType + \" already registered.\"));\r\n        }\r\n        this._peerFactoriesRegisteredByUs[windowType] = factory;\r\n        // #deleteme TODO: review success/failure code paths\r\n        // #deleteme TODO: review - should we create the window type here?\r\n        var entity = {\r\n            id: windowType,\r\n            peer_type: windowType,\r\n            configuration: parameters\r\n        };\r\n        return this._gw3Session.send({\r\n            type: gwMessageAddPeerFactories,\r\n            factories: [entity]\r\n        })\r\n            .then(function () {\r\n            _this.invokeCallbacks(_this._windowTypeStatusChangeCallbacks, new entityEvent_1.EntityEvent(GW3Bridge.peerFactoryGwMessageEntityToWindowType(entity), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added)), gwMessageAddPeerFactories);\r\n        })\r\n            .catch(function () {\r\n            delete _this._peerFactoriesRegisteredByUs[windowType];\r\n        });\r\n    };\r\n    GW3Bridge.prototype.unregisterWindowFactory = function (windowType) {\r\n        var _this = this;\r\n        var factory = this._peerFactoriesRegisteredByUs[windowType];\r\n        if (!factory) {\r\n            return Promise.reject(new Error(\"Factory for windowType \" + windowType + \" not registered.\"));\r\n        }\r\n        delete this._peerFactoriesRegisteredByUs[windowType];\r\n        return this._gw3Session.send({\r\n            type: gwMessageRemovePeerFactories,\r\n            factory_ids: [windowType]\r\n        }).then(function () {\r\n            _this.invokeCallbacks(_this._windowTypeStatusChangeCallbacks, new entityEvent_1.EntityEvent(new windowType_1.default(windowType, undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Removed)), gwMessageAddPeerFactories);\r\n        });\r\n    };\r\n    GW3Bridge.prototype.onActivityStatusChange = function (callback) {\r\n        this._activityChangeCallbacks.push(callback);\r\n    };\r\n    GW3Bridge.prototype.initiateActivity = function (activityType, context, configuration) {\r\n        var _this = this;\r\n        var initiateMsg = {\r\n            type: gwMessageCreateActivity,\r\n            activity_type: activityType,\r\n            initial_context: context,\r\n        };\r\n        if (this.isOverrideTypeDefinition(configuration)) {\r\n            initiateMsg.types_override = {\r\n                owner_type: { type: configuration.owner.type, name: configuration.owner.name, configuration: configuration.owner },\r\n                helper_types: configuration.helpers && configuration.helpers.map(function (wd) { return ({ type: wd.type, name: wd.name, configuration: wd }); })\r\n            };\r\n        }\r\n        else {\r\n            initiateMsg.configuration = configuration && configuration.map(function (wd) { return ({ type: wd.type, name: wd.name, configuration: wd }); });\r\n        }\r\n        return this.sendCreateAndMapResultingMessagesToPromise(initiateMsg, gwMessageActivityInitiated, function (msg, requestId) { return msg.request_id === requestId; }, gwMessageActivityCreated, function (msg, requestId, initMsg) { return msg.activity_id === initMsg.activity_id; }, gwMessageActivityDestroyed, function (msg, requestId, initMsg) { return msg.activity_id === initMsg.activity_id; }, function (msg) { return msg.activity_id; }).then(function (id) {\r\n            if (_this._config.mode === \"trackMyTypeAndInitiatedFromMe\") {\r\n                if (!_this._activityTypesInitiatedFromMe[activityType]) {\r\n                    _this._activityTypesInitiatedFromMe[activityType] = true;\r\n                    return _this._gw3Session\r\n                        .send({\r\n                        type: \"subscribe\",\r\n                        activity_types: [activityType]\r\n                    })\r\n                        .then(function () {\r\n                        return id;\r\n                    });\r\n                }\r\n            }\r\n            return id;\r\n        });\r\n    };\r\n    GW3Bridge.prototype.stopActivity = function (activity) {\r\n        return this._gw3Session.send({\r\n            type: gwMessageDestroyActivity,\r\n            activity_id: activity.id,\r\n            // #deleteme TODO: review - reason?\r\n            reason_uri: \"com.tick42.glue.activity.constants.destroyReason.general\",\r\n            reason: \"Destroying activity\"\r\n        }).then(function (_) { return true; });\r\n    };\r\n    GW3Bridge.prototype.updateActivityContext = function (activity, context, fullReplace, removedKeys) {\r\n        if (fullReplace) {\r\n            // this will currently fail on GW3\r\n            return this._contexts.set(activity.id, context);\r\n        }\r\n        else {\r\n            removedKeys = removedKeys || [];\r\n            for (var _i = 0, removedKeys_1 = removedKeys; _i < removedKeys_1.length; _i++) {\r\n                var x = removedKeys_1[_i];\r\n                context[x] = null;\r\n            }\r\n            return this._contexts.update(activity.id, context);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.announceWindow = function (windowType, activityWindowId) {\r\n        // in the GW3 case we are only joined to an activity after we announce ourselves\r\n        // so all announcement calls should go in 'registerWindow', not here\r\n        // (registerWindow registers a window that's not part of an activity, at least yet)\r\n        throw new Error(\"Invalid operation 'announceWindow' for GW3 protocol\");\r\n    };\r\n    GW3Bridge.prototype.registerWindow = function (type, name, independent) {\r\n        var shouldSendReady = this._connection.gatewayToken;\r\n        var peerId = this._connection.peerId;\r\n        // if running in GD3 (glue42gd is there) we should send ready only if we have the activityInfo object in glue\r\n        if (typeof window !== \"undefined\") {\r\n            var glue42gd = window.glue42gd;\r\n            if (glue42gd) {\r\n                shouldSendReady = glue42gd.activityInfo !== undefined;\r\n            }\r\n        }\r\n        if (shouldSendReady) {\r\n            this._gw3Session.send({\r\n                type: gwMessageReady,\r\n            });\r\n        }\r\n        this.invokeCallbacks(this._activityWindowChangeCallbacks, new entityEvent_1.EntityEvent(new activityWindow_1.default(peerId, name, type, undefined, undefined, independent, this.generateWindowGetter(peerId), undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added)), \"register window\");\r\n        return Promise.resolve(peerId);\r\n    };\r\n    GW3Bridge.prototype.onActivityWindowChange = function (callback) {\r\n        this._activityWindowChangeCallbacks.push(callback);\r\n    };\r\n    GW3Bridge.prototype.createWindow = function (activityId, windowDefinition) {\r\n        var _this = this;\r\n        // if the user hasn't provided a layout option but has some of left,top,width,height\r\n        // insert a layout\r\n        if (!windowDefinition.layout) {\r\n            if (windowDefinition.left || windowDefinition.width || windowDefinition.height || windowDefinition.top) {\r\n                windowDefinition.layout = {\r\n                    mode: \"pixels\",\r\n                    cellSize: 1,\r\n                };\r\n            }\r\n        }\r\n        return this.sendCreateAndMapResultingMessagesToPromise({\r\n            type: gwMessageCreatePeer,\r\n            peer_type: windowDefinition.type,\r\n            configuration: windowDefinition,\r\n            activity_id: activityId,\r\n        }, undefined, undefined, gwMessagePeerCreated, function (msg, requestId) { return msg.request_id === requestId; }, undefined, undefined, function (msg) { return msg.created_id; })\r\n            .then(function (id) {\r\n            return _this.joinActivity(activityId, id)\r\n                .then(function () {\r\n                return id;\r\n            });\r\n        });\r\n    };\r\n    GW3Bridge.prototype.closeWindow = function (id) {\r\n        return this._gw3Session.send({\r\n            destroy_peer_id: id\r\n        }).then(function (_) { return undefined; });\r\n    };\r\n    GW3Bridge.prototype.getAnnouncementInfo = function () {\r\n        var activityId = this._config.activityId || (this._config.announcementInfo && this._config.announcementInfo.activityId);\r\n        var activityWindowType = (this._config.announcementInfo && this._config.announcementInfo.activityWindowType);\r\n        var activityWindowIndependent = (this._config.announcementInfo && this._config.announcementInfo.activityWindowIndependent);\r\n        var activityWindowName = (this._config.announcementInfo && this._config.announcementInfo.activityWindowName);\r\n        if (typeof window !== \"undefined\" &&\r\n            typeof window.location !== \"undefined\" &&\r\n            window.location.search &&\r\n            typeof URLSearchParams === \"function\") {\r\n            var searchParams = new URLSearchParams(location.search.slice(1));\r\n            activityWindowType = activityWindowType || searchParams.get(\"t42PeerType\");\r\n            activityWindowType = activityWindowType || searchParams.get(\"t42ActivityWindowType\");\r\n            if (typeof activityWindowIndependent === \"undefined\") {\r\n                activityWindowIndependent = searchParams.get(\"t42ActivityWindowIndependent\");\r\n            }\r\n            activityWindowName = activityWindowName || searchParams.get(\"t42ActivityWindowName\");\r\n            activityId = activityId || searchParams.get(\"t42ActivityId\");\r\n        }\r\n        activityWindowType = activityWindowType || \"unknown\";\r\n        activityWindowIndependent = activityWindowIndependent || false;\r\n        activityWindowName = activityWindowName || this._connection.peerId;\r\n        return {\r\n            activityWindowId: undefined,\r\n            activityId: activityId,\r\n            activityWindowType: activityWindowType,\r\n            activityWindowIndependent: activityWindowIndependent,\r\n            activityWindowName: activityWindowName,\r\n        };\r\n    };\r\n    GW3Bridge.prototype.joinActivity = function (activityId, windowId) {\r\n        var _this = this;\r\n        return this._gw3Session.send({\r\n            type: gwMmessageJoinActivity,\r\n            target_id: windowId,\r\n            activity_id: activityId\r\n        }).then(function () {\r\n            _this.invokeCallbacks(_this._activityWindowChangeCallbacks, new entityEvent_1.EntityEvent(new activityWindow_1.default(windowId, undefined, undefined, activityId, undefined, undefined, _this.generateWindowGetter(windowId), undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowJoinedActivity)), \"activity joined - ActivityWindow\");\r\n            _this.invokeCallbacks(_this._activityChangeCallbacks, new entityEvent_1.EntityEvent(new activity_1.default(activityId, undefined, new activityStatus_1.ActivityStatus(\"created\", undefined, undefined), undefined, undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Updated)), \"activity joined - Activity\");\r\n        });\r\n    };\r\n    GW3Bridge.prototype.leaveActivity = function (activityId, windowId) {\r\n        var _this = this;\r\n        return this._gw3Session.send({\r\n            type: gwMessageLeaveActivity,\r\n            target_id: windowId,\r\n            activity_id: activityId\r\n        }).then(function () {\r\n            _this.invokeCallbacks(_this._activityWindowChangeCallbacks, new entityEvent_1.EntityEvent(new activityWindow_1.default(windowId, undefined, undefined, null, undefined, undefined, _this.generateWindowGetter(windowId), undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowLeftActivity)), \"activity left - ActivityWindow\");\r\n            _this.invokeCallbacks(_this._activityChangeCallbacks, new entityEvent_1.EntityEvent(new activity_1.default(activityId, undefined, new activityStatus_1.ActivityStatus(\"created\", undefined, undefined), undefined, undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Updated)), \"activity left - Activity\");\r\n        });\r\n    };\r\n    // purposefully returning empty arrays\r\n    GW3Bridge.prototype.getActivityTypes = function () {\r\n        return Promise.resolve([]);\r\n    };\r\n    GW3Bridge.prototype.getWindowTypes = function () {\r\n        return Promise.resolve([]);\r\n    };\r\n    GW3Bridge.prototype.getActivities = function () {\r\n        return Promise.resolve([]);\r\n    };\r\n    GW3Bridge.prototype.getActivityWindows = function () {\r\n        return Promise.resolve([]);\r\n    };\r\n    // N/A\r\n    // #deleteme TODO: ignore for now\r\n    // POSTPONED\r\n    GW3Bridge.prototype.createStackedWindows = function (id, windowDefinitions, timeout) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.getWindowBounds = function (id) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.setWindowBounds = function (id, bounds) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.activateWindow = function (id, focus) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.setWindowVisibility = function (id, visible) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.cloneActivity = function (id, cloneOptions) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.attachActivities = function (from, to, tag) {\r\n        return this._gw3Session.send({\r\n            type: gwNmessageMergeActivities,\r\n            into: to,\r\n            merge: from\r\n        });\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.detachActivities = function (activityId, newActivityInfo) {\r\n        return this._gw3Session.send({\r\n            type: gwMessageSplitActivities,\r\n            from: activityId,\r\n        }).then(function () { return \"\"; });\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.onActivitiesAttached = function (callback) {\r\n        // POSTPONED\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.onActivitiesDetached = function (callback) {\r\n        // POSTPONED\r\n    };\r\n    GW3Bridge.prototype.onActivityAttachedDescriptorsRefreshed = function (callback) {\r\n        // POSTPONED\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.getAttachedDescriptors = function () {\r\n        return Promise.resolve([]);\r\n    };\r\n    // helpers\r\n    // Protocol handling\r\n    GW3Bridge.prototype.getRandomRequestId = function () {\r\n        return this._connection.peerId + \":\" + Math.floor(Math.random() * 1e9) + \"\";\r\n    };\r\n    GW3Bridge.prototype.forwardAddedAndRemovedMessagesToEventHandler = function (addedMessageType, removedMessageType, mapper, handlers) {\r\n        var getGetEntityEvent = function (isAdded) { return function (entity) { return new entityEvent_1.EntityEvent(entity, new entityEvent_1.EntityEventContext(isAdded ?\r\n            entityEvent_1.EntityEventType.Added :\r\n            entityEvent_1.EntityEventType.Removed)); }; };\r\n        var sub1;\r\n        var sub2;\r\n        sub1 = addedMessageType && this.forwardMessageToEventHandler(addedMessageType, function (msg) { return mapper(msg, true); }, getGetEntityEvent(true), handlers);\r\n        sub2 = removedMessageType && this.forwardMessageToEventHandler(removedMessageType, function (msg) { return mapper(msg, false); }, getGetEntityEvent(false), handlers);\r\n        return [sub1, sub2].filter(function (x) { return x; });\r\n    };\r\n    GW3Bridge.prototype.forwardMessageToEventHandler = function (messageType, mapper, getEntityEvent, handler) {\r\n        return this.subscribe(messageType, function (msg) {\r\n            mapper(msg)\r\n                .forEach(function (ent) {\r\n                return handler.forEach(function (h) { return h(getEntityEvent(ent, msg)); });\r\n            });\r\n        });\r\n    };\r\n    GW3Bridge.prototype.sendCreateAndMapResultingMessagesToPromise = function (msg, initiatedMessageType, initiatedMessageFilter, createdMessageType, createdMessageFilter, cancelledMessageType, cancelledMessageFilter, createdMessageToPromiseResolution) {\r\n        var _this = this;\r\n        var reqId = this.getRandomRequestId();\r\n        var resolveCreatedPromise;\r\n        var rejectCreatedPromise;\r\n        var createdPromise = new Promise(function (resolve, reject) {\r\n            resolveCreatedPromise = resolve;\r\n            rejectCreatedPromise = reject;\r\n        });\r\n        var initiatedMessageAck = null;\r\n        var initiatedSubscription;\r\n        var createdSubscription;\r\n        var cancelledSubscription;\r\n        var errorSubscription;\r\n        var dropSubscriptions = function () {\r\n            _this.dropSubscription(initiatedSubscription);\r\n            _this.dropSubscription(createdSubscription);\r\n            _this.dropSubscription(cancelledSubscription);\r\n            _this.dropSubscription(errorSubscription);\r\n        };\r\n        initiatedSubscription = initiatedMessageType &&\r\n            this.subscribe(initiatedMessageType, function (msg4) {\r\n                if (!initiatedMessageFilter(msg4, reqId)) {\r\n                    return;\r\n                }\r\n                initiatedMessageAck = msg4;\r\n                _this.dropSubscription(initiatedSubscription);\r\n            });\r\n        createdSubscription =\r\n            this.subscribe(createdMessageType, function (msg1) {\r\n                if (!createdMessageFilter(msg1, reqId, initiatedMessageAck)) {\r\n                    return;\r\n                }\r\n                resolveCreatedPromise(createdMessageToPromiseResolution(msg1));\r\n            });\r\n        cancelledSubscription = cancelledMessageType &&\r\n            this.subscribe(cancelledMessageType, function (msg2) {\r\n                if (!cancelledMessageFilter(msg2, reqId, initiatedMessageAck)) {\r\n                    return;\r\n                }\r\n                rejectCreatedPromise(msg2);\r\n            });\r\n        errorSubscription = cancelledMessageType &&\r\n            this.subscribe(gwMmessageError, function (msg3) {\r\n                if (msg3.request_id !== reqId) {\r\n                    return;\r\n                }\r\n                rejectCreatedPromise(msg3);\r\n            });\r\n        msg.request_id = reqId;\r\n        var toReturn = this._gw3Session\r\n            .send(msg)\r\n            .then(function () {\r\n            return createdPromise;\r\n        });\r\n        toReturn.then(dropSubscriptions, dropSubscriptions);\r\n        return toReturn;\r\n    };\r\n    // Entity Mapping\r\n    GW3Bridge.prototype.peerFactoryIdAndOwnerIdToWindowType = function (factoryId, ownerId) {\r\n        var peerType = this._peerIdAndFactoryIdToPeerType[ownerId + \":\" + factoryId];\r\n        if (!peerType) {\r\n            return null;\r\n        }\r\n        else {\r\n            return new windowType_1.default(peerType, undefined);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribe = function (messageType, handler) {\r\n        var _this = this;\r\n        var sub = this._connection.on(\r\n        // #deleteme TODO: review first arg\r\n        \"js-activity\", messageType, function (msg) { return handler.bind(_this)(msg); });\r\n        this._gw3Subscriptions.push(sub);\r\n        return sub;\r\n    };\r\n    GW3Bridge.prototype.dropSubscription = function (subscription) {\r\n        if (subscription) {\r\n            this._connection.off(subscription);\r\n            delete this._gw3Subscriptions[this._gw3Subscriptions.indexOf(subscription)];\r\n        }\r\n    };\r\n    GW3Bridge.prototype.invokeCallbacks = function (callbacks, event, description) {\r\n        var _this = this;\r\n        callbacks.forEach(function (cb) {\r\n            try {\r\n                cb(event);\r\n            }\r\n            catch (err) {\r\n                _this._logger.error(\"Error in \" + (description || event.context.type) + \" callback: \" + JSON.stringify(err));\r\n            }\r\n        });\r\n    };\r\n    GW3Bridge.prototype.handleActivityCreatedMessage = function (msg) {\r\n        if (!msg.context_id) {\r\n            this._logger.error(\"Activity created with unknown context_id: \" + msg.activity_id);\r\n        }\r\n        else {\r\n            this.subscribeToContext(msg);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribeToContext = function (msg) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var activityId, _a, _b;\r\n            var _this = this;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        activityId = msg.activity_id;\r\n                        _a = this._contextSubscriptions;\r\n                        _b = activityId;\r\n                        return [4 /*yield*/, this._contexts.subscribe(activityId, function (data) {\r\n                                var event = new entityEvent_1.EntityEvent(new activity_1.default(activityId, undefined, undefined, data, undefined), new entityEvent_1.ActivityContextChangedEventContext(data));\r\n                                _this.invokeCallbacks(_this._activityChangeCallbacks, event, \"context updated\");\r\n                            })];\r\n                    case 1:\r\n                        _a[_b] =\r\n                            _c.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    GW3Bridge.prototype.handleActivityDestroyedMessage = function (msg) {\r\n        var unsubscribeContext = this._contextSubscriptions[msg.activity_id];\r\n        if (typeof unsubscribeContext === \"function\") {\r\n            unsubscribeContext();\r\n        }\r\n        delete this._contextSubscriptions[msg.activity_id];\r\n    };\r\n    GW3Bridge.prototype.handlePeerFactoriesAdded = function (msg) {\r\n        var _this = this;\r\n        msg.factories.forEach(function (entity) {\r\n            _this._peerIdAndFactoryIdToPeerType[msg.owner_id + \":\" + entity.id] = entity.peer_type;\r\n        });\r\n    };\r\n    GW3Bridge.prototype.handlePeerFactoriesRemoved = function (msg) {\r\n        var _this = this;\r\n        msg.factory_ids.forEach(function (factoryId) {\r\n            delete _this._peerIdAndFactoryIdToPeerType[msg.owner_id + \":\" + factoryId];\r\n        });\r\n    };\r\n    GW3Bridge.prototype.forwardActivityTypeMessagesToStatusEventHandlers = function () {\r\n        this.forwardAddedAndRemovedMessagesToEventHandler(gwMmessageActivityTypesAdded, gwMessageActivityTypesRemoved, function (msg, isAdded) { return isAdded\r\n            ? msg.types.map(function (t) { return GW3Bridge.activityTypeGwMessageEntityToActivityType(t, undefined); })\r\n            : msg.types.map(function (t) { return new activityType_1.default(t.name, undefined, undefined, undefined); }); }, this._activityTypeStatusChangeCallbacks);\r\n    };\r\n    GW3Bridge.prototype.forwardActivityCreatedAndJoinedActivityToActivityWindowEventHandlers = function () {\r\n        var _this = this;\r\n        // if we're created as part of this activity, the JOINED ACTIVITY is\r\n        // the first time we'll hear about it; so let's record the participants\r\n        for (var _i = 0, _a = [gwMessageActivityCreated, gwMessageJoinedActivity]; _i < _a.length; _i++) {\r\n            var activityCreatedMessage = _a[_i];\r\n            this.forwardMessageToEventHandler(activityCreatedMessage, function (msg) {\r\n                return ([msg.owner])\r\n                    .concat(msg.participants || [])\r\n                    .map(function (info) { return new activityWindow_1.default(info.peer_id, info.name, info.type, msg.activity_id, undefined, undefined, _this.generateWindowGetter(info.peer_id), undefined); });\r\n            }, function (ent, msg) { return new entityEvent_1.EntityEvent(ent, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowJoinedActivity)); }, this._activityWindowChangeCallbacks);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.forwardActivityMessagesToStatusEventHandlers = function () {\r\n        // see dot-net-activity\\Activity\\ActivityState.cs\r\n        for (var _i = 0, _a = [gwMessageActivityCreated, gwMessageJoinedActivity]; _i < _a.length; _i++) {\r\n            var createdMessage = _a[_i];\r\n            this.forwardMessageToEventHandler(createdMessage, function (msg) { return [GW3Bridge.activityGwMessageToActivity(msg, new activityStatus_1.ActivityStatus(\"started\", \"\", new Date()))]; }, function (ent, msg) { return GW3Bridge.activityToActivityStatusChangeEvent(ent); }, this._activityChangeCallbacks);\r\n        }\r\n        this.forwardMessageToEventHandler(gwMessageActivityDestroyed, function (msg) { return [GW3Bridge.activityGwMessageToActivity(msg, new activityStatus_1.ActivityStatus(\"destroyed\", msg.reason, new Date()))]; }, function (ent, msg) { return GW3Bridge.activityToActivityStatusChangeEvent(ent); }, this._activityChangeCallbacks);\r\n        this.forwardMessageToEventHandler(gwMessageActivityInitiated, function (msg) { return [GW3Bridge.activityGwMessageToActivity(msg, new activityStatus_1.ActivityStatus(\"created\", \"\", new Date()))]; }, function (ent, msg) { return GW3Bridge.activityToActivityStatusChangeEvent(ent); }, this._activityChangeCallbacks);\r\n    };\r\n    GW3Bridge.prototype.forwardPeerFactoryMessagesToStatusEventHandlers = function () {\r\n        var _this = this;\r\n        this.forwardAddedAndRemovedMessagesToEventHandler(gwMessagePeerFactoriesAdded, gwMessagePeerFactoriesRemoved, function (msg, isAdded) { return isAdded\r\n            ? msg.factories.map(GW3Bridge.peerFactoryGwMessageEntityToWindowType)\r\n            : msg.factory_ids.map(function (id) { return _this.peerFactoryIdAndOwnerIdToWindowType(id, msg.owner_id); }).filter(function (x) { return x != null; }); }, this._windowTypeStatusChangeCallbacks);\r\n    };\r\n    GW3Bridge.prototype.forwardPeerFactoryMessagesToPeerFactoryRequests = function () {\r\n        var _this = this;\r\n        this.subscribe(gwMessagePeerRequested, function (msg) {\r\n            var factory = _this._peerFactoriesRegisteredByUs[msg.peer_factory];\r\n            if (!factory) {\r\n                _this._gw3Session.send({\r\n                    type: gwMmessageError,\r\n                    request_id: msg.request_id,\r\n                    reason: \"Unknown peer factory \" + msg.peer_factory\r\n                });\r\n                return;\r\n            }\r\n            try {\r\n                var configuration = msg.configuration || {};\r\n                // NB: peer factories (or whoever they're delegating to) need to support whatever activity\r\n                // environment (GW3, HC) we're targeting when they're creating peers\r\n                // the manager is env agnostic, the bridge will augment the configuration with whatever's required\r\n                // NB: also, since peers are requested in two ways (single peer with just its configuration,\r\n                // or peer created as part of new activity, where the factory receives the aggregate config of\r\n                // all peers, combined from ADD ACTIVITY TYPE and CREATE ACTIVITY), the peer factories need to\r\n                // be able to handle both configuration structures intelligently.\r\n                configuration.gateway_token = configuration.gateway_token || msg.gateway_token;\r\n                configuration.peer_factory = configuration.peer_factory || msg.peer_factory;\r\n                var promise = factory.create({\r\n                    activityId: msg.activity.id,\r\n                    type: msg.activity.type,\r\n                    gwToken: configuration.gateway_token,\r\n                    configuration: configuration,\r\n                });\r\n                if (promise && promise.then && promise.catch) {\r\n                    promise.catch(function (err) { return _this._gw3Session.send({\r\n                        type: gwMmessageError,\r\n                        request_id: msg.request_id,\r\n                        reason: err && (err.message || JSON.stringify(err))\r\n                    }); });\r\n                }\r\n            }\r\n            catch (err) {\r\n                _this._gw3Session.send({\r\n                    type: gwMmessageError,\r\n                    request_id: msg.request_id,\r\n                    reason: err && (err.message || JSON.stringify(err))\r\n                });\r\n            }\r\n        });\r\n    };\r\n    GW3Bridge.prototype.forwardActivityWindowMessagesToEventHandlers = function () {\r\n        var _this = this;\r\n        var _loop_1 = function (joinedMessage) {\r\n            this_1.subscribe(joinedMessage, function (msg) {\r\n                var joinedId = (joinedMessage === gwMessageActivityJoined) ? msg.joined_id : msg.peer_id;\r\n                var joinedType = (joinedMessage === gwMessageActivityJoined) ? msg.joined_type : msg.peer_type;\r\n                var joinedName = (joinedMessage === gwMessageActivityJoined) ? msg.joined_name : msg.peer_name;\r\n                var entity = new activityWindow_1.default(joinedId, joinedName, joinedType /* for ACTIVITY JOINED */, msg.activity_id, undefined, undefined, _this.generateWindowGetter(joinedId), undefined);\r\n                // TODO review - what if it's our activity, do we\r\n                // even need to subscribe\r\n                if (!_this._contextSubscriptions[msg.activity_id]) {\r\n                    _this.subscribeToContext(msg).then(function () {\r\n                        if (joinedMessage === gwMessageJoinedActivity) {\r\n                            _this._activityJoinedPromiseResolve({});\r\n                        }\r\n                    });\r\n                }\r\n                else if (joinedMessage === gwMessageJoinedActivity) {\r\n                    _this._activityJoinedPromiseResolve({});\r\n                }\r\n                // TODO review: we might have the context data here already\r\n                // why not update it here instead of waiting for subscribeToContext\r\n                _this.invokeCallbacks(_this._activityWindowChangeCallbacks, new entityEvent_1.EntityEvent(entity, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowJoinedActivity)), joinedMessage);\r\n            });\r\n        };\r\n        var this_1 = this;\r\n        for (var _i = 0, _a = [gwMessageActivityJoined, gwMessageJoinedActivity]; _i < _a.length; _i++) {\r\n            var joinedMessage = _a[_i];\r\n            _loop_1(joinedMessage);\r\n        }\r\n        this.subscribe(gwMessageActivityLeft, function (msg) {\r\n            var entity = new activityWindow_1.default(msg.left_id, undefined, undefined, null, undefined, undefined, _this.generateWindowGetter(msg.left_id), undefined);\r\n            _this.invokeCallbacks(_this._activityWindowChangeCallbacks, new entityEvent_1.EntityEvent(entity, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowLeftActivity)), gwMessageActivityLeft);\r\n        });\r\n        this.forwardAddedAndRemovedMessagesToEventHandler(gwMessagePeerCreated, undefined, function (msg) { return [\r\n            new activityWindow_1.default(msg.created_id, undefined /* #deleteme TODO: review - we should know the name if any */, undefined /* #deleteme TODO: review - we should know the type */, undefined, undefined, undefined, _this.generateWindowGetter(msg.created_id), undefined)\r\n        ]; }, this._activityWindowChangeCallbacks);\r\n    };\r\n    GW3Bridge.prototype.generateWindowGetter = function (peerId) {\r\n        var _this = this;\r\n        return function () {\r\n            var server = _this._config.agm.servers().filter(function (s) { return s.peerId === peerId; })[0];\r\n            if (!server) {\r\n                return;\r\n            }\r\n            var windowId = server.windowId;\r\n            return _this._config.windows.list().filter(function (w) { return w.id === windowId; })[0];\r\n        };\r\n    };\r\n    GW3Bridge.prototype.isOverrideTypeDefinition = function (value) {\r\n        if (typeof value === \"undefined\") {\r\n            return false;\r\n        }\r\n        if (value.owner) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return GW3Bridge;\r\n}());\r\nexports.default = GW3Bridge;\r\n//# sourceMappingURL=gw3Bridge.js.map\n\n/***/ }),\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar entityEvent_1 = __webpack_require__(2);\r\nvar activityType_1 = __webpack_require__(10);\r\nvar promiseExtensions_1 = __webpack_require__(8);\r\nvar readyMarker_1 = __webpack_require__(19);\r\nvar entityObservableCollection_1 = __webpack_require__(58);\r\nvar logger_1 = __webpack_require__(4);\r\nvar util = __webpack_require__(0);\r\nvar localWindowFactory_1 = __webpack_require__(56);\r\nvar entityEvent_2 = __webpack_require__(2);\r\nvar hcBridge_1 = __webpack_require__(14);\r\nvar ActivityManager = /** @class */ (function () {\r\n    function ActivityManager(bridge, autoAnnounce, windows) {\r\n        var _this = this;\r\n        this._logger = logger_1.Logger.Get(\"activityManager\");\r\n        this._announcedWindows = [];\r\n        this._attachedCallbacks = [];\r\n        this._detachedCallbacks = [];\r\n        this._frameColorChangesCallbacks = [];\r\n        this._bridge = bridge;\r\n        this._activityTypes = new entityObservableCollection_1.EntityObservableCollection(function (e) { return _this._grabEntity(e); });\r\n        this._windowTypes = new entityObservableCollection_1.EntityObservableCollection(function (e) { return _this._grabEntity(e); });\r\n        this._activities = new entityObservableCollection_1.EntityObservableCollection(function (e) { return _this._grabEntity(e); });\r\n        this._windows = new entityObservableCollection_1.EntityObservableCollection(function (e) { return _this._grabEntity(e); });\r\n        // signals to wait for - get AT, get WT, get Activities and get Windows\r\n        this._dataReadyMarker = new readyMarker_1.ReadyMarker(\"Activity Manager Data\", [\"GetActivityTypes\", \"GetWindowTypes\", \"GetActivities\", \"GetWindows\"].length);\r\n        this._descriptorsMarker = new readyMarker_1.ReadyMarker(\"Attached Activities Descriptors\", [\"GetDescriptors\"].length);\r\n        // waiting for activity data first\r\n        // NB: in the GW3 case, we don't have the ability to request data at will\r\n        // but need wait for delta messages\r\n        // So GW3Bridge returns empty arrays from the get() calls\r\n        // We're relying on the fact that the GW3 bridge will wait\r\n        // until resolving its .ready()\r\n        if (autoAnnounce) {\r\n            // if auto announce replace the ready marker, so:\r\n            // 1) wait for data\r\n            // 2) get descriptors\r\n            // 3) announce the current window\r\n            this._readyMarker = new readyMarker_1.ReadyMarker(\"Activity Manager Announce\", [\"Announcement\"].length);\r\n            this._dataReadyMarker.setCallback(function (dataErr) {\r\n                if (dataErr) {\r\n                    _this._readyMarker.error(dataErr);\r\n                }\r\n                _this._descriptorsMarker.setCallback(function (err) {\r\n                    if (err) {\r\n                        _this._readyMarker.error(err);\r\n                    }\r\n                    _this._logger.debug(\"Auto announcing window\");\r\n                    // signal no matter if it failed or not\r\n                    _this.announceWindow()\r\n                        .then(function (w) {\r\n                        // NB: this creates glue.activities.my.window\r\n                        _this._announcedWindows.push(w);\r\n                        _this._readyMarker.signal(\"Successfully announced window with id '\" + w.id + \"'\");\r\n                    })\r\n                        .catch(function (errCatch) {\r\n                        _this._logger.debug(\"Will not announce window - \" + errCatch);\r\n                        _this._readyMarker.signal();\r\n                    });\r\n                });\r\n                _this.refreshDescriptors();\r\n            });\r\n        }\r\n        else {\r\n            // TODO: not sure if this still works\r\n            this._readyMarker = this._dataReadyMarker;\r\n        }\r\n        this._bridge.onActivitiesAttached(function (e) {\r\n            _this._handleActivitiesAttached(e);\r\n        });\r\n        this._bridge.onActivitiesDetached(function (e) {\r\n            _this._handleActivitiesDetached(e);\r\n        });\r\n        this._bridge.onActivityAttachedDescriptorsRefreshed(function (e) {\r\n            _this._handleActivityDescriptorsRefreshed(e);\r\n        });\r\n        if (windows) {\r\n            windows.onWindowFrameColorChanged(this._handleWindowFrameColorChanged.bind(this));\r\n        }\r\n        // initialize the bridge\r\n        this._bridge.init();\r\n        // NB: there is no race condition here.\r\n        // Since browser/Node JS is a single-threaded environment, assuming no events on _bridge\r\n        // fire inside .init(), this subscribe will catch anything that comes between it and the init() call\r\n        this._subscribeForData();\r\n        // NB: in GW3 case, the initial state messages after a JOIN come in before the JOIN's SUCCESS\r\n        // message (see https://confluence.tick42.com:8443/display/TD/Global+Gateway+Domain#GlobalGatewayDomain-JOIN)\r\n        // so the .initReady().then() callback will only get invoked after we've received the initial domain\r\n        // state. We need to be ready to handle events before that, hence the _subscribeForData() above.\r\n        // what's more, our own JOINED ACTIVITY will come only after we've sent our READY, hence waiting\r\n        // for bridge.ready() in the manager's ready()\r\n        // wait for it to become ready and then start getting/subscribing for data\r\n        this._bridge\r\n            .initReady()\r\n            .then(function (aw) {\r\n            _this._getInitialData();\r\n        })\r\n            .catch(function (error) {\r\n            // tslint:disable-next-line\r\n            console.log(error);\r\n        });\r\n    }\r\n    Object.defineProperty(ActivityManager.prototype, \"usingHc\", {\r\n        get: function () {\r\n            return this._bridge.bridgeType === \"HC\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityManager.prototype, \"announcedWindows\", {\r\n        get: function () {\r\n            return this._announcedWindows;\r\n        },\r\n        set: function (v) {\r\n            throw new Error(\"not allowed\");\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ActivityManager.prototype.ready = function (callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            _this._readyMarker.setCallback(function (err) {\r\n                if (!err) {\r\n                    resolve(_this);\r\n                }\r\n                else {\r\n                    reject(_this._readyMarker.getError());\r\n                }\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(Promise.all([this._bridge.ready(), promise]).then(function () { return _this; }), callback);\r\n    };\r\n    /**\r\n     * @returns All known activity types\r\n     */\r\n    ActivityManager.prototype.getActivityTypes = function () {\r\n        return this._activityTypes.get();\r\n    };\r\n    /**\r\n     * Gets ActivityType by name\r\n     * @param name  Name to search for\r\n     * @returns     If found the @type ActivityType; otherwise undefined\r\n     */\r\n    ActivityManager.prototype.getActivityType = function (name) {\r\n        return this._activityTypes.getByName(name);\r\n    };\r\n    /**\r\n     * Registers a new activity type\r\n     * @param activityTypeName      The name of the activity type to be created\r\n     * @param ownerWindowType       The type of the owner window or a WindowDefinition for the owner window\r\n     * @param helperWindowTypes     Types of helper windows (or WindowDefinitions for helper windows) for that activity type\r\n     * @param config                (HC only, deprecated) Layout config\r\n     * @param description           (HC only, deprecated) Description for the new activity type\r\n     * @param callback              (Optional) Callback for results - if not specified the method will return a promise\r\n     */\r\n    ActivityManager.prototype.registerActivityType = function (activityTypeName, ownerWindowType, helperWindowTypes, config, description, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            // activityTypeName checks\r\n            if (util.isUndefinedOrNull(activityTypeName)) {\r\n                reject(\"activityTypeName argument can not be undefined\");\r\n                return;\r\n            }\r\n            if (!util.isString(activityTypeName)) {\r\n                reject(\"activityTypeName should be string\");\r\n                return;\r\n            }\r\n            // check if type is already defined\r\n            var actType = _this.getActivityType(activityTypeName);\r\n            if (!util.isUndefinedOrNull(actType)) {\r\n                reject(\"Activity type '\" + activityTypeName + \"' already exists\");\r\n                return;\r\n            }\r\n            // ownerWindowType checks\r\n            var ownerDefinition;\r\n            if (util.isUndefined(ownerWindowType)) {\r\n                reject(\"Owner window type can not be undefined\");\r\n                return;\r\n            }\r\n            if (util.isString(ownerWindowType)) {\r\n                ownerDefinition = { type: ownerWindowType, name: \"\", isIndependent: false, arguments: {} };\r\n            }\r\n            else {\r\n                ownerDefinition = ownerWindowType;\r\n            }\r\n            // helperWindowTypes checks\r\n            var helperDefinitions = [];\r\n            if (!util.isUndefined(helperWindowTypes) && util.isArray(helperWindowTypes)) {\r\n                // tslint:disable-next-line\r\n                for (var index in helperWindowTypes) {\r\n                    var item = helperWindowTypes[index];\r\n                    if (util.isString(item)) {\r\n                        var definition = {\r\n                            type: item,\r\n                            name: \"\",\r\n                            isIndependent: false,\r\n                            arguments: {},\r\n                            relativeTo: \"\",\r\n                            relativeDirection: \"\",\r\n                            windowStyleAttributes: {}\r\n                        };\r\n                        helperDefinitions.push(definition);\r\n                    }\r\n                    else {\r\n                        helperDefinitions.push(item);\r\n                    }\r\n                }\r\n            }\r\n            // redirect to bridge\r\n            _this._bridge\r\n                .registerActivityType(activityTypeName, ownerDefinition, helperDefinitions, config, description)\r\n                .then(function (activityType) {\r\n                // add to from collections\r\n                _this._grabEntity(activityType);\r\n                resolve(activityType);\r\n            })\r\n                .catch(function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Unregister existing activity type\r\n     * @param type The name of the activity type to be removed\r\n     */\r\n    ActivityManager.prototype.unregisterActivityType = function (type, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            // check if type is defined\r\n            var actType = _this.getActivityType(type);\r\n            if (util.isUndefined(actType)) {\r\n                reject(\"Activity type '\" + type + \"' does not exists\");\r\n                return;\r\n            }\r\n            _this._bridge.unregisterActivityType(type).then(function () { return resolve(actType); }, reject);\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Initiates a new activity from the given type.\r\n     * @param activityType  The ActivityType to initiate\r\n     * @param context       The initial context of the activity\r\n     * @param callback      Callback for result\r\n     * @param configuration Optional configuration passed to window/peer factories for the new activity's participants\r\n     * @returns             Promise for activity\r\n     */\r\n    ActivityManager.prototype.initiate = function (activityType, context, callback, configuration) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            // check if type is defined\r\n            var actType = _this.getActivityType(activityType);\r\n            if (util.isUndefined(actType)) {\r\n                reject(\"Activity type '\" + activityType + \"' does not exists\");\r\n                return;\r\n            }\r\n            _this._bridge\r\n                .initiateActivity(activityType, context, configuration)\r\n                .then(function (actId) {\r\n                _this._activities\r\n                    .getOrWait(actId)\r\n                    .then(function (act) {\r\n                    resolve(act);\r\n                })\r\n                    .catch(function (err) { return reject(err); });\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    ActivityManager.prototype.subscribeActivityTypeEvents = function (handler) {\r\n        this._activityTypes.subscribe(function (at, context) {\r\n            handler(at, context.type);\r\n        });\r\n    };\r\n    /**\r\n     * @returns All known WindowTypes\r\n     */\r\n    ActivityManager.prototype.getWindowTypes = function () {\r\n        return this._windowTypes.get();\r\n    };\r\n    /**\r\n     * Gets WindowType by name\r\n     * @param name  The name of the type @type WindowType\r\n     * @returns     WindowType if found; undefined otherwise\r\n     */\r\n    ActivityManager.prototype.getWindowType = function (name) {\r\n        return this._windowTypes.getByName(name);\r\n    };\r\n    /**\r\n     * Registers a factory for a given WindowType. The factory will be called once window of that type is requested\r\n     * @param windowType   Window type that will be constructed from the factory. Can be a string (name of the window type)\r\n     * or object that has name, description properties\r\n     * @param factoryMethod      The factory that will construct Windows of that type\r\n     * @param description\r\n     * @param callback\r\n     * @param configuration\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.registerWindowFactory = function (windowType, factoryMethod, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(windowType)) {\r\n                reject(\"no windowType specified\");\r\n                return;\r\n            }\r\n            if (util.isObject(windowType)) {\r\n                windowType = windowType.getName();\r\n            }\r\n            else if (!util.isString(windowType)) {\r\n                reject(\"windowType should be string or object that has getName method\");\r\n                return;\r\n            }\r\n            var factory = new localWindowFactory_1.LocalWindowFactory(factoryMethod);\r\n            _this._bridge\r\n                .registerWindowFactory(windowType, factory)\r\n                .then(function (v) {\r\n                resolve(v);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Unregisters all factories for a given WindowType.\r\n     * @param windowType   Window type that is constructed from the factory.\r\n     * @param callback\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.unregisterWindowFactory = function (windowType, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(windowType)) {\r\n                reject(\"no windowType specified\");\r\n                return;\r\n            }\r\n            if (!util.isString(windowType)) {\r\n                reject(\"windowType should be a string\");\r\n                return;\r\n            }\r\n            _this._bridge\r\n                .unregisterWindowFactory(windowType)\r\n                .then(function (v) {\r\n                resolve(v);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * @returns All started activities\r\n     * @param activityType Can be a string or @type ActivityType. If string a new activityType will be created using the string for name.\r\n     * @returns Array of Activity objects\r\n     */\r\n    ActivityManager.prototype.getActivities = function (activityType) {\r\n        var act = this._activities.get();\r\n        if (!activityType) {\r\n            return act;\r\n        }\r\n        var types = activityType;\r\n        if (util.isString(activityType)) {\r\n            types = [activityType];\r\n        }\r\n        else if (activityType instanceof activityType_1.default) {\r\n            types = [activityType.name];\r\n        }\r\n        else if (activityType instanceof Array) {\r\n            // TODO check if string array or array of ActivityTypes\r\n        }\r\n        else {\r\n            throw new Error(\"Invalid input argument 'activityType' = \" + activityType);\r\n        }\r\n        return act.filter(function (at) {\r\n            var type = at.type;\r\n            return util.some(types, function (t) {\r\n                return type.id === t.id;\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Returns Activity by ID\r\n     */\r\n    ActivityManager.prototype.getActivityById = function (id) {\r\n        return this._activities.getByName(id);\r\n    };\r\n    /**\r\n     * Initialises activity for the current window - by doing this the window is announced as activity aware to the other participants\r\n     * @param windowType            Type of window\r\n     * @param activityWindowId      The id of the window that was created\r\n     * @returns {}                  Promise for an activity window (joined to an activity, if the activity creation fails the promise will be rejected)\r\n     */\r\n    ActivityManager.prototype.announceWindow = function (activityWindowId, windowType) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            // get the announcement info from the bridge (e.g. the context in HC) - this will be used if no arguments passed\r\n            var announcementInfo = _this._bridge.getAnnouncementInfo();\r\n            if (util.isUndefined(activityWindowId)) {\r\n                activityWindowId = announcementInfo.activityWindowId;\r\n            }\r\n            if (util.isUndefined(windowType)) {\r\n                windowType = announcementInfo.activityWindowType;\r\n            }\r\n            if (util.isUndefinedOrNull(windowType)) {\r\n                throw new Error(\"Can not announce - unknown windowType\");\r\n            }\r\n            var activityId = announcementInfo && announcementInfo.activityId;\r\n            // We cover two cases here:\r\n            // * no activityWindowId supplied (neither in arguments or announcement info) - in that case we register new window by type. Most of the time this is the case when an independent window is created outside activity\r\n            // * activityWindowId supplied - window created as part of activity creation\r\n            // NB: in GW3, windows are created standalone, and receive 'JOINED' after they send a 'READY'\r\n            // so we always go in 'if' case, not 'else'\r\n            if (util.isUndefinedOrNull(activityWindowId)) {\r\n                _this._logger.debug(\"Registering window with type:'\" + windowType + \"', name:'\" + announcementInfo.activityWindowName + \"', ind.:'\" + announcementInfo.activityWindowIndependent + \"'\");\r\n                // register new window created outside activity\r\n                _this._bridge.registerWindow(windowType, announcementInfo.activityWindowName, announcementInfo.activityWindowIndependent)\r\n                    .then(_this._windows.getOrWait.bind(_this._windows))\r\n                    .then(function (w) {\r\n                    if (activityId) {\r\n                        return _this._activities.getOrWait(activityId).then(function (_) { return w; });\r\n                    }\r\n                    else {\r\n                        return w;\r\n                    }\r\n                })\r\n                    .then(function (w) {\r\n                    resolve(w);\r\n                })\r\n                    .catch(function (err) {\r\n                    _this._logger.error(err);\r\n                });\r\n            }\r\n            else {\r\n                // announce new window created in an activity creation process\r\n                _this._logger.debug(\"Announcing window with id '\" + activityWindowId + \"' and type '\" + windowType + \"'\");\r\n                // check if the window is already created -\r\n                var currentWindow = _this._windows.getByName(activityWindowId);\r\n                if (!util.isUndefinedOrNull(currentWindow)) {\r\n                    _this._logger.debug(\"Window with id '\" + activityWindowId + \"' already announced - reusing the window\");\r\n                    resolve(currentWindow);\r\n                    return;\r\n                }\r\n                // window events handler\r\n                var windowEventHandler_1 = function (a, w, e) {\r\n                    if (activityWindowId === w.id) {\r\n                        if (typeof htmlContainer !== \"undefined\") {\r\n                            _this._logger.trace(\"Got HC event for id '\" + activityWindowId + \"'\");\r\n                            resolve(w);\r\n                            _this.unsubscribeWindowEvents(windowEventHandler_1);\r\n                        }\r\n                        else if (e === entityEvent_1.EntityEventType.ActivityWindowJoinedActivity) {\r\n                            var activity = w.activity;\r\n                            if (util.isUndefined(activity)) {\r\n                                reject(\"UNDEFINED ACTIVITY\");\r\n                            }\r\n                            _this._logger.trace(\"Got joined event for id '\" + activityWindowId + \"'\");\r\n                            resolve(w);\r\n                            _this.unsubscribeWindowEvents(windowEventHandler_1);\r\n                        }\r\n                    }\r\n                };\r\n                _this.subscribeWindowEvents(windowEventHandler_1);\r\n                _this._logger.trace(\"Waiting for joined event for id '\" + activityWindowId + \"'\");\r\n                _this._bridge.announceWindow(windowType, activityWindowId);\r\n            }\r\n        });\r\n        return promise;\r\n    };\r\n    /**\r\n     * Allows you to subscribe for windows events, e.g. window type registered\r\n     * @param handler   The handler to receive notifications\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.subscribeWindowTypeEvents = function (handler) {\r\n        this._windowTypes.subscribe(function (wt, context) {\r\n            handler(wt, context.type);\r\n        });\r\n    };\r\n    /**\r\n     * Subscribe for activity status events\r\n     * @param handler Handler function that will receive status notifications\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.subscribeActivityEvents = function (handler) {\r\n        var _this = this;\r\n        return this._activities.subscribe(function (act, context) {\r\n            if (context.type === entityEvent_1.EntityEventType.StatusChange) {\r\n                var p = context;\r\n                handler(act, p.newStatus, p.oldStatus);\r\n            }\r\n            // implicitly leave the activity on destroy\r\n            if (context.type === entityEvent_1.EntityEventType.Removed ||\r\n                (context.type === entityEvent_1.EntityEventType.StatusChange &&\r\n                    context.newStatus.getState() === entityEvent_2.ActivityState.Destroyed)) {\r\n                for (var _i = 0, _a = _this._windows.get(); _i < _a.length; _i++) {\r\n                    var window_1 = _a[_i];\r\n                    if (window_1.activity && window_1.activity.id === act.id) {\r\n                        _this._windows.process(new entityEvent_1.EntityEvent(window_1, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowLeftActivity)));\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Allows you to subscribe for windows events, e.g. window joining to activity\r\n     * @param handler   The handler to receive notifications\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.subscribeWindowEvents = function (handler) {\r\n        return this._windows.subscribe(function (window, context) {\r\n            var eventType = context.type;\r\n            if (eventType === entityEvent_1.EntityEventType.Added) {\r\n                // rename added to opened (because added is misleading - semantically it's the opposite of remove);\r\n                eventType = \"opened\";\r\n            }\r\n            handler(window.activity, window, eventType);\r\n        });\r\n    };\r\n    ActivityManager.prototype.unsubscribeWindowEvents = function (handler) {\r\n        // this._windows.unsubscribe(handler);\r\n    };\r\n    /**\r\n     * Creates a new window from a given type and joins it to an activity\r\n     *\r\n     * @param activity      Activity to join the window to\r\n     * @param windowType    The window type to join (string or window definition)\r\n     * @param callback      (Optional) Result callback\r\n     * @returns             Promise for ActivityWindow\r\n     */\r\n    ActivityManager.prototype.createWindow = function (activity, windowTypeOrConfiguration, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(windowTypeOrConfiguration)) {\r\n                reject(\"windowType is undefined\");\r\n            }\r\n            var windowDefinition;\r\n            if (util.isString(windowTypeOrConfiguration)) {\r\n                windowDefinition = { type: windowTypeOrConfiguration, name: \"\", isIndependent: false, arguments: {} };\r\n            }\r\n            else {\r\n                windowDefinition = windowTypeOrConfiguration;\r\n            }\r\n            var relativeToWindow;\r\n            if (!util.isUndefinedOrNull(windowDefinition.relativeTo)) {\r\n                relativeToWindow = windowDefinition.relativeTo;\r\n                if (typeof relativeToWindow === \"string\") {\r\n                    var windows = _this.getWindows({ type: relativeToWindow });\r\n                    if (!util.isUndefinedOrNull(windows) && windows.length > 0) {\r\n                        windowDefinition.relativeTo = windows[0].id;\r\n                    }\r\n                }\r\n                else if (!util.isUndefinedOrNull(relativeToWindow.type)) {\r\n                    var windows = _this.getWindows({ type: relativeToWindow.type });\r\n                    if (!util.isUndefinedOrNull(windows) && windows.length > 0) {\r\n                        windowDefinition.relativeTo = windows[0].id;\r\n                    }\r\n                }\r\n                else if (!util.isUndefinedOrNull(relativeToWindow.windowId)) {\r\n                    windowDefinition.relativeTo = relativeToWindow.windowId;\r\n                }\r\n            }\r\n            _this._bridge.createWindow(activity && activity.id, windowDefinition)\r\n                .then(function (wid) {\r\n                _this._logger.debug(\"Window created, waiting for window entity with id \" + wid);\r\n                var handler = function (window, context) {\r\n                    // wait until the window has activity property (this means it was joined)\r\n                    if (window.id === wid && (!activity || window.activity)) {\r\n                        _this._logger.debug(\"Got entity window with id \" + wid);\r\n                        resolve(window);\r\n                        _this._windows.unsubscribe(handler);\r\n                    }\r\n                };\r\n                // if we can not get the window right away, wait for event\r\n                _this._windows.subscribe(handler);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Creates relative windows from a given types and joins them to an activity\r\n     *\r\n     * @param activity               Activity to join relative windows to\r\n     * @param relativeWindowTypes    Relative window types to join (string or window definitions array)\r\n     * @param callback               (Optional) Result callback\r\n     * @returns                      Promise for ActivityWindow\r\n     */\r\n    ActivityManager.prototype.createStackedWindows = function (activity, relativeWindowTypes, timeout, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(activity)) {\r\n                reject(\"activity is undefined\");\r\n            }\r\n            if (util.isUndefinedOrNull(relativeWindowTypes)) {\r\n                reject(\"relativeWindowTypes is undefined\");\r\n            }\r\n            if (!Array.isArray(relativeWindowTypes)) {\r\n                reject(\"relativeWindowTypes has to be array\");\r\n            }\r\n            if (util.isUndefinedOrNull(timeout)) {\r\n                timeout = 20000; // default timeout: 20 seconds\r\n            }\r\n            var relativeWindows = [];\r\n            relativeWindowTypes.forEach(function (element) {\r\n                var windowDefinition;\r\n                if (util.isString(element)) {\r\n                    windowDefinition = { type: element, name: \"\", isIndependent: false, arguments: {} };\r\n                }\r\n                else {\r\n                    windowDefinition = element;\r\n                }\r\n                var relativeToWindow;\r\n                if (!util.isUndefinedOrNull(windowDefinition.relativeTo)) {\r\n                    // this can not be string, converted in the prev. layer\r\n                    relativeToWindow = windowDefinition.relativeTo;\r\n                    if (!util.isUndefinedOrNull(relativeToWindow.type)) {\r\n                        windowDefinition.relativeTo = relativeToWindow.type;\r\n                    }\r\n                    else if (!util.isUndefinedOrNull(relativeToWindow.windowId)) {\r\n                        var windows = _this.getWindows({ id: relativeToWindow.windowId });\r\n                        if (!util.isUndefinedOrNull(windows) && windows.length > 0) {\r\n                            windowDefinition.relativeTo = windows[0].type.name;\r\n                            windowDefinition.useExisting = true;\r\n                        }\r\n                    }\r\n                }\r\n                relativeWindows.push(windowDefinition);\r\n            });\r\n            _this._bridge.createStackedWindows(activity.id, relativeWindows, timeout)\r\n                .then(function (wid) {\r\n                var activityWindows = [];\r\n                var alreadyCreated = [];\r\n                var handler = function (window, context) {\r\n                    // wait until the window has activity property (this means it was joined)\r\n                    if (wid.indexOf(window.id) >= 0 && alreadyCreated.indexOf(window.id) < 0 && window.activity) {\r\n                        this._logger.debug(\"Got entity window with id \" + wid);\r\n                        activityWindows.push(window);\r\n                        alreadyCreated.push(window.id);\r\n                        if (activityWindows.length === wid.length) {\r\n                            resolve(activityWindows);\r\n                            this._windows.unsubscribe(handler);\r\n                        }\r\n                    }\r\n                }.bind(_this);\r\n                // if we can not get the window right away, wait for event\r\n                _this._windows.subscribe(handler);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Joins a new window from a given type to the activity\r\n     *\r\n     * @param activity      Activity to join the window to\r\n     * @param window        The window to join\r\n     * @param callback      (Optional) Result callback\r\n     * @returns             Promise for ActivityWindow\r\n     */\r\n    ActivityManager.prototype.addWindowToActivity = function (activity, window, callback) {\r\n        var toReturn = this._bridge.joinActivity(activity.id, window.id)\r\n            .then(function () { return window; });\r\n        promiseExtensions_1.nodeify(toReturn, callback);\r\n        return toReturn;\r\n    };\r\n    /**\r\n     * Removes a window from the activity\r\n     *\r\n     * @param activity  Activity to remove the window from\r\n     * @param           The window to remove\r\n     * @param           (Optional) Result callback\r\n     * @returns         Promise for ActivityWindow\r\n     */\r\n    ActivityManager.prototype.leaveWindowFromActivity = function (activity, window, callback) {\r\n        var toReturn = this._bridge.leaveActivity(activity.id, window.id)\r\n            .then(function () { return window; });\r\n        promiseExtensions_1.nodeify(toReturn, callback);\r\n        return toReturn;\r\n    };\r\n    /**\r\n     * Replaces the activity context\r\n     * @param activity  Activity\r\n     * @param context   The new context\r\n     * @param callback  (Optional) Result callback\r\n     * @returns         Promise for Activity\r\n     */\r\n    ActivityManager.prototype.setActivityContext = function (activity, context, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(activity)) {\r\n                reject(\"activity can not be null\");\r\n            }\r\n            // TODO: duplication with updateActivityContext\r\n            // DONE: verify is the change visible here when 'updateActivityContext' resolves?\r\n            _this._bridge\r\n                .updateActivityContext(activity, context, true)\r\n                .then(function (_) {\r\n                resolve(activity);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Updates activity context using the properties from  context argument.\r\n     * If old context is {a:1, b:2, c:3} and invoking updateContext({b:3, c:null}) will result a context\r\n     * be {a:1, b:3}\r\n     *\r\n     * @param activity\r\n     * @param context\r\n     * @param callback\r\n     */\r\n    ActivityManager.prototype.updateActivityContext = function (activity, context, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(activity)) {\r\n                reject(\"activity can not be null\");\r\n            }\r\n            var removedKeys = [];\r\n            for (var key in context) {\r\n                if (context.hasOwnProperty(key) && context[key] === null) {\r\n                    removedKeys.push(key);\r\n                }\r\n            }\r\n            for (var _i = 0, removedKeys_1 = removedKeys; _i < removedKeys_1.length; _i++) {\r\n                var removedKey = removedKeys_1[_i];\r\n                delete context[removedKey];\r\n            }\r\n            _this._bridge\r\n                .updateActivityContext(activity, context, false, removedKeys)\r\n                .then(function (_) {\r\n                // DONE: verify is the change already visible here when 'updateActivityContext' resolves?\r\n                resolve(activity);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Subscribe for activity context update events\r\n     *\r\n     * @param activity  Activity\r\n     * @param handler   Handler function that will receive context related events\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.subscribeActivityContextChanged = function (handler) {\r\n        this._activities.subscribe(function (act, context) {\r\n            if (context.type === entityEvent_1.EntityEventType.ActivityContextChange) {\r\n                var updateContext = context;\r\n                handler(act, act.context);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Stops an activity\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.stopActivity = function (activity, callback) {\r\n        var promise = this._bridge.stopActivity(activity);\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Returns activity windows based on some filter. If no filter supplied all activity windows are returned.\r\n     * @param filter  Filter that\r\n     * @returns Array of ActivityWindows that match the filter object\r\n     */\r\n    ActivityManager.prototype.getWindows = function (filter) {\r\n        if (util.isUndefined(filter)) {\r\n            return this._windows.get();\r\n        }\r\n        if (!util.isUndefined(filter.id)) {\r\n            return [this._windows.getByName(filter.id)];\r\n        }\r\n        var allWindows = this._windows.get();\r\n        return allWindows.filter(function (w) {\r\n            if (!util.isUndefined(filter.type) && w.type.id !== filter.type) {\r\n                return false;\r\n            }\r\n            if (!util.isUndefined(filter.name) && w.name !== filter.name) {\r\n                return false;\r\n            }\r\n            if (!util.isUndefined(filter.activityId)) {\r\n                if (util.isUndefinedOrNull(w.activity)) {\r\n                    return false;\r\n                }\r\n                if (w.activity.id !== filter.activityId) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n    };\r\n    ActivityManager.prototype.getWindowBounds = function (id) {\r\n        return this._bridge.getWindowBounds(id);\r\n    };\r\n    ActivityManager.prototype.setWindowBounds = function (id, bounds, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            _this._bridge.setWindowBounds(id, bounds)\r\n                .then(function () { return resolve(); })\r\n                .catch(function (err) { return reject(err); });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    ActivityManager.prototype.closeWindow = function (id) {\r\n        return this._bridge.closeWindow(id);\r\n    };\r\n    ActivityManager.prototype.activateWindow = function (id, focus) {\r\n        return this._bridge.activateWindow(id, focus);\r\n    };\r\n    ActivityManager.prototype.setWindowVisibility = function (id, visible) {\r\n        return this._bridge.setWindowVisibility(id, visible);\r\n    };\r\n    ActivityManager.prototype.clone = function (activity, cloneOptions, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (!activity) {\r\n                reject(\"activity can not be null\");\r\n            }\r\n            _this._bridge.cloneActivity(activity.id, cloneOptions)\r\n                .then(function (activityId) {\r\n                _this._activities\r\n                    .getOrWait(activityId)\r\n                    .then(function (act) {\r\n                    resolve(act);\r\n                })\r\n                    .catch(function (err) { return reject(err); });\r\n            })\r\n                .catch(function (err) { return reject(err); });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    ActivityManager.prototype.attachActivities = function (from, to, tag, callback) {\r\n        var _this = this;\r\n        tag = tag || {};\r\n        var promise = new Promise(function (resolve, reject) {\r\n            var fromActivity = _this._activities.getByName(from);\r\n            if (!fromActivity) {\r\n                reject(\"can not find activity with id \" + from);\r\n                return;\r\n            }\r\n            var toActivity = _this._activities.getByName(to);\r\n            if (!toActivity) {\r\n                reject(\"can not find activity with id \" + to);\r\n                return;\r\n            }\r\n            return _this._bridge.attachActivities(from, to, tag)\r\n                .then(function (data) {\r\n                var newActId = data.to;\r\n                var state = data.descriptor;\r\n                var allStates = data.descriptors;\r\n                _this._activities.getOrWait(newActId).then(function (act) {\r\n                    act._updateDescriptors(allStates);\r\n                    var stateWrapped = act.attached.filter(function (u) { return u.ownerId === state.ownerId; })[0];\r\n                    resolve(stateWrapped);\r\n                });\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    ActivityManager.prototype.detachActivities = function (activityId, descriptor, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            return _this._bridge.detachActivities(activityId, descriptor)\r\n                .then(/*(params)*/ function () {\r\n                // #deleteme TODO: deal with this\r\n                var oldActId = undefined; // params.oldActivityId;\r\n                var newActId = undefined; // params.newActivityId;\r\n                var descriptors = undefined; // params.descriptors;\r\n                _this._activities\r\n                    .getOrWait(oldActId)\r\n                    .then(function (oldAct) {\r\n                    oldAct._updateDescriptors(descriptors);\r\n                    _this._activities\r\n                        .getOrWait(newActId)\r\n                        .then(function (newAct) {\r\n                        resolve(newAct);\r\n                    });\r\n                })\r\n                    .catch(function (err) { return reject(err); });\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    ActivityManager.prototype.subscribeActivitiesAttached = function (callback) {\r\n        this._attachedCallbacks.push(callback);\r\n    };\r\n    ActivityManager.prototype.subscribeActivitiesDetached = function (callback) {\r\n        this._detachedCallbacks.push(callback);\r\n    };\r\n    ActivityManager.prototype.subscribeActivityFrameColorChanged = function (callback) {\r\n        this._frameColorChangesCallbacks.push(callback);\r\n    };\r\n    /** Assigns a manager to a given ActivityEntity */\r\n    ActivityManager.prototype._grabEntity = function (entity) {\r\n        entity._manager = this;\r\n    };\r\n    ActivityManager.prototype._getInitialData = function () {\r\n        var _this = this;\r\n        this._logger.debug(\"Request initial data...\");\r\n        // NB: there's no possibility for duplicate entities from events that have come\r\n        // in between _bridge.init() and _bridge.ready()'s resolve, since the ObservableCollections\r\n        // coalesce items by id.\r\n        this._bridge.getActivityTypes()\r\n            .then(function (at) {\r\n            _this._activityTypes.add(at);\r\n            _this._dataReadyMarker.signal(\"Got act types\");\r\n        })\r\n            .catch(function (error) {\r\n            _this._logger.error(error);\r\n            _this._dataReadyMarker.error(\"Can not initialize ActivityManager - error getting activity types -\" + error);\r\n        });\r\n        this._bridge.getWindowTypes()\r\n            .then(function (wt) {\r\n            _this._windowTypes.add(wt);\r\n            _this._dataReadyMarker.signal(\"Got window types\");\r\n        })\r\n            .catch(function (error) {\r\n            _this._logger.error(error);\r\n            _this._dataReadyMarker.error(\"Can not initialize ActivityManager - error getting window types  \" + error);\r\n        });\r\n        this._bridge.getActivities()\r\n            .then(function (ac) {\r\n            _this._activities.add(ac);\r\n            _this._dataReadyMarker.signal(\"Got activities\");\r\n        })\r\n            .catch(function (error) {\r\n            _this._logger.error(error);\r\n            _this._dataReadyMarker.error(\"Can not initialize ActivityManager - error getting activity instances -\" + error);\r\n        });\r\n        this._bridge.getActivityWindows()\r\n            .then(function (aw) {\r\n            _this._windows.add(aw);\r\n            _this._dataReadyMarker.signal(\"Got windows\");\r\n        })\r\n            .catch(function (error) {\r\n            _this._logger.error(error);\r\n            _this._dataReadyMarker.error(\"Can not initialize ActivityManager - error getting activity windows -\" + error);\r\n        });\r\n    };\r\n    ActivityManager.prototype._subscribeForData = function () {\r\n        var _this = this;\r\n        this._logger.debug(\"Subscribe for data...\");\r\n        // NB: there's no possibility for duplicate entities from events that have come\r\n        // in between _bridge.init() and _bridge.ready()'s resolve, since the ObservableCollections\r\n        // coalesce items by id.\r\n        this._bridge.onActivityTypeStatusChange(function (event) {\r\n            _this._activityTypes.process(event);\r\n        });\r\n        this._bridge.onWindowTypeStatusChange(function (event) {\r\n            _this._windowTypes.process(event);\r\n        });\r\n        this._bridge.onActivityStatusChange(function (event) {\r\n            var activity = _this._activities.process(event);\r\n            if (event.context.type === entityEvent_1.EntityEventType.ActivityWindowJoinedActivity &&\r\n                activity &&\r\n                activity.context &&\r\n                _this._bridge instanceof hcBridge_1.default) {\r\n                // for parity with older code which explicitly sent a context update to subscribers\r\n                // upon joining an activity\r\n                _this._activities.process(new entityEvent_1.EntityEvent(activity, new entityEvent_1.ActivityContextChangedEventContext(activity.context)));\r\n            }\r\n        });\r\n        this._bridge.onActivityWindowChange(function (event) {\r\n            _this._windows.process(event);\r\n        });\r\n    };\r\n    ActivityManager.prototype._handleActivitiesAttached = function (data) {\r\n        var _this = this;\r\n        var newActId = data.to;\r\n        var descriptor = data.descriptor;\r\n        var descriptors = data.descriptors;\r\n        this._activities.getOrWait(newActId).then(function (act) {\r\n            act._updateDescriptors(descriptors);\r\n            var descriptorAsObjectFromAPI = act.attached.filter(function (u) { return u.ownerId === descriptor.ownerId; })[0];\r\n            _this._attachedCallbacks.forEach(function (callback) {\r\n                try {\r\n                    callback(act, descriptorAsObjectFromAPI);\r\n                }\r\n                catch (err) {\r\n                    return;\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ActivityManager.prototype._handleActivitiesDetached = function (data) {\r\n        var _this = this;\r\n        var oldActId = data.oldActivityId;\r\n        var newActId = data.newActivityId;\r\n        var descriptors = data.descriptors;\r\n        var descriptor = data.descriptor;\r\n        this._activities.getOrWait(oldActId).then(function (oldAct) {\r\n            oldAct._updateDescriptors(descriptors);\r\n            _this._activities.getOrWait(newActId).then(function (newAct) {\r\n                _this._detachedCallbacks.forEach(function (callback) {\r\n                    try {\r\n                        callback(newAct, oldAct, descriptor);\r\n                    }\r\n                    catch (err) {\r\n                        return;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    };\r\n    ActivityManager.prototype._handleActivityDescriptorsRefreshed = function (data) {\r\n        var id = data.id;\r\n        var descriptors = data.descriptors;\r\n        var act = this._activities.getByName(id);\r\n        if (act) {\r\n            act._updateDescriptors(descriptors);\r\n        }\r\n    };\r\n    ActivityManager.prototype.refreshDescriptors = function () {\r\n        var _this = this;\r\n        this._bridge.getAttachedDescriptors()\r\n            .then(function (map) {\r\n            // populate descriptors\r\n            if (map) {\r\n                Object.keys(map).forEach(function (key) {\r\n                    var actId = key;\r\n                    var descriptors = map[key];\r\n                    var act = _this._activities.getByName(actId);\r\n                    if (act) {\r\n                        act._updateDescriptors(descriptors);\r\n                    }\r\n                });\r\n            }\r\n            _this._descriptorsMarker.signal(\"Successfully got descriptors\");\r\n        })\r\n            .catch(function (err) {\r\n            _this._descriptorsMarker.error(\"failed to get descriptors - \" + err);\r\n        });\r\n    };\r\n    ActivityManager.prototype._handleWindowFrameColorChanged = function (win) {\r\n        if (!win.activityId) {\r\n            return;\r\n        }\r\n        var act = this._activities.getByName(win.activityId);\r\n        if (!act) {\r\n            return;\r\n        }\r\n        // notify for the owner only\r\n        if (!act.owner) {\r\n            return;\r\n        }\r\n        if (act.owner.underlyingWindow.id !== win.id) {\r\n            return;\r\n        }\r\n        this._frameColorChangesCallbacks.forEach(function (callback) {\r\n            try {\r\n                callback(act, win.frameColor);\r\n            }\r\n            catch (e) {\r\n                return;\r\n            }\r\n        });\r\n    };\r\n    return ActivityManager;\r\n}());\r\nexports.default = ActivityManager;\r\n//# sourceMappingURL=activityManager.js.map\n\n/***/ }),\n/* 56 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LocalWindowFactory = /** @class */ (function () {\r\n    function LocalWindowFactory(createFunction) {\r\n        this.createFunction = createFunction;\r\n        this.createFunction = createFunction;\r\n    }\r\n    LocalWindowFactory.prototype.create = function (activityInfo) {\r\n        return this.createFunction(activityInfo);\r\n    };\r\n    return LocalWindowFactory;\r\n}());\r\nexports.LocalWindowFactory = LocalWindowFactory;\r\n//# sourceMappingURL=localWindowFactory.js.map\n\n/***/ }),\n/* 57 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AttachedActivityDescriptor = /** @class */ (function () {\r\n    function AttachedActivityDescriptor(manager, ownerActivityId, state) {\r\n        this._manager = manager;\r\n        this._ownerActivityId = ownerActivityId;\r\n        this._state = state;\r\n    }\r\n    Object.defineProperty(AttachedActivityDescriptor.prototype, \"ownerId\", {\r\n        get: function () {\r\n            return this._state.ownerId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AttachedActivityDescriptor.prototype, \"windowIds\", {\r\n        get: function () {\r\n            return this._state.windowIds;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AttachedActivityDescriptor.prototype, \"frameColor\", {\r\n        get: function () {\r\n            return this._state.frameColor;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AttachedActivityDescriptor.prototype, \"context\", {\r\n        get: function () {\r\n            return this._state.context;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AttachedActivityDescriptor.prototype, \"tag\", {\r\n        get: function () {\r\n            return this._state.tag;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AttachedActivityDescriptor.prototype.detach = function (descriptor) {\r\n        var _this = this;\r\n        descriptor = descriptor || {};\r\n        var merged = {};\r\n        Object.keys(this._state).forEach(function (prop) {\r\n            merged[prop] = _this._state[prop];\r\n        });\r\n        merged.context = descriptor.context || merged.context;\r\n        merged.frameColor = descriptor.frameColor || merged.frameColor;\r\n        return this._manager.detachActivities(this._ownerActivityId, merged);\r\n    };\r\n    return AttachedActivityDescriptor;\r\n}());\r\nexports.AttachedActivityDescriptor = AttachedActivityDescriptor;\r\n//# sourceMappingURL=attachedActivityDescriptor.js.map\n\n/***/ }),\n/* 58 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar entityEvent_1 = __webpack_require__(2);\r\nvar entityEvent_2 = __webpack_require__(2);\r\n/**\r\n * Collection of ActivityEntities that provides change notifications\r\n * @module entityCollection\r\n * @private\r\n */\r\nvar EntityObservableCollection = /** @class */ (function () {\r\n    function EntityObservableCollection(processNew) {\r\n        this._items = {};\r\n        this._listeners = [];\r\n        this._processNew = processNew;\r\n    }\r\n    /**\r\n     * Adds one item to the collection\r\n     */\r\n    EntityObservableCollection.prototype.addOne = function (item) {\r\n        this.add([item]);\r\n    };\r\n    /**\r\n     * Adds an array of items to the collection\r\n     */\r\n    EntityObservableCollection.prototype.add = function (items) {\r\n        var _this = this;\r\n        items.forEach(function (element) {\r\n            _this.process(new entityEvent_1.EntityEvent(element, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added)));\r\n        });\r\n    };\r\n    /**\r\n     * Process existing EntityEvent\r\n     */\r\n    EntityObservableCollection.prototype.process = function (event) {\r\n        var context = event.context;\r\n        var type = context.type;\r\n        var entity = event.entity;\r\n        // here we're populating some data which particular implementations (e.g.\r\n        // GW3) can't provide\r\n        // TODO: extract these cases into external filters\r\n        // activity status change without old status?\r\n        // grab it from the existing entity\r\n        if (type === entityEvent_1.EntityEventType.StatusChange &&\r\n            !context.oldStatus) {\r\n            var act = this._items[entity.id];\r\n            if (act) {\r\n                context.oldStatus = act.status;\r\n            }\r\n        }\r\n        // the GW3 bridge notifies us of possible status changes (it's mostly stateless so\r\n        // it can't/doesn't distinguish between JOINED ACTIVITY for an activity we already\r\n        // know about vs a brand new activity. for this reason, we just coalesce status\r\n        // updates which indicate the same state.\r\n        if (type === entityEvent_1.EntityEventType.StatusChange &&\r\n            context.oldStatus &&\r\n            context.newStatus &&\r\n            context.oldStatus.state ===\r\n                context.newStatus.state) {\r\n            context.type = entityEvent_1.EntityEventType.Updated;\r\n        }\r\n        // coalesce multiple joined/left events\r\n        //\r\n        if (type === entityEvent_1.EntityEventType.ActivityWindowJoinedActivity &&\r\n            this._items[entity.id] &&\r\n            this._items[entity.id].activity) {\r\n            context.type = entityEvent_1.EntityEventType.Updated;\r\n        }\r\n        if (type === entityEvent_1.EntityEventType.ActivityWindowLeftActivity &&\r\n            this._items[entity.id] &&\r\n            !this._items[entity.id].activity) {\r\n            context.type = entityEvent_1.EntityEventType.Updated;\r\n        }\r\n        // update internal collections (adding the entity or updating existing entity). From that\r\n        // point start using the internalEntity\r\n        // NB: undefined properties are coalesced, null properties represent removals\r\n        var internalEntity = this._updateInternalCollections(entity, type, context);\r\n        this._notifyListeners(internalEntity, context);\r\n        return internalEntity;\r\n    };\r\n    /**\r\n     * Gets all items from the collection.\r\n     */\r\n    EntityObservableCollection.prototype.get = function () {\r\n        var result = [];\r\n        for (var key in this._items) {\r\n            if (this._items.hasOwnProperty(key)) {\r\n                var element = this._items[key];\r\n                result.push(element);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    /**\r\n     * Gets item by name/id\r\n     * @param name  Name/id of the item to get\r\n     * @returns     Item if found; undefined if not\r\n     */\r\n    EntityObservableCollection.prototype.getByName = function (name) {\r\n        // this does not work for some reason\r\n        // return this._items[name];\r\n        for (var key in this._items) {\r\n            if (key === name) {\r\n                return this._items[key];\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    /**\r\n     * Gets a item if in the collection or waits for it to appear\r\n     * @param name\r\n     * @returns {Promise<T>}\r\n     */\r\n    EntityObservableCollection.prototype.getOrWait = function (name) {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            var entityAddedHandler = function (entity) {\r\n                if (entity.id !== name) {\r\n                    return;\r\n                }\r\n                resolve(entity);\r\n                _this.unsubscribe(entityAddedHandler);\r\n            };\r\n            _this.subscribe(entityAddedHandler);\r\n            // try to get right away - if not here wait for it to appear\r\n            var window = _this.getByName(name);\r\n            if (window) {\r\n                _this.unsubscribe(entityAddedHandler);\r\n                resolve(window);\r\n                return;\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Subscribes a listener for changes\r\n     * @param handler Callback for changes\r\n     */\r\n    EntityObservableCollection.prototype.subscribe = function (handler) {\r\n        var _this = this;\r\n        this._listeners.push(handler);\r\n        // replay existing items for new subscribers\r\n        Object.keys(this._items).forEach(function (key) {\r\n            var element = _this._items[key];\r\n            handler(element, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added.toString()));\r\n        });\r\n        return function () {\r\n            _this.unsubscribe(handler);\r\n        };\r\n    };\r\n    /**\r\n     *  Unsubscribes a listener\r\n     */\r\n    EntityObservableCollection.prototype.unsubscribe = function (handler) {\r\n        var index = this._listeners.indexOf(handler);\r\n        if (index !== -1) {\r\n            this._listeners.splice(index, 1);\r\n        }\r\n    };\r\n    /**\r\n     * Notify all listeners for some event\r\n     */\r\n    EntityObservableCollection.prototype._notifyListeners = function (entity, context) {\r\n        this._listeners.forEach(function (listener) {\r\n            try {\r\n                listener(entity, context);\r\n            }\r\n            catch (e) {\r\n                return;\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Update internal collections (usually after some kind of modification event has arrived)\r\n     */\r\n    EntityObservableCollection.prototype._updateInternalCollections = function (entity, type, context) {\r\n        var entityAsAny = entity;\r\n        // #deleteme TODO: refactor - currently we apply some rules for each type\r\n        var isActivityDestroy = (type === entityEvent_1.EntityEventType.StatusChange &&\r\n            entityAsAny.status &&\r\n            entityAsAny.status.state === entityEvent_2.ActivityState.Destroyed) ||\r\n            (type === entityEvent_1.EntityEventType.StatusChange &&\r\n                context &&\r\n                context.newStatus &&\r\n                context.newStatus.state === entityEvent_2.ActivityState.Destroyed);\r\n        // #deleteme TODO: verify this stuff\r\n        // windows have two states - removed from activity and closed (TODO: this only works in GD 2.1 and later)\r\n        var isWindowClose = type === entityEvent_1.EntityEventType.Closed;\r\n        var isTypeRemove = type === entityEvent_1.EntityEventType.Removed && typeof entityAsAny.isIndependent === \"undefined\";\r\n        if (isTypeRemove || isWindowClose || isActivityDestroy) {\r\n            var oldEntity = this._items[entity.id];\r\n            delete this._items[entity.id];\r\n            // on remove return the input entity\r\n            this._processNew(entity);\r\n            if (oldEntity) {\r\n                entity._beforeDelete(oldEntity);\r\n            }\r\n            return entity;\r\n        }\r\n        else {\r\n            var key = entity.id;\r\n            // if new object add, otherwise clone object properties\r\n            if (!this._items.hasOwnProperty(key)) {\r\n                this._processNew(entity);\r\n                this._items[entity.id] = entity;\r\n            }\r\n            else {\r\n                this._items[entity.id]._update(entity);\r\n            }\r\n        }\r\n        return this._items[entity.id];\r\n    };\r\n    return EntityObservableCollection;\r\n}());\r\nexports.EntityObservableCollection = EntityObservableCollection;\r\n//# sourceMappingURL=entityObservableCollection.js.map\n\n/***/ }),\n/* 59 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityModule_1 = __webpack_require__(53);\r\nexports.ActivityModule = activityModule_1.ActivityModule;\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 60 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar application_1 = __webpack_require__(61);\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar instance_1 = __webpack_require__(65);\r\nvar AppManagerImpl = /** @class */ (function () {\r\n    function AppManagerImpl(_agm, _activities, _windows, _logger, _gdMajorVersion) {\r\n        var _this = this;\r\n        this._agm = _agm;\r\n        this._activities = _activities;\r\n        this._windows = _windows;\r\n        this._logger = _logger;\r\n        this._gdMajorVersion = _gdMajorVersion;\r\n        this._apps = {};\r\n        this._instances = [];\r\n        this._registry = callback_registry_1.default();\r\n        this.application = function (name) {\r\n            return _this._apps[name];\r\n        };\r\n        this.applications = function () {\r\n            return Object.keys(_this._apps).map(function (k) { return _this._apps[k]; });\r\n        };\r\n        this.instances = function () {\r\n            return _this._instances;\r\n        };\r\n        this.getMyInstance = function () {\r\n            if (_this._gdMajorVersion >= 3) {\r\n                // GD3 check\r\n                var instanceId_1 = window.glue42gd.appInstanceId;\r\n                return _this._instances.filter(function (i) { return i.id === instanceId_1; })[0];\r\n            }\r\n            if (_this._gdMajorVersion === 2) {\r\n                var myWindowId_1 = window.htmlContainer.windowId;\r\n                var matchingInstances = _this._instances.filter(function (i) { return i.id === myWindowId_1; });\r\n                if (matchingInstances.length < 2) {\r\n                    return matchingInstances[0];\r\n                }\r\n                // If we have two matches - this can happen only when asking for the window\r\n                // of activity owner - so return the instance that is not activity instance\r\n                return matchingInstances.filter(function (i) { return !i.isActivityInstance; })[0];\r\n            }\r\n            return undefined;\r\n        };\r\n        this.handleAppAdded = function (props) {\r\n            var id = _this._getAppId(props);\r\n            _this._logger.trace(\"adding app \" + id);\r\n            _this._apps[id] = new application_1.default(_this, id, _this._agm);\r\n            var app = _this._updateAppFromProps(props);\r\n            _this._registry.execute(\"appAdded\", app);\r\n        };\r\n        this.handleAppUpdated = function (props) {\r\n            // TODO: check side effects, is this._apps updated?\r\n            var app = _this._updateAppFromProps(props);\r\n            _this._registry.execute(\"appChanged\", app);\r\n        };\r\n        this.handleAppRemoved = function (props) {\r\n            var id = _this._getAppId(props);\r\n            _this._logger.trace(\"removing app \" + id);\r\n            var app = _this.application(id);\r\n            // remove all instances related to the app\r\n            _this._instances = _this._instances.filter(function (i) { return i.application.name !== app.name; });\r\n            delete _this._apps[id];\r\n            _this._registry.execute(\"appRemoved\", app);\r\n        };\r\n        this.handleAppReady = function (props) {\r\n            var id = _this._getAppId(props);\r\n            var app = _this._getAppOrThrow(id);\r\n            app.updateFromProps(props);\r\n            if (app.available) {\r\n                _this._registry.execute(\"appAvailable\", app);\r\n            }\r\n            else {\r\n                _this._registry.execute(\"appUnavailable\", app);\r\n            }\r\n        };\r\n        this.handleInstanceStarted = function (props) {\r\n            _this._logger.trace(\"started app \" + props.Name + \" \" + props.Id);\r\n            var id = _this._getInstanceId(props);\r\n            var app = _this.application(_this._getInstanceAppName(props));\r\n            var instance = new instance_1.default(id, app, _this, _this._agm, _this._activities, _this._windows);\r\n            _this._updateInstanceFromProps(instance, props);\r\n            _this._instances.push(instance);\r\n            _this._registry.execute(\"instanceStarted\", instance);\r\n        };\r\n        this.handleInstanceStopped = function (props) {\r\n            _this._logger.trace(\"failed to start app \" + props.Name + \" \" + props.Id);\r\n            var id = _this._getInstanceId(props);\r\n            var appName = _this._getInstanceAppName(props);\r\n            var instance = _this._getInstanceOrThrow(id, appName);\r\n            _this._instances = _this._instances.filter(function (i) { return !_this._matchInstance(i, id, appName); });\r\n            _this._registry.execute(\"instanceStopped\", instance);\r\n            instance.done();\r\n        };\r\n        this.handleInstanceAgmServerReady = function (props) {\r\n            var id = _this._getInstanceId(props);\r\n            var appName = _this._getInstanceAppName(props);\r\n            var instance = _this._getInstanceOrThrow(id, appName);\r\n            instance.updateAgmInstanceFromProps(props);\r\n            _this._registry.execute(\"instanceAgmServerReady\", instance);\r\n        };\r\n        this.handleInstanceStartFailed = function (props) {\r\n            var id = _this._getInstanceId(props);\r\n            var app = _this.application(_this._getInstanceAppName(props));\r\n            var startFailed = true;\r\n            var instance = new instance_1.default(id, app, undefined, undefined, undefined, undefined, startFailed);\r\n            _this._updateInstanceFromProps(instance, props);\r\n            _this._registry.execute(\"instanceStartFailed\", instance);\r\n        };\r\n        this.handleInstanceUpdated = function (props) {\r\n            var id = _this._getInstanceId(props);\r\n            var app = _this._getInstanceAppName(props);\r\n            var instance = _this._getInstanceOrThrow(id, app);\r\n            _this._updateInstanceFromProps(instance, props);\r\n        };\r\n        /** Event subscription methods */\r\n        this.onInstanceStarted = function (callback) {\r\n            _this._replay(_this._instances, callback);\r\n            return _this._registry.add(\"instanceStarted\", callback);\r\n        };\r\n        this.onInstanceStartFailed = function (callback) {\r\n            return _this._registry.add(\"instanceStartFailed\", callback);\r\n        };\r\n        this.onInstanceStopped = function (callback) {\r\n            return _this._registry.add(\"instanceStopped\", callback);\r\n        };\r\n        this.onInstanceUpdated = function (callback) {\r\n            return _this._registry.add(\"instanceChanged\", callback);\r\n        };\r\n        this.onInstanceAgmServerReady = function (callback) {\r\n            return _this._registry.add(\"instanceAgmServerReady\", callback);\r\n        };\r\n        this.onAppAdded = function (callback) {\r\n            _this._replay(_this._apps, callback);\r\n            return _this._registry.add(\"appAdded\", callback);\r\n        };\r\n        this.onAppRemoved = function (callback) {\r\n            return _this._registry.add(\"appRemoved\", callback);\r\n        };\r\n        this.onAppAvailable = function (callback) {\r\n            return _this._registry.add(\"appAvailable\", callback);\r\n        };\r\n        this.onAppUnavailable = function (callback) {\r\n            return _this._registry.add(\"appUnavailable\", callback);\r\n        };\r\n        this.onAppChanged = function (callback) {\r\n            return _this._registry.add(\"appChanged\", callback);\r\n        };\r\n        //\r\n    }\r\n    AppManagerImpl.prototype._getAppOrThrow = function (id) {\r\n        var result = this.application(id);\r\n        if (!result) {\r\n            throw Error(\"app with id \" + id + \" not found\");\r\n        }\r\n        return result;\r\n    };\r\n    AppManagerImpl.prototype._getAppId = function (props) {\r\n        return props.Name;\r\n    };\r\n    AppManagerImpl.prototype._matchInstance = function (instance, id, appName) {\r\n        return instance.id === id && instance.application.name === appName;\r\n    };\r\n    AppManagerImpl.prototype._getInstanceByIdAndName = function (id, appName) {\r\n        var _this = this;\r\n        return this._instances.filter(function (i) { return _this._matchInstance(i, id, appName); })[0];\r\n    };\r\n    AppManagerImpl.prototype._getInstanceOrThrow = function (id, appName) {\r\n        var result = this._getInstanceByIdAndName(id, appName);\r\n        if (!result) {\r\n            throw Error(\"instance with id \" + id + \" not found\");\r\n        }\r\n        return result;\r\n    };\r\n    AppManagerImpl.prototype._getInstanceId = function (props) {\r\n        return props.Id;\r\n    };\r\n    AppManagerImpl.prototype._getInstanceAppName = function (props) {\r\n        return props.Name;\r\n    };\r\n    AppManagerImpl.prototype._updateAppFromProps = function (props) {\r\n        var id = this._getAppId(props);\r\n        this._logger.trace(\"updating app with  + \" + id + \", \" + props);\r\n        var app = this._getAppOrThrow(id);\r\n        app.updateFromProps(props);\r\n        return app;\r\n    };\r\n    AppManagerImpl.prototype._updateInstanceFromProps = function (instance, props) {\r\n        this._logger.trace(\"updating instance with \" + this._getInstanceId(props) + \" for app \" + this._getInstanceAppName(props));\r\n        instance.updateFromProps(props);\r\n    };\r\n    AppManagerImpl.prototype._replay = function (itemsToReplay, callback) {\r\n        if (itemsToReplay) {\r\n            // if not array transform to array using Object.values\r\n            if (Array.isArray(itemsToReplay)) {\r\n                itemsToReplay.forEach(function (item) { return callback(item); });\r\n            }\r\n            else {\r\n                var itemsToReplayArr = Object.keys(itemsToReplay).map(function (key) { return itemsToReplay[key]; });\r\n                itemsToReplayArr.forEach(function (item) { return callback(item); });\r\n            }\r\n        }\r\n    };\r\n    return AppManagerImpl;\r\n}());\r\nexports.default = AppManagerImpl;\r\n//# sourceMappingURL=app-manager.js.map\n\n/***/ }),\n/* 61 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AgmNames = __webpack_require__(5);\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar helper_1 = __webpack_require__(11);\r\nvar ApplicationImpl = /** @class */ (function () {\r\n    function ApplicationImpl(_appManager, _name, _agm) {\r\n        // TODO: Replace string events with constants. The string declaration of the registry event name should only ever appear once. Ever. Period.\r\n        var _this = this;\r\n        this._appManager = _appManager;\r\n        this._name = _name;\r\n        this._agm = _agm;\r\n        this._registry = callback_registry_1.default();\r\n        // subscribe for events from app-manager\r\n        _appManager.onInstanceStarted(function (instance) {\r\n            if (instance.application.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"instanceStarted\", instance);\r\n        });\r\n        _appManager.onInstanceStopped(function (instance) {\r\n            if (instance.application.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"instanceStopped\", instance);\r\n        });\r\n        _appManager.onAppRemoved(function (app) {\r\n            if (app.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"appRemoved\", app);\r\n        });\r\n        _appManager.onAppChanged(function (app) {\r\n            if (app.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"appChanged\", app);\r\n        });\r\n        _appManager.onAppAvailable(function (app) {\r\n            if (app.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"appAvailable\", app);\r\n        });\r\n        _appManager.onAppUnavailable(function (app) {\r\n            if (app.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"appUnavailable\", app);\r\n        });\r\n    }\r\n    Object.defineProperty(ApplicationImpl.prototype, \"name\", {\r\n        get: function () { return this._name; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"title\", {\r\n        get: function () { return this._props.Title; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"version\", {\r\n        get: function () { return this._props.Version; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"autoStart\", {\r\n        get: function () { return this._props.AutoStart; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"isShell\", {\r\n        get: function () { return this._props.IsShell; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"caption\", {\r\n        get: function () { return this._props.Caption; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"hidden\", {\r\n        get: function () { return this._props.IsHidden; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"container\", {\r\n        get: function () { return this._props.ApplicationName; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"activityType\", {\r\n        get: function () { return this._props.ActivityType; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"activityWindowType\", {\r\n        get: function () { return this._props.ActivityWindowType; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"windowSettings\", {\r\n        get: function () {\r\n            if (!this._props.Arguments) {\r\n                return {};\r\n            }\r\n            return helper_1.objectClone(this._props.Arguments);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"allowMultiple\", {\r\n        get: function () { return this._props.AllowMultiple; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"available\", {\r\n        get: function () { return this._props.IsReady || false; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"icon\", {\r\n        get: function () { return this._props.Icon; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"iconURL\", {\r\n        get: function () { return this._props.IconUrl; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"sortOrder\", {\r\n        get: function () { return this._props.SortOrder; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"userProperties\", {\r\n        get: function () {\r\n            if (!this._props.UserProperties) {\r\n                return {};\r\n            }\r\n            return helper_1.objectClone(this._props.UserProperties);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"isActivity\", {\r\n        get: function () {\r\n            return this._props.ActivityType !== undefined && this._props.ActivityType !== \"\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"configuration\", {\r\n        get: function () {\r\n            return {\r\n                autoStart: this._props.AutoStart,\r\n                caption: this._props.Caption,\r\n                hidden: this._props.IsHidden,\r\n                container: this._props.ApplicationName,\r\n                activityType: this._props.ActivityType,\r\n                allowMultiple: this._props.AllowMultiple\r\n            };\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"instances\", {\r\n        get: function () {\r\n            var _this = this;\r\n            return this._appManager.instances().filter(function (instance) { return instance.application.name === _this._name; });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"type\", {\r\n        get: function () {\r\n            return this._props.Type;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"mode\", {\r\n        get: function () {\r\n            if (!this._props) {\r\n                // no info about the app\r\n                return \"unknown\";\r\n            }\r\n            // GD3 - we always have Mode from the stream object\r\n            if (this._props.Mode && typeof this._props.Mode === \"string\") {\r\n                return this._props.Mode.toLowerCase();\r\n            }\r\n            // GD2\r\n            // return unknown for activity applications\r\n            if (this.isActivity) {\r\n                return \"unknown\";\r\n            }\r\n            // check definition -> hc.args.mode\r\n            if (this._props.Arguments && this._props.Arguments.mode && typeof this._props.Arguments.mode === \"string\") {\r\n                return this._props.Arguments.mode.toLowerCase();\r\n            }\r\n            // if no hc.args.mode, check hc.WindowStyleAttributes\r\n            var styleAttributes = this._props.WindowStyleAttributes;\r\n            if (styleAttributes) {\r\n                // WindowStyleAttributes is not a valid JSON, we will need to find mode in the string\r\n                styleAttributes = styleAttributes.split(\" \").join(\"\");\r\n                var searchFor = \"mode:\\\"\";\r\n                var modeIndex = styleAttributes.indexOf(searchFor);\r\n                if (modeIndex !== -1) {\r\n                    var startModeIndex = modeIndex + searchFor.length;\r\n                    var stopModeIndex = styleAttributes.indexOf(\"\\\"\", startModeIndex);\r\n                    var style = styleAttributes.substr(startModeIndex, stopModeIndex - startModeIndex);\r\n                    if (style && typeof style === \"string\") {\r\n                        return style.toLowerCase();\r\n                    }\r\n                }\r\n            }\r\n            // default mode for GD2\r\n            return \"flat\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ApplicationImpl.prototype.updateFromProps = function (props) {\r\n        var _this = this;\r\n        if (!this._props) {\r\n            this._props = { Name: props.Name };\r\n        }\r\n        Object.keys(props).forEach(function (key) {\r\n            _this._props[key] = props[key];\r\n        });\r\n    };\r\n    ApplicationImpl.prototype.start = function (context, options) {\r\n        var _this = this;\r\n        var name = this._name;\r\n        var startTimeout = 10000;\r\n        return new Promise(function (resolve, reject) {\r\n            options = options || {};\r\n            context = context || {};\r\n            context._t42 = { createWindowArgs: options };\r\n            if (typeof options.waitForAGMReady === \"undefined\") {\r\n                options.waitForAGMReady = true;\r\n            }\r\n            var waitForAGMInstance = options.waitForAGMReady;\r\n            var waitForInstance = !options.waitForAGMReady;\r\n            var waitForApplicationInstance = function (id) {\r\n                // fetch from the current list in app-manager\r\n                var check = function () {\r\n                    var filtered = _this._appManager.instances().filter(function (i) { return i.id === id; });\r\n                    var result;\r\n                    if (filtered.length === 2) {\r\n                        result = filtered[0].isActivityInstance ? filtered[0] : filtered[1];\r\n                    }\r\n                    result = filtered[0];\r\n                    if (result && waitForAGMInstance) {\r\n                        if (result.agm) {\r\n                            return result;\r\n                        }\r\n                        else {\r\n                            return undefined;\r\n                        }\r\n                    }\r\n                    return result;\r\n                };\r\n                var unsub;\r\n                // reject after some timeout\r\n                setTimeout(function () {\r\n                    if (unsub) {\r\n                        unsub();\r\n                        reject(\"timeout\");\r\n                    }\r\n                }, startTimeout);\r\n                var waitFunc = function (i) {\r\n                    if (i.id !== id) {\r\n                        return;\r\n                    }\r\n                    if (unsub) {\r\n                        unsub();\r\n                        unsub = undefined;\r\n                    }\r\n                    // schedule - we need this because there might be more than one\r\n                    // instance with the same id (activity case) - so this handler\r\n                    // will kick for the very first\r\n                    setTimeout(function () {\r\n                        resolve(check());\r\n                    }, 1);\r\n                };\r\n                if (waitForAGMInstance) {\r\n                    unsub = _this._appManager.onInstanceAgmServerReady(waitFunc);\r\n                }\r\n                else {\r\n                    // if not there subscribe for instance events\r\n                    unsub = _this._appManager.onInstanceStarted(waitFunc);\r\n                }\r\n                // try to find it in the current list\r\n                var instances = check();\r\n                if (instances) {\r\n                    unsub = undefined;\r\n                    resolve(instances);\r\n                }\r\n            };\r\n            _this._agm.invoke(AgmNames.StartApplicationMethodName, {\r\n                Name: name,\r\n                Context: context,\r\n                WaitForAgmInstance: waitForAGMInstance,\r\n                WaitForInstance: waitForInstance\r\n            }, \"best\", {\r\n                methodResponseTimeoutMs: startTimeout\r\n            }, function (result) {\r\n                var acsResult = result.returned.Instance_0 || result.returned;\r\n                if (acsResult && acsResult.Id) {\r\n                    // we received instance from ACS, let's wait until it appears on the stream\r\n                    waitForApplicationInstance(acsResult.Id);\r\n                }\r\n                else {\r\n                    // we haven't received instance from ACS - this might happen if the app does not\r\n                    // support tracking instances (e.g. we start internet explorer with some url)\r\n                    resolve(undefined);\r\n                }\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    ApplicationImpl.prototype.onInstanceStarted = function (callback) {\r\n        this._registry.add(\"instanceStarted\", callback);\r\n    };\r\n    ApplicationImpl.prototype.onInstanceStopped = function (callback) {\r\n        this._registry.add(\"instanceStopped\", callback);\r\n    };\r\n    ApplicationImpl.prototype.onAvailable = function (callback) {\r\n        this._registry.add(\"appAvailable\", callback);\r\n    };\r\n    ApplicationImpl.prototype.onUnavailable = function (callback) {\r\n        this._registry.add(\"appUnavailable\", callback);\r\n    };\r\n    ApplicationImpl.prototype.onChanged = function (callback) {\r\n        this._registry.add(\"appChanged\", callback);\r\n    };\r\n    ApplicationImpl.prototype.onRemoved = function (callback) {\r\n        this._registry.add(\"appRemoved\", callback);\r\n    };\r\n    return ApplicationImpl;\r\n}());\r\nexports.default = ApplicationImpl;\r\n//# sourceMappingURL=application.js.map\n\n/***/ }),\n/* 62 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.OnNotificationEvent = \"OnNotification\";\r\nexports.OnBranchChangedEvent = \"OnBranchChanged\";\r\nexports.OnBranchesModifiedEvent = \"OnBranchesModified\";\r\nexports.OnApplicationAddedEvent = \"OnApplicationAdded\";\r\nexports.OnApplicationRemovedEvent = \"OnApplicationRemoved\";\r\nexports.OnApplicationChangedEvent = \"OnApplicationChanged\";\r\nexports.OnApplicationReadyEvent = \"OnApplicationReady\";\r\nexports.OnApplicationStartedEvent = \"OnApplicationStarted\";\r\nexports.OnApplicationRegisteredEvent = \"OnApplicationRegistered\";\r\nexports.OnApplicationAgmServerReadyEvent = \"OnApplicationAgmServerReady\";\r\nexports.OnApplicationUpdatedEvent = \"OnApplicationUpdated\";\r\nexports.OnApplicationStoppedEvent = \"OnApplicationStopped\";\r\nexports.OnApplicationStartFailedEvent = \"OnApplicationStartFailed\";\r\n//# sourceMappingURL=event-names.js.map\n\n/***/ }),\n/* 63 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AgmNames = __webpack_require__(5);\r\nvar EventNames = __webpack_require__(62);\r\nvar helper_1 = __webpack_require__(11);\r\n/** Subscribe for the AGM stream published by ACS and distributes events to applications and instances components */\r\nfunction createDataSubscription(agm, applications, entitlements, skipIcons) {\r\n    var subscription;\r\n    var start = function () {\r\n        var resolveFunc;\r\n        var rejectFunc;\r\n        var resultPromise = new Promise(function (resolve, reject) {\r\n            resolveFunc = resolve;\r\n            rejectFunc = reject;\r\n        });\r\n        agm.subscribe(AgmNames.OnEventMethodName, { arguments: { skipIcon: skipIcons }, waitTimeoutMs: 10000 })\r\n            .then(function (s) {\r\n            subscription = s;\r\n            subscription.onData(function (streamData) {\r\n                var events = streamData.data;\r\n                helper_1.objectValues(events[EventNames.OnApplicationAddedEvent])\r\n                    .map(function (item) { return applications.handleAppAdded(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationChangedEvent])\r\n                    .map(function (item) { return applications.handleAppUpdated(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationRemovedEvent])\r\n                    .map(function (item) { return applications.handleAppRemoved(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationReadyEvent])\r\n                    .map(function (item) { return applications.handleAppReady(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationStartedEvent])\r\n                    .map(function (item) { return applications.handleInstanceStarted(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationStartFailedEvent])\r\n                    .map(function (item) { return applications.handleInstanceStartFailed(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationStoppedEvent])\r\n                    .map(function (item) { return applications.handleInstanceStopped(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationUpdatedEvent])\r\n                    .map(function (item) { return applications.handleInstanceUpdated(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationAgmServerReadyEvent])\r\n                    .map(function (item) { return applications.handleInstanceAgmServerReady(item); });\r\n                helper_1.objectValues(events[EventNames.OnBranchChangedEvent])\r\n                    .map(function (item) { return entitlements.handleBranchModified(item); });\r\n                helper_1.objectValues(events[EventNames.OnBranchesModifiedEvent])\r\n                    .map(function (item) { return entitlements.handleBranchesModified(item); });\r\n                resolveFunc();\r\n            });\r\n            subscription.onFailed(function (err) { return rejectFunc(err); });\r\n        })\r\n            .catch(function (err) { return rejectFunc(\"Error subscribing for \" + AgmNames.OnEventMethodName + \" stream. Err: \" + err); });\r\n        return resultPromise;\r\n    };\r\n    var stop = function () {\r\n        if (subscription) {\r\n            subscription.close();\r\n        }\r\n    };\r\n    return {\r\n        start: start,\r\n        stop: stop\r\n    };\r\n}\r\nexports.default = createDataSubscription;\r\n//# sourceMappingURL=data-subscription.js.map\n\n/***/ }),\n/* 64 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AgmNames = __webpack_require__(5);\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar promisify = __webpack_require__(49);\r\nvar EntitlementsImpl = /** @class */ (function () {\r\n    function EntitlementsImpl(_agm) {\r\n        var _this = this;\r\n        this._agm = _agm;\r\n        this._registry = callback_registry_1.default();\r\n        this.handleBranchModified = function (branch) {\r\n            _this._registry.execute(\"branchChanged\", branch);\r\n        };\r\n        this.handleBranchesModified = function (branches) {\r\n            _this._registry.execute(\"branchesChanged\", branches);\r\n        };\r\n        this.getRegion = function (success, error) {\r\n            return promisify(_this._agmInvoke(AgmNames.GetConfigurationRegionMethodName, function (e) { return e.returned.Region; }), success, error);\r\n        };\r\n        this.getBranches = function (success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.GetBranchesMethodName, function (e) {\r\n                var obj = e.returned.Branches;\r\n                return Object.keys(obj).map(function (key) { return obj[key]; });\r\n            });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.getCurrentBranch = function (success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.GetCurrentBranchMethodName, function (e) { return e.returned.Branch; }, undefined);\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.setRegion = function (region, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.SetConfigurationRegionMethodName, function (e) { return e.returned.ResultMessage; }, { Region: region });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.setCurrentBranch = function (branch, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.SetCurrentBranchMethodName, function (e) { return e.returned.ResultMessage; }, { Branch: branch });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.currentUser = function (success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.GetUserMethodName);\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.getFunctionalEntitlement = function (funct, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.GetFunctionalEntitlementMethodName, function (e) { return e.returned.Entitlement; }, { Function: funct });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.getFunctionalEntitlementBranch = function (funct, branch, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.GetFunctionalEntitlementMethodName, function (e) { return e.returned.Entitlement; }, { Function: funct, Branch: branch });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.canI = function (func, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.CanIMethodName, function (e) { return e.returned.Result; }, { Function: func });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.canIBranch = function (func, branch, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.CanIMethodName, function (e) { return e.returned.Result; }, { Function: func, Branch: branch });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.onBranchesChanged = function (callback) {\r\n            _this._registry.add(\"branchesChanged\", callback);\r\n        };\r\n        this.onBranchChanged = function (callback) {\r\n            _this._registry.add(\"branchChanged\", callback);\r\n        };\r\n        this.exit = function (options) {\r\n            return _this._agmInvoke(AgmNames.ShutdownMethodName, null, options);\r\n        };\r\n        this._agmInvoke = function (method, transformFunction, args) {\r\n            args = args || {};\r\n            return new Promise(function (resolve, reject) {\r\n                var errHandler = function (error) { return reject(error); };\r\n                _this._agm.invoke(method, args)\r\n                    .then(function (result) {\r\n                    if (!transformFunction) {\r\n                        transformFunction = function (d) { return d.returned; };\r\n                    }\r\n                    resolve(transformFunction(result));\r\n                })\r\n                    .catch(errHandler);\r\n            });\r\n        };\r\n        //\r\n    }\r\n    return EntitlementsImpl;\r\n}());\r\nexports.default = EntitlementsImpl;\r\n//# sourceMappingURL=entitlements.js.map\n\n/***/ }),\n/* 65 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AgmNames = __webpack_require__(5);\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar InstanceImpl = /** @class */ (function () {\r\n    function InstanceImpl(_id, _app, _appManager, _agm, _activities, _windows, startFailed) {\r\n        var _this = this;\r\n        this._id = _id;\r\n        this._app = _app;\r\n        this._appManager = _appManager;\r\n        this._agm = _agm;\r\n        this._activities = _activities;\r\n        this._windows = _windows;\r\n        this.onAgmReady = this._addToRegistry(\"agmReady\");\r\n        this.onStopped = this._addToRegistry(\"stopped\");\r\n        this._registry = callback_registry_1.default();\r\n        if (startFailed) {\r\n            return;\r\n        }\r\n        this._unsubscribeInstanceStopped = this._appManager.onInstanceStopped(function (instance) {\r\n            if (instance.id !== _this._id) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"stopped\", instance);\r\n        });\r\n        this._unsubscribeInstanceAgmServerReady = this._appManager.onInstanceAgmServerReady(function (instance) {\r\n            if (instance.id !== _this._id) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"agmReady\", instance);\r\n        });\r\n    }\r\n    Object.defineProperty(InstanceImpl.prototype, \"id\", {\r\n        get: function () { return this._id; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"application\", {\r\n        get: function () { return this._app; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"activity\", {\r\n        get: function () {\r\n            var _this = this;\r\n            if (!this._activities) {\r\n                throw new Error(\"This method requires glue.activities library to be enabled.\");\r\n            }\r\n            return this._activities.all.instances.get()\r\n                .filter(function (activityInstance) { return activityInstance.id === _this._activityId; })[0];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"activityInstances\", {\r\n        get: function () {\r\n            var _this = this;\r\n            return this._appManager.instances()\r\n                .filter(function (i) { return i.context && (i.context.activityId === _this._activityId); });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"activityOwnerInstance\", {\r\n        get: function () {\r\n            return this._appManager.instances()\r\n                .filter(function (instance) {\r\n                if (instance.window && instance.window.context) {\r\n                    var instWinCntx = instance.window.context;\r\n                    if (instWinCntx._t42 && instWinCntx._t42.activityIsOwner) {\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            })[0];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"window\", {\r\n        get: function () {\r\n            var _this = this;\r\n            if (!this._windows) {\r\n                throw new Error(\"This method requires glue.windows library to be enabled.\");\r\n            }\r\n            var win = this._windows.list().filter(function (w) { return w.id === _this._id; })[0];\r\n            if (!win && this.activity && this.activityOwnerInstance) {\r\n                // This is covering GD3 activity instance\r\n                win = this.activityOwnerInstance.window;\r\n            }\r\n            return win;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"context\", {\r\n        get: function () { return this._startUpContext; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"title\", {\r\n        get: function () { return this._title; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"isActivityInstance\", {\r\n        get: function () { return this._isActivityInstance; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"activityId\", {\r\n        get: function () { return this._activityId; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"inActivity\", {\r\n        get: function () { return this._inActivity; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"isSingleWindowApp\", {\r\n        get: function () { return !this._inActivity; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"agm\", {\r\n        get: function () {\r\n            return this._agmInstance;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    InstanceImpl.prototype.updateFromProps = function (props) {\r\n        this._startUpContext = props.Context;\r\n        this._title = props.Title;\r\n        this._isActivityInstance = false;\r\n        if (props.ActivityId && props.ActivityId !== \"\") {\r\n            this._activityId = props.ActivityId;\r\n            this._isActivityInstance = true;\r\n        }\r\n        if (!this._activityId && this._startUpContext && this._startUpContext.activityId) {\r\n            this._activityId = this._startUpContext.activityId;\r\n        }\r\n        this._inActivity = Boolean(this._activityId);\r\n        this.updateAgmInstanceFromProps(props);\r\n    };\r\n    InstanceImpl.prototype.updateAgmInstanceFromProps = function (props) {\r\n        if (!props.AgmServers) {\r\n            return;\r\n        }\r\n        if (props.GD3) {\r\n            var agmInstances = props.AgmServers;\r\n            if (agmInstances) {\r\n                this._agmInstance = agmInstances[0];\r\n            }\r\n        }\r\n        else {\r\n            var gdAgmServers = props.AgmServers;\r\n            var propsAgmServer = Object.keys(gdAgmServers)[0];\r\n            if (!propsAgmServer) {\r\n                return;\r\n            }\r\n            var propsAgm = gdAgmServers[propsAgmServer];\r\n            this._agmInstance = {\r\n                machine: propsAgm.machineName,\r\n                user: propsAgm.userName,\r\n                environment: propsAgm.environment,\r\n                application: propsAgm.applicationName,\r\n            };\r\n        }\r\n    };\r\n    InstanceImpl.prototype.stop = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var unsubscribe = _this._appManager.onInstanceStopped(function (instance) {\r\n                if (instance.id === _this._id) {\r\n                    unsubscribe();\r\n                    resolve();\r\n                }\r\n            });\r\n            _this._agm.invoke(AgmNames.StopApplicationMethodName, {\r\n                Name: _this._app.name,\r\n                Id: _this._id\r\n            })\r\n                .catch(function (err) { return reject(err); });\r\n        });\r\n    };\r\n    InstanceImpl.prototype.activate = function () {\r\n        return this._agm.invoke(AgmNames.ActivateApplicationMethodName, { Name: this._app.name, Id: this._id });\r\n    };\r\n    InstanceImpl.prototype.done = function () {\r\n        // remove all handlers\r\n        this._registry.clear();\r\n        // remove subscriptions\r\n        this._unsubscribeInstanceAgmServerReady();\r\n        this._unsubscribeInstanceStopped();\r\n    };\r\n    InstanceImpl.prototype._addToRegistry = function (key) {\r\n        var _this = this;\r\n        return function (callback) {\r\n            _this._registry.add(key, callback);\r\n        };\r\n    };\r\n    return InstanceImpl;\r\n}());\r\nexports.default = InstanceImpl;\r\n//# sourceMappingURL=instance.js.map\n\n/***/ }),\n/* 66 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar app_manager_1 = __webpack_require__(60);\r\nvar entitlements_1 = __webpack_require__(64);\r\nvar snapshot_1 = __webpack_require__(67);\r\nvar data_subscription_1 = __webpack_require__(63);\r\nexports.default = (function (config) {\r\n    if (!config) {\r\n        throw Error(\"config not set\");\r\n    }\r\n    if (!config.agm) {\r\n        throw Error(\"config.agm is missing\");\r\n    }\r\n    var START_ONLY = \"startOnly\";\r\n    var SKIP_ICONS = \"skipIcons\";\r\n    var FULL = \"full\";\r\n    var mode = config.mode || START_ONLY;\r\n    if (mode !== START_ONLY && mode !== SKIP_ICONS && mode !== FULL) {\r\n        throw new Error(\"Invalid mode for appManager lib - \" + mode + \" is not supported\");\r\n    }\r\n    var activities = config.activities;\r\n    var agm = config.agm;\r\n    var logger = config.logger;\r\n    var windows = config.windows;\r\n    var appManager = new app_manager_1.default(agm, activities, windows, logger.subLogger(\"applications\"), config.gdMajorVersion);\r\n    var entitlements = new entitlements_1.default(agm);\r\n    var readyPromise;\r\n    if (mode === START_ONLY) {\r\n        readyPromise = snapshot_1.default(agm, appManager);\r\n    }\r\n    else {\r\n        var subscription = data_subscription_1.default(agm, appManager, entitlements, mode === SKIP_ICONS);\r\n        readyPromise = subscription.start();\r\n    }\r\n    var api = {\r\n        ready: function () { return readyPromise; },\r\n        applications: appManager.applications,\r\n        application: appManager.application,\r\n        onAppAdded: appManager.onAppAdded,\r\n        onAppRemoved: appManager.onAppRemoved,\r\n        onAppChanged: appManager.onAppChanged,\r\n        onAppAvailable: appManager.onAppAvailable,\r\n        onAppUnavailable: appManager.onAppUnavailable,\r\n        instances: appManager.instances,\r\n        get myInstance() {\r\n            return appManager.getMyInstance();\r\n        },\r\n        onInstanceStarted: appManager.onInstanceStarted,\r\n        onInstanceStopped: appManager.onInstanceStopped,\r\n        onInstanceUpdated: appManager.onInstanceUpdated,\r\n        onInstanceStartFailed: appManager.onInstanceStartFailed,\r\n        getRegion: entitlements.getRegion,\r\n        getBranches: entitlements.getBranches,\r\n        getCurrentBranch: entitlements.getCurrentBranch,\r\n        getFunctionalEntitlement: entitlements.getFunctionalEntitlement,\r\n        getFunctionalEntitlementBranch: entitlements.getFunctionalEntitlementBranch,\r\n        setCurrentBranch: entitlements.setCurrentBranch,\r\n        setRegion: entitlements.setRegion,\r\n        currentUser: entitlements.currentUser,\r\n        canI: entitlements.canI,\r\n        canIBranch: entitlements.canIBranch,\r\n        onBranchesChanged: entitlements.onBranchesChanged,\r\n        exit: entitlements.exit\r\n    };\r\n    return api;\r\n});\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 67 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AgmNames = __webpack_require__(5);\r\nvar helper_1 = __webpack_require__(11);\r\n/** Retrieves application snapshot from ACS */\r\nfunction snapshot(agm, appManager) {\r\n    return new Promise(function (resolve, reject) {\r\n        agm.invoke(AgmNames.GetApplicationsMethodName, { skipIcon: true })\r\n            .then(function (response) {\r\n            var data = response.returned;\r\n            if (!data) {\r\n                resolve();\r\n            }\r\n            var applications = data.applications;\r\n            if (!applications) {\r\n                resolve();\r\n            }\r\n            helper_1.objectValues(applications).map(function (item) { return appManager.handleAppAdded(item); });\r\n            resolve();\r\n        })\r\n            .catch(function (err) { return reject(\"Error getting application snapshot: \" + err.message); });\r\n    });\r\n}\r\nexports.default = snapshot;\r\n//# sourceMappingURL=snapshot.js.map\n\n/***/ }),\n/* 68 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.default = (function (options) {\r\n    // Possible options per lib (this is InputLibConfig type)\r\n    // * false - library is disabled (e.g. config.appManager = false)\r\n    // * true - library is enabled in running in default mode (e.g config.appManager = true).\r\n    //          Exception is if default mode is false - in that case it runs default true mode.\r\n    // * string - start in some mode (e.g. config.appManager = \"full\")\r\n    // * object - allows further customization (e.g config.appManager = {mode: \"full\", someSetting: 42})\r\n    //\r\n    // Some libs support different running modes, some do not.\r\n    //\r\n    // Currently defaults are:\r\n    // appManager: disabled\r\n    // layouts: enabled in 'slim' mode\r\n    // activities: enabled in 'trackMyTypeAndInitiatedFromMe' mode\r\n    // windows: enabled (does not support modes)\r\n    //\r\n    // InputLibConfig is transformed to LibConfigObject\r\n    /**\r\n     * Transforms InputLibConfig (the config as specified from the user)\r\n     * to LibConfigObject(internal library configuration)\r\n     */\r\n    function getLibConfig(value, defaultMode, trueMode) {\r\n        // if value is false return undefined\r\n        if (typeof value === \"boolean\" && !value) {\r\n            return undefined;\r\n        }\r\n        // find the mode of the library\r\n        var mode = getModeAsString(value, defaultMode, trueMode);\r\n        // if object we will replace the mode because appManager = {mode: true, setting: 42}\r\n        // should be turned into appManager = {mode: 'slim', setting: 42}\r\n        if (typeof value === \"object\") {\r\n            value.mode = mode;\r\n            return value;\r\n        }\r\n        return {\r\n            mode: mode,\r\n        };\r\n    }\r\n    /**\r\n     * Finds the mode based for a given library\r\n     * 1. If object we call recursively using object.mode for value\r\n     * 1. If the user hasn't specified anything we use the hard coded defaults\r\n     * 3. If the value is false or it got defaulted to false, we return undefined\r\n     * 4. If the value is true we return trueMode or defaultMode (if trueMode is undefined)\r\n     */\r\n    function getModeAsString(value, defaultMode, trueMode) {\r\n        if (typeof value === \"object\") {\r\n            // 1. if object\r\n            return getModeAsString(value.mode, defaultMode, trueMode) + \"\";\r\n        }\r\n        else if (typeof value === \"undefined\") {\r\n            // 2. if the user does not pass anything\r\n            if (typeof defaultMode === \"boolean\" && !defaultMode) {\r\n                // 3. if gets defaulted to false, the library should be off\r\n                return undefined;\r\n            }\r\n            else {\r\n                return defaultMode + \"\";\r\n            }\r\n        }\r\n        else if (typeof value === \"boolean\") {\r\n            // 4. if the user passes true, use trueMode or defaultMode\r\n            if (value) {\r\n                // if the user passes true, use trueMode or defaultMode\r\n                return ((trueMode === undefined) ? defaultMode : trueMode) + \"\";\r\n            }\r\n            else {\r\n                // 3. if the user passes false, the library should be off\r\n                return undefined;\r\n            }\r\n        }\r\n        return value + \"\";\r\n    }\r\n    var appDefaultMode = false;\r\n    var appDefaultTrueMode = \"startOnly\";\r\n    var activitiesDefaultMode = \"trackMyTypeAndInitiatedFromMe\";\r\n    var layoutsDefaultMode = \"slim\";\r\n    return {\r\n        layouts: getLibConfig(options.layouts, layoutsDefaultMode),\r\n        activities: getLibConfig(options.activities, activitiesDefaultMode),\r\n        appManager: getLibConfig(options.appManager, appDefaultMode, appDefaultTrueMode),\r\n        windows: getLibConfig(options.windows, true)\r\n    };\r\n});\r\n//# sourceMappingURL=config.js.map\n\n/***/ }),\n/* 69 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar SaveContextMethodName = \"T42.HC.GetSaveContext\";\r\n/**\r\n * Logic for apps that want to provide custom context on save\r\n */\r\nvar ContextProvider = /** @class */ (function () {\r\n    function ContextProvider(agm, activitiesGetter, callbacks) {\r\n        this.agm = agm;\r\n        this.activitiesGetter = activitiesGetter;\r\n        this.callbacks = callbacks;\r\n        this.registeredRequestsMethods = false;\r\n    }\r\n    ContextProvider.prototype.onSaveRequested = function (callback) {\r\n        if (!this.registeredRequestsMethods) {\r\n            this.registerRequestMethods();\r\n            this.registeredRequestsMethods = true;\r\n        }\r\n        return this.callbacks.add(\"saveRequested\", callback);\r\n    };\r\n    ContextProvider.prototype.isActivityOwner = function () {\r\n        // fallback for GD2 - remove once the bellow code is tested\r\n        if (typeof htmlContainer !== \"undefined\") {\r\n            var context = htmlContainer.getContext();\r\n            return context && context._t42 && context._t42.activityIsOwner;\r\n        }\r\n        // check if we're the activity owners\r\n        var activities = this.activitiesGetter();\r\n        if (!activities) {\r\n            return false;\r\n        }\r\n        if (!activities.inActivity) {\r\n            return false;\r\n        }\r\n        var myWindow = activities.my.window;\r\n        var myActivity = activities.my.activity;\r\n        if (!myActivity && !myWindow) {\r\n            return false;\r\n        }\r\n        // TODO - fix activities typings\r\n        return myActivity.owner.id === myWindow.id;\r\n    };\r\n    ContextProvider.prototype.registerRequestMethods = function () {\r\n        var _this = this;\r\n        this.agm.register(SaveContextMethodName, function (args) {\r\n            var requestResult = _this.callbacks.execute(\"saveRequested\", args)[0];\r\n            if (!requestResult) {\r\n                return {};\r\n            }\r\n            requestResult.activityContext = requestResult.activityContext || {};\r\n            requestResult.windowContext = requestResult.windowContext || {};\r\n            // always include the window context\r\n            var result = { windowContext: requestResult.windowContext, activityContext: undefined };\r\n            // if we're the activity owner put the context too\r\n            if (_this.isActivityOwner()) {\r\n                result.activityContext = requestResult.activityContext;\r\n            }\r\n            return result;\r\n        });\r\n    };\r\n    return ContextProvider;\r\n}());\r\nexports.default = ContextProvider;\r\n//# sourceMappingURL=contextProvider.js.map\n\n/***/ }),\n/* 70 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar store_1 = __webpack_require__(21);\r\nvar shortid_1 = __webpack_require__(40);\r\nvar contextProvider_1 = __webpack_require__(69);\r\nvar transform_1 = __webpack_require__(22);\r\nvar layout_1 = __webpack_require__(20);\r\nvar LayoutsAPIImpl = /** @class */ (function () {\r\n    function LayoutsAPIImpl(config, stream, callbacks) {\r\n        this.config = config;\r\n        this.stream = stream;\r\n        this.callbacks = callbacks;\r\n        this.appManager = config.appManager;\r\n        this.onEvent = stream.onEvent;\r\n        this.provider = new contextProvider_1.default(config.agm, config.activityGetter, callbacks);\r\n        stream.subscribe();\r\n    }\r\n    LayoutsAPIImpl.prototype.ready = function () {\r\n        if (this.config.mode === \"fullWaitSnapshot\") {\r\n            return this.stream.gotSnapshot;\r\n        }\r\n        return this.stream.ready;\r\n    };\r\n    LayoutsAPIImpl.prototype.save = function (layout) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.verifyNotSlimMode();\r\n            if (!layout.name) {\r\n                throw Error(\"layout.name argument is required\");\r\n            }\r\n            if (!layout.type) {\r\n                layout.type = \"Global\";\r\n            }\r\n            if (layout.activityId) {\r\n                layout.type = \"Activity\";\r\n            }\r\n            if (typeof layout.ignoreHidden === \"undefined\") {\r\n                layout.ignoreHidden = true; // default to true\r\n            }\r\n            var layoutObject = {\r\n                name: layout.name,\r\n                actIds: [],\r\n                appIds: [],\r\n                type: layout.type,\r\n                context: layout.context,\r\n                options: { ignoreLayoutRestrictions: false },\r\n            };\r\n            if (layout.type === \"Activity\") {\r\n                var actId = layout.activityId;\r\n                if (!actId) {\r\n                    if (!_this.appManager.myInstance.inActivity) {\r\n                        throw new Error(\"Current application is not in activity. Can not save activity layout for it\");\r\n                    }\r\n                    actId = _this.appManager.myInstance.activityId;\r\n                }\r\n                layoutObject.actIds.push(actId);\r\n                layoutObject.options = { ignoreLayoutRestrictions: true };\r\n            }\r\n            else if (layout.type === \"Global\") {\r\n                var instances = _this.appManager.instances();\r\n                if (layout.ignoreHidden) {\r\n                    instances = instances.filter(function (i) { return _this.isVisibleWindow(i); });\r\n                }\r\n                if (layout.ignoreMyInstance && _this.appManager.myInstance) {\r\n                    instances = instances.filter(function (i) { return i.id !== _this.appManager.myInstance.id; });\r\n                }\r\n                instances.reduce(function (prev, current) {\r\n                    if (!current.id) {\r\n                        return prev;\r\n                    }\r\n                    if (current.inActivity) {\r\n                        var actId = current.activityId;\r\n                        if (prev.actIds.indexOf(actId) === -1) {\r\n                            prev.actIds.push(actId);\r\n                        }\r\n                    }\r\n                    else {\r\n                        prev.appIds.push(current.id);\r\n                    }\r\n                    return prev;\r\n                }, layoutObject);\r\n            }\r\n            else {\r\n                throw new Error(\"layout type \" + layout.type + \" not supported\");\r\n            }\r\n            _this.invokeMethodAndTrack(\"T42.ACS.SaveLayout\", layoutObject, resolve, reject);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.restore = function (options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.verifyNotSlimMode();\r\n            if (typeof options === \"undefined\") {\r\n                throw Error(\"options argument is required\");\r\n            }\r\n            if (!options.name) {\r\n                throw Error(\"options.name argument is required\");\r\n            }\r\n            if (!options.type) {\r\n                options.type = \"Global\";\r\n            }\r\n            if (options.activityIdToJoin) {\r\n                options.type = \"Activity\";\r\n            }\r\n            if (typeof options.restoreActivityOwner === \"undefined\") {\r\n                options.restoreActivityOwner = false;\r\n            }\r\n            if (typeof options.ignoreActivityWindowTypes === \"undefined\") {\r\n                options.ignoreActivityWindowTypes = [];\r\n            }\r\n            if (typeof options.setActivityContext === \"undefined\") {\r\n                options.setActivityContext = true;\r\n            }\r\n            // if no closeOwnRunning we set closeRunningInstance to true; if\r\n            if (typeof options.closeRunningInstance === \"undefined\") {\r\n                if (options.type === \"Global\") {\r\n                    options.closeRunningInstance = true;\r\n                }\r\n                else if (options.type === \"Activity\") {\r\n                    // we don't close anything in case of activity layout type\r\n                    options.closeRunningInstance = false;\r\n                }\r\n            }\r\n            if (typeof options.reuseWindows === \"undefined\") {\r\n                options.reuseWindows = true;\r\n            }\r\n            options.context = options.context || {};\r\n            var t42 = {\r\n                restoreOptions: {\r\n                    activityToJoin: options.activityIdToJoin,\r\n                    setActivityContext: options.setActivityContext,\r\n                    ignoreActivityWindowTypes: options.ignoreActivityWindowTypes,\r\n                    restoreActivityOwner: options.restoreActivityOwner,\r\n                    closeOldWindows: true,\r\n                    reuseExistingWindows: options.reuseWindows\r\n                }\r\n            };\r\n            var arg = {\r\n                type: options.type,\r\n                name: options.name,\r\n                context: options.context,\r\n                toClose: [],\r\n                splash: options.splash\r\n            };\r\n            if (options.closeRunningInstance) {\r\n                arg.toClose = _this.getInstancesToClose(options);\r\n            }\r\n            if (options.timeout) {\r\n                arg.timeout = options.timeout;\r\n            }\r\n            arg.context._t42 = t42;\r\n            _this.invokeMethodAndTrack(\"T42.ACS.RestoreLayout\", arg, resolve, reject, true);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.remove = function (type, name) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.verifyNotSlimMode();\r\n            if (!name) {\r\n                throw Error(\"name argument is required\");\r\n            }\r\n            if (!type) {\r\n                throw Error(\"type argument is required\");\r\n            }\r\n            var msg = {\r\n                type: type,\r\n                name: name,\r\n            };\r\n            _this.invokeMethodAndTrack(\"T42.ACS.RemoveLayout\", msg, resolve, reject);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.list = function () {\r\n        this.verifyNotSlimMode();\r\n        return store_1.default.all;\r\n    };\r\n    LayoutsAPIImpl.prototype.import = function (layouts, mode) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.verifyNotSlimMode();\r\n            var msg = {\r\n                mode: mode || \"replace\",\r\n                layouts: layouts\r\n            };\r\n            _this.invokeMethodAndTrack(\"T42.ACS.ImportLayouts\", msg, resolve, reject);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.export = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var handleResult = function (result) {\r\n                var layouts = _this.getObjectValues(result.Layouts).map(function (t) { return new layout_1.default(transform_1.default(t)); });\r\n                resolve(layouts);\r\n            };\r\n            _this.invokeMethodAndTrack(\"T42.ACS.ExportLayouts\", {}, handleResult, reject, true);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.rename = function (layout, newName) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.verifyNotSlimMode();\r\n            if (!layout) {\r\n                throw Error(\"layout argument is required\");\r\n            }\r\n            if (!layout.name) {\r\n                throw Error(\"name argument is required\");\r\n            }\r\n            if (!layout.type) {\r\n                throw Error(\"type argument is required\");\r\n            }\r\n            var msg = { type: layout.type, oldName: layout.name, newName: newName };\r\n            _this.invokeMethodAndTrack(\"T42.ACS.RenameLayout\", msg, resolve, reject);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.onAdded = function (callback) {\r\n        var result = this.callbacks.add(\"added\", callback);\r\n        if (store_1.default.all.length > 0) {\r\n            store_1.default.all.forEach(function (layout) {\r\n                try {\r\n                    callback(layout);\r\n                }\r\n                catch (err) { /** */ }\r\n            });\r\n        }\r\n        return result;\r\n    };\r\n    LayoutsAPIImpl.prototype.onRemoved = function (callback) {\r\n        return this.callbacks.add(\"removed\", callback);\r\n    };\r\n    LayoutsAPIImpl.prototype.onChanged = function (callback) {\r\n        return this.callbacks.add(\"changed\", callback);\r\n    };\r\n    LayoutsAPIImpl.prototype.onRenamed = function (callback) {\r\n        return this.callbacks.add(\"renamed\", callback);\r\n    };\r\n    LayoutsAPIImpl.prototype.onEvent = function (callback) {\r\n        return this.stream.onEvent(callback);\r\n    };\r\n    LayoutsAPIImpl.prototype.onSaveRequested = function (callback) {\r\n        return this.provider.onSaveRequested(callback);\r\n    };\r\n    LayoutsAPIImpl.prototype.verifyNotSlimMode = function () {\r\n        if (this.config.mode === \"slim\") {\r\n            throw Error(\"Operation not allowed in slim mode. Run in full mode.\");\r\n        }\r\n    };\r\n    LayoutsAPIImpl.prototype.isVisibleWindow = function (instance) {\r\n        // GD3\r\n        // allow exes to participate in layouts (TODO - check if the app is layouts aware (has the layouts methods) - if not treat it as not visible window)\r\n        if (instance.application.type === \"exe\" || instance.application.type === \"node\") {\r\n            return true;\r\n        }\r\n        // allow activities to participate in layouts\r\n        if (instance.application.type === \"activity\") {\r\n            return true;\r\n        }\r\n        if (!instance || !instance.window) {\r\n            return false;\r\n        }\r\n        return instance.window.isVisible;\r\n    };\r\n    LayoutsAPIImpl.prototype.invokeMethodAndTrack = function (methodName, args, resolve, reject, skipStreamEvent) {\r\n        var streamEventReceived = skipStreamEvent;\r\n        var agmResult;\r\n        var token = shortid_1.generate();\r\n        args.token = token;\r\n        var handleResult = function () {\r\n            if (streamEventReceived && agmResult) {\r\n                resolve(agmResult);\r\n            }\r\n        };\r\n        if (!skipStreamEvent) {\r\n            this.stream.waitFor(token)\r\n                .then(function () {\r\n                streamEventReceived = true;\r\n                handleResult();\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        }\r\n        var responseHandler = function (result) {\r\n            if (!result.returned) {\r\n                reject(\"No result from method \" + methodName);\r\n            }\r\n            if (result.returned.status && (result.returned.status !== \"Success\" && result.returned.status !== \"PartialSuccess\")) {\r\n                reject(result.returned);\r\n            }\r\n            agmResult = result.returned;\r\n            handleResult();\r\n        };\r\n        this.config.agm.invoke(methodName, args, \"best\", { methodResponseTimeoutMs: 120 * 1000 })\r\n            .then(responseHandler)\r\n            .catch(function (err) { return reject(err); });\r\n    };\r\n    LayoutsAPIImpl.prototype.getInstancesToClose = function (options) {\r\n        var _this = this;\r\n        var instances = [];\r\n        var shellApp = this.appManager.applications().filter(function (a) { return a.isShell; })[0];\r\n        var shellApplicationName = shellApp ? shellApp.name : \"AppManager\";\r\n        this.appManager.instances().forEach(function (i) {\r\n            // ignore my instance\r\n            if (_this.appManager.myInstance && i.id === _this.appManager.myInstance.id) {\r\n                return;\r\n            }\r\n            // ignore shell app\r\n            if (i.application.name === shellApplicationName) {\r\n                return;\r\n            }\r\n            // ignore hidden windows\r\n            if (!_this.isVisibleWindow(i)) {\r\n                return;\r\n            }\r\n            // if activity layout stop only the instances\r\n            // running in the same activity\r\n            if (options.type === \"Activity\") {\r\n                if (i.activityId !== options.activityIdToJoin) {\r\n                    return;\r\n                }\r\n            }\r\n            instances.push({ application: i.application.name, instance: i.id });\r\n        });\r\n        return instances;\r\n    };\r\n    LayoutsAPIImpl.prototype.getObjectValues = function (obj) {\r\n        if (!obj) {\r\n            return [];\r\n        }\r\n        return Object.keys(obj).map(function (k) { return obj[k]; });\r\n    };\r\n    return LayoutsAPIImpl;\r\n}());\r\nexports.default = LayoutsAPIImpl;\r\n//# sourceMappingURL=layouts.js.map\n\n/***/ }),\n/* 71 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar layouts_1 = __webpack_require__(70);\r\nvar acsStream_1 = __webpack_require__(72);\r\nvar nullStream_1 = __webpack_require__(73);\r\nvar callback_registry_1 = __webpack_require__(1);\r\nfunction default_1(config) {\r\n    if (!config.agm) {\r\n        throw Error(\"config.agm is required\");\r\n    }\r\n    if (!config.logger) {\r\n        throw Error(\"config.logger is required\");\r\n    }\r\n    // default mode to slim\r\n    config.mode = config.mode || \"slim\";\r\n    var logger = config.logger;\r\n    var callbacks = callback_registry_1.default();\r\n    var acsStream;\r\n    if (config.mode === \"full\" || \"fullWaitSnapshot\") {\r\n        acsStream = new acsStream_1.default(config.agm, callbacks);\r\n    }\r\n    else {\r\n        acsStream = nullStream_1.default();\r\n    }\r\n    return new layouts_1.default(config, acsStream, callbacks);\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 72 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar store_1 = __webpack_require__(21);\r\nvar layout_1 = __webpack_require__(20);\r\nvar transform_1 = __webpack_require__(22);\r\n/**\r\n * ACS event stream related to layouts\r\n */\r\nvar ACSStream = /** @class */ (function () {\r\n    function ACSStream(agm, callbacks) {\r\n        var _this = this;\r\n        this.agm = agm;\r\n        this.callbacks = callbacks;\r\n        this.ready = new Promise(function (resolve, reject) {\r\n            _this.resolveReady = resolve;\r\n            _this.rejectReady = reject;\r\n        });\r\n        this.gotSnapshot = new Promise(function (resolve, reject) {\r\n            _this.resolveGotSnapshot = resolve;\r\n            _this.rejectGotSnapshot = reject;\r\n        });\r\n    }\r\n    ACSStream.prototype.subscribe = function (noRetry) {\r\n        var _this = this;\r\n        var transform = function (obj) {\r\n            return _this.getObjectValues(obj).map(function (t) { return transform_1.default(t); });\r\n        };\r\n        // if we don't have OnLayoutEvent stream  we're running pre 2.1 GD version or outside GD,\r\n        if (!this.checkForLayoutEventMethod()) {\r\n            // if no retry resolve right away\r\n            if (noRetry) {\r\n                this.resolveReady();\r\n            }\r\n            // if we should retry, schedule  one more time\r\n            setTimeout(function () {\r\n                _this.subscribe(true);\r\n            }, 500);\r\n        }\r\n        else {\r\n            this.agm.subscribe(\"T42.ACS.OnLayoutEvent\", { waitTimeoutMs: 10000 })\r\n                .then(function (subs) {\r\n                subs.onData(function (args) {\r\n                    var data = args.data;\r\n                    if (data.IsSnapshot) {\r\n                        _this.resolveGotSnapshot();\r\n                    }\r\n                    _this.addLayouts(transform(data.OnLayoutAdded));\r\n                    _this.removeLayouts(transform(data.OnLayoutRemoved));\r\n                    _this.changeLayouts(transform(data.OnLayoutChanged));\r\n                    _this.renameLayouts(transform(data.OnLayoutRenamed));\r\n                    _this.callbacks.execute(\"streamEvent\", data);\r\n                });\r\n                subs.onFailed(function (err) {\r\n                    var msg = \"can not subscribe to T42.ACS.OnLayoutEvent \" + err;\r\n                    _this.rejectReady(msg);\r\n                    _this.rejectGotSnapshot(msg);\r\n                });\r\n                _this.resolveReady();\r\n            })\r\n                .catch(function (err) {\r\n                var msg = \"Error subscribing for T42.ACS.OnLayoutEvent stream. Err: \" + err;\r\n                _this.rejectReady(msg);\r\n                _this.rejectGotSnapshot(msg);\r\n            });\r\n        }\r\n    };\r\n    ACSStream.prototype.onEvent = function (callback) {\r\n        return this.callbacks.add(\"streamEvent\", callback);\r\n    };\r\n    ACSStream.prototype.waitFor = function (token, timeout) {\r\n        var _this = this;\r\n        if (!timeout) {\r\n            timeout = 10000; // default timeout is 10 seconds\r\n        }\r\n        return new Promise(function (resolve, reject) {\r\n            var done = false;\r\n            var unsubscribe = _this.onEvent(function (streamEvent) {\r\n                if (streamEvent.Token === token) {\r\n                    done = true;\r\n                    unsubscribe();\r\n                    resolve();\r\n                }\r\n            });\r\n            setTimeout(function () {\r\n                if (!done) {\r\n                    reject(\"timed out\");\r\n                }\r\n            }, timeout);\r\n        });\r\n    };\r\n    ACSStream.prototype.checkForLayoutEventMethod = function () {\r\n        try {\r\n            return this.agm\r\n                .methods()\r\n                .map(function (m) { return m.name; })\r\n                .indexOf(\"T42.ACS.OnLayoutEvent\") !== -1;\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    };\r\n    ACSStream.prototype.addLayouts = function (layoutsData) {\r\n        var _this = this;\r\n        if (!layoutsData) {\r\n            return;\r\n        }\r\n        layoutsData.forEach(function (layoutData) {\r\n            var layout = new layout_1.default(layoutData);\r\n            store_1.default.add(layout);\r\n            _this.callbacks.execute(\"added\", layout);\r\n        });\r\n    };\r\n    ACSStream.prototype.removeLayouts = function (removedLayouts) {\r\n        var _this = this;\r\n        if (!removedLayouts) {\r\n            return;\r\n        }\r\n        removedLayouts.forEach(function (removedLayout) {\r\n            store_1.default.removeWhere(function (existingLayout) { return !_this.compareLayouts(existingLayout, removedLayout); });\r\n            _this.callbacks.execute(\"removed\", removedLayout);\r\n        });\r\n    };\r\n    ACSStream.prototype.changeLayouts = function (changedLayouts) {\r\n        var _this = this;\r\n        if (!changedLayouts) {\r\n            return;\r\n        }\r\n        changedLayouts.forEach(function (changedLayout) {\r\n            // removed the changed layout and push it again\r\n            store_1.default.removeWhere(function (existingLayout) { return !_this.compareLayouts(existingLayout, changedLayout); });\r\n            store_1.default.add(new layout_1.default(changedLayout));\r\n            // execute callback\r\n            _this.callbacks.execute(\"changed\", changedLayout);\r\n        });\r\n    };\r\n    ACSStream.prototype.renameLayouts = function (renamedLayouts) {\r\n        var _this = this;\r\n        if (!renamedLayouts) {\r\n            return;\r\n        }\r\n        renamedLayouts.forEach(function (renamedLayout) {\r\n            var existingLayout = store_1.default.first(function (current) { return _this.compareLayouts(current, { type: renamedLayout.type, name: renamedLayout.oldName }); });\r\n            if (!existingLayout) {\r\n                throw Error(\"received rename event for unknown layout with type \" + renamedLayout.type + \" and name \" + renamedLayout.oldName);\r\n            }\r\n            existingLayout.name = renamedLayout.newName;\r\n            _this.callbacks.execute(\"renamed\", existingLayout);\r\n        });\r\n    };\r\n    ACSStream.prototype.compareLayouts = function (layout1, layout2) {\r\n        return layout1.name === layout2.name && layout1.type === layout2.type;\r\n    };\r\n    ACSStream.prototype.getObjectValues = function (obj) {\r\n        if (!obj) {\r\n            return [];\r\n        }\r\n        return Object.keys(obj).map(function (k) { return obj[k]; });\r\n    };\r\n    return ACSStream;\r\n}());\r\nexports.default = ACSStream;\r\n//# sourceMappingURL=acsStream.js.map\n\n/***/ }),\n/* 73 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction default_1() {\r\n    return {\r\n        ready: Promise.resolve(undefined),\r\n        subscribe: function () { },\r\n        onEvent: function (callback) { return function () { }; },\r\n        waitFor: function (token, timeout) { return Promise.resolve(undefined); },\r\n        gotSnapshot: Promise.resolve(undefined),\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=nullStream.js.map\n\n/***/ }),\n/* 74 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar glue_1 = __webpack_require__(35);\r\nif (typeof window !== \"undefined\") {\r\n    window.Glue = glue_1.default;\r\n}\r\n// add default library for ES6 modules\r\nglue_1.default.default = glue_1.default;\r\nmodule.exports = glue_1.default;\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 75 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Utils = /** @class */ (function () {\r\n    function Utils() {\r\n    }\r\n    Utils.getGDMajorVersion = function () {\r\n        if (typeof window === \"undefined\") {\r\n            return -1;\r\n        }\r\n        if (!window.glueDesktop) {\r\n            return -1;\r\n        }\r\n        if (!window.glueDesktop.version) {\r\n            return -1;\r\n        }\r\n        var ver = Number(window.glueDesktop.version.substr(0, 1));\r\n        return isNaN(ver) ? -1 : ver;\r\n    };\r\n    Utils.isNode = function () {\r\n        // Only Node.JS has a process variable that is of [[Class]] process\r\n        try {\r\n            return Object.prototype.toString.call(global.process) === \"[object process]\";\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    };\r\n    return Utils;\r\n}());\r\nexports.default = Utils;\r\n//# sourceMappingURL=utils.js.map\n\n/***/ }),\n/* 76 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gd_1 = __webpack_require__(78);\r\nvar hc_1 = __webpack_require__(80);\r\nexports.default = (function (agm, logger, appManagerGetter, gdMajorVersion) {\r\n    var _logger = logger;\r\n    return new Promise(function (resolve, reject) {\r\n        if (gdMajorVersion === 2) {\r\n            // We are running in HC\r\n            _logger.trace(\"running in HC\");\r\n            hc_1.default(agm, _logger, appManagerGetter, window.htmlContainer.containerName, window.htmlContainer.windowId)\r\n                .then(resolve)\r\n                .catch(reject);\r\n        }\r\n        else if (gdMajorVersion >= 3) {\r\n            // We are running in GD 3\r\n            // TODO expose instance in glu42gd\r\n            _logger.trace(\"running in GD\");\r\n            var gd = new gd_1.default(agm, _logger, appManagerGetter, undefined, window.glue42gd.windowId);\r\n            gd.init()\r\n                .then(resolve)\r\n                .catch(reject);\r\n        }\r\n        else {\r\n            // We are running in Browser or Node, we should check which stream is available\r\n            // But we need to pass the container as dependency\r\n            var hcPromise = hc_1.default(agm, _logger, appManagerGetter);\r\n            var gdPromise = new gd_1.default(agm, _logger, appManagerGetter).init();\r\n            var wait = function (ms) { return new Promise(function (res, rej) { return setTimeout(function () { rej(\"timeout waiting for streams\"); }, ms); }); };\r\n            Promise.race([hcPromise, gdPromise, wait(10000)])\r\n                .then(resolve)\r\n                .catch(reject);\r\n        }\r\n    });\r\n});\r\n//# sourceMappingURL=detector.js.map\n\n/***/ }),\n/* 77 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar objectAssign = __webpack_require__(39);\r\nvar GDExecutor = /** @class */ (function () {\r\n    function GDExecutor() {\r\n    }\r\n    Object.defineProperty(GDExecutor.prototype, \"hostInstance\", {\r\n        get: function () {\r\n            return this.agmTarget;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    GDExecutor.prototype.init = function (agm, instance) {\r\n        this.agm = agm;\r\n        this.agmTarget = instance;\r\n    };\r\n    GDExecutor.prototype.close = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"close\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.navigate = function (resultWindow, newUrl) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"navigate\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    url: newUrl\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.setStyle = function (resultWindow, style) {\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            Promise.resolve();\r\n        });\r\n    };\r\n    GDExecutor.prototype.setTitle = function (resultWindow, newTitle) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var options = {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    title: newTitle\r\n                }\r\n            };\r\n            _this.execute(\"setTitle\", options)\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n            Promise.resolve();\r\n        });\r\n    };\r\n    GDExecutor.prototype.moveResize = function (resultWindow, dimensions) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"moveResize\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    bounds: dimensions\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.addFrameButton = function (resultWindow, buttonInfo) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"addButton\", {\r\n                windowId: resultWindow.id,\r\n                options: buttonInfo\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.removeFrameButton = function (resultWindow, buttonId) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"removeButton\", {\r\n                windowId: resultWindow.id,\r\n                options: buttonId\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.activate = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"activate\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.focus = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"focus\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.maximizeRestore = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            _this.execute(\"maximizeRestore\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.maximize = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"maximize\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.restore = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"restore\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.minimize = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"minimize\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.collapse = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"collapse\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.expand = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"expand\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.toggleCollapse = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"toggleCollapse\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.snap = function (resultWindow, target, direction) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var sourceWindowId = resultWindow.id;\r\n            var targetWindowId;\r\n            var errorMessage = \"Invalid target parameter - should be an object with property id or a string. Invoked for source window id:\" +\r\n                resultWindow.id;\r\n            if (!target) {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            if (typeof target === \"string\") {\r\n                targetWindowId = target;\r\n            }\r\n            else if (typeof target.id !== \"undefined\") {\r\n                targetWindowId = target.id;\r\n            }\r\n            else {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            var args = {\r\n                targetWindowId: targetWindowId\r\n            };\r\n            if (direction) {\r\n                args.snappingEdge = direction;\r\n            }\r\n            _this.execute(\"snap\", {\r\n                windowId: resultWindow.id,\r\n                options: args\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.attachTab = function (resultWindow, options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"attachTab\", {\r\n                windowId: resultWindow.id,\r\n                options: options\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.detachTab = function (resultWindow, options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            _this.execute(\"detachTab\", {\r\n                windowId: resultWindow.id,\r\n                options: options\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.setVisible = function (resultWindow, toBeVisible) {\r\n        var _this = this;\r\n        if (toBeVisible === void 0) { toBeVisible = true; }\r\n        return new Promise(function (resolve, reject) {\r\n            var command;\r\n            if (toBeVisible) {\r\n                command = \"show\";\r\n            }\r\n            else {\r\n                command = \"hide\";\r\n            }\r\n            _this.execute(command, { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.showLoader = function (resultWindow, loader) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"showLoadingAnimation\", { windowId: resultWindow.id, options: loader })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.hideLoader = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"hideLoadingAnimation\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.updateContext = function (resultWindow, context) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"updateContext\", {\r\n                windowId: resultWindow.id,\r\n                context: context,\r\n                replace: Object.keys(resultWindow.context).length > 0 ? false : true\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.lock = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"lockUnlock\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    isLocked: true\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.unlock = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"lockUnlock\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    isLocked: false\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.getIcon = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"getIcon\", {\r\n                windowId: resultWindow.id,\r\n                options: {}\r\n            })\r\n                .then(function (result) {\r\n                resolve(result.icon);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.setIcon = function (resultWindow, base64Image) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"setIcon\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    dataURL: base64Image\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.setFrameColor = function (resultWindow, frameColor) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            _this.execute(\"setFrameColor\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    frameColor: frameColor\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.setTabHeaderVisible = function (resultWindow, toBeTabHeaderVisible) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            _this.execute(\"setTabHeaderVisible\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    toShow: toBeTabHeaderVisible\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.execute = function (command, options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var args = {};\r\n            objectAssign(args, options);\r\n            args.command = command;\r\n            _this.agm\r\n                .invoke(\"T42.Wnd.Execute\", args, _this.agmTarget)\r\n                .then(function (i) {\r\n                if (i.returned && i.returned.errorMsg) {\r\n                    reject(i);\r\n                }\r\n                else {\r\n                    resolve(i.returned);\r\n                }\r\n            })\r\n                .catch(function (i) {\r\n                reject(i);\r\n            });\r\n        });\r\n    };\r\n    /** Groups */\r\n    GDExecutor.prototype.setGroupHeaderVisible = function (windowId, toShow) {\r\n        return this.execute(\"setGroupHeaderVisibility\", {\r\n            windowId: windowId,\r\n            options: {\r\n                toShow: toShow\r\n            }\r\n        });\r\n    };\r\n    return GDExecutor;\r\n}());\r\nexports.GDExecutor = GDExecutor;\r\nexports.default = new GDExecutor();\r\n//# sourceMappingURL=executor.js.map\n\n/***/ }),\n/* 78 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = __webpack_require__(1);\r\nvar store_1 = __webpack_require__(3);\r\nvar window_1 = __webpack_require__(24);\r\nvar executor_1 = __webpack_require__(77);\r\nvar helpers_1 = __webpack_require__(23);\r\nvar GDEnvironment = /** @class */ (function () {\r\n    function GDEnvironment(agm, logger, appManagerGetter, instance, wndId) {\r\n        this._registry = CallbackFactory();\r\n        this._waitTimeout = 10000;\r\n        this._agm = agm;\r\n        this._logger = logger.subLogger(\"gd-env\");\r\n        this._agmInstance = this.normalizeInstance(instance);\r\n        this._windowId = wndId;\r\n        this._appManagerGetter = appManagerGetter;\r\n    }\r\n    GDEnvironment.prototype.init = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // if we don't have an Instance, thats means that we are running outside from any Tick42 Containers\r\n            // so our target is best\r\n            if (typeof _this._agmInstance === \"undefined\") {\r\n                _this._agmInstance = \"best\";\r\n            }\r\n            var streamPromise = new Promise(function (streamResolve, streamReject) {\r\n                _this._agm.subscribe(\"T42.Wnd.OnEvent\", {\r\n                    waitTimeoutMs: _this._waitTimeout,\r\n                    target: _this._agmInstance,\r\n                })\r\n                    .then(function (stream) {\r\n                    stream.onData(function (streamData) {\r\n                        _this.updateWindow(streamData.data);\r\n                    });\r\n                    stream.onFailed(function (err) {\r\n                        reject(err);\r\n                    });\r\n                    _this._agmInstance = _this.normalizeInstance(stream.serverInstance);\r\n                    // Init the executor\r\n                    executor_1.default.init(_this._agm, _this._agmInstance);\r\n                    resolve(_this);\r\n                })\r\n                    .catch(function (err) {\r\n                    reject(\"Can not subscribe for stream T42.Wnd.OnEvent. Err: \" + err);\r\n                });\r\n            });\r\n        });\r\n    };\r\n    Object.defineProperty(GDEnvironment.prototype, \"executor\", {\r\n        get: function () {\r\n            return executor_1.default;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    GDEnvironment.prototype.open = function (name, url, options, success, error) {\r\n        options = options || {};\r\n        var copyOptions = Object.assign({}, options);\r\n        // relativeTo fix\r\n        if (typeof name === \"undefined\") {\r\n            if (error) {\r\n                error({ message: \"The name is undefined\" });\r\n            }\r\n            return;\r\n        }\r\n        if (typeof copyOptions.relativeTo !== \"undefined\" && typeof copyOptions.relativeTo !== \"string\") {\r\n            copyOptions.relativeTo = copyOptions.relativeTo.id || \"\";\r\n        }\r\n        copyOptions.name = name;\r\n        copyOptions.url = url;\r\n        // This is for compatability between gd2 and gd3\r\n        copyOptions.windowState = options.windowState || options.state;\r\n        // Otherwise glue desktop throws an error for extra properties\r\n        delete copyOptions.state;\r\n        this._agm.invoke(\"T42.Wnd.Create\", copyOptions, this._agmInstance)\r\n            .then(function (message) {\r\n            if (message.returned !== undefined) {\r\n                var id = message.returned.id;\r\n                success(id);\r\n            }\r\n            else {\r\n                error({ message: \"failed to execute T42.Wnd.Create - unknown reason\" });\r\n            }\r\n        }).catch(function (e) {\r\n            if (typeof error === \"function\") {\r\n                error(e);\r\n            }\r\n        });\r\n    };\r\n    GDEnvironment.prototype.tabAttached = function (callback) {\r\n        return this._registry.add(\"tab-attached\", callback);\r\n    };\r\n    GDEnvironment.prototype.tabDetached = function (callback) {\r\n        return this._registry.add(\"tab-detached\", callback);\r\n    };\r\n    GDEnvironment.prototype.onWindowFrameColorChanged = function (callback) {\r\n        return this._registry.add(\"frame-color-changed\", callback);\r\n    };\r\n    GDEnvironment.prototype.onEvent = function (callback) {\r\n        return this._registry.add(\"window-event\", callback);\r\n    };\r\n    GDEnvironment.prototype.my = function () {\r\n        return this._windowId;\r\n    };\r\n    GDEnvironment.prototype.execute = function (command, options) {\r\n        return this._agm.invoke(\"T42.Wnd.Execute\", {\r\n            command: command,\r\n            options: options,\r\n        });\r\n    };\r\n    /** Groups */\r\n    GDEnvironment.prototype.setGroupHeaderVisible = function (windowId, toShow) {\r\n        return this._agm.invoke(\"T42.Wnd.SetGroupHeaderVisible\", {\r\n            windowId: windowId,\r\n            toShow: toShow,\r\n        }, this._agmInstance);\r\n    };\r\n    GDEnvironment.prototype.onCompositionChanged = function (callback) {\r\n        return this._registry.add(\"composition-changed\", callback);\r\n    };\r\n    GDEnvironment.prototype.onGroupHeaderVisibilityChanged = function (callback) {\r\n        return this._registry.add(\"group-header-changed\", callback);\r\n    };\r\n    GDEnvironment.prototype.onWindowGotFocus = function (callback) {\r\n        return this._registry.add(\"got-focus\", callback);\r\n    };\r\n    GDEnvironment.prototype.onWindowLostFocus = function (callback) {\r\n        return this._registry.add(\"lost-focus\", callback);\r\n    };\r\n    GDEnvironment.prototype.normalizeInstance = function (instance) {\r\n        if (!instance) {\r\n            return undefined;\r\n        }\r\n        return {\r\n            application: instance.application,\r\n            machine: instance.machine,\r\n            user: instance.user,\r\n        };\r\n    };\r\n    GDEnvironment.prototype.updateWindow = function (windowInfo) {\r\n        var _this = this;\r\n        var extendedStreamEvent = this.getExtendedStreamEvent(windowInfo);\r\n        // this is the snapshot of all windows\r\n        if (windowInfo.type === \"Snapshot\") {\r\n            var windowInfoFullInfoEvent = windowInfo;\r\n            windowInfoFullInfoEvent.windows.forEach(function (w) {\r\n                var win = _this.createWindow(w.id, w);\r\n                store_1.default.markReadyToShow(win.API.id);\r\n                _this._registry.execute(\"window-event\", extendedStreamEvent);\r\n            });\r\n            return;\r\n        }\r\n        // if new window handle it separately\r\n        if (windowInfo.type === \"Created\") {\r\n            var windowInfoCreatedEvent = windowInfo;\r\n            var win = this.createWindow(windowInfoCreatedEvent.windowId, windowInfoCreatedEvent.data || {});\r\n            store_1.default.setReadyState(win.API.id);\r\n            this._registry.execute(\"window-event\", extendedStreamEvent);\r\n            return;\r\n        }\r\n        // otherwise check if the window is in our internal collections and update its state\r\n        var windowObjectAndEvents = store_1.default.get(windowInfo.windowId);\r\n        if (!windowObjectAndEvents) {\r\n            this._logger.error(\"received update for unknown window. Stream:', \" + JSON.stringify(windowInfo, null, 4));\r\n            return;\r\n        }\r\n        var theWindow = windowObjectAndEvents.API;\r\n        var theWindowEvents = windowObjectAndEvents.Events;\r\n        // handle bounds changed\r\n        if (windowInfo.type === \"BoundsChanged\") {\r\n            var windowInfoBoundsChangedEvent = windowInfo;\r\n            theWindowEvents.handleBoundsChanged(windowInfoBoundsChangedEvent.data);\r\n        }\r\n        // handle url changed\r\n        if (windowInfo.type === \"UrlChanged\") {\r\n            var windowInfoUrlChangedEvent = windowInfo;\r\n            store_1.default.setUrlChangedState(windowInfoUrlChangedEvent.windowId);\r\n            theWindowEvents.handleUrlChanged(windowInfoUrlChangedEvent.data);\r\n        }\r\n        // handle title changed\r\n        if (windowInfo.type === \"TitleChanged\") {\r\n            var windowInfoTitleChanged = windowInfo;\r\n            theWindowEvents.handleTitleChanged(windowInfoTitleChanged.data);\r\n        }\r\n        // handle visibility changed\r\n        if (windowInfo.type === \"VisibilityChanged\") {\r\n            theWindowEvents.handleVisibilityChanged(windowInfo.data);\r\n        }\r\n        // handle context changed\r\n        if (windowInfo.type === \"ContextChanged\") {\r\n            theWindowEvents.handleContextUpdated(windowInfo.data);\r\n        }\r\n        // handle window state changed\r\n        if (windowInfo.type === \"StateChanged\") {\r\n            theWindowEvents.handleWindowChangeState(windowInfo.data);\r\n        }\r\n        // handle frame color changed\r\n        if (windowInfo.type === \"FrameColorChanged\") {\r\n            theWindowEvents.handleFrameColorChanged(windowInfo.data);\r\n            this._registry.execute(\"frame-color-changed\", theWindow);\r\n        }\r\n        // handle composition changed - groups API\r\n        if (windowInfo.type === \"CompositionChanged\") {\r\n            var windowInfoCompositionChanged = windowInfo;\r\n            theWindowEvents.handleCompositionChanged(windowInfoCompositionChanged.data.neighbors, windowInfoCompositionChanged.data.groupId);\r\n            this._registry.execute(\"composition-changed\", windowInfoCompositionChanged.data);\r\n        }\r\n        if (windowInfo.type === \"GroupHeaderVisibilityChanged\") {\r\n            var info = windowInfo;\r\n            theWindowEvents.handleGroupHeaderVisibilityChanged(info.data.groupHeaderVisible);\r\n            this._registry.execute(\"group-header-changed\", info.data);\r\n        }\r\n        // handle focus changed\r\n        if (windowInfo.type === \"FocusChanged\") {\r\n            var windowInfoFocusChanged = windowInfo;\r\n            this.focusChanged(theWindowEvents, theWindow, windowInfoFocusChanged.data);\r\n        }\r\n        if (windowInfo.type === \"WindowFrameChanged\") {\r\n            theWindowEvents.handleFrameAttached(windowInfo.data.frameId, windowInfo.data.isTabHeaderVisible);\r\n            this._registry.execute(\"frame-changed\");\r\n        }\r\n        if (windowInfo.type === \"WindowFrameAdded\") {\r\n            theWindowEvents.handleAttached(windowInfo.data.frameId, windowInfo.data.isTabHeaderVisible);\r\n            var winsToBeNotified_1 = helpers_1.getWindowsByTabGroupId(theWindow.id, windowInfo.data.frameId);\r\n            // Getting all windows, except current, with same tabGroupId\r\n            Object.keys(winsToBeNotified_1).forEach(function (id) {\r\n                var win = winsToBeNotified_1[id];\r\n                // Executing event windowAttached to all windows\r\n                win.Events.handleWindowAttached(theWindow);\r\n            });\r\n            this._registry.execute(\"tab-attached\", theWindow, windowInfo.data.frameId, windowInfo.data.isTabHeaderVisible);\r\n        }\r\n        if (windowInfo.type === \"WindowFrameRemoved\") {\r\n            // In the event, tabGroupId is empty, will be update on the next event FrameAttached\r\n            var oldTabGroupId = theWindow.tabGroupId;\r\n            theWindowEvents.handleDetached(windowInfo.data.frameId);\r\n            var winsToBeNotified_2 = helpers_1.getWindowsByTabGroupId(theWindow.id, oldTabGroupId);\r\n            Object.keys(winsToBeNotified_2).forEach(function (id) {\r\n                var win = winsToBeNotified_2[id];\r\n                win.Events.handleWindowDetached(theWindow);\r\n            });\r\n            var un_1 = this._registry.add(\"frame-changed\", function () {\r\n                un_1();\r\n                _this._registry.execute(\"tab-detached\", theWindow, windowInfo.data.frameId, theWindow.tabGroupId);\r\n            });\r\n        }\r\n        if (windowInfo.type === \"TabHeaderVisibilityChanged\") {\r\n            theWindowEvents.handleTabHeaderVisibilityChanged(windowInfo.data.isTabHeaderVisible);\r\n        }\r\n        if (windowInfo.type === \"FrameSelectionChanged\") {\r\n            theWindowEvents.handleFrameSelectionChanged(windowInfo.data.newWindowId, windowInfo.data.prevWindowId);\r\n        }\r\n        if (windowInfo.type === \"ButtonClicked\") {\r\n            theWindowEvents.handleFrameButtonClicked(windowInfo.data);\r\n        }\r\n        if (windowInfo.type === \"ButtonAdded\") {\r\n            theWindowEvents.handleFrameButtonAdded(windowInfo.data);\r\n        }\r\n        if (windowInfo.type === \"ButtonRemoved\") {\r\n            theWindowEvents.handleFrameButtonRemoved(windowInfo.data);\r\n        }\r\n        // Clear the window on close event\r\n        if (windowInfo.type === \"Closed\") {\r\n            store_1.default.remove(windowObjectAndEvents);\r\n            theWindowEvents.handleWindowClose();\r\n        }\r\n        // expose to external listeners\r\n        this._registry.execute(\"window-event\", extendedStreamEvent);\r\n    };\r\n    GDEnvironment.prototype.createWindow = function (windowId, options) {\r\n        var windowObjAndEvents = window_1.default(windowId, this.mapToWindowConstructorOptions(options), executor_1.default, this._logger, this._appManagerGetter);\r\n        store_1.default.add(windowObjAndEvents);\r\n        return windowObjAndEvents;\r\n    };\r\n    GDEnvironment.prototype.focusChanged = function (theWindowEvents, theWindow, focus) {\r\n        theWindowEvents.handleFocusChanged(focus);\r\n        if (focus) {\r\n            this._registry.execute(\"got-focus\", theWindow);\r\n        }\r\n        else {\r\n            this._registry.execute(\"lost-focus\", theWindow);\r\n        }\r\n    };\r\n    GDEnvironment.prototype.mapToWindowConstructorOptions = function (args) {\r\n        // TODO\r\n        return {\r\n            name: args.name,\r\n            context: args.context,\r\n            bounds: args.bounds,\r\n            url: args.url,\r\n            title: args.title,\r\n            isVisible: args.isVisible,\r\n            focus: args.isFocused,\r\n            state: args.state,\r\n            frameColor: args.frameColor,\r\n            groupId: args.groupId,\r\n            neighbours: args.neighbors,\r\n            isFocused: args.isFocused,\r\n            isGroupHeaderVisible: args.groupHeaderVisible,\r\n            isCollapsed: args.isCollapsed,\r\n            tabGroupId: args.frameId,\r\n            mode: args.mode,\r\n            isTabHeaderVisible: args.isTabHeaderVisible,\r\n            isTabSelected: args.isActiveTab,\r\n            settings: args.settings,\r\n            windowType: args.windowType,\r\n        };\r\n    };\r\n    GDEnvironment.prototype.getExtendedStreamEvent = function (streamEvent) {\r\n        try {\r\n            var result = __assign({ state: streamEvent.type, windowName: store_1.default.get(streamEvent.windowId).API.name }, streamEvent);\r\n            if (result.state === \"WindowFrameAdded\") {\r\n                result.state = \"TabAttached\";\r\n            }\r\n            if (result.state === \"StateChanged\") {\r\n                result.state = result.data.charAt(0).toUpperCase() + result.data.slice(1);\r\n            }\r\n            if (result.state === \"ButtonAdded\") {\r\n                result.state = \"FrameButtonAdded\";\r\n            }\r\n            if (result.state === \"ButtonRemoved\") {\r\n                result.state = \"FrameButtonRemoved\";\r\n            }\r\n            return result;\r\n        }\r\n        catch (error) {\r\n            return streamEvent;\r\n        }\r\n    };\r\n    return GDEnvironment;\r\n}());\r\nexports.default = GDEnvironment;\r\n//# sourceMappingURL=gd.js.map\n\n/***/ }),\n/* 79 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar HcExecutor = /** @class */ (function () {\r\n    function HcExecutor() {\r\n    }\r\n    Object.defineProperty(HcExecutor.prototype, \"hostInstance\", {\r\n        get: function () {\r\n            return this.agmTarget;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    HcExecutor.prototype.init = function (agm, instance) {\r\n        this.agm = agm;\r\n        this.agmTarget = instance;\r\n    };\r\n    HcExecutor.prototype.close = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.url === undefined;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Close\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onClose);\r\n        });\r\n    };\r\n    HcExecutor.prototype.navigate = function (resultWindow, newUrl) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.url === newUrl;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Html.OpenUrl\", successHandler, errorHandler, { url: newUrl }, conditionFunc, resultWindow.onUrlChanged, true);\r\n        });\r\n    };\r\n    HcExecutor.prototype.setStyle = function (resultWindow, style) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetWindowStyle\", successHandler, errorHandler, { windowStyleAttributes: JSON.stringify(style) });\r\n        });\r\n    };\r\n    HcExecutor.prototype.setTitle = function (resultWindow, newTitle) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.title === newTitle;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetWindowTitle\", successHandler, errorHandler, { title: newTitle }, conditionFunc, resultWindow.onTitleChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.moveResize = function (resultWindow, dimensions) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                var b = resultWindow.bounds;\r\n                var isSame = true;\r\n                Object.keys(dimensions).forEach(function (key) {\r\n                    if (dimensions[key] !== b[key]) {\r\n                        isSame = false;\r\n                        return;\r\n                    }\r\n                });\r\n                return isSame;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.ResizeAndMove\", successHandler, errorHandler, dimensions, conditionFunc, resultWindow.onBoundsChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.addFrameButton = function (resultWindow, buttonInfo) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.AddFrameButton\", successHandler, errorHandler, { buttonInfo: buttonInfo }, conditionFunc, resultWindow.onFrameButtonAdded);\r\n        });\r\n    };\r\n    HcExecutor.prototype.removeFrameButton = function (resultWindow, buttonId) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.RemoveFrameButton\", successHandler, errorHandler, { buttonId: buttonId }, conditionFunc, resultWindow.onFrameButtonRemoved);\r\n        });\r\n    };\r\n    HcExecutor.prototype.activate = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.isFocused;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Activate\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onFocusChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.focus = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Activate\", successHandler, errorHandler, { focus: true }, conditionFunc, resultWindow.onFocusChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.maximizeRestore = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.MaximizeOrRestoreDown\", successHandler, errorHandler);\r\n        });\r\n    };\r\n    HcExecutor.prototype.maximize = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.state === \"maximized\";\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Maximize\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onMaximized);\r\n        });\r\n    };\r\n    HcExecutor.prototype.restore = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.state === \"normal\";\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Restore\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onNormal);\r\n        });\r\n    };\r\n    HcExecutor.prototype.minimize = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.state === \"minimized\";\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Minimize\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onMinimized);\r\n        });\r\n    };\r\n    HcExecutor.prototype.collapse = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.isCollapsed;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetCollapsed\", successHandler, errorHandler, { collapsed: true }, conditionFunc, resultWindow.onCollapsed);\r\n        });\r\n    };\r\n    HcExecutor.prototype.expand = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return !resultWindow.isCollapsed;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetCollapsed\", successHandler, errorHandler, { collapsed: false }, conditionFunc, resultWindow.onExpanded);\r\n        });\r\n    };\r\n    HcExecutor.prototype.toggleCollapse = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            var subscribeFunc = resultWindow.isCollapsed ? resultWindow.onExpanded : resultWindow.onCollapsed;\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetCollapsed\", successHandler, errorHandler, { title: \"\" }, conditionFunc, subscribeFunc);\r\n        });\r\n    };\r\n    HcExecutor.prototype.snap = function (resultWindow, target, direction) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var sourceWindowId = resultWindow.id;\r\n            var targetWindowId;\r\n            var errorMessage = \"Invalid target parameter - should be an object with property id or a string. Invoked for source window id:\" + resultWindow.id;\r\n            if (!target) {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            if (typeof target === \"string\") {\r\n                targetWindowId = target;\r\n            }\r\n            else if (typeof target.id !== \"undefined\") {\r\n                targetWindowId = target.id;\r\n            }\r\n            else {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            var args = {\r\n                sourceWindowId: sourceWindowId,\r\n                targetWindowId: targetWindowId,\r\n            };\r\n            if (direction) {\r\n                args.snappingEdge = direction;\r\n            }\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Snap\", successHandler, errorHandler, args);\r\n        });\r\n    };\r\n    HcExecutor.prototype.attachTab = function (resultWindow, args) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.AttachTab\", successHandler, errorHandler, args);\r\n        });\r\n    };\r\n    HcExecutor.prototype.detachTab = function (resultWindow, args) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var _options = args || {};\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.DettachTab\", successHandler, errorHandler, args);\r\n        });\r\n    };\r\n    HcExecutor.prototype.setVisible = function (resultWindow, toBeVisible) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (typeof toBeVisible === \"undefined\") {\r\n                toBeVisible = true;\r\n            }\r\n            var conditionFunc = function () {\r\n                return resultWindow.isVisible === toBeVisible;\r\n            };\r\n            var styles = { Hidden: !toBeVisible };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetWindowStyle\", successHandler, errorHandler, { windowStyleAttributes: JSON.stringify(styles) }, conditionFunc, resultWindow.onVisibilityChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.showLoader = function (resultWindow, loader) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var opt = loader || {};\r\n            opt.enabled = true;\r\n            opt.timeout = opt.timeout || -1; // by default show the loader forever\r\n            var argsForSend = { loader: opt };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.UpdateLoader\", successHandler, errorHandler, argsForSend);\r\n        });\r\n    };\r\n    HcExecutor.prototype.hideLoader = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.UpdateLoader\", successHandler, errorHandler, { loader: { enabled: false } });\r\n        });\r\n    };\r\n    HcExecutor.prototype.updateContext = function (resultWindow, context) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!context) {\r\n                reject(\"Invalid context parameter - should be an object. Invoked for source window id:\" + resultWindow.id);\r\n                return;\r\n            }\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.UpdateContext\", successHandler, errorHandler, { context: context }, conditionFunc, resultWindow.onContextUpdated);\r\n        });\r\n    };\r\n    HcExecutor.prototype.lock = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Lock\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onLockingChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.unlock = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Unlock\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onLockingChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.getIcon = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // TODO check it in HC\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.GetIcon\", successHandler, errorHandler);\r\n        });\r\n    };\r\n    HcExecutor.prototype.setIcon = function (resultWindow, base64Image) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!base64Image) {\r\n                reject(\"Invalid base64Image parameter. Invoked for source window id:\" + resultWindow.id);\r\n                return;\r\n            }\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetIcon\", successHandler, errorHandler, { base64ImageSource: base64Image });\r\n        });\r\n    };\r\n    HcExecutor.prototype.setFrameColor = function (resultWindow, frameColor) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!frameColor) {\r\n                reject(\"Invalid frameColor parameter. Invoked for source window id:\" + resultWindow.id);\r\n                return;\r\n            }\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetWindowStyle\", successHandler, errorHandler, { windowStyleAttributes: JSON.stringify({ stickyFrameColor: frameColor }) }, conditionFunc, resultWindow.onFrameColorChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.setTabHeaderVisible = function (resultWindow, toBeTabHeaderVisible) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (typeof toBeTabHeaderVisible === \"undefined\") {\r\n                toBeTabHeaderVisible = true;\r\n            }\r\n            var conditionFunc = function () {\r\n                return resultWindow.isTabHeaderVisible === toBeTabHeaderVisible;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetTabHeaderVisible\", successHandler, errorHandler, { toShow: toBeTabHeaderVisible }, conditionFunc, resultWindow.onTabHeaderVisibilityChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.execute = function (command, options) {\r\n        return this.agm.invoke(\"T42.Wnd.Execute\", {\r\n            command: command,\r\n            options: options,\r\n        });\r\n    };\r\n    /** Groups */\r\n    HcExecutor.prototype.setGroupHeaderVisible = function (windowId, toShow) {\r\n        return this.agm.invoke(\"T42.Wnd.SetGroupHeaderVisible\", {\r\n            windowId: windowId,\r\n            toShow: toShow,\r\n        }, this.agmTarget);\r\n    };\r\n    HcExecutor.prototype.agmAction = function (resultWindow, action, success, error, args, conditionFunc, subscribeFunc, ignoreTimeout) {\r\n        // Stop if the window is closed\r\n        ignoreTimeout = ignoreTimeout || false;\r\n        if (resultWindow.url === undefined) {\r\n            if (typeof error === \"function\") {\r\n                error(\"Cannot execute a command on a closed window.\");\r\n            }\r\n            return;\r\n        }\r\n        if (typeof conditionFunc === \"undefined\" || conditionFunc()) {\r\n            this.agmInvoke(resultWindow, action, args, success, error);\r\n        }\r\n        else {\r\n            var removeCallback_1 = function () {\r\n                return;\r\n            };\r\n            var isResolved_1 = false;\r\n            var successHandler = function () {\r\n                isResolved_1 = true;\r\n                removeCallback_1();\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n            };\r\n            removeCallback_1 = subscribeFunc(successHandler);\r\n            if (!ignoreTimeout) {\r\n                setTimeout(function () {\r\n                    if (!isResolved_1) {\r\n                        if (typeof error === \"function\") {\r\n                            error(\"Agm invoke timeout! action: \" + action);\r\n                        }\r\n                    }\r\n                }, 2000);\r\n            }\r\n            this.agmInvoke(resultWindow, action, args, function () {\r\n                return;\r\n            }, error);\r\n        }\r\n    };\r\n    HcExecutor.prototype.agmInvoke = function (resultWindow, action, args, success, error) {\r\n        // Add the window ID to the arguments\r\n        args = args || {};\r\n        args.windowId = resultWindow.id;\r\n        // Invoke the AGM method\r\n        this.agm.invoke(action, args, this.agmTarget, {}, successHandler, errorHandler);\r\n        function successHandler() {\r\n            if (typeof success === \"function\") {\r\n                success(resultWindow);\r\n            }\r\n        }\r\n        function errorHandler(err) {\r\n            if (typeof error === \"function\") {\r\n                if (err.all_return_values && err.all_return_values.length > 0) {\r\n                    error(err.all_return_values[0].message);\r\n                }\r\n                else {\r\n                    error(err);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return HcExecutor;\r\n}());\r\nexports.HcExecutor = HcExecutor;\r\nexports.default = new HcExecutor();\r\n//# sourceMappingURL=executor.js.map\n\n/***/ }),\n/* 80 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = __webpack_require__(1);\r\nvar store_1 = __webpack_require__(3);\r\nvar window_1 = __webpack_require__(24);\r\nvar executor_1 = __webpack_require__(79);\r\nvar helpers_1 = __webpack_require__(23);\r\nexports.default = (function (agm, logger, appManagerGetter, cntName, wndId) {\r\n    return new Promise(function (resolve, reject) {\r\n        var _registry = CallbackFactory();\r\n        var _logger = logger.subLogger(\"hc-env\");\r\n        var waitTimeout = 10000;\r\n        var _windowId = wndId;\r\n        var hcEnv;\r\n        var instance;\r\n        // We have two cases here:\r\n        // 1. when we are in HC\r\n        // 2. when we are in Browser/Node, but we have also started  HC/GD\r\n        if (typeof cntName !== \"undefined\") {\r\n            instance = { application: \"HtmlContainer.\" + cntName };\r\n        }\r\n        else {\r\n            instance = \"best\";\r\n        }\r\n        var streamPromise = new Promise(function (streamResolve, streamReject) {\r\n            agm.subscribe(\"T42.Wnd.WindowStateChanged\", {\r\n                waitTimeoutMs: waitTimeout,\r\n                target: instance,\r\n            })\r\n                .then(function (stream) {\r\n                stream.onData(function (streamData) {\r\n                    instance = streamData.server;\r\n                    updateWindow(streamData.data.state, streamData.data);\r\n                });\r\n                stream.onFailed(function (err) {\r\n                    streamReject(err);\r\n                });\r\n                streamResolve();\r\n            })\r\n                .catch(function (err) {\r\n                streamReject(\"Can not subscribe for stream T42.Wnd.WindowStateChanged. Err: \" + err);\r\n            });\r\n        });\r\n        var listWindowsPromise = new Promise(function (listWndResolve, listWndReject) {\r\n            agm.invoke(\"T42.Wnd.ListWindows\", {}, instance, { waitTimeoutMs: waitTimeout })\r\n                .then(function (result) {\r\n                // add the server object\r\n                instance = result.executed_by;\r\n                // populate windows\r\n                Object.keys(result.returned).forEach(function (existingWindow) {\r\n                    var windowInfo = result.returned[existingWindow];\r\n                    var windowObjAndEvents = createWindow(windowInfo.windowId, windowInfo);\r\n                    // Added to store, showing to world\r\n                    store_1.default.markReadyToShow(windowObjAndEvents.API.id);\r\n                });\r\n                listWndResolve();\r\n            })\r\n                .catch(function (e) {\r\n                listWndReject(\"Can not invoke T42.Wnd.ListWindows method. Err: \" + e);\r\n            });\r\n        });\r\n        Promise.all([streamPromise, listWindowsPromise])\r\n            .then(function () {\r\n            // Init the executor, if we have container name - use it, if not get the first one from the collection\r\n            executor_1.default.init(agm, instance);\r\n            resolve(hcEnv);\r\n        })\r\n            .catch(function (e) {\r\n            reject(\"can not subscribe for stream T42.Wnd.WindowStateChanged or can not invoke T42.Wnd.ListWindows \");\r\n        });\r\n        function updateWindow(eventType, windowInfo) {\r\n            // if new window handle it separately\r\n            if (eventType === \"Created\") {\r\n                var win = createWindow(windowInfo.windowId, windowInfo);\r\n                _registry.execute(\"window-event\", windowInfo);\r\n                // if the window has focus, trigger got focus event\r\n                if (windowInfo.focus) {\r\n                    focusChanged(win.Events, win.API, true);\r\n                }\r\n                return;\r\n            }\r\n            // otherwise check if the window is in our internal collections and update its state\r\n            var windowObjectAndEvents = store_1.default.get(windowInfo.windowId);\r\n            if (!windowObjectAndEvents) {\r\n                _logger.error(\"received update for unknown window. Stream:', \" + JSON.stringify(windowInfo, null, 4));\r\n                return;\r\n            }\r\n            var theWindow = windowObjectAndEvents.API;\r\n            var theWindowEvents = windowObjectAndEvents.Events;\r\n            var oldFrameColor = theWindow.frameColor;\r\n            // const property: string = \"handle\" + eventType;\r\n            // // Try the generic handlers\r\n            // if (theWindowEvents.hasOwnProperty(property)) {\r\n            //     theWindowEvents[property](windowInfo);\r\n            // }\r\n            if (eventType === \"Ready\") {\r\n                store_1.default.setReadyState(windowObjectAndEvents.API.id);\r\n            }\r\n            if (eventType === \"TitleChanged\") {\r\n                theWindowEvents.handleTitleChanged(windowInfo.windowTitle);\r\n            }\r\n            if (eventType === \"UrlChanged\") {\r\n                store_1.default.setUrlChangedState(windowObjectAndEvents.API.id);\r\n                theWindowEvents.handleUrlChanged(windowInfo.url);\r\n            }\r\n            if (eventType === \"WindowStyleChanged\") {\r\n                var parsedWsa = parseWindowStyleAttributes(windowInfo.windowStyleAttributes);\r\n                theWindowEvents.handleWindowSettingsChanged(parsedWsa);\r\n                theWindowEvents.handleVisibilityChanged(!parsedWsa.hidden);\r\n            }\r\n            if (eventType === \"Normal\" ||\r\n                eventType === \"Maximized\" ||\r\n                eventType === \"Minimized\" ||\r\n                eventType === \"Collapsed\" ||\r\n                eventType === \"Expanded\") {\r\n                var state = eventType.toLowerCase();\r\n                theWindowEvents.handleWindowChangeState(state);\r\n            }\r\n            if (eventType === \"ContextUpdated\") {\r\n                theWindowEvents.handleContextUpdated(windowInfo.context);\r\n            }\r\n            if (eventType === \"FrameButtonAdded\") {\r\n                theWindowEvents.handleFrameButtonAdded(windowInfo);\r\n            }\r\n            if (eventType === \"FrameButtonRemoved\") {\r\n                theWindowEvents.handleFrameButtonRemoved(windowInfo);\r\n            }\r\n            if (eventType === \"FrameButtonClicked\") {\r\n                theWindowEvents.handleFrameButtonClicked(windowInfo);\r\n            }\r\n            if (eventType === \"FrameSelectionChanged\") {\r\n                theWindowEvents.handleFrameSelectionChanged(windowInfo.newWindow, windowInfo.prevWindow);\r\n            }\r\n            if (eventType === \"FrameIsLockedChanged\") {\r\n                theWindowEvents.handleFrameIsLockedChanged(windowInfo.isLocked);\r\n            }\r\n            if (eventType === \"TabHeaderVisibilityChanged\") {\r\n                theWindowEvents.handleTabHeaderVisibilityChanged(windowInfo.tabHeaderVisible);\r\n            }\r\n            if (eventType === \"BoundsChanged\") {\r\n                var bounds = {\r\n                    height: windowInfo.height,\r\n                    left: windowInfo.left,\r\n                    top: windowInfo.top,\r\n                    width: windowInfo.width,\r\n                };\r\n                theWindowEvents.handleBoundsChanged(bounds);\r\n            }\r\n            if (eventType === \"FocusChanged\") {\r\n                focusChanged(theWindowEvents, theWindow, windowInfo.focus);\r\n            }\r\n            if (eventType === \"FrameColorChanged\") {\r\n                if (oldFrameColor !== windowInfo.frameColor) {\r\n                    theWindowEvents.handleFrameColorChanged(windowInfo.frameColor);\r\n                    _registry.execute(\"frame-color-changed\", theWindow);\r\n                }\r\n            }\r\n            if (eventType === \"FrameAttached\") {\r\n                theWindowEvents.handleFrameAttached(windowInfo.tabGroupId, windowInfo.tabHeaderVisible);\r\n            }\r\n            if (eventType === \"TabAttached\") {\r\n                theWindowEvents.handleAttached(windowInfo.tabGroupId, windowInfo.tabHeaderVisible);\r\n                var winsToBeNotified_1 = helpers_1.getWindowsByTabGroupId(theWindow.id, windowInfo.tabGroupId);\r\n                // Getting all windows, except current, with same tabGroupId\r\n                Object.keys(winsToBeNotified_1).forEach(function (id) {\r\n                    var win = winsToBeNotified_1[id];\r\n                    // Executing event windowAttached to all windows\r\n                    win.Events.handleWindowAttached(theWindow);\r\n                });\r\n                _registry.execute(\"tab-attached\", theWindow, windowInfo.tabGroupId, windowInfo.tabHeaderVisible);\r\n            }\r\n            if (eventType === \"TabDettached\") {\r\n                // In the event, tabGroupId is empty, will be update on the next event FrameAttached\r\n                var oldTabGroupId = theWindow.tabGroupId;\r\n                theWindowEvents.handleDetached(windowInfo.tabGroupId);\r\n                var winsToBeNotified_2 = helpers_1.getWindowsByTabGroupId(theWindow.id, oldTabGroupId);\r\n                Object.keys(winsToBeNotified_2).forEach(function (id) {\r\n                    var win = winsToBeNotified_2[id];\r\n                    win.Events.handleWindowDetached(theWindow);\r\n                });\r\n                _registry.execute(\"tab-detached\", theWindow, windowInfo.tabGroupId, theWindow.tabGroupId);\r\n            }\r\n            if (eventType === \"CompositionChanged\") {\r\n                theWindowEvents.handleCompositionChanged(windowInfo.neighbours, windowInfo.groupId);\r\n                _registry.execute(\"composition-changed\", windowInfo);\r\n            }\r\n            if (eventType === \"GroupHeaderVisibilityChanged\") {\r\n                theWindowEvents.handleGroupHeaderVisibilityChanged(windowInfo.groupHeaderVisible);\r\n                _registry.execute(\"group-header-changed\", windowInfo);\r\n            }\r\n            // Clear the window on close event\r\n            if (eventType === \"Closed\") {\r\n                if (windowInfo.focus) {\r\n                    // raise lost focus event\r\n                    focusChanged(theWindowEvents, theWindow, false);\r\n                }\r\n                store_1.default.remove(windowObjectAndEvents);\r\n                theWindowEvents.handleWindowClose();\r\n            }\r\n            // expose to external listeners\r\n            _registry.execute(\"window-event\", windowInfo);\r\n        }\r\n        function focusChanged(theWindowEvents, theWindow, focus) {\r\n            theWindowEvents.handleFocusChanged(focus);\r\n            if (focus) {\r\n                _registry.execute(\"got-focus\", theWindow);\r\n            }\r\n            else {\r\n                _registry.execute(\"lost-focus\", theWindow);\r\n            }\r\n        }\r\n        function createWindow(windowId, args) {\r\n            var windowObjAndEvents = window_1.default(windowId, mapToWindowConstructorOptions(args), executor_1.default, _logger, appManagerGetter);\r\n            store_1.default.add(windowObjAndEvents);\r\n            return windowObjAndEvents;\r\n        }\r\n        function open(name, url, options, success, error) {\r\n            options = options || {};\r\n            // relativeTo fix\r\n            if (typeof options.relativeTo !== \"undefined\" && typeof options.relativeTo !== \"string\") {\r\n                options.relativeTo = options.relativeTo.id || \"\";\r\n            }\r\n            options.windowName = name;\r\n            options.url = url;\r\n            agm.invoke(\"T42.Html.CreateWindow\", options)\r\n                .then(function (message) {\r\n                if (message.returned !== undefined) {\r\n                    var id = message.returned.id;\r\n                    success(id);\r\n                }\r\n                else {\r\n                    error(\"failed to execute T42.Html.CreateWindow - unknown reason\");\r\n                }\r\n            }).catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n            });\r\n        }\r\n        function tabAttached(callback) {\r\n            return _registry.add(\"tab-attached\", callback);\r\n        }\r\n        function tabDetached(callback) {\r\n            return _registry.add(\"tab-detached\", callback);\r\n        }\r\n        function onWindowFrameColorChanged(callback) {\r\n            return _registry.add(\"frame-color-changed\", callback);\r\n        }\r\n        function onWindowGotFocus(callback) {\r\n            return _registry.add(\"got-focus\", callback);\r\n        }\r\n        function onWindowLostFocus(callback) {\r\n            return _registry.add(\"lost-focus\", callback);\r\n        }\r\n        function onEvent(callback) {\r\n            return _registry.add(\"window-event\", callback);\r\n        }\r\n        function my() {\r\n            return _windowId;\r\n        }\r\n        function onCompositionChanged(callback) {\r\n            return _registry.add(\"composition-changed\", callback);\r\n        }\r\n        function onGroupHeaderVisibilityChanged(callback) {\r\n            return _registry.add(\"group-header-changed\", callback);\r\n        }\r\n        function mapToWindowConstructorOptions(args) {\r\n            var _state = typeof args.WindowState !== \"undefined\" ? args.WindowState.toLowerCase() : \"normal\";\r\n            var windowStyleAttributes = parseWindowStyleAttributes(args.windowStyleAttributes);\r\n            return {\r\n                name: args.windowName,\r\n                url: args.url,\r\n                title: args.windowTitle,\r\n                context: args.context,\r\n                bounds: {\r\n                    height: args.height,\r\n                    left: args.left,\r\n                    top: args.top,\r\n                    width: args.width,\r\n                },\r\n                focus: args.focus,\r\n                frameColor: args.frameColor,\r\n                groupId: args.groupId,\r\n                isCollapsed: args.isCollapsed,\r\n                isGroupHeaderVisible: args.isGroupHeaderVisible,\r\n                isLocked: args.isLocked,\r\n                isTabHeaderVisible: args.isTabHeaderVisible,\r\n                isTabSelected: args.isTabSelected,\r\n                isVisible: !windowStyleAttributes.hidden,\r\n                isFocused: windowStyleAttributes.focus,\r\n                mode: windowStyleAttributes.mode,\r\n                settings: windowStyleAttributes,\r\n                state: _state,\r\n                tabGroupId: args.tabGroupId,\r\n                neighbours: args.neighbours,\r\n            };\r\n        }\r\n        function parseWindowStyleAttributes(windowStyles) {\r\n            if (windowStyles === undefined) {\r\n                return {};\r\n            }\r\n            if (typeof windowStyles !== \"object\") {\r\n                return JSON.parse(windowStyles);\r\n            }\r\n            return windowStyles;\r\n        }\r\n        hcEnv = {\r\n            my: my,\r\n            onEvent: onEvent,\r\n            open: open,\r\n            tabAttached: tabAttached,\r\n            tabDetached: tabDetached,\r\n            onWindowFrameColorChanged: onWindowFrameColorChanged,\r\n            executor: executor_1.default,\r\n            onCompositionChanged: onCompositionChanged,\r\n            onGroupHeaderVisibilityChanged: onGroupHeaderVisibilityChanged,\r\n            onWindowGotFocus: onWindowGotFocus,\r\n            onWindowLostFocus: onWindowLostFocus,\r\n        };\r\n    });\r\n});\r\n//# sourceMappingURL=hc.js.map\n\n/***/ }),\n/* 81 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = __webpack_require__(1);\r\nvar store_1 = __webpack_require__(3);\r\nexports.default = (function (id, executor) {\r\n    var _registry = CallbackFactory();\r\n    var _windowsId = [];\r\n    var isGroupHeaderVisibleCalled;\r\n    //#region \"API functions\"\r\n    function addWindow(winId) {\r\n        if (_windowsId.indexOf(winId) === -1) {\r\n            _windowsId.push(winId);\r\n            var window_1 = store_1.default.get(winId);\r\n            window_1.Events.handleGroupAssociation(groupObject);\r\n            _registry.execute(\"window-added\", groupObject, window_1.API);\r\n        }\r\n    }\r\n    function removeWindow(winId) {\r\n        var index = _windowsId.indexOf(winId);\r\n        if (index !== -1) {\r\n            _windowsId.splice(index, 1);\r\n            var window_2 = _mapToWindowObject(winId);\r\n            _registry.execute(\"window-removed\", groupObject, window_2);\r\n        }\r\n    }\r\n    function find(window, success) {\r\n        var winId;\r\n        if (typeof window === \"string\") {\r\n            winId = window;\r\n        }\r\n        else {\r\n            winId = window.id;\r\n        }\r\n        var index = _windowsId.indexOf(winId);\r\n        if (index !== -1) {\r\n            var mappedWindow = _mapToWindowObject(_windowsId[index]);\r\n            if (typeof success === \"function\") {\r\n                success(mappedWindow);\r\n            }\r\n            return mappedWindow;\r\n        }\r\n    }\r\n    function windows(success) {\r\n        var mappedWindows = _mapToWindowObjects();\r\n        if (typeof success === \"function\") {\r\n            success(mappedWindows);\r\n        }\r\n        return mappedWindows;\r\n    }\r\n    function showHeader(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setGroupHeaderVisible(_windowsId[0], true)\r\n                .then(function (w) {\r\n                if (typeof success === \"function\") {\r\n                    success(groupObject);\r\n                }\r\n                resolve(groupObject);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function hideHeader(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setGroupHeaderVisible(_windowsId[0], false)\r\n                .then(function (w) {\r\n                if (typeof success === \"function\") {\r\n                    success(groupObject);\r\n                }\r\n                resolve(groupObject);\r\n            })\r\n                .catch(function (e) {\r\n                return;\r\n            });\r\n        });\r\n    }\r\n    function execute(command, options, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.execute(command, options)\r\n                .then(function (w) {\r\n                if (typeof success === \"function\") {\r\n                    success(groupObject);\r\n                }\r\n                resolve(groupObject);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    //#endregion \"API functions\"\r\n    //#region \"Stream function\"\r\n    function handleGroupHeaderVisibilityChanged(windowInfo) {\r\n        if (isGroupHeaderVisibleCalled !== windowInfo.groupHeaderVisible) {\r\n            isGroupHeaderVisibleCalled = windowInfo.groupHeaderVisible;\r\n            _registry.execute(\"header-visibility-changed\", groupObject);\r\n        }\r\n    }\r\n    //#endregion \"Stream function\"\r\n    //#region \"Internal function\"\r\n    function _mapToWindowObjects() {\r\n        var winObjects = [];\r\n        _windowsId.forEach(function (winId) {\r\n            var windowObject = _mapToWindowObject(winId);\r\n            if (typeof windowObject !== \"undefined\") {\r\n                winObjects.push(windowObject);\r\n            }\r\n        });\r\n        return winObjects;\r\n    }\r\n    function _mapToWindowObject(windowId) {\r\n        return store_1.default.get(windowId) ? store_1.default.get(windowId).API : undefined;\r\n    }\r\n    function _getGroupHeaderVisibility() {\r\n        // if one of the windows has a flag hideGroupHeader the group header should be off.\r\n        var _isGroupHeaderVisible;\r\n        var result = _mapToWindowObjects().filter(function (w) {\r\n            return !w.isGroupHeaderVisible;\r\n        });\r\n        _isGroupHeaderVisible = result.length === 0;\r\n        return _isGroupHeaderVisible;\r\n    }\r\n    //#endregion \"Internal function\"\r\n    //#region \"Events\"\r\n    function onHeaderVisibilityChanged(callback) {\r\n        return _registry.add(\"header-visibility-changed\", callback);\r\n    }\r\n    function onWindowAdded(callback) {\r\n        return _registry.add(\"window-added\", callback);\r\n    }\r\n    function onWindowRemoved(callback) {\r\n        return _registry.add(\"window-removed\", callback);\r\n    }\r\n    //#endregion \"Events\"\r\n    //#region \"API\"\r\n    var groupObject = {\r\n        id: id,\r\n        get windows() {\r\n            return windows();\r\n        },\r\n        find: find,\r\n        get isHeaderVisible() {\r\n            return _getGroupHeaderVisibility();\r\n        },\r\n        showHeader: showHeader,\r\n        hideHeader: hideHeader,\r\n        maximize: function (success, error) {\r\n            return execute(\"maximize\", { groupId: id }, success, error);\r\n        },\r\n        restore: function (success, error) {\r\n            return execute(\"restore\", { groupId: id }, success, error);\r\n        },\r\n        onHeaderVisibilityChanged: onHeaderVisibilityChanged,\r\n        onWindowAdded: onWindowAdded,\r\n        onWindowRemoved: onWindowRemoved,\r\n    };\r\n    var internal = {\r\n        addWindow: addWindow,\r\n        removeWindow: removeWindow,\r\n        handleGroupHeaderVisibilityChanged: handleGroupHeaderVisibilityChanged,\r\n    };\r\n    return {\r\n        groupAPI: groupObject,\r\n        groupInternal: internal,\r\n    };\r\n    //#endregion \"API\"\r\n});\r\n//# sourceMappingURL=group.js.map\n\n/***/ }),\n/* 82 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = __webpack_require__(1);\r\nvar group_1 = __webpack_require__(81);\r\nvar store_1 = __webpack_require__(3);\r\nexports.default = (function (environment, logger) {\r\n    var _logger = logger.subLogger(\"groups\");\r\n    var _registry = CallbackFactory();\r\n    var _groups = {};\r\n    // Getting already existing windows and create Group API for each window\r\n    var windows = store_1.default.list;\r\n    Object.keys(windows).forEach(function (k) {\r\n        addNewWindow(windows[k]);\r\n    });\r\n    environment.onCompositionChanged(function (windowInfo) {\r\n        handleCompositionChanged(windowInfo);\r\n    });\r\n    environment.onGroupHeaderVisibilityChanged(function (windowInfo) {\r\n        var windowId = windowInfo.windowId;\r\n        var group = findGroupByWindow(windowId);\r\n        if (typeof group !== \"undefined\") {\r\n            var groupEvents = _groups[group.id];\r\n            groupEvents.groupInternal.handleGroupHeaderVisibilityChanged(windowInfo);\r\n        }\r\n    });\r\n    store_1.default.onAdded(function (win) {\r\n        addNewWindow(win);\r\n    });\r\n    store_1.default.onRemoved(function (win) {\r\n        removeWindow(win);\r\n    });\r\n    // Methods\r\n    function my() {\r\n        return findGroupByWindow(environment.my());\r\n    }\r\n    function list(success) {\r\n        var result = Object.keys(_groups).map(function (groupId) {\r\n            if (_groups[groupId]) {\r\n                return _groups[groupId].groupAPI;\r\n            }\r\n        });\r\n        if (typeof success === \"function\") {\r\n            success(result);\r\n        }\r\n        return result;\r\n    }\r\n    function findGroupByWindow(winId, success) {\r\n        var windowId;\r\n        if (typeof winId === \"undefined\") {\r\n            logger.debug(\"trying to find a group by a window, but winId is undefined\");\r\n            return;\r\n        }\r\n        if (typeof winId === \"string\") {\r\n            windowId = winId;\r\n        }\r\n        else {\r\n            windowId = winId.id;\r\n        }\r\n        var groupFound;\r\n        Object.keys(_groups).forEach(function (groupId) {\r\n            var group = _groups[groupId].groupAPI;\r\n            if (group.find(windowId) !== undefined) {\r\n                groupFound = group;\r\n                return;\r\n            }\r\n        });\r\n        if (typeof success === \"function\") {\r\n            success(groupFound);\r\n        }\r\n        return groupFound;\r\n    }\r\n    // Events\r\n    function onWindowMoved(callback) {\r\n        return _registry.add(\"window-moved\", callback);\r\n    }\r\n    // Private\r\n    function createOrGetGroup(groupId) {\r\n        if (!_groups.hasOwnProperty(groupId)) {\r\n            var createdGroup = group_1.default(groupId, environment.executor);\r\n            _groups[groupId] = createdGroup;\r\n            return createdGroup;\r\n        }\r\n        else {\r\n            return _groups[groupId];\r\n        }\r\n    }\r\n    function deleteGroup(groupId) {\r\n        if (_groups.hasOwnProperty(groupId) && typeof _groups[groupId] !== \"undefined\") {\r\n            if (_groups[groupId].groupAPI.windows.length === 0) {\r\n                delete _groups[groupId];\r\n            }\r\n        }\r\n    }\r\n    function addNewWindow(win) {\r\n        _logger.trace(\"Adding new window \" + win.API.id + \" to win.API.groupId \" + win.API.groupId);\r\n        var group = addWindow(win);\r\n        if (group) {\r\n            _logger.trace(\"handleGroupAssociation \" + win.API.id + \" to group.groupAPI.id \" + group.groupAPI.id);\r\n            win.Events.handleGroupAssociation(group.groupAPI);\r\n        }\r\n    }\r\n    function addWindow(win, groupId) {\r\n        var windowGroupId = groupId || win.API.groupId;\r\n        var windowId = win.API.id;\r\n        if (typeof windowGroupId === \"undefined\" || typeof windowId === \"undefined\") {\r\n            _logger.debug(\"trying to add a window without group - winId: \" + windowId);\r\n            return;\r\n        }\r\n        var group = createOrGetGroup(windowGroupId);\r\n        group.groupInternal.addWindow(windowId);\r\n        return group;\r\n    }\r\n    function removeWindow(win, groupId) {\r\n        var windowId = win.API.id;\r\n        var windowGroupId = groupId || win.API.groupId;\r\n        if (typeof windowGroupId !== \"undefined\") {\r\n            var group = _groups[windowGroupId];\r\n            group.groupInternal.removeWindow(windowId);\r\n            win.Events.handleGroupAssociation(undefined);\r\n            deleteGroup(windowGroupId);\r\n        }\r\n    }\r\n    function handleCompositionChanged(windowInfo) {\r\n        var newGroupId = windowInfo.groupId;\r\n        var windowId = windowInfo.windowId;\r\n        var oldGroup = findGroupByWindow(windowId);\r\n        var oldGroupId = oldGroup ? oldGroup.id : undefined;\r\n        _logger.trace(\"handleCompositionChanged newGroupId: \" + newGroupId + \" windowId: \" + windowId + \" oldGroup: \" + oldGroupId);\r\n        if (oldGroupId === newGroupId) {\r\n            _logger.trace(\"handleCompositionChanged newGroupId: \" + newGroupId + \" windowId: \" + windowId + \" oldGroup: \" + oldGroupId + \" are the same - returning...\");\r\n            return;\r\n        }\r\n        var win = store_1.default.get(windowId) || store_1.default.get(windowId);\r\n        var newGroup = addWindow(win, newGroupId);\r\n        if (oldGroup) {\r\n            removeWindow(win, oldGroupId);\r\n            _registry.execute(\"window-moved\", windowId, oldGroup, newGroupId);\r\n        }\r\n        win.Events.handleGroupChanged(newGroup.groupAPI, oldGroup);\r\n    }\r\n    //#region \"API\"\r\n    var groups = {\r\n        get my() {\r\n            return my();\r\n        },\r\n        list: list,\r\n        findGroupByWindow: findGroupByWindow,\r\n    };\r\n    //#endregion \"API\r\n    var events = { onWindowMoved: onWindowMoved };\r\n    return {\r\n        groupsAPI: groups,\r\n        groupsEvents: events,\r\n    };\r\n});\r\n//# sourceMappingURL=groups.js.map\n\n/***/ }),\n/* 83 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = __webpack_require__(1);\r\nvar detector_1 = __webpack_require__(76);\r\nvar groups_1 = __webpack_require__(82);\r\nvar store_1 = __webpack_require__(3);\r\nexports.default = (function (agm, logger, appManagerGetter, gdMajorVersion) {\r\n    var _registry = CallbackFactory();\r\n    var _logger = logger;\r\n    var groups;\r\n    var environment;\r\n    store_1.default.init(_logger);\r\n    var isReady = new Promise(function (resolve, reject) {\r\n        detector_1.default(agm, _logger, appManagerGetter, gdMajorVersion)\r\n            .then(function (env) {\r\n            environment = env;\r\n            groups = groups_1.default(env, _logger);\r\n            resolve();\r\n        })\r\n            .catch(function (e) {\r\n            var err = \"Environment detector fails with: \" + e;\r\n            _logger.error(err);\r\n            reject(err);\r\n        });\r\n    });\r\n    function ready() {\r\n        return isReady;\r\n    }\r\n    function my() {\r\n        var myWindow = store_1.default.getIfReady(environment.my());\r\n        return myWindow ? myWindow.API : undefined;\r\n    }\r\n    function open(name, url, options, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            var errorHandler = function (errorResponse) {\r\n                if (typeof error === \"function\") {\r\n                    error(errorResponse);\r\n                }\r\n                reject(errorResponse);\r\n            };\r\n            var successHandler = function (id) {\r\n                store_1.default.waitFor(id)\r\n                    .then(function (win) {\r\n                    if (typeof success === \"function\") {\r\n                        success(win);\r\n                    }\r\n                    resolve(win);\r\n                })\r\n                    .catch(errorHandler);\r\n            };\r\n            environment.open(name, url, options, successHandler, errorHandler);\r\n        });\r\n    }\r\n    function find(name, success, error) {\r\n        var windows = store_1.default.list;\r\n        var windowsForListing = Object.keys(windows).reduce(function (memo, winId) {\r\n            var window = windows[winId];\r\n            if (window && window.API.name === name) {\r\n                memo.push(window.API);\r\n            }\r\n            return memo;\r\n        }, []);\r\n        if (typeof success !== \"function\") {\r\n            return windowsForListing[0];\r\n        }\r\n        if (windowsForListing.length > 0) {\r\n            success(windowsForListing[0]);\r\n        }\r\n        else {\r\n            if (typeof error === \"function\") {\r\n                error(\"There is no window with name:\" + name);\r\n            }\r\n        }\r\n    }\r\n    function findById(id, success, error) {\r\n        var windows = store_1.default.list;\r\n        var windowsForListing = Object.keys(windows).reduce(function (memo, winId) {\r\n            var window = windows[winId];\r\n            if (typeof window !== \"undefined\" && window.API.id === id) {\r\n                memo.push(window.API);\r\n            }\r\n            return memo;\r\n        }, []);\r\n        if (typeof success !== \"function\") {\r\n            return windowsForListing[0];\r\n        }\r\n        if (windowsForListing.length > 0) {\r\n            success(windowsForListing[0]);\r\n        }\r\n        else {\r\n            if (typeof error === \"function\") {\r\n                error(\"There is no window with such id:\" + id);\r\n            }\r\n        }\r\n    }\r\n    function list(success) {\r\n        var windows = store_1.default.list;\r\n        var windowsForListing = Object.keys(windows)\r\n            .map(function (k) {\r\n            return windows[k].API;\r\n        });\r\n        if (typeof success !== \"function\") {\r\n            return windowsForListing;\r\n        }\r\n        success(windowsForListing);\r\n    }\r\n    function windowAdded(callback) {\r\n        return _registry.add(\"window-added\", callback);\r\n    }\r\n    function windowRemoved(callback) {\r\n        return _registry.add(\"window-removed\", callback);\r\n    }\r\n    function tabAttached(callback) {\r\n        return isReady.then(function () {\r\n            environment.tabAttached(callback);\r\n        });\r\n    }\r\n    function tabDetached(callback) {\r\n        return isReady.then(function () {\r\n            environment.tabDetached(callback);\r\n        });\r\n    }\r\n    function onWindowFrameColorChanged(callback) {\r\n        return isReady.then(function () {\r\n            return environment.onWindowFrameColorChanged(callback);\r\n        });\r\n    }\r\n    function onWindowGotFocus(callback) {\r\n        var unsubscribe;\r\n        isReady.then(function () {\r\n            unsubscribe = environment.onWindowGotFocus(callback);\r\n        });\r\n        return function () {\r\n            if (unsubscribe) {\r\n                unsubscribe();\r\n            }\r\n        };\r\n    }\r\n    function onWindowLostFocus(callback) {\r\n        var unsubscribe;\r\n        isReady.then(function () {\r\n            unsubscribe = environment.onWindowLostFocus(callback);\r\n        });\r\n        return function () {\r\n            if (unsubscribe) {\r\n                unsubscribe();\r\n            }\r\n        };\r\n    }\r\n    function onEvent(callback) {\r\n        var unsubFunc;\r\n        var unsubscribed = false;\r\n        isReady.then(function () {\r\n            if (unsubscribed) {\r\n                return;\r\n            }\r\n            unsubFunc = environment.onEvent(callback);\r\n        });\r\n        return function () {\r\n            unsubscribed = true;\r\n            if (unsubFunc) {\r\n                unsubFunc();\r\n            }\r\n        };\r\n    }\r\n    function handleWindowAdded(w) {\r\n        _registry.execute(\"window-added\", w.API);\r\n    }\r\n    function handleWindowRemoved(w) {\r\n        _registry.execute(\"window-removed\", w.API);\r\n    }\r\n    store_1.default.onReadyWindow(handleWindowAdded);\r\n    store_1.default.onRemoved(handleWindowRemoved);\r\n    // The API itself\r\n    return {\r\n        my: my,\r\n        open: open,\r\n        find: find,\r\n        findById: findById,\r\n        list: list,\r\n        ready: ready,\r\n        onWindowAdded: windowAdded,\r\n        windowAdded: windowAdded,\r\n        onWindowRemoved: windowRemoved,\r\n        windowRemoved: windowRemoved,\r\n        onTabAttached: tabAttached,\r\n        onTabDetached: tabDetached,\r\n        onWindowFrameColorChanged: onWindowFrameColorChanged,\r\n        get groups() {\r\n            return groups.groupsAPI;\r\n        },\r\n        onWindowGotFocus: onWindowGotFocus,\r\n        onWindowLostFocus: onWindowLostFocus,\r\n        onEvent: onEvent,\r\n    };\r\n});\r\n//# sourceMappingURL=main.js.map\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// tick42-glue.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 74);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bfb50f3ef20a3a10416b","\"use strict\";\r\n// some small useful functions (so we don't reference underscore or lodash)\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction isNumber(arg) {\r\n    return typeof arg === \"number\";\r\n}\r\nexports.isNumber = isNumber;\r\nfunction isString(arg) {\r\n    return typeof arg === \"string\";\r\n}\r\nexports.isString = isString;\r\nfunction isObject(arg) {\r\n    return typeof arg === \"object\" && arg !== null;\r\n}\r\nexports.isObject = isObject;\r\nfunction isArray(arg) {\r\n    // TODO optimize\r\n    if (Array.isArray) {\r\n        return Array.isArray(arg);\r\n    }\r\n    return toString.call(arg) === \"[object Array]\";\r\n}\r\nexports.isArray = isArray;\r\nfunction isUndefined(arg) {\r\n    return typeof arg === \"undefined\";\r\n}\r\nexports.isUndefined = isUndefined;\r\nfunction isUndefinedOrNull(arg) {\r\n    return !arg || typeof arg === \"undefined\";\r\n}\r\nexports.isUndefinedOrNull = isUndefinedOrNull;\r\n/**\r\n *  Checks if an object is empty (has no properties)\r\n * @private\r\n */\r\nfunction isEmpty(arg) {\r\n    for (var prop in arg) {\r\n        if (arg.hasOwnProperty(prop)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nexports.isEmpty = isEmpty;\r\nfunction isFunction(arg) {\r\n    return !!(arg && arg.constructor && arg.call && arg.apply);\r\n}\r\nexports.isFunction = isFunction;\r\nfunction some(array, predicate) {\r\n    for (var index = 0; index < array.length; index++) {\r\n        if (predicate(array[index], index)) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexports.some = some;\r\nfunction first(array, predicate) {\r\n    for (var index = 0; index < array.length; index++) {\r\n        if (predicate(array[index], index)) {\r\n            return array[index];\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\nexports.first = first;\r\nfunction ifNotUndefined(what, doWithIt) {\r\n    if (typeof what !== \"undefined\") {\r\n        doWithIt(what);\r\n    }\r\n}\r\nexports.ifNotUndefined = ifNotUndefined;\r\nfunction promisify(promise, successCallback, errorCallback) {\r\n    \"use strict\";\r\n    if (typeof successCallback !== \"function\" && typeof errorCallback !== \"function\") {\r\n        return promise;\r\n    }\r\n    if (typeof successCallback !== \"function\") {\r\n        successCallback = function () { return; };\r\n    }\r\n    else if (typeof errorCallback !== \"function\") {\r\n        errorCallback = function () { return; };\r\n    }\r\n    promise.then(successCallback, errorCallback);\r\n}\r\nexports.promisify = promisify;\r\n//# sourceMappingURL=util.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/helpers/util.js\n// module id = 0\n// module chunks = 0","\"use strict\";\r\nfunction createRegistry(options) {\r\n    if (options && options.errorHandling\r\n        && typeof options.errorHandling !== \"function\"\r\n        && options.errorHandling !== \"log\"\r\n        && options.errorHandling !== \"silent\"\r\n        && options.errorHandling !== \"throw\") {\r\n        throw new Error(\"Invalid options passed to createRegistry. Prop errorHandling should be [\\\"log\\\" | \\\"silent\\\" | \\\"throw\\\" | (err) => void], but \" + typeof options.errorHandling + \" was passed\");\r\n    }\r\n    var _userErrorHandler = options && typeof options.errorHandling === \"function\" && options.errorHandling;\r\n    var callbacks = {};\r\n    function add(key, callback) {\r\n        var callbacksForKey = callbacks[key];\r\n        if (!callbacksForKey) {\r\n            callbacksForKey = [];\r\n            callbacks[key] = callbacksForKey;\r\n        }\r\n        callbacksForKey.push(callback);\r\n        return function () {\r\n            var allForKey = callbacks[key];\r\n            if (!allForKey) {\r\n                return;\r\n            }\r\n            allForKey = allForKey.reduce(function (acc, element, index) {\r\n                if (!(element === callback && acc.length === index)) {\r\n                    acc.push(element);\r\n                }\r\n                return acc;\r\n            }, []);\r\n            callbacks[key] = allForKey;\r\n        };\r\n    }\r\n    function execute(key) {\r\n        var argumentsArr = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            argumentsArr[_i - 1] = arguments[_i];\r\n        }\r\n        var callbacksForKey = callbacks[key];\r\n        if (!callbacksForKey || callbacksForKey.length === 0) {\r\n            return [];\r\n        }\r\n        var results = [];\r\n        callbacksForKey.forEach(function (callback) {\r\n            try {\r\n                var result = callback.apply(undefined, argumentsArr);\r\n                results.push(result);\r\n            }\r\n            catch (err) {\r\n                results.push(undefined);\r\n                _handleError(err, key);\r\n            }\r\n        });\r\n        return results;\r\n    }\r\n    function _handleError(exceptionArtifact, key) {\r\n        var errParam = exceptionArtifact instanceof Error ? exceptionArtifact : new Error(exceptionArtifact);\r\n        if (_userErrorHandler) {\r\n            _userErrorHandler(errParam);\r\n            return;\r\n        }\r\n        var msg = \"[ERROR] callback-registry: User callback for key \\\"\" + key + \"\\\" failed: \" + errParam.stack;\r\n        if (options) {\r\n            switch (options.errorHandling) {\r\n                case \"log\":\r\n                    return console.error(msg);\r\n                case \"silent\":\r\n                    return;\r\n                case \"throw\":\r\n                    throw new Error(msg);\r\n            }\r\n        }\r\n        console.error(msg);\r\n    }\r\n    function clear() {\r\n        callbacks = {};\r\n    }\r\n    return {\r\n        add: add,\r\n        execute: execute,\r\n        clear: clear\r\n    };\r\n}\r\n;\r\ncreateRegistry.default = createRegistry;\r\nmodule.exports = createRegistry;\r\n//# sourceMappingURL=index.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/callback-registry/lib/index.js\n// module id = 1\n// module chunks = 0","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar EntityEvent = /** @class */ (function () {\r\n    function EntityEvent(entitiy, context) {\r\n        this.entity = entitiy;\r\n        this.context = context;\r\n    }\r\n    return EntityEvent;\r\n}());\r\nexports.EntityEvent = EntityEvent;\r\nvar EntityEventContext = /** @class */ (function () {\r\n    function EntityEventContext(eventType) {\r\n        this.type = eventType;\r\n    }\r\n    return EntityEventContext;\r\n}());\r\nexports.EntityEventContext = EntityEventContext;\r\nvar ActivityStatusChangeEventContext = /** @class */ (function (_super) {\r\n    __extends(ActivityStatusChangeEventContext, _super);\r\n    function ActivityStatusChangeEventContext(newStatus, oldStatus) {\r\n        var _this = _super.call(this, EntityEventType.StatusChange) || this;\r\n        _this.newStatus = newStatus;\r\n        _this.oldStatus = oldStatus;\r\n        return _this;\r\n    }\r\n    return ActivityStatusChangeEventContext;\r\n}(EntityEventContext));\r\nexports.ActivityStatusChangeEventContext = ActivityStatusChangeEventContext;\r\nvar ActivityContextChangedEventContext = /** @class */ (function (_super) {\r\n    __extends(ActivityContextChangedEventContext, _super);\r\n    function ActivityContextChangedEventContext(context) {\r\n        var _this = _super.call(this, EntityEventType.ActivityContextChange) || this;\r\n        _this.context = typeof context === \"string\" ? JSON.parse(context) : context;\r\n        return _this;\r\n    }\r\n    return ActivityContextChangedEventContext;\r\n}(EntityEventContext));\r\nexports.ActivityContextChangedEventContext = ActivityContextChangedEventContext;\r\nvar EntityEventType = /** @class */ (function () {\r\n    function EntityEventType() {\r\n    }\r\n    EntityEventType.Added = \"added\";\r\n    EntityEventType.Removed = \"removed\";\r\n    EntityEventType.Updated = \"updated\";\r\n    EntityEventType.Closed = \"closed\";\r\n    EntityEventType.StatusChange = \"statusChange\";\r\n    EntityEventType.ActivityContextChange = \"activityContextUpdate\";\r\n    EntityEventType.ActivityWindowEvent = \"activityWindowEvent\";\r\n    // #deleteme TODO: these are not implemented in HC\r\n    EntityEventType.ActivityWindowJoinedActivity = \"joined\";\r\n    EntityEventType.ActivityWindowLeftActivity = \"left\";\r\n    return EntityEventType;\r\n}());\r\nexports.EntityEventType = EntityEventType;\r\nvar ActivityState = /** @class */ (function () {\r\n    function ActivityState() {\r\n    }\r\n    ActivityState.Created = \"created\";\r\n    ActivityState.Started = \"started\";\r\n    ActivityState.Destroyed = \"destroyed\";\r\n    return ActivityState;\r\n}());\r\nexports.ActivityState = ActivityState;\r\n//# sourceMappingURL=entityEvent.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/contracts/entityEvent.js\n// module id = 2\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = require(\"callback-registry\");\r\nvar WindowStore = /** @class */ (function () {\r\n    function WindowStore() {\r\n        this.waitForTimeoutInMilliseconds = 60000;\r\n        this._windows = {};\r\n        this._pendingWindows = {};\r\n        this._pendingWindowsStates = {};\r\n        this._registry = CallbackFactory();\r\n    }\r\n    WindowStore.prototype.init = function (logger) {\r\n        this._logger = logger;\r\n    };\r\n    // Returns a window which either in Ready OR NOT 'ready' state (when the window is NOT marked with readyToShow)\r\n    WindowStore.prototype.get = function (id) {\r\n        return this._windows[id] || this._pendingWindows[id];\r\n    };\r\n    // Returns a window which is in 'ready' state (when the window is marked with readyToShow)\r\n    WindowStore.prototype.getIfReady = function (id) {\r\n        return this._windows[id];\r\n    };\r\n    Object.defineProperty(WindowStore.prototype, \"list\", {\r\n        get: function () {\r\n            return this._windows;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    WindowStore.prototype.add = function (window) {\r\n        var isExist = this._pendingWindows[window.API.id] ? true : false;\r\n        if (isExist) {\r\n            this._logger.error(\"trying to add window with id \" + window.API.id + \" from windowStore, which already exists\");\r\n            return;\r\n        }\r\n        var remote = window.API.windowType === \"remote\";\r\n        this._pendingWindows[window.API.id] = window;\r\n        this._pendingWindowsStates[window.API.id] = {\r\n            ready: false,\r\n            urlChanged: remote,\r\n        };\r\n        this._registry.execute(\"on-added\", window);\r\n    };\r\n    WindowStore.prototype.remove = function (window) {\r\n        delete this._windows[window.API.id];\r\n        delete this._pendingWindows[window.API.id];\r\n        delete this._pendingWindowsStates[window.API.id];\r\n        this._registry.execute(\"on-removed\", window);\r\n    };\r\n    WindowStore.prototype.setReadyState = function (windowId) {\r\n        var targetWindowState = this._pendingWindowsStates[windowId];\r\n        if (typeof targetWindowState === \"undefined\") {\r\n            return;\r\n        }\r\n        targetWindowState.ready = true;\r\n        if (targetWindowState.urlChanged) {\r\n            this.markReadyToShow(windowId);\r\n        }\r\n    };\r\n    WindowStore.prototype.setUrlChangedState = function (windowId) {\r\n        var targetWindowState = this._pendingWindowsStates[windowId];\r\n        if (typeof targetWindowState === \"undefined\") {\r\n            return;\r\n        }\r\n        targetWindowState.urlChanged = true;\r\n        if (targetWindowState.ready) {\r\n            this.markReadyToShow(windowId);\r\n        }\r\n    };\r\n    WindowStore.prototype.waitFor = function (id) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var un;\r\n            var timeout = setTimeout(function () {\r\n                un();\r\n                reject(\"waitFor timed out.\");\r\n            }, _this.waitForTimeoutInMilliseconds);\r\n            var win = _this._windows[id];\r\n            if (win) {\r\n                clearTimeout(timeout);\r\n                resolve(win.API);\r\n            }\r\n            else {\r\n                un = _this.onReadyWindow(function (w) {\r\n                    if (w.API.id !== id) {\r\n                        return;\r\n                    }\r\n                    clearTimeout(timeout);\r\n                    un();\r\n                    resolve(w.API);\r\n                });\r\n            }\r\n        });\r\n    };\r\n    WindowStore.prototype.onReadyWindow = function (callback) {\r\n        return this._registry.add(\"on-ready\", callback);\r\n    };\r\n    WindowStore.prototype.onAdded = function (callback) {\r\n        return this._registry.add(\"on-added\", callback);\r\n    };\r\n    WindowStore.prototype.onRemoved = function (callback) {\r\n        return this._registry.add(\"on-removed\", callback);\r\n    };\r\n    // newly created windows now need to hear both \"ready\" and \"urlChanged\" events in otder to be markedReadyToShow\r\n    WindowStore.prototype.markReadyToShow = function (windowId) {\r\n        if (this._pendingWindows[windowId]) {\r\n            this._windows[windowId] = this._pendingWindows[windowId];\r\n            delete this._pendingWindows[windowId];\r\n            delete this._pendingWindowsStates[windowId];\r\n        }\r\n        this._registry.execute(\"on-ready\", this._windows[windowId]);\r\n    };\r\n    return WindowStore;\r\n}());\r\nexports.WindowStore = WindowStore;\r\nexports.default = new WindowStore();\r\n//# sourceMappingURL=store.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/windows/store.js\n// module id = 3\n// module chunks = 0","\"use strict\";\r\n/* tslint:disable */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar util = require(\"./util\");\r\nvar LogLevel = /** @class */ (function () {\r\n    function LogLevel() {\r\n    }\r\n    LogLevel.Trace = \"trace\";\r\n    LogLevel.Debug = \"debug\";\r\n    LogLevel.Info = \"info\";\r\n    LogLevel.Warn = \"warn\";\r\n    LogLevel.Error = \"error\";\r\n    return LogLevel;\r\n}());\r\nexports.LogLevel = LogLevel;\r\nvar Logger = /** @class */ (function () {\r\n    function Logger(name) {\r\n        this._name = name;\r\n        // we have a glue logger let's create a new logger for it\r\n        if (!util.isUndefinedOrNull(Logger.GlueLogger)) {\r\n            this._glueLogger = Logger.GlueLogger.subLogger(name);\r\n        }\r\n    }\r\n    Logger.GetNamed = function (name) {\r\n        return new Logger(name);\r\n    };\r\n    Logger.Get = function (owner) {\r\n        return new Logger(Logger.GetTypeName(owner));\r\n    };\r\n    Logger.prototype.trace = function (message) {\r\n        if (!util.isUndefinedOrNull(this._glueLogger)) {\r\n            this._glueLogger.trace(message);\r\n        }\r\n        else {\r\n            if (Logger.Level === LogLevel.Trace) {\r\n                console.info(this._getMessage(message, LogLevel.Trace));\r\n            }\r\n        }\r\n    };\r\n    Logger.prototype.debug = function (message) {\r\n        if (!util.isUndefinedOrNull(this._glueLogger)) {\r\n            this._glueLogger.debug(message);\r\n        }\r\n        else {\r\n            if (Logger.Level === LogLevel.Debug ||\r\n                Logger.Level === LogLevel.Trace) {\r\n                console.info(this._getMessage(message, LogLevel.Debug));\r\n            }\r\n        }\r\n    };\r\n    Logger.prototype.info = function (message) {\r\n        if (!util.isUndefinedOrNull(this._glueLogger)) {\r\n            this._glueLogger.info(message);\r\n        }\r\n        else {\r\n            if (Logger.Level === LogLevel.Debug ||\r\n                Logger.Level === LogLevel.Trace ||\r\n                Logger.Level === LogLevel.Info) {\r\n                console.info(this._getMessage(message, LogLevel.Info));\r\n            }\r\n        }\r\n    };\r\n    Logger.prototype.warn = function (message) {\r\n        if (!util.isUndefinedOrNull(this._glueLogger)) {\r\n            this._glueLogger.warn(message);\r\n        }\r\n        else {\r\n            if (Logger.Level === LogLevel.Debug ||\r\n                Logger.Level === LogLevel.Trace ||\r\n                Logger.Level === LogLevel.Info ||\r\n                Logger.Level === LogLevel.Warn) {\r\n                console.info(this._getMessage(message, LogLevel.Info));\r\n            }\r\n        }\r\n    };\r\n    Logger.prototype.error = function (message) {\r\n        if (!util.isUndefinedOrNull(this._glueLogger)) {\r\n            this._glueLogger.error(message);\r\n        }\r\n        else {\r\n            console.error(this._getMessage(message, LogLevel.Error));\r\n            console.trace();\r\n        }\r\n    };\r\n    Logger.prototype._getMessage = function (message, level) {\r\n        return \"[\" + level + \"] \" + this._name + \" - \" + message;\r\n    };\r\n    /**\r\n     * Returns the function name for a given object (same as constructor.name but cross-browser)\r\n     */\r\n    Logger.GetTypeName = function (object) {\r\n        var funcNameRegex = /function (.{1,})\\(/;\r\n        var results = (funcNameRegex).exec(object.constructor.toString());\r\n        return (results && results.length > 1) ? results[1] : \"\";\r\n    };\r\n    Logger.Level = LogLevel.Info;\r\n    return Logger;\r\n}());\r\nexports.Logger = Logger;\r\n//# sourceMappingURL=logger.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/helpers/logger.js\n// module id = 4\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ShutdownMethodName = \"T42.ACS.Shutdown\";\r\nexports.FeedackMethodName = \"T42.ACS.Feedback\";\r\nexports.GetConfigurationRegionMethodName = \"T42.ACS.GetConfigurationRegion\";\r\nexports.SetConfigurationRegionMethodName = \"T42.ACS.SetConfigurationRegion\";\r\nexports.GetUserMethodName = \"T42.ACS.GetUser\";\r\nexports.GetBranchesMethodName = \"T42.ACS.GetBranches\";\r\nexports.GetCurrentBranchMethodName = \"T42.ACS.GetCurrentBranch\";\r\nexports.SetCurrentBranchMethodName = \"T42.ACS.SetCurrentBranch\";\r\nexports.GetFunctionalEntitlementMethodName = \"T42.ACS.GetFunctionalEntitlement\";\r\nexports.CanIMethodName = \"T42.ACS.CanI\";\r\nexports.StartApplicationMethodName = \"T42.ACS.StartApplication\";\r\nexports.StopApplicationMethodName = \"T42.ACS.StopApplication\";\r\nexports.ActivateApplicationMethodName = \"T42.ACS.ActivateApplication\";\r\nexports.RunApplicationMethodName = \"T42.ACS.RunApplication\";\r\nexports.OnEventMethodName = \"T42.ACS.OnEvent\";\r\nexports.GetApplicationsMethodName = \"T42.ACS.GetApplications\";\r\n//# sourceMappingURL=agm-names.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/app-manager/const/agm-names.js\n// module id = 5\n// module chunks = 0","'use strict';\n\nvar randomFromSeed = require('./random/random-from-seed');\n\nvar ORIGINAL = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-';\nvar alphabet;\nvar previousSeed;\n\nvar shuffled;\n\nfunction reset() {\n    shuffled = false;\n}\n\nfunction setCharacters(_alphabet_) {\n    if (!_alphabet_) {\n        if (alphabet !== ORIGINAL) {\n            alphabet = ORIGINAL;\n            reset();\n        }\n        return;\n    }\n\n    if (_alphabet_ === alphabet) {\n        return;\n    }\n\n    if (_alphabet_.length !== ORIGINAL.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. You submitted ' + _alphabet_.length + ' characters: ' + _alphabet_);\n    }\n\n    var unique = _alphabet_.split('').filter(function(item, ind, arr){\n       return ind !== arr.lastIndexOf(item);\n    });\n\n    if (unique.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. These characters were not unique: ' + unique.join(', '));\n    }\n\n    alphabet = _alphabet_;\n    reset();\n}\n\nfunction characters(_alphabet_) {\n    setCharacters(_alphabet_);\n    return alphabet;\n}\n\nfunction setSeed(seed) {\n    randomFromSeed.seed(seed);\n    if (previousSeed !== seed) {\n        reset();\n        previousSeed = seed;\n    }\n}\n\nfunction shuffle() {\n    if (!alphabet) {\n        setCharacters(ORIGINAL);\n    }\n\n    var sourceArray = alphabet.split('');\n    var targetArray = [];\n    var r = randomFromSeed.nextValue();\n    var characterIndex;\n\n    while (sourceArray.length > 0) {\n        r = randomFromSeed.nextValue();\n        characterIndex = Math.floor(r * sourceArray.length);\n        targetArray.push(sourceArray.splice(characterIndex, 1)[0]);\n    }\n    return targetArray.join('');\n}\n\nfunction getShuffled() {\n    if (shuffled) {\n        return shuffled;\n    }\n    shuffled = shuffle();\n    return shuffled;\n}\n\n/**\n * lookup shuffled letter\n * @param index\n * @returns {string}\n */\nfunction lookup(index) {\n    var alphabetShuffled = getShuffled();\n    return alphabetShuffled[index];\n}\n\nfunction get () {\n  return alphabet || ORIGINAL;\n}\n\nmodule.exports = {\n    get: get,\n    characters: characters,\n    seed: setSeed,\n    lookup: lookup,\n    shuffled: getShuffled\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/shortid/lib/alphabet.js\n// module id = 6\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Base class for activity entities with reference to the activity manager\r\n * @private\r\n */\r\nvar ActivityEntity = /** @class */ (function () {\r\n    function ActivityEntity(id) {\r\n        this._id = id;\r\n    }\r\n    Object.defineProperty(ActivityEntity.prototype, \"id\", {\r\n        get: function () {\r\n            return this._id;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Updates the properties of the current object using the properties of another object\r\n     * These two should have the same id.\r\n     */\r\n    ActivityEntity.prototype._update = function (other) {\r\n        if (other._id !== this._id) {\r\n            throw Error(\"Can not update from entity with different id.\");\r\n        }\r\n        this._updateCore(other);\r\n    };\r\n    ActivityEntity.prototype._updateCore = function (other) {\r\n        return;\r\n    };\r\n    ActivityEntity.prototype._beforeDelete = function (other) {\r\n        return;\r\n    };\r\n    return ActivityEntity;\r\n}());\r\nexports.default = ActivityEntity;\r\n//# sourceMappingURL=activityEntity.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/entities/activityEntity.js\n// module id = 7\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar util = require(\"../helpers/util\");\r\nvar nextTick = function (cb) {\r\n    setTimeout(cb, 0);\r\n};\r\n/**\r\n * Convert a Promise to node style callback\r\n * @private\r\n */\r\nfunction nodeify(promise, callback) {\r\n    if (!util.isFunction(callback)) {\r\n        return promise;\r\n    }\r\n    promise.then(function (resp) {\r\n        nextTick(function () {\r\n            callback(null, resp);\r\n        });\r\n    }, function (err) {\r\n        nextTick(function () {\r\n            callback(err, null);\r\n        });\r\n    });\r\n}\r\nexports.nodeify = nodeify;\r\n//# sourceMappingURL=promiseExtensions.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/helpers/promiseExtensions.js\n// module id = 8\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar util = require(\"../helpers/util\");\r\nvar util_1 = require(\"../helpers/util\");\r\n// A helper class that provides lame activity AGM implementation\r\n// Can be initialized with or without activity - in case no activity (independent windows outside activity) only\r\n// subset of the methods work\r\nvar ActivityAGM = /** @class */ (function () {\r\n    function ActivityAGM(activity) {\r\n        this._activity = activity;\r\n    }\r\n    ActivityAGM.prototype.register = function (definition, handler) {\r\n        this._ensureHasAgm();\r\n        ActivityAGM.AGM.register(definition, handler);\r\n    };\r\n    ActivityAGM.prototype.servers = function () {\r\n        this._ensureHasAgm();\r\n        if (util.isUndefinedOrNull(this._activity)) {\r\n            // or return ActivityAGM.AGM.servers()\r\n            return [];\r\n        }\r\n        return this._activity.windows.map(function (w) {\r\n            return w.instance;\r\n        });\r\n    };\r\n    ActivityAGM.prototype.methods = function () {\r\n        var _this = this;\r\n        this._ensureHasAgm();\r\n        if (util.isUndefinedOrNull(this._activity)) {\r\n            // or return ActivityAGM.AGM.methods()\r\n            return [];\r\n        }\r\n        var windows = this._activity.windows;\r\n        var methodNames = [];\r\n        var methods = [];\r\n        // get all windows and their methods, then assemble distinct methods\r\n        windows.forEach(function (window) {\r\n            var windowMethods = _this.methodsForWindow(window);\r\n            windowMethods.forEach(function (currentWindowMethod) {\r\n                if (methodNames.indexOf(currentWindowMethod.name) === -1) {\r\n                    methodNames.push(currentWindowMethod.name);\r\n                    methods.push(currentWindowMethod);\r\n                }\r\n            });\r\n        });\r\n        return methods;\r\n    };\r\n    ActivityAGM.prototype.methodsForWindow = function (window) {\r\n        this._ensureHasAgm();\r\n        // get instance and use agm to get methods for instance\r\n        if (!window.instance) {\r\n            return [];\r\n        }\r\n        return ActivityAGM.AGM.methodsForInstance(window.instance);\r\n    };\r\n    /** Possible invoke targets\r\n     *\r\n     * \"activity.all\" - [default]\r\n     * \"activity.best\"\r\n     * ActivityWindow\r\n     * [ActivityWindow] -\r\n     *\r\n     * classic AGM\r\n     * \"all\" - agm all\r\n     * \"best\" - agm best\r\n     * instance - agm\r\n     * [ instances ]\r\n     *\r\n     */\r\n    ActivityAGM.prototype.invoke = function (methodName, arg, target, options, success, error) {\r\n        this._ensureHasAgm();\r\n        var activityServers = this.servers();\r\n        var serversToInvokeAgainst = [];\r\n        if (util.isUndefinedOrNull(target)) {\r\n            target = \"activity.all\";\r\n        }\r\n        if (util.isString(target)) {\r\n            if (target === \"activity.all\") {\r\n                serversToInvokeAgainst = activityServers;\r\n            }\r\n            else if (target === \"activity.best\") {\r\n                var potentialTargets = activityServers.filter(function (server) {\r\n                    var methods = ActivityAGM.AGM.methodsForInstance(server);\r\n                    return methods.filter(function (m) {\r\n                        return m.name === methodName;\r\n                    }).length > 0;\r\n                });\r\n                if (potentialTargets.length > 0) {\r\n                    serversToInvokeAgainst = [potentialTargets[0]];\r\n                }\r\n            }\r\n            else if (target === \"all\" || target === \"best\") {\r\n                return util_1.promisify(ActivityAGM.AGM.invoke(methodName, arg, target, options), success, error);\r\n            }\r\n            else {\r\n                throw new Error(\"Invalid invoke target \" + target);\r\n            }\r\n        }\r\n        else if (util.isArray(target)) {\r\n            // if the array is not empty\r\n            if (target.length >= 0) {\r\n                var firstElem = target[0];\r\n                // check argument type\r\n                if (this._isInstance(firstElem)) {\r\n                    serversToInvokeAgainst = target.map(function (instance) { return instance; });\r\n                }\r\n                else if (this._isActivityWindow(firstElem)) {\r\n                    serversToInvokeAgainst = target.map(function (win) { return win.instance; });\r\n                }\r\n                else {\r\n                    throw new Error(\"Unknown target object\");\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (this._isInstance(target)) {\r\n                serversToInvokeAgainst = [target];\r\n            }\r\n            else if (this._isActivityWindow(target)) {\r\n                serversToInvokeAgainst = [target.instance];\r\n            }\r\n            else {\r\n                throw new Error(\"Unknown target object\");\r\n            }\r\n        }\r\n        throw new Error(\"Not implemented\");\r\n        // return promisify(ActivityAGM.AGM.invoke(methodName, arg, serversToInvokeAgainst, options), success, error);\r\n    };\r\n    ActivityAGM.prototype.unregister = function (definition) {\r\n        this._ensureHasAgm();\r\n        return ActivityAGM.AGM.unregister(definition);\r\n    };\r\n    ActivityAGM.prototype.createStream = function (methodDefinition, subscriptionAddedHandler, subscriptionRemovedHandler) {\r\n        this._ensureHasAgm();\r\n        ActivityAGM.AGM.createStream(methodDefinition, {\r\n            subscriptionAddedHandler: subscriptionAddedHandler,\r\n            subscriptionRemovedHandler: subscriptionRemovedHandler,\r\n            subscriptionRequestHandler: undefined\r\n        });\r\n    };\r\n    ActivityAGM.prototype.subscribe = function (methodDefinition, parameters, target) {\r\n        this._ensureHasAgm();\r\n        // #deleteme TODO: check servers needed?\r\n        // const servers = this.servers();\r\n        return ActivityAGM.AGM.subscribe(methodDefinition, parameters);\r\n    };\r\n    ActivityAGM.prototype._ensureHasAgm = function () {\r\n        if (util.isUndefinedOrNull(ActivityAGM.AGM)) {\r\n            throw new Error(\"Agm should be configured to be used in activity\");\r\n        }\r\n    };\r\n    ActivityAGM.prototype._isInstance = function (obj) {\r\n        // lame check\r\n        return obj.application !== undefined;\r\n    };\r\n    ActivityAGM.prototype._isActivityWindow = function (obj) {\r\n        return obj.instance !== undefined;\r\n    };\r\n    return ActivityAGM;\r\n}());\r\nexports.ActivityAGM = ActivityAGM;\r\n//# sourceMappingURL=activityAGM.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/core/activityAGM.js\n// module id = 9\n// module chunks = 0","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityEntity_1 = require(\"./activityEntity\");\r\nvar util_1 = require(\"../helpers/util\");\r\n/**\r\n * An activity type is a definition template for an activity, consisting of a collection of window types,\r\n * their layout and an initial activity context.\r\n *\r\n * @module activityType\r\n */\r\nvar ActivityType = /** @class */ (function (_super) {\r\n    __extends(ActivityType, _super);\r\n    function ActivityType(name, ownerWindow, helperWindows, description) {\r\n        var _this = _super.call(this, name) || this;\r\n        _this._name = name;\r\n        _this._description = description;\r\n        _this._ownerWindow = ownerWindow;\r\n        _this._helperWindows = helperWindows || [];\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ActivityType.prototype, \"name\", {\r\n        /**\r\n         * @var {string} name Name of the activity type\r\n         */\r\n        get: function () {\r\n            return this._name;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityType.prototype, \"description\", {\r\n        /**\r\n         * @var {string} description description for the activity type\r\n         */\r\n        get: function () {\r\n            return this._description;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityType.prototype, \"helperWindows\", {\r\n        /**\r\n         * A list of window types that should be created when initiating a new instance of that activity type\r\n         * @var {windowDefinition[]} helperWindows\r\n         */\r\n        get: function () {\r\n            return this._helperWindows;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityType.prototype, \"ownerWindow\", {\r\n        /**\r\n         * @var {windowDefinition} ownerWindow Returns the definition of the owner window for that activity type\r\n         */\r\n        get: function () {\r\n            return this._ownerWindow;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Initiates a new activity of this type\r\n     *\r\n     * @function initiate\r\n     * @param {object} context The initial context to be used for the new activity\r\n     * @param callback\r\n     * @param configuration\r\n     * @returns {Promise<activity>}\r\n     */\r\n    ActivityType.prototype.initiate = function (context, callback, configuration) {\r\n        return this._manager.initiate(this._name, context, callback, configuration);\r\n    };\r\n    ActivityType.prototype._updateCore = function (other) {\r\n        var _this = this;\r\n        _super.prototype._updateCore.call(this, other);\r\n        util_1.ifNotUndefined(other._description, function (x) { return _this._description = x; });\r\n        util_1.ifNotUndefined(other._ownerWindow, function (x) { return _this._ownerWindow = x; });\r\n        util_1.ifNotUndefined(other._helperWindows, function (x) { return _this._helperWindows = x; });\r\n    };\r\n    return ActivityType;\r\n}(activityEntity_1.default));\r\nexports.default = ActivityType;\r\n//# sourceMappingURL=activityType.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/entities/activityType.js\n// module id = 10\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction objectValues(source) {\r\n    if (!source) {\r\n        return [];\r\n    }\r\n    return Object.keys(source).map(function (key) { return source[key]; });\r\n}\r\nexports.objectValues = objectValues;\r\nfunction objectClone(obj) {\r\n    var result;\r\n    try {\r\n        result = JSON.parse(JSON.stringify(obj || {}));\r\n    }\r\n    catch (error) {\r\n        result = {};\r\n    }\r\n    return result;\r\n}\r\nexports.objectClone = objectClone;\r\n//# sourceMappingURL=helper.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/app-manager/helper.js\n// module id = 11\n// module chunks = 0","module.exports = require(\"cluster\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cluster\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"crypto\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"crypto\"\n// module id = 13\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar entityEvent_1 = require(\"../contracts/entityEvent\");\r\nvar activityStatus_1 = require(\"../contracts/activityStatus\");\r\nvar activityType_1 = require(\"../entities/activityType\");\r\nvar windowType_1 = require(\"../entities/windowType\");\r\nvar activity_1 = require(\"../entities/activity\");\r\nvar activityWindow_1 = require(\"../entities/activityWindow\");\r\nvar logger_1 = require(\"../helpers/logger\");\r\nvar readyMarker_1 = require(\"../helpers/readyMarker\");\r\nvar util = require(\"../helpers/util\");\r\n/**\r\n * HtmlContainer (HC) bridge\r\n * @private\r\n * @module hcBridge\r\n */\r\nvar HCBridge = /** @class */ (function () {\r\n    function HCBridge(agm, windows, appManagerGetter, mode, typesToTrack) {\r\n        // HC constants\r\n        this._activityTypeEntityName = \"activityType\";\r\n        this._windowTypeEntityName = \"windowType\";\r\n        this._activityEntityName = \"activity\";\r\n        this._windowEntityName = \"activityWindow\";\r\n        this._logger = logger_1.Logger.Get(\"hcBridge\");\r\n        // event sequences\r\n        this._lastSeq = 0;\r\n        this._eventQueue = [];\r\n        this._activityTypeCallbacks = [];\r\n        this._windowTypeCallbacks = [];\r\n        this._activityCallbacks = [];\r\n        this._windowCallbacks = [];\r\n        this._agm = agm;\r\n        this._windows = windows;\r\n        this._appManagerGetter = appManagerGetter;\r\n        this._mode = mode;\r\n        this._typesToTrack = typesToTrack;\r\n    }\r\n    /**\r\n     *  Convert an ActivityType entity coming from HC to ActivityType\r\n     */\r\n    HCBridge._hcToJsActivityType = function (hcActType) {\r\n        return new activityType_1.default(hcActType.name, hcActType.ownerWindowType, hcActType.helperWindowTypes, hcActType.description);\r\n    };\r\n    HCBridge._getURLParameter = function (name) {\r\n        return decodeURIComponent((new RegExp(\"[?|&]\" + name + \"=\" + \"([^&;]+?)(&|#|;|$)\").exec(location.search) || [, \"\"])[1].replace(/\\+/g, \"%20\")) || null;\r\n    };\r\n    Object.defineProperty(HCBridge.prototype, \"bridgeType\", {\r\n        get: function () {\r\n            return \"HC\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    HCBridge.prototype.joinActivity = function (activityId, windowId) {\r\n        throw new Error(\"Not implemented\");\r\n    };\r\n    HCBridge.prototype.leaveActivity = function (activityId, windowId) {\r\n        throw new Error(\"Not implemented\");\r\n    };\r\n    HCBridge.prototype.init = function () {\r\n        var _this = this;\r\n        this._readyMarker = new readyMarker_1.ReadyMarker(\"HC Bridge\", 1);\r\n        this._htmlContainer = window.htmlContainer.activityFacade;\r\n        if (this._htmlContainer.subscribeForJoinBreakEvents) {\r\n            this._htmlContainer.subscribeForJoinBreakEvents(function (e) {\r\n                _this._handleGenericEvents(e);\r\n            });\r\n        }\r\n        var options = this._agm ? this._agm.instance : undefined;\r\n        var initFunc = this._htmlContainer.init;\r\n        if (this._htmlContainer.init2) {\r\n            initFunc = this._htmlContainer.init2;\r\n            options = {\r\n                jsAgmInstance: options,\r\n                glueVersion: 3,\r\n                mode: this._mode,\r\n                typesToTrack: this._typesToTrack\r\n            };\r\n        }\r\n        initFunc(options, this._hcEventHandler.bind(this), // event listener\r\n        function () {\r\n            _this._readyMarker.signal(\"Init done from HC\");\r\n        }, function (error) {\r\n            _this._readyMarker.error(error);\r\n        });\r\n    };\r\n    HCBridge.prototype.initReady = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._readyMarker.setCallback(function (err) {\r\n                if (!err) {\r\n                    resolve(_this);\r\n                }\r\n                else {\r\n                    _this._logger.error(\"Error initializing HC bridge - \" + err);\r\n                    reject(_this._readyMarker.getError());\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.ready = function () {\r\n        return this.initReady();\r\n    };\r\n    HCBridge.prototype._handleGenericEvents = function (event) {\r\n        this._processEventBySeq(event);\r\n    };\r\n    HCBridge.prototype._hcEventHandler = function (eventJson) {\r\n        this._logger.trace(eventJson);\r\n        var event = JSON.parse(eventJson);\r\n        this._processEventBySeq(event);\r\n    };\r\n    HCBridge.prototype._processEventBySeq = function (event) {\r\n        var seq = event.sequence;\r\n        if (seq === this._lastSeq + 1) {\r\n            // if this is the event we expect process it\r\n            this._processEvent(event);\r\n            this._lastSeq++;\r\n            // empty the next items in the queue - if any\r\n            var nextEvent = this._eventQueue[seq + 1];\r\n            if (!util.isUndefined(nextEvent)) {\r\n                this._logger.debug(\"replaying message number \" + seq);\r\n                this._processEventBySeq(nextEvent);\r\n                delete this._eventQueue[seq + 1];\r\n            }\r\n        }\r\n        else {\r\n            // save in the queue\r\n            this._eventQueue[seq] = event;\r\n            this._logger.debug(\"Got out of order event with number \" + seq + \". Will wait for previous event(s) before replaying.\");\r\n        }\r\n    };\r\n    HCBridge.prototype._processEvent = function (event) {\r\n        if (event.genericEvent) {\r\n            this._processGenericEvent(event);\r\n            return;\r\n        }\r\n        var entityType = event.entityType;\r\n        var eventContext = this._convertContext(event.context);\r\n        var entity;\r\n        switch (entityType) {\r\n            case this._activityTypeEntityName:\r\n                entity = HCBridge._hcToJsActivityType(event.entity);\r\n                this._publishActivityTypeStatusChange(entity, eventContext);\r\n                break;\r\n            case this._windowTypeEntityName:\r\n                entity = this._hcToJsWindowType(event.entity);\r\n                this._publishWindowTypeStatusChange(entity, eventContext);\r\n                break;\r\n            case this._activityEntityName:\r\n                entity = this._hcToJsActivity(event.entity);\r\n                this._publishActivityStatusChange(entity, eventContext);\r\n                break;\r\n            case this._windowEntityName:\r\n                entity = this._hcToJsWindow(event.entity);\r\n                this._publishActivityWindowEvent(entity, eventContext);\r\n                break;\r\n        }\r\n    };\r\n    HCBridge.prototype._processGenericEvent = function (event) {\r\n        var info = event.data;\r\n        if (event.type === \"ActivitiesAttached\") {\r\n            if (this._activitiesAttachedHandler) {\r\n                this._activitiesAttachedHandler(info);\r\n            }\r\n        }\r\n        else if (event.type === \"ActivitiesDetached\") {\r\n            if (this._activitiesDetached) {\r\n                this._activitiesDetached(info);\r\n            }\r\n        }\r\n        else if (event.type === \"ActivityAttachedDescriptorsRefreshed\") {\r\n            if (this._activityAttachedDescriptorsRefreshed) {\r\n                this._activityAttachedDescriptorsRefreshed(info);\r\n            }\r\n        }\r\n    };\r\n    HCBridge.prototype._convertContext = function (hcContext) {\r\n        if (hcContext.type === entityEvent_1.EntityEventType.StatusChange) {\r\n            var oldStatus = new activityStatus_1.ActivityStatus(hcContext.oldStatus.state, hcContext.oldStatus.statusMessage, hcContext.oldStatus.statusTime);\r\n            var newStatus = new activityStatus_1.ActivityStatus(hcContext.newStatus.state, hcContext.newStatus.statusMessage, hcContext.newStatus.statusTime);\r\n            return new entityEvent_1.ActivityStatusChangeEventContext(newStatus, oldStatus);\r\n        }\r\n        else if (hcContext.type === entityEvent_1.EntityEventType.ActivityWindowEvent) {\r\n            return new entityEvent_1.EntityEventContext(hcContext.event);\r\n        }\r\n        else if (hcContext.type === entityEvent_1.EntityEventType.ActivityContextChange) {\r\n            return new entityEvent_1.ActivityContextChangedEventContext(hcContext.newContext);\r\n        }\r\n        return new entityEvent_1.EntityEventContext(hcContext.type);\r\n    };\r\n    /**\r\n     *  Convert an Activity entity from HC to Activity\r\n     */\r\n    HCBridge.prototype._hcToJsActivity = function (hcAct) {\r\n        var window = hcAct.owner ? this._hcToJsWindow(hcAct.owner) : null;\r\n        var windowId = window ? window.id : null;\r\n        var status = new activityStatus_1.ActivityStatus(hcAct.status.state, hcAct.status.statusMessage, hcAct.status.statusTime);\r\n        var context = JSON.parse(hcAct.context);\r\n        return new activity_1.default(hcAct.id, hcAct.type.name, status, context, windowId);\r\n    };\r\n    /**\r\n     *  Convert a WindowType entity coming from HC to WindowType\r\n     */\r\n    HCBridge.prototype._hcToJsWindowType = function (hcWinType) {\r\n        var _this = this;\r\n        if (util.isUndefined(hcWinType.factories)) {\r\n            hcWinType.factories = [];\r\n        }\r\n        // lazy init\r\n        if (!this._appByWindowTypeGetter) {\r\n            if (!this._appManagerGetter) {\r\n                this._appByWindowTypeGetter = function () { return undefined; };\r\n            }\r\n            this._appByWindowTypeGetter = function (wt) {\r\n                var appMgr = _this._appManagerGetter();\r\n                return appMgr.applications().filter(function (app) { return app.activityWindowType === wt; })[0];\r\n            };\r\n        }\r\n        return new windowType_1.default(hcWinType.name, this._appByWindowTypeGetter);\r\n    };\r\n    // /** Convert a WindowFactory entity coming from HC to WindowFactory */\r\n    // static _hcToJsWindowTypeFactory(hcWinTypeFactory: any): WindowFactory {\r\n    //   return new ProxyWindowFactory(hcWinTypeFactory.description);\r\n    // }\r\n    HCBridge.prototype.getActivityTypes = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // get all from HC\r\n            _this._htmlContainer.getActivityTypes(function (infos) {\r\n                // transform to Activity Js Entities\r\n                var result = infos.map(function (info) { return HCBridge._hcToJsActivityType(info); });\r\n                resolve(result);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.registerActivityType = function (activityTypeName, ownerWindow, helperWindows, layoutConfig, description) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (helperWindows === undefined) {\r\n                helperWindows = [];\r\n            }\r\n            var config = {\r\n                name: activityTypeName,\r\n                ownerWindowType: ownerWindow,\r\n                helperWindowTypes: helperWindows,\r\n                description: description,\r\n                layoutConfig: JSON.stringify(layoutConfig)\r\n            };\r\n            // pass create request to HC\r\n            _this._htmlContainer.registerActivityType(JSON.stringify(config), function (info) {\r\n                // transform to Activity Js Entity\r\n                var newActivityType = HCBridge._hcToJsActivityType(info);\r\n                resolve(newActivityType);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.unregisterActivityType = function (activityTypeName) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // pass create request to HC\r\n            _this._htmlContainer.unregisterActivityType(activityTypeName, \r\n            /*( info )*/ function () {\r\n                resolve();\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.getWindowTypes = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // get all from HC\r\n            _this._htmlContainer.getWindowTypes(function (infos) {\r\n                // transform to Activity Js Entities\r\n                var result = infos.map(function (info) { return _this._hcToJsWindowType(info); });\r\n                resolve(result);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.registerWindowFactory = function (windowTypeName, factory, parameters) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(windowTypeName)) {\r\n                reject(\"windowTypeName should be provided\");\r\n                return;\r\n            }\r\n            // pass create request to HC\r\n            _this._htmlContainer.registerWindowFactory(windowTypeName, factory.create.bind(factory), \r\n            /*(info)*/ function () {\r\n                resolve();\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.initiateActivity = function (activityType, context, configuration) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(activityType)) {\r\n                reject(\"windowTypeName should be provided\");\r\n                return;\r\n            }\r\n            if (util.isUndefinedOrNull(context)) {\r\n                context = {};\r\n            }\r\n            // pass create request to HC\r\n            _this._htmlContainer.initiate(activityType, JSON.stringify(context), function (activityId) {\r\n                resolve(activityId);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.getAnnouncementInfo = function () {\r\n        var hc = window.htmlContainer;\r\n        var context = hc.getContext();\r\n        var result = { activityWindowId: \"\", activityWindowType: \"\", activityWindowIndependent: false, activityWindowName: \"\" };\r\n        if (!context.activityId) {\r\n            // in case we're not in activity just return. this will\r\n            // lead to window not registering itself\r\n            return result;\r\n        }\r\n        result.activityWindowType = context.activityWindowType;\r\n        if (util.isUndefined(result.activityWindowType)) {\r\n            result.activityWindowType = HCBridge._getURLParameter(\"activityWindowType\");\r\n        }\r\n        result.activityWindowId = context.activityWindowId;\r\n        if (util.isUndefined(result.activityWindowId)) {\r\n            result.activityWindowId = HCBridge._getURLParameter(\"activityWindowId\");\r\n        }\r\n        result.activityWindowIndependent = context.activityWindowIndependent;\r\n        if (util.isUndefined(result.activityWindowIndependent)) {\r\n            // TODO parse\r\n            // result.activityWindowIndependent = this._getURLParameter(\"activityWindowIndependent\");\r\n        }\r\n        result.activityWindowName = context.activityWindowName;\r\n        if (util.isUndefined(result.activityWindowName)) {\r\n            result.activityWindowName = HCBridge._getURLParameter(\"activityWindowName\");\r\n        }\r\n        return result;\r\n    };\r\n    HCBridge.prototype.announceWindow = function (windowType, activityWindowId) {\r\n        var _this = this;\r\n        if (util.isUndefined(windowType)) {\r\n            throw new Error(\"can not determine window type\");\r\n        }\r\n        if (util.isUndefined(windowType)) {\r\n            throw new Error(\"can not determine window activityWindowId\");\r\n        }\r\n        this._htmlContainer.announceWindow(windowType, activityWindowId, function (error) {\r\n            _this._logger.error(\"Error announcing activity window with id '\" + activityWindowId + \"'. \" + error);\r\n        });\r\n    };\r\n    HCBridge.prototype.getActivities = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // get all from HC\r\n            _this._logger.trace(\"Executing getActivities()\");\r\n            _this._htmlContainer.getActivities(function (activitiesStr) {\r\n                // transform to Activity Js Entities\r\n                _this._logger.trace(\"Got getActivities() :\" + activitiesStr);\r\n                var activities = JSON.parse(activitiesStr);\r\n                var result = activities.map(function (act) { return _this._hcToJsActivity(act); });\r\n                resolve(result);\r\n            }, function (error) {\r\n                _this._logger.trace(\"Error in getActivities() :\" + error);\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.updateActivityContext = function (activity, context, fullReplace, removedKeys) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (util.isUndefined(removedKeys)) {\r\n                removedKeys = [];\r\n            }\r\n            var options = {\r\n                fullReplace: fullReplace,\r\n                removedKeys: removedKeys\r\n            };\r\n            _this._htmlContainer.setActivityContext(activity.id, JSON.stringify(context), JSON.stringify(options), function (newContextString) {\r\n                // receives the new context as string\r\n                var newContext = JSON.parse(newContextString);\r\n                resolve(newContext);\r\n            }, function (error) { return reject(error); });\r\n        });\r\n    };\r\n    HCBridge.prototype.getActivityWindows = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // get all from HC\r\n            _this._htmlContainer.getWindows(function (windows) {\r\n                // transform to Activity Js Entities\r\n                var result = windows.map(function (wind) { return _this._hcToJsWindow(wind); });\r\n                resolve(result);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.stopActivity = function (activity) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.stopActivity(activity.id, function (result) {\r\n                resolve(result);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.unregisterWindowFactory = function (windowTypeName) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.registerWindowFactory(windowTypeName, \r\n            /*(info)*/ function () {\r\n                resolve();\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.createWindow = function (id, windowDefinition) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var objToSend = windowDefinition;\r\n            var functionToUse = _this._htmlContainer.createWindow2;\r\n            if (!functionToUse) {\r\n                functionToUse = _this._htmlContainer.createWindow;\r\n                objToSend = JSON.stringify(windowDefinition);\r\n            }\r\n            functionToUse(id, objToSend, function (newId) {\r\n                resolve(newId);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.createStackedWindows = function (id, windowDefinitions, timeout) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var objToSend = windowDefinitions;\r\n            var functionToUse = _this._htmlContainer.createStackedWindows2;\r\n            if (!functionToUse) {\r\n                functionToUse = _this._htmlContainer.createStackedWindows;\r\n                objToSend = JSON.stringify(windowDefinitions);\r\n            }\r\n            functionToUse(id, objToSend, timeout, function (newId) {\r\n                resolve(newId);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.onActivityTypeStatusChange = function (callback) {\r\n        this._activityTypeCallbacks.push(callback);\r\n    };\r\n    HCBridge.prototype.onWindowTypeStatusChange = function (callback) {\r\n        this._windowTypeCallbacks.push(callback);\r\n    };\r\n    HCBridge.prototype.onActivityStatusChange = function (callback) {\r\n        this._activityCallbacks.push(callback);\r\n    };\r\n    HCBridge.prototype.onActivityWindowChange = function (callback) {\r\n        this._windowCallbacks.push(callback);\r\n    };\r\n    HCBridge.prototype.getWindowBounds = function (id) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.getWindowBounds(id, function (bounds) {\r\n                resolve(bounds);\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.setWindowBounds = function (id, bounds) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.setWindowBounds(id, JSON.stringify(bounds), function () {\r\n                resolve();\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.registerWindow = function (type, name, independent) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.registerWindow(type, name, independent, function (id) {\r\n                resolve(id);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.closeWindow = function (id) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.closeWindow(id, function () {\r\n                resolve();\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.activateWindow = function (id, focus) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.activateWindow(id, focus, function () {\r\n                resolve();\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.setWindowVisibility = function (id, visible) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.setWindowVisibility(id, visible, function () {\r\n                resolve();\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.cloneActivity = function (id, options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.cloneActivity(id, options, function (activityId) {\r\n                resolve(activityId);\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype._publishStatusChange = function (entity, context, callbacks) {\r\n        var entityEvent = new entityEvent_1.EntityEvent(entity, context);\r\n        callbacks.forEach(function (callback) {\r\n            callback(entityEvent);\r\n        });\r\n    };\r\n    HCBridge.prototype._publishActivityTypeStatusChange = function (at, context) {\r\n        this._publishStatusChange(at, context, this._activityTypeCallbacks);\r\n    };\r\n    HCBridge.prototype._publishWindowTypeStatusChange = function (wt, context) {\r\n        this._publishStatusChange(wt, context, this._windowTypeCallbacks);\r\n    };\r\n    HCBridge.prototype._publishActivityStatusChange = function (act, context) {\r\n        this._publishStatusChange(act, context, this._activityCallbacks);\r\n    };\r\n    HCBridge.prototype._publishActivityWindowEvent = function (w, context) {\r\n        this._publishStatusChange(w, context, this._windowCallbacks);\r\n    };\r\n    HCBridge.prototype.attachActivities = function (from, to, tag) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.attachActivities(from, to, tag, function (state) {\r\n                resolve(state);\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.detachActivities = function (activityId, newActivityInfo) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this._htmlContainer.detachActivities(activityId, newActivityInfo, function (newActivityId) {\r\n                resolve(newActivityId);\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    HCBridge.prototype.onActivitiesAttached = function (callback) {\r\n        this._activitiesAttachedHandler = callback;\r\n    };\r\n    HCBridge.prototype.onActivitiesDetached = function (callback) {\r\n        this._activitiesDetached = callback;\r\n    };\r\n    HCBridge.prototype.onActivityAttachedDescriptorsRefreshed = function (callback) {\r\n        this._activityAttachedDescriptorsRefreshed = callback;\r\n    };\r\n    HCBridge.prototype.getAttachedDescriptors = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!_this._htmlContainer.getAttachedDescriptors) {\r\n                // support for container that does not have descriptors\r\n                resolve([]);\r\n                return;\r\n            }\r\n            _this._htmlContainer.getAttachedDescriptors(function (result) {\r\n                resolve(result);\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     *  Convert a ActivityWindow entity coming from HC to ActivityWindow\r\n     */\r\n    HCBridge.prototype._hcToJsWindow = function (hcWindow) {\r\n        var _this = this;\r\n        var windowGetter = function () { return undefined; };\r\n        if (this._windows) {\r\n            if (hcWindow.hcWindowId) {\r\n                windowGetter = function () { return _this._windows.list().filter(function (w) { return w.id === hcWindow.hcWindowId; })[0]; };\r\n            }\r\n            else {\r\n                // backward compatibility for HC < 1.58\r\n                windowGetter = function () { return _this._windows.list().filter(function (w) { return w.application === hcWindow.instance.application; })[0]; };\r\n            }\r\n        }\r\n        return new activityWindow_1.default(hcWindow.id, hcWindow.name, hcWindow.type, hcWindow.activityId, hcWindow.instance, hcWindow.isIndependent, windowGetter, hcWindow.hcWindowId);\r\n    };\r\n    return HCBridge;\r\n}());\r\nexports.default = HCBridge;\r\n//# sourceMappingURL=hcBridge.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/bridges/hcBridge.js\n// module id = 14\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * @typedef {Object} activityStatus Defines activity instance status\r\n * @property {string} state Current state\r\n * @property {string} message Message\r\n * @property {Date} time Time of the last status update\r\n */\r\nvar ActivityStatus = /** @class */ (function () {\r\n    function ActivityStatus(state, message, time) {\r\n        this.state = state;\r\n        this.message = message;\r\n        this.time = time;\r\n    }\r\n    ActivityStatus.prototype.getState = function () {\r\n        return this.state;\r\n    };\r\n    ActivityStatus.prototype.getMessage = function () {\r\n        return this.message;\r\n    };\r\n    ActivityStatus.prototype.getTime = function () {\r\n        return this.time;\r\n    };\r\n    return ActivityStatus;\r\n}());\r\nexports.ActivityStatus = ActivityStatus;\r\n//# sourceMappingURL=activityStatus.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/contracts/activityStatus.js\n// module id = 15\n// module chunks = 0","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityEntity_1 = require(\"./activityEntity\");\r\nvar activityAGM_1 = require(\"../core/activityAGM\");\r\nvar attachedActivityDescriptor_1 = require(\"./attachedActivityDescriptor\");\r\nvar promiseExtensions_1 = require(\"../helpers/promiseExtensions\");\r\nvar util_1 = require(\"../helpers/util\");\r\n/**\r\n * Activity is an instance of an activity type just like an object is an instance of a class\r\n * in class-based languages (and just like ‘John’ is an instance of a 'Person’).\r\n *\r\n * Activity is often used as a synonym for activity instance.\r\n *\r\n * Each activity instance has a single owner window and can optionally have one or more helper windows.\r\n *\r\n * @module activity\r\n */\r\nvar Activity = /** @class */ (function (_super) {\r\n    __extends(Activity, _super);\r\n    function Activity(id, actType, status, context, ownerId) {\r\n        var _this = _super.call(this, id) || this;\r\n        _this._id = id;\r\n        _this._actType = actType;\r\n        _this._status = status;\r\n        _this._context = context;\r\n        _this._ownerId = ownerId;\r\n        _this._agm = new activityAGM_1.ActivityAGM(_this);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Activity.prototype, \"type\", {\r\n        /**\r\n         * Activity type\r\n         * @var {module:activityType} type\r\n         */\r\n        get: function () {\r\n            if (this._manager) {\r\n                return this._manager.getActivityType(this._actType);\r\n            }\r\n            return undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Activity.prototype, \"context\", {\r\n        /**\r\n         * Get current activity context. To update use updateContext , to replace setContext\r\n         * @var {object} context\r\n         */\r\n        get: function () {\r\n            return this._context;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Activity.prototype, \"status\", {\r\n        /**\r\n         * Get activity status\r\n         * @var {activityStatus} status\r\n         */\r\n        get: function () {\r\n            return this._status;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Activity.prototype, \"owner\", {\r\n        /**\r\n         * The owner window\r\n         * @var {module:activityWindow} owner\r\n         */\r\n        get: function () {\r\n            if (!this._ownerId) {\r\n                return null;\r\n            }\r\n            return this._manager.getWindows({ id: this._ownerId })[0];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Activity.prototype, \"windows\", {\r\n        /**\r\n         * All windows participating in the activity\r\n         * @var {module:activityWindow[]} windows\r\n         */\r\n        get: function () {\r\n            return this._manager.getWindows({ activityId: this._id });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Activity.prototype, \"agm\", {\r\n        /**\r\n         * @var {module:activityAGM} agm\r\n         */\r\n        get: function () {\r\n            return this._agm;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Joins a specific window to the activity\r\n     *\r\n     * @private\r\n     * @function join\r\n     * @param window    The window to join\r\n     * @param callback  (Optional) Result callback\r\n     * @returns         Promise for ActivityWindow\r\n     */\r\n    Activity.prototype.addWindow = function (window, callback) {\r\n        return this._manager.addWindowToActivity(this, window, callback);\r\n    };\r\n    /**\r\n     * Creates a new window and joins it to the activity\r\n     *\r\n     * @function createWindow\r\n     * @param {string|windowDefinition} windowType The type of the window to be created\r\n     * @param callback\r\n     * @returns {Promise<module:activityWindow>}\r\n     */\r\n    Activity.prototype.createWindow = function (windowType, callback) {\r\n        return this._manager.createWindow(this, windowType, callback);\r\n    };\r\n    /**\r\n     * Creates a stacked set of windows and joins them to the\r\n     *\r\n     * @function createStackedWindows\r\n     * @param {string[] | windowDefinition[]} windowTypes The types of the windows to be created\r\n     * @param {number} timeout\r\n     * @param callback\r\n     * @returns {Promise<module:activityWindow[]>}\r\n     */\r\n    Activity.prototype.createStackedWindows = function (windowTypes, timeout, callback) {\r\n        return this._manager.createStackedWindows(this, windowTypes, timeout, callback);\r\n    };\r\n    /**\r\n     * Removes a window from the activity\r\n     *\r\n     * @private\r\n     * @param window\r\n     * @param callback\r\n     * @returns     Promise for ActivityWindow\r\n     */\r\n    Activity.prototype.leave = function (window, callback) {\r\n        return this._manager.leaveWindowFromActivity(this, window, callback);\r\n    };\r\n    /**\r\n     * Get all windows participating in the activity from a given type\r\n     *\r\n     * @param {string} windowType\r\n     * @returns {module:activityWindow[]}\r\n     */\r\n    Activity.prototype.getWindowsByType = function (windowType) {\r\n        var filter = { activityId: this._id, type: windowType };\r\n        return this._manager.getWindows(filter);\r\n    };\r\n    /**\r\n     * Replaces the activity context with a new one.\r\n     *\r\n     * @function setContext\r\n     * @param {object} context   The new context\r\n     * @param callback\r\n     * @returns {Promise<Object>}\r\n     */\r\n    Activity.prototype.setContext = function (context, callback) {\r\n        return this._manager.setActivityContext(this, context, callback);\r\n    };\r\n    /**\r\n     * Updates activity context using the properties from the context argument.\r\n     * If old context is {a:1, b:2, c:3} and invoking updateContext({b:3, c:null}) will result a context\r\n     * be {a:1, b:3}\r\n     *\r\n     * @function updateContext\r\n     * @param {object} context\r\n     * @param callback\r\n     * @return {Promise<object>}\r\n     */\r\n    Activity.prototype.updateContext = function (context, callback) {\r\n        return this._manager.updateActivityContext(this, context, callback);\r\n    };\r\n    /**\r\n     * Subscribe for status change events\r\n     *\r\n     * @function onStatusChange\r\n     *\r\n     * @param {activityStatusChangeHandler} handler Handler function that will receive status notifications\r\n     */\r\n    Activity.prototype.onStatusChange = function (handler) {\r\n        var _this = this;\r\n        return this._manager.subscribeActivityEvents(function (a, ns, os) {\r\n            if (a.id === _this.id) {\r\n                handler(a, ns, os);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Subscribe for window related events, like joined, removed from activity\r\n     *\r\n     * @function onWindowEvent\r\n     * @param {windowEventHandler} handler Handler function that will receive windows events\r\n     */\r\n    Activity.prototype.onWindowEvent = function (handler) {\r\n        var _this = this;\r\n        return this._manager.subscribeWindowEvents(function (a, w, e) {\r\n            if (a.id === _this.id) {\r\n                handler(a, w, e);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Subscribe for context updates\r\n     *\r\n     * @function onContextChanged\r\n     * @param {contextChangedHandler} handler Handler function that will receive context related events\r\n     */\r\n    Activity.prototype.onContextChanged = function (handler) {\r\n        var _this = this;\r\n        this._manager.subscribeActivityContextChanged(function (act, context) {\r\n            if (act.id === _this.id) {\r\n                handler(context, act);\r\n            }\r\n        });\r\n        try {\r\n            // replay the context at the time of subscribing, swallow user exceptions\r\n            handler(this.context, this);\r\n        }\r\n        catch (e) {\r\n            return;\r\n        }\r\n    };\r\n    /**\r\n     * Stops the activity\r\n     * @function stop\r\n     */\r\n    Activity.prototype.stop = function () {\r\n        this._manager.stopActivity(this);\r\n    };\r\n    /**\r\n     * Clones the activity into a new one\r\n     * @function clone\r\n     * @param {CloneOptions} options\r\n     */\r\n    Activity.prototype.clone = function (options) {\r\n        return this._manager.clone(this, options);\r\n    };\r\n    Activity.prototype.attach = function (activity, tag) {\r\n        var activityId;\r\n        if (typeof activity === \"string\") {\r\n            activityId = activity;\r\n        }\r\n        else {\r\n            activityId = activity.id;\r\n        }\r\n        return this._manager.attachActivities(activityId, this.id, tag);\r\n    };\r\n    Activity.prototype.onActivityAttached = function (callback) {\r\n        var _this = this;\r\n        this._manager.subscribeActivitiesAttached(function (newActId, oldActId, descriptor) {\r\n            if (newActId !== _this._id) {\r\n                return;\r\n            }\r\n            callback(descriptor);\r\n        });\r\n    };\r\n    Activity.prototype.onDetached = function (callback) {\r\n        var _this = this;\r\n        this._manager.subscribeActivitiesDetached(function (newAct, originalActivity, state) {\r\n            if (originalActivity.id !== _this._id) {\r\n                return;\r\n            }\r\n            callback(newAct, state);\r\n        });\r\n    };\r\n    Activity.prototype._updateCore = function (other) {\r\n        var _this = this;\r\n        _super.prototype._updateCore.call(this, other);\r\n        util_1.ifNotUndefined(other._actType, function (x) { return _this._actType = x; });\r\n        util_1.ifNotUndefined(other._context, function (x) { return _this._context = x; });\r\n        util_1.ifNotUndefined(other._ownerId, function (x) { return _this._ownerId = x; });\r\n        if (other._status && (!this._status || (this._status.state !== other._status.state))) {\r\n            this._status = other._status;\r\n        }\r\n    };\r\n    Activity.prototype._updateDescriptors = function (allStates) {\r\n        var _this = this;\r\n        this._attached = allStates.map(function (s) {\r\n            return new attachedActivityDescriptor_1.AttachedActivityDescriptor(_this._manager, _this._id, s);\r\n        });\r\n    };\r\n    Object.defineProperty(Activity.prototype, \"attached\", {\r\n        get: function () {\r\n            return this._attached;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Activity.prototype.setFrameColor = function (color, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            var callbacksToWait = _this.windows.length;\r\n            if (callbacksToWait === 0) {\r\n                resolve(_this);\r\n            }\r\n            _this.windows.forEach(function (w) {\r\n                w.underlyingWindow.setFrameColor(color, function () {\r\n                    callbacksToWait--;\r\n                    if (callbacksToWait <= 0) {\r\n                        resolve(_this);\r\n                    }\r\n                });\r\n            });\r\n            setTimeout(function () {\r\n                if (callbacksToWait > 0) {\r\n                    reject(_this.id + \" - timed out waiting for setFrameColor with\" + color);\r\n                }\r\n            }, 5000);\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    Activity.prototype.getFrameColor = function () {\r\n        if (!this.windows || this.windows.length === 0) {\r\n            return \"\";\r\n        }\r\n        return this.windows[0].underlyingWindow.frameColor;\r\n    };\r\n    return Activity;\r\n}(activityEntity_1.default));\r\nexports.default = Activity;\r\n//# sourceMappingURL=activity.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/entities/activity.js\n// module id = 16\n// module chunks = 0","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityEntity_1 = require(\"./activityEntity\");\r\nvar logger_1 = require(\"../helpers/logger\");\r\nvar util = require(\"../helpers/util\");\r\nvar util_1 = require(\"../helpers/util\");\r\nvar entityEvent_1 = require(\"../contracts/entityEvent\");\r\n/**\r\n * A window participating in an activity\r\n *\r\n * @module activityWindow\r\n */\r\nvar ActivityWindow = /** @class */ (function (_super) {\r\n    __extends(ActivityWindow, _super);\r\n    function ActivityWindow(id, name, type, activityId, instance, isIndependent, windowGetter, hcWindowId) {\r\n        var _this = _super.call(this, id) || this;\r\n        _this._logger = logger_1.Logger.Get(\"window\");\r\n        _this._type = type;\r\n        _this._activityId = activityId;\r\n        _this._name = name;\r\n        _this._instance = instance;\r\n        _this._isIndependent = isIndependent;\r\n        _this._windowGetter = windowGetter;\r\n        _this._hcWindowId = hcWindowId;\r\n        return _this;\r\n    }\r\n    /**\r\n     * Return window's title\r\n     * @function getBounds\r\n     * @return {Promise<WindowBounds>}\r\n     */\r\n    ActivityWindow.prototype.getBounds = function () {\r\n        return this._manager.getWindowBounds(this.id);\r\n    };\r\n    Object.defineProperty(ActivityWindow.prototype, \"name\", {\r\n        /**\r\n         * @var {string} name The window name\r\n         */\r\n        get: function () {\r\n            return this._name;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityWindow.prototype, \"isIndependent\", {\r\n        /**\r\n         * @var {bool} isIndependent True if this is an independent window\r\n         */\r\n        get: function () {\r\n            return this._isIndependent;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityWindow.prototype, \"type\", {\r\n        /**\r\n         * @var {module:windowType} type The window type\r\n         */\r\n        get: function () {\r\n            if (this._manager) {\r\n                return this._manager.getWindowType(this._type);\r\n            }\r\n            return undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityWindow.prototype, \"activity\", {\r\n        /**\r\n         * @var {module:activity} activity The activity that the window is part of\r\n         */\r\n        get: function () {\r\n            if (util.isUndefined(this._activityId)) {\r\n                return undefined;\r\n            }\r\n            return this._manager.getActivityById(this._activityId);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityWindow.prototype, \"isOwner\", {\r\n        /**\r\n         * @var {bool} isOwner True if the window is the owner of the activity.\r\n         */\r\n        get: function () {\r\n            var act = this.activity;\r\n            if (util.isUndefined(act)) {\r\n                return false;\r\n            }\r\n            return act.owner.id === this.id;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Sets window's visibility\r\n     *\r\n     * @function setVisible\r\n     * @param {boolean} isVisible\r\n     * @returns {Promise<module:activityWindow>}\r\n     */\r\n    ActivityWindow.prototype.setVisible = function (isVisible, callback) {\r\n        return this._manager.setWindowVisibility(this.id, isVisible);\r\n    };\r\n    /**\r\n     * Activate window\r\n     * @function activate\r\n     * @param {boolean} focus If true then activate window with focus otherwise activate window without focus\r\n     */\r\n    ActivityWindow.prototype.activate = function (focus) {\r\n        return this._manager.activateWindow(this.id, focus);\r\n    };\r\n    /**\r\n     * Sets window's bounds\r\n     * @function setBounds\r\n     *\r\n     * @param {bounds} bounds The new bounds to be applied\r\n     * @returns  {Promise<module:activityWindow>}\r\n     */\r\n    ActivityWindow.prototype.setBounds = function (bounds, callback) {\r\n        return this._manager.setWindowBounds(this.id, bounds, callback);\r\n    };\r\n    /**\r\n     * Closes the window\r\n     *\r\n     * @function close\r\n     * @returns {Promise}\r\n     */\r\n    ActivityWindow.prototype.close = function () {\r\n        return this._manager.closeWindow(this.id);\r\n    };\r\n    Object.defineProperty(ActivityWindow.prototype, \"instance\", {\r\n        /**\r\n         * @var {agmInstance} instance The agm instance of that window. You can use this to invoke AGM methods against that window\r\n         */\r\n        get: function () {\r\n            return this._instance;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityWindow.prototype, \"underlyingWindow\", {\r\n        /**\r\n         * Returns the window as object from Windows API (glue.windows).\r\n         *\r\n         * @var {window} underlyingWindow\r\n         */\r\n        get: function () {\r\n            var window = this._windowGetter();\r\n            if (!window) {\r\n                // we don't have the window object any more, let's return as much as we can\r\n                return {\r\n                    id: this._hcWindowId\r\n                };\r\n            }\r\n            return window;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ActivityWindow.prototype.onActivityJoined = function (callback) {\r\n        this._subscribeForActivityWindowEvent(entityEvent_1.EntityEventType.ActivityWindowJoinedActivity, callback);\r\n    };\r\n    ActivityWindow.prototype.onActivityRemoved = function (callback) {\r\n        this._subscribeForActivityWindowEvent(entityEvent_1.EntityEventType.ActivityWindowLeftActivity, callback);\r\n    };\r\n    ActivityWindow.prototype._updateCore = function (other) {\r\n        var _this = this;\r\n        util_1.ifNotUndefined(other._activityId, function (x) { return _this._activityId = x; });\r\n        util_1.ifNotUndefined(other._isIndependent, function (x) { return _this._isIndependent = x; });\r\n        util_1.ifNotUndefined(other._hcWindowId, function (x) { return _this._hcWindowId = x; });\r\n        util_1.ifNotUndefined(other._type, function (x) { return _this._type = x; });\r\n        util_1.ifNotUndefined(other._name, function (x) { return _this._name = x; });\r\n        if (!util.isUndefinedOrNull(other._instance)) {\r\n            this._instance = other._instance;\r\n        }\r\n    };\r\n    ActivityWindow.prototype._subscribeForActivityWindowEvent = function (eventName, callback) {\r\n        var _this = this;\r\n        this._manager.subscribeWindowEvents(function (activity, window, event) {\r\n            // ignore events not related to this window\r\n            if (window.id !== _this.id) {\r\n                return;\r\n            }\r\n            if (event === eventName) {\r\n                callback(activity);\r\n            }\r\n        });\r\n    };\r\n    ActivityWindow.prototype._beforeDelete = function (other) {\r\n        this._hcWindowId = other._hcWindowId;\r\n    };\r\n    return ActivityWindow;\r\n}(activityEntity_1.default));\r\nexports.default = ActivityWindow;\r\n//# sourceMappingURL=activityWindow.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/entities/activityWindow.js\n// module id = 17\n// module chunks = 0","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityEntity_1 = require(\"./activityEntity\");\r\n/**\r\n * A window type is a definition of a window, typically configured in ACS.\r\n *\r\n * @module windowType\r\n */\r\nvar WindowType = /** @class */ (function (_super) {\r\n    __extends(WindowType, _super);\r\n    function WindowType(name, appByWindowTypeGetter) {\r\n        var _this = _super.call(this, name) || this;\r\n        _this._name = name;\r\n        _this._appByWindowTypeGetter = appByWindowTypeGetter;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(WindowType.prototype, \"name\", {\r\n        /**\r\n         * Name of the window type\r\n         * @var {string} name\r\n         */\r\n        get: function () {\r\n            return this._name;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(WindowType.prototype, \"config\", {\r\n        /**\r\n         * Returns the ACS configuration related to this window type (as application object from AppManager API)\r\n         * @returns {any}\r\n         */\r\n        get: function () {\r\n            return this._appByWindowTypeGetter(this._name);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(WindowType.prototype, \"windows\", {\r\n        /**\r\n         * @var {activityWindow[]} windows All windows from that type\r\n         */\r\n        get: function () {\r\n            return this._manager.getWindows({ type: this._name });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    WindowType.prototype.create = function (activity, configuration) {\r\n        var definition = Object.assign({ type: this.name, name: this.name, isIndependent: false }, configuration);\r\n        return this._manager.createWindow(activity, definition);\r\n    };\r\n    return WindowType;\r\n}(activityEntity_1.default));\r\nexports.default = WindowType;\r\n//# sourceMappingURL=windowType.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/entities/windowType.js\n// module id = 18\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar logger_1 = require(\"./logger\");\r\nvar util = require(\"../helpers/util\");\r\n/**\r\n * Class that can be used as a marker for successful completion of a set of events\r\n * @private\r\n * @module readyMarker\r\n */\r\nvar ReadyMarker = /** @class */ (function () {\r\n    /**\r\n     * Creates new marker\r\n     * @param name Name of the marker, useful in logging\r\n     * @param signalsToWait Number of signals(events) that needs to be signaled (completed) before the marker is set as completed\r\n     */\r\n    function ReadyMarker(name, signalsToWait) {\r\n        this._logger = logger_1.Logger.Get(\"ReadyMarker [\" + name + \"]\");\r\n        this._logger.debug(\"Initializing ready marker for '\" + name + \"' with \" + signalsToWait + \" signals to wait\");\r\n        if (signalsToWait <= 0) {\r\n            throw new Error(\"Invalid signal number. Should be > 0\");\r\n        }\r\n        this._signals = signalsToWait;\r\n        this._callbacks = [];\r\n        this._name = name;\r\n    }\r\n    /**\r\n     * Adds a new callback that will be notified when the events are completed (success) or some error happened\r\n     */\r\n    ReadyMarker.prototype.setCallback = function (callback) {\r\n        if (this.isSet()) {\r\n            callback(undefined);\r\n            return;\r\n        }\r\n        else if (this.isError()) {\r\n            callback(this._error);\r\n            return;\r\n        }\r\n        this._callbacks.push(callback);\r\n    };\r\n    /**\r\n     * Signals for a completion of an event. If this is the last event success callbacks will be called\r\n     */\r\n    ReadyMarker.prototype.signal = function (message) {\r\n        this._logger.debug(\"Signaled - \" + message + \" - signals left \" + (this._signals - 1));\r\n        this._signals--;\r\n        if (this._signals < 0) {\r\n            throw new Error(\"Error in ready marker '\" + this._name + \" - signals are \" + this._signals);\r\n        }\r\n        if (this.isSet()) {\r\n            this._callbacks.forEach(function (callback) {\r\n                callback(undefined);\r\n            });\r\n        }\r\n    };\r\n    /**\r\n     * Signals for an error in some of the events. This will notify all callbacks that the marker has failed\r\n     */\r\n    ReadyMarker.prototype.error = function (error) {\r\n        this._error = error;\r\n        this._callbacks.forEach(function (errorCallback) {\r\n            errorCallback(error);\r\n        });\r\n    };\r\n    /**\r\n     * Checks if the marker is set (completed)\r\n     */\r\n    ReadyMarker.prototype.isSet = function () {\r\n        if (this.isError()) {\r\n            return false;\r\n        }\r\n        return this._signals === 0;\r\n    };\r\n    /**\r\n     * Checks if the marker has failed (some of the events has failed)\r\n     */\r\n    ReadyMarker.prototype.isError = function () {\r\n        return !util.isUndefined(this._error);\r\n    };\r\n    /**\r\n     * Returns the last reported error (undefined if no error)\r\n     */\r\n    ReadyMarker.prototype.getError = function () {\r\n        return this._error;\r\n    };\r\n    return ReadyMarker;\r\n}());\r\nexports.ReadyMarker = ReadyMarker;\r\n//# sourceMappingURL=readyMarker.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/helpers/readyMarker.js\n// module id = 19\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LayoutImpl = /** @class */ (function () {\r\n    function LayoutImpl(data) {\r\n        this.name = data.name;\r\n        this.type = data.type;\r\n        this.components = data.components;\r\n        this.context = data.context;\r\n    }\r\n    return LayoutImpl;\r\n}());\r\nexports.default = LayoutImpl;\r\n//# sourceMappingURL=layout.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/layouts/layout.js\n// module id = 20\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// provides a unified way to access layouts array\r\nvar LayoutStore = /** @class */ (function () {\r\n    function LayoutStore() {\r\n        this.layouts = [];\r\n    }\r\n    LayoutStore.prototype.removeWhere = function (condition) {\r\n        this.layouts = this.layouts.filter(condition);\r\n    };\r\n    LayoutStore.prototype.add = function (item) {\r\n        this.layouts.push(item);\r\n    };\r\n    Object.defineProperty(LayoutStore.prototype, \"all\", {\r\n        get: function () {\r\n            return this.layouts;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LayoutStore.prototype.where = function (condition) {\r\n        return this.layouts.filter(condition);\r\n    };\r\n    LayoutStore.prototype.first = function (condition) {\r\n        return this.where(condition)[0];\r\n    };\r\n    return LayoutStore;\r\n}());\r\nexports.LayoutStore = LayoutStore;\r\nexports.default = new LayoutStore();\r\n//# sourceMappingURL=store.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/layouts/store.js\n// module id = 21\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// A simple transformation that makes object to start with lowercase\r\n// Note that this is not full implementation as it supports only:\r\n// undefined, null, arrays, number, string, bool. Anything out of this\r\n// list is considered Object\r\nfunction transformACSLayout(something) {\r\n    if (!something) {\r\n        return something;\r\n    }\r\n    if (Array.isArray(something)) {\r\n        return something.map(function (item) {\r\n            return transformACSLayout(item);\r\n        });\r\n    }\r\n    if (typeof something === \"string\" || typeof something === \"number\" || typeof something === \"boolean\") {\r\n        return something;\r\n    }\r\n    var initial = {};\r\n    return Object.keys(something).reduce(function (accumulator, current) {\r\n        var value = something[current];\r\n        var convertedValue = transformACSLayout(value);\r\n        var key = current;\r\n        if (current[0].toLowerCase() !== current[0]) {\r\n            key = current[0].toLowerCase() + current.substr(1);\r\n        }\r\n        accumulator[key] = convertedValue;\r\n        return accumulator;\r\n    }, initial);\r\n}\r\nexports.default = transformACSLayout;\r\n//# sourceMappingURL=transform.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/layouts/transform.js\n// module id = 22\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar store_1 = require(\"../store\");\r\nfunction getWindowsByTabGroupId(windowId, tabGroupId) {\r\n    var windows = store_1.default.list;\r\n    return Object.keys(windows).reduce(function (memo, id) {\r\n        var win = windows[id];\r\n        if (win.API.tabGroupId === tabGroupId && win.API.id !== windowId) {\r\n            memo[id] = win;\r\n        }\r\n        return memo;\r\n    }, {});\r\n}\r\nexports.getWindowsByTabGroupId = getWindowsByTabGroupId;\r\n//# sourceMappingURL=helpers.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/windows/environment/helpers.js\n// module id = 23\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = require(\"callback-registry\");\r\nvar store_1 = require(\"./store\");\r\nexports.default = (function (id, options, executor, logger, appManagerGetter) {\r\n    var _registry = callback_registry_1.default();\r\n    var _logger = logger.subLogger(\"window \" + id);\r\n    var _name = options.name;\r\n    var _mode = options.mode;\r\n    var _url = options.url;\r\n    var _title = options.title;\r\n    var _context = options.context || {};\r\n    var _bounds = options.bounds;\r\n    var _frameColor = options.frameColor;\r\n    var _focus = options.focus;\r\n    var _neighbours = options.neighbours || {};\r\n    var _groupId = options.groupId;\r\n    var _isGroupHeaderVisible = options.isGroupHeaderVisible;\r\n    var _isTabHeaderVisible = options.isTabHeaderVisible;\r\n    var _isTabSelected = options.isTabSelected;\r\n    var _settings = options.settings;\r\n    // is Window visible\r\n    var _isVisible = options.isVisible;\r\n    // Window state Collapsed | Expanded\r\n    var isCollapsed = options.isCollapsed;\r\n    // Window state normal | maximized | minimized\r\n    var _windowState = options.state;\r\n    // tabGroupId only for window with 'Tab' mode\r\n    var _tabGroupId = options.tabGroupId;\r\n    // window is locked or unlocked;\r\n    var _isLocked = options.isLocked;\r\n    var _group;\r\n    var resultWindow;\r\n    // Holding all frame buttons\r\n    var _frameButtons = [];\r\n    //#region \"AGM methods\"\r\n    function close(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.close(resultWindow)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function navigate(newUrl, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.navigate(resultWindow, newUrl)\r\n                .then(function () {\r\n                if (newUrl === _url) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onUrlChanged(function (url, win) {\r\n                    if (win.id === id && url === win.url) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setStyle(style, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setStyle(resultWindow, style)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setTitle(newTitle, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setTitle(resultWindow, newTitle)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n        // OPTION 2\r\n        // const promise = executor.setTitle(resultWindow, newTitle)\r\n        // return promisify\r\n    }\r\n    function moveResize(dimensions, success, error) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            executor.moveResize(resultWindow, dimensions)\r\n                .then(function () {\r\n                var areHeightsEqual = dimensions.height ? _bounds.height === dimensions.height : true;\r\n                var areWidthsEqual = dimensions.width ? _bounds.width === dimensions.width : true;\r\n                var areLeftsEqual = dimensions.left ? _bounds.left === dimensions.left : true;\r\n                var areTopsEqual = dimensions.top ? _bounds.top === dimensions.top : true;\r\n                if (areHeightsEqual &&\r\n                    areWidthsEqual &&\r\n                    areLeftsEqual &&\r\n                    areTopsEqual) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = _this.onBoundsChanged(function (win) {\r\n                    areHeightsEqual = dimensions.height ? win.bounds.height === dimensions.height : true;\r\n                    areWidthsEqual = dimensions.width ? win.bounds.width === dimensions.width : true;\r\n                    areLeftsEqual = dimensions.left ? win.bounds.left === dimensions.left : true;\r\n                    areTopsEqual = dimensions.top ? win.bounds.top === dimensions.top : true;\r\n                    if (win.id === _this.id &&\r\n                        areHeightsEqual &&\r\n                        areWidthsEqual &&\r\n                        areLeftsEqual &&\r\n                        areTopsEqual) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function addFrameButton(buttonInfo, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            if (typeof buttonInfo === \"undefined\") {\r\n                if (typeof error === \"function\") {\r\n                    error(\"No button info\");\r\n                    return;\r\n                }\r\n                reject(\"No button info\");\r\n                return;\r\n            }\r\n            if (buttonInfo.buttonId === undefined) {\r\n                if (typeof error === \"function\") {\r\n                    error(\"No buttonId\");\r\n                    return;\r\n                }\r\n                reject(\"No buttonId\");\r\n                return;\r\n            }\r\n            if (buttonInfo.imageBase64 === undefined) {\r\n                if (typeof error === \"function\") {\r\n                    error(\"No imageBase64\");\r\n                    return;\r\n                }\r\n                reject(\"No imageBase64\");\r\n                return;\r\n            }\r\n            executor.addFrameButton(resultWindow, buttonInfo)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function removeFrameButton(buttonId, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            if (buttonId === undefined || buttonId === \"\") {\r\n                if (typeof error === \"function\") {\r\n                    error(\"No buttonId\");\r\n                    return;\r\n                }\r\n                reject(\"No buttonId\");\r\n                return;\r\n            }\r\n            executor.removeFrameButton(resultWindow, buttonId)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function activate(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.activate(resultWindow)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function focus(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.focus(resultWindow)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function maximizeRestore(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            var currEvent = _windowState === \"normal\" ? onMaximized : onNormal;\r\n            executor.maximizeRestore(resultWindow)\r\n                .then(function () {\r\n                var un = currEvent(function () {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    un();\r\n                    resolve(resultWindow);\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function maximize(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.maximize(resultWindow)\r\n                .then(function () {\r\n                if (_windowState === \"maximized\") {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onMaximized(function (win) {\r\n                    if (win.id === id && win.state === \"maximized\") {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function restore(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.restore(resultWindow)\r\n                .then(function () {\r\n                if (_windowState === \"normal\") {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onNormal(function (win) {\r\n                    if (id === win.id && win.state === \"normal\") {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function minimize(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.minimize(resultWindow)\r\n                .then(function () {\r\n                if (_windowState === \"minimized\") {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onMinimized(function (win) {\r\n                    if (id === win.id && win.state === \"minimized\") {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        return resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function collapse(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.collapse(resultWindow)\r\n                .then(function () {\r\n                if (isCollapsed) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onCollapsed(function (win) {\r\n                    if (win.id === id) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function expand(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.expand(resultWindow)\r\n                .then(function () {\r\n                if (!isCollapsed) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onExpanded(function (win) {\r\n                    if (win.id === id) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function toggleCollapse(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            var currEvent = isCollapsed ? onExpanded : onCollapsed;\r\n            executor.toggleCollapse(resultWindow)\r\n                .then(function () {\r\n                currEvent(function (win) {\r\n                    if (win.id === id) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function snap(target, direction, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.snap(resultWindow, target, direction)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function attachTab(tab, index, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            var sourceWindowId;\r\n            var targetWindowId = resultWindow.id;\r\n            var errorMessage = \"Invalid tab parameter - should be an object with property id or a string. Invoked for source window id:\" + resultWindow.id;\r\n            if (!tab) {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            if (typeof tab === \"string\") {\r\n                sourceWindowId = tab;\r\n            }\r\n            else if (typeof tab.id !== \"undefined\") {\r\n                sourceWindowId = tab.id;\r\n            }\r\n            else {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            var argsForSend = {\r\n                sourceWindowId: sourceWindowId,\r\n                targetWindowId: targetWindowId,\r\n            };\r\n            if (index) {\r\n                argsForSend.index = index;\r\n            }\r\n            executor.attachTab(resultWindow, argsForSend)\r\n                .then(function () {\r\n                var sourceWin = store_1.default.get(argsForSend.sourceWindowId).API;\r\n                sourceWin.onAttached(function (win) {\r\n                    if (win.id === sourceWin.id) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function detachTab(opt, success, error) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var argsForSend = { windowId: resultWindow.id };\r\n            var _options = opt || {};\r\n            if (typeof _options.relativeTo !== \"undefined\") {\r\n                if (typeof _options.relativeTo === \"string\") {\r\n                    argsForSend.relativeTo = _options.relativeTo;\r\n                }\r\n                else if (typeof _options.relativeTo.id !== \"undefined\") {\r\n                    argsForSend.relativeTo = _options.relativeTo.id;\r\n                }\r\n                if (typeof _options.relativeDirection !== \"undefined\") {\r\n                    argsForSend.relativeDirection = _options.relativeDirection;\r\n                }\r\n                if (typeof _options.width !== \"undefined\") {\r\n                    argsForSend.width = _options.width;\r\n                }\r\n                if (typeof _options.height !== \"undefined\") {\r\n                    argsForSend.height = _options.height;\r\n                }\r\n            }\r\n            if (typeof _options.bounds !== \"undefined\") {\r\n                argsForSend.bounds = _options.bounds;\r\n            }\r\n            if (typeof _options.hideTabHeader !== \"undefined\") {\r\n                argsForSend.hideTabHeader = _options.hideTabHeader;\r\n            }\r\n            executor.detachTab(resultWindow, argsForSend)\r\n                .then(function () {\r\n                var visibilityChangeHeard = false;\r\n                var detachedHeard = false;\r\n                var unVisibility = _registry.add(\"frame-attached\", (function (win) {\r\n                    var isVisibilityCorrect = _options.hideTabHeader === undefined || _options.hideTabHeader !== win.isTabHeaderVisible;\r\n                    if (id === win.id && isVisibilityCorrect) {\r\n                        visibilityChangeHeard = true;\r\n                        unVisibility();\r\n                        if (detachedHeard) {\r\n                            if (typeof success === \"function\") {\r\n                                success(resultWindow);\r\n                            }\r\n                            resolve(resultWindow);\r\n                            if (typeof unDetached === \"function\") {\r\n                                unDetached();\r\n                            }\r\n                        }\r\n                    }\r\n                }));\r\n                var unDetached = _this.onDetached(function (win) {\r\n                    if (id === win.id) {\r\n                        detachedHeard = true;\r\n                        unDetached();\r\n                        if (visibilityChangeHeard) {\r\n                            if (typeof success === \"function\") {\r\n                                success(resultWindow);\r\n                            }\r\n                            resolve(resultWindow);\r\n                            if (typeof unVisibility === \"function\") {\r\n                                unVisibility();\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setVisible(toBeVisible, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setVisible(resultWindow, toBeVisible)\r\n                .then(function () {\r\n                var isVisibilityCorrect = toBeVisible === undefined ? _isVisible === true : _isVisible === toBeVisible;\r\n                if (isVisibilityCorrect) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = onVisibilityChanged(function (win) {\r\n                    isVisibilityCorrect = toBeVisible === undefined ? win.isVisible === true : win.isVisible === toBeVisible;\r\n                    if (win.id === id && isVisibilityCorrect) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function showLoader(loader) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.showLoader(resultWindow, loader)\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function hideLoader() {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.hideLoader(resultWindow)\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function updateContext(context, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.updateContext(resultWindow, context)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function lock(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.lock(resultWindow)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function unlock(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.unlock(resultWindow)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function getIcon(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            // agm.invoke(\"T42.Wnd.GetIcon\", { windowId: resultWindow.id }, \"best\", {}, successHandler, error);\r\n            executor.getIcon(resultWindow)\r\n                .then(function (icon) {\r\n                if (typeof success === \"function\") {\r\n                    success(icon);\r\n                }\r\n                resolve(icon);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setIcon(base64Image, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setIcon(resultWindow, base64Image)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setFrameColor(frameColor, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setFrameColor(resultWindow, frameColor)\r\n                .then(function () {\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function setTabHeaderVisible(toBeTabHeaderVisible, success, error) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setTabHeaderVisible(resultWindow, toBeTabHeaderVisible)\r\n                .then(function () {\r\n                if (_isTabHeaderVisible === toBeTabHeaderVisible) {\r\n                    if (typeof success === \"function\") {\r\n                        success(resultWindow);\r\n                    }\r\n                    return resolve(resultWindow);\r\n                }\r\n                var un = _this.onTabHeaderVisibilityChanged(function (win) {\r\n                    if (win.id === id && win.isTabHeaderVisible === toBeTabHeaderVisible) {\r\n                        if (typeof success === \"function\") {\r\n                            success(resultWindow);\r\n                        }\r\n                        un();\r\n                        resolve(resultWindow);\r\n                    }\r\n                });\r\n            })\r\n                .catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    //#endregion \"AGM methods\"\r\n    //#region \"Events\"\r\n    function onTitleChanged(callback) {\r\n        callback(resultWindow.title, resultWindow);\r\n        return _registry.add(\"onTitleChanged\", callback);\r\n    }\r\n    function onClose(callback) {\r\n        return _registry.add(\"onClose\", callback);\r\n    }\r\n    function onUrlChanged(callback) {\r\n        return _registry.add(\"onUrlChanged\", callback);\r\n    }\r\n    function onFrameButtonAdded(callback) {\r\n        return _registry.add(\"onFrameButtonAdded\", callback);\r\n    }\r\n    function onFrameButtonRemoved(callback) {\r\n        return _registry.add(\"onFrameButtonRemoved\", callback);\r\n    }\r\n    function onFrameButtonClicked(callback) {\r\n        return _registry.add(\"onFrameButtonClicked\", callback);\r\n    }\r\n    function onCollapsed(callback) {\r\n        if (isCollapsed) {\r\n            callback(resultWindow);\r\n        }\r\n        return _registry.add(\"collapsed\", callback);\r\n    }\r\n    function onExpanded(callback) {\r\n        if (!isCollapsed) {\r\n            callback(resultWindow);\r\n        }\r\n        return _registry.add(\"expanded\", callback);\r\n    }\r\n    function onMaximized(callback) {\r\n        if (_windowState === \"maximized\") {\r\n            callback(resultWindow);\r\n        }\r\n        return _registry.add(\"maximized\", callback);\r\n    }\r\n    function onMinimized(callback) {\r\n        if (_windowState === \"minimized\") {\r\n            callback(resultWindow);\r\n        }\r\n        return _registry.add(\"minimized\", callback);\r\n    }\r\n    function onNormal(callback) {\r\n        if (_windowState === \"normal\") {\r\n            callback(resultWindow);\r\n        }\r\n        return _registry.add(\"normal\", callback);\r\n    }\r\n    function onAttached(callback) {\r\n        return _registry.add(\"attached\", callback);\r\n    }\r\n    function onDetached(callback) {\r\n        return _registry.add(\"detached\", callback);\r\n    }\r\n    function onVisibilityChanged(callback) {\r\n        return _registry.add(\"visibility-changed\", callback);\r\n    }\r\n    function onContextUpdated(callback) {\r\n        return _registry.add(\"context-updated\", callback);\r\n    }\r\n    function onLockingChanged(callback) {\r\n        return _registry.add(\"lock-changed\", callback);\r\n    }\r\n    function onBoundsChanged(callback) {\r\n        return _registry.add(\"bounds-changed\", callback);\r\n    }\r\n    function onFocusChanged(callback) {\r\n        return _registry.add(\"focus-changed\", callback);\r\n    }\r\n    function onFrameColorChanged(callback) {\r\n        return _registry.add(\"frame-color-changed\", callback);\r\n    }\r\n    function onTabHeaderVisibilityChanged(callback) {\r\n        return _registry.add(\"tab-header-visibility-changed\", callback);\r\n    }\r\n    function onWindowAttached(callback) {\r\n        return _registry.add(\"window-attached\", callback);\r\n    }\r\n    function onWindowDetached(callback) {\r\n        return _registry.add(\"window-detached\", callback);\r\n    }\r\n    function onGroupChanged(callback) {\r\n        return _registry.add(\"group-changed\", callback);\r\n    }\r\n    function onTabSelectionChanged(callback) {\r\n        return _registry.add(\"tab-selection-changed\", callback);\r\n    }\r\n    //#endregion \"Events\"\r\n    //#region \"Stream function\"\r\n    function handleTitleChanged(newTitle) {\r\n        _title = newTitle;\r\n        _registry.execute(\"onTitleChanged\", newTitle, resultWindow);\r\n    }\r\n    function handleUrlChanged(newUrl) {\r\n        _url = newUrl;\r\n        _registry.execute(\"onUrlChanged\", newUrl, resultWindow);\r\n    }\r\n    function handleVisibilityChanged(isVisible) {\r\n        if (isVisible === _isVisible) {\r\n            return;\r\n        }\r\n        _isVisible = isVisible;\r\n        _registry.execute(\"visibility-changed\", resultWindow);\r\n    }\r\n    function handleWindowSettingsChanged(settings) {\r\n        _settings = settings;\r\n        _registry.execute(\"settings-changed\", resultWindow);\r\n    }\r\n    function handleContextUpdated(context) {\r\n        _context = context;\r\n        _registry.execute(\"context-updated\", _context, resultWindow);\r\n    }\r\n    function handleWindowClose() {\r\n        if (resultWindow.id === undefined) {\r\n            return;\r\n        }\r\n        resultWindow.id = undefined;\r\n        _registry.execute(\"onClose\", resultWindow);\r\n    }\r\n    function handleFrameButtonAdded(frameButton) {\r\n        var buttonObj = [\"buttonId\", \"imageBase64\", \"order\", \"tooltip\"].reduce(function (memo, k) {\r\n            memo[k] = frameButton[k];\r\n            return memo;\r\n        }, {});\r\n        var frameButtonsIds = _frameButtons.map(function (btn) {\r\n            return btn.buttonId;\r\n        });\r\n        if (frameButtonsIds.indexOf(frameButton.buttonId) === -1) {\r\n            _frameButtons.push(buttonObj);\r\n        }\r\n        _registry.execute(\"onFrameButtonAdded\", buttonObj, resultWindow);\r\n    }\r\n    function handleFrameButtonRemoved(frameButtonId) {\r\n        var button;\r\n        _frameButtons = _frameButtons.reduce(function (memo, btn) {\r\n            if (btn.buttonId === frameButtonId) {\r\n                button = btn;\r\n            }\r\n            else {\r\n                memo.push(btn);\r\n            }\r\n            return memo;\r\n        }, []);\r\n        if (button !== undefined) {\r\n            _registry.execute(\"onFrameButtonRemoved\", button, resultWindow);\r\n        }\r\n    }\r\n    function handleFrameButtonClicked(frameButton) {\r\n        var button = _frameButtons.filter(function (btn) {\r\n            return btn.buttonId === frameButton.buttonId;\r\n        });\r\n        if (button.length > 0) {\r\n            _registry.execute(\"onFrameButtonClicked\", button[0], resultWindow);\r\n        }\r\n    }\r\n    function handleWindowChangeState(state) {\r\n        if (state === \"collapsed\") {\r\n            isCollapsed = true;\r\n        }\r\n        else if (state === \"expanded\") {\r\n            isCollapsed = false;\r\n        }\r\n        else {\r\n            _windowState = state;\r\n        }\r\n        _registry.execute(state, resultWindow);\r\n    }\r\n    function handleFrameIsLockedChanged(isLocked) {\r\n        _isLocked = isLocked;\r\n        _registry.execute(\"lock-changed\", resultWindow);\r\n    }\r\n    function handleBoundsChanged(bounds) {\r\n        if (_bounds.top === bounds.top && _bounds.left === bounds.left && _bounds.width === bounds.width && _bounds.height === bounds.height) {\r\n            return;\r\n        }\r\n        _bounds.top = bounds.top;\r\n        _bounds.left = bounds.left;\r\n        _bounds.width = bounds.width;\r\n        _bounds.height = bounds.height;\r\n        _registry.execute(\"bounds-changed\", resultWindow);\r\n    }\r\n    function handleFocusChanged(isFocused) {\r\n        _focus = isFocused;\r\n        _registry.execute(\"focus-changed\", resultWindow);\r\n    }\r\n    function handleFrameColorChanged(frameColor) {\r\n        _frameColor = frameColor;\r\n        _registry.execute(\"frame-color-changed\", resultWindow);\r\n    }\r\n    function handleFrameAttached(tabGroupId, isTabHeaderVisible) {\r\n        _tabGroupId = tabGroupId;\r\n        _isTabHeaderVisible = isTabHeaderVisible;\r\n        _registry.execute(\"frame-attached\", resultWindow);\r\n    }\r\n    function handleCompositionChanged(neighbours, groupId) {\r\n        _neighbours = neighbours || {};\r\n        _groupId = groupId;\r\n    }\r\n    function handleGroupHeaderVisibilityChanged(isGroupHeaderVisible) {\r\n        _isGroupHeaderVisible = isGroupHeaderVisible;\r\n    }\r\n    function handleTabHeaderVisibilityChanged(isTabHeaderVisible) {\r\n        if (_isTabHeaderVisible !== isTabHeaderVisible) {\r\n            _isTabHeaderVisible = isTabHeaderVisible;\r\n            _registry.execute(\"tab-header-visibility-changed\", resultWindow);\r\n        }\r\n    }\r\n    function handleFrameSelectionChanged(newWindow, prevWindow) {\r\n        var selectedWindow;\r\n        if (typeof newWindow !== \"undefined\" && newWindow === id) {\r\n            _isTabSelected = true;\r\n            selectedWindow = resultWindow;\r\n        }\r\n        else {\r\n            _isTabSelected = false;\r\n            selectedWindow = store_1.default.get(newWindow) ? store_1.default.get(newWindow).API : undefined;\r\n        }\r\n        var previousWindow = store_1.default.get(prevWindow) ? store_1.default.get(prevWindow).API : undefined;\r\n        if (_isTabSelected && previousWindow) {\r\n            var un_1 = previousWindow.onTabSelectionChanged(function (newWin, prevWin) {\r\n                if (prevWin.id === previousWindow.id) {\r\n                    un_1();\r\n                    _registry.execute(\"tab-selection-changed\", selectedWindow, previousWindow, resultWindow);\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            _registry.execute(\"tab-selection-changed\", selectedWindow, previousWindow, resultWindow);\r\n        }\r\n    }\r\n    function handleAttached(newTabGroupId, tabHeaderVisible) {\r\n        _tabGroupId = newTabGroupId;\r\n        _isTabHeaderVisible = tabHeaderVisible;\r\n        _registry.execute(\"attached\", resultWindow);\r\n    }\r\n    function handleWindowAttached(win) {\r\n        _registry.execute(\"window-attached\", win);\r\n    }\r\n    function handleDetached(tabGroupId) {\r\n        // this tabGroupId is always the same as the current one\r\n        // the tabGroupId is actually changed in the frame-attached event\r\n        var un = _registry.add(\"frame-attached\", function (win) {\r\n            if (win.id === id) {\r\n                un();\r\n                _registry.execute(\"detached\", resultWindow);\r\n            }\r\n        });\r\n    }\r\n    function handleWindowDetached(win) {\r\n        _registry.execute(\"window-detached\", win);\r\n    }\r\n    //#endregion \"Stream function\"\r\n    //#region \"Group Events\"\r\n    function handleGroupChanged(newGroup, oldGroup) {\r\n        logger.trace(\"handle group changed to win: \" + id + \" with group id: \" + newGroup.id);\r\n        _group = newGroup;\r\n        _groupId = newGroup.id;\r\n        _registry.execute(\"group-changed\", resultWindow, newGroup, oldGroup);\r\n    }\r\n    // This is used to set the relation from window to corespondent group API, it could be undefined, if the window is removed from group\r\n    function handleGroupAssociation(group) {\r\n        if (group) {\r\n            _logger.trace(\"setting group to win: \" + id + \" with group id: \" + group.id);\r\n        }\r\n        _group = group;\r\n    }\r\n    //#region \"Internal function\"\r\n    function getAllTabs() {\r\n        var allWindows = store_1.default.list;\r\n        if (_mode.toLowerCase() !== \"tab\") {\r\n            return [];\r\n        }\r\n        return Object.keys(allWindows).reduce(function (memo, win) {\r\n            var window = allWindows[win];\r\n            if (window\r\n                && window.API.tabGroupId\r\n                && typeof window.API.tabGroupId !== \"undefined\"\r\n                && typeof resultWindow.tabGroupId !== \"undefined\"\r\n                && window.API.tabGroupId === resultWindow.tabGroupId) {\r\n                memo.push(window.API);\r\n            }\r\n            return memo;\r\n        }, []);\r\n    }\r\n    function mapWindowIdsToWindowObjects(windowIdArr) {\r\n        return windowIdArr.reduce(function (memo, winId) {\r\n            var window = store_1.default.get(winId);\r\n            if (window) {\r\n                memo.push(window.API);\r\n            }\r\n            return memo;\r\n        }, []);\r\n    }\r\n    function getNeighboursByDirection(direction) {\r\n        var windowIds = _neighbours[direction];\r\n        if (typeof windowIds !== \"undefined\") {\r\n            return mapWindowIdsToWindowObjects(windowIds);\r\n        }\r\n    }\r\n    function getApplicationName() {\r\n        if (_context._APPLICATION_NAME) {\r\n            return _context._APPLICATION_NAME;\r\n        }\r\n        if (_context && _context._t42 && _context._t42.application) {\r\n            return _context._t42.application;\r\n        }\r\n        var info = getWindowInfo();\r\n        if (!info) {\r\n            return undefined;\r\n        }\r\n        return info.applicationName;\r\n    }\r\n    function getWindowInfo() {\r\n        if (typeof window.glue42gd !== \"undefined\" && window.glue42gd.getWindowInfo) {\r\n            var info = window.glue42gd.getWindowInfo(id);\r\n            if (!info) {\r\n                return undefined;\r\n            }\r\n            else {\r\n                return info;\r\n            }\r\n        }\r\n    }\r\n    //#endregion \"Internal function\"\r\n    //#region \"API\"\r\n    resultWindow = {\r\n        get name() {\r\n            return _name;\r\n        },\r\n        get application() {\r\n            var appManager = appManagerGetter();\r\n            return appManager ? appManager.application(getApplicationName()) : undefined;\r\n        },\r\n        get hostInstance() {\r\n            return executor.hostInstance;\r\n        },\r\n        get agmInstance() {\r\n            var appName = getApplicationName();\r\n            return appName ? { application: appName } : undefined;\r\n        },\r\n        get url() {\r\n            return _url;\r\n        },\r\n        id: id,\r\n        get title() {\r\n            return _title;\r\n        },\r\n        get windowStyleAttributes() {\r\n            return _settings;\r\n        },\r\n        get settings() {\r\n            return _settings;\r\n        },\r\n        get tabGroupId() {\r\n            return _mode.toLowerCase() === \"tab\" ? _tabGroupId : undefined;\r\n        },\r\n        get frameButtons() {\r\n            return _frameButtons;\r\n        },\r\n        get mode() {\r\n            return _mode;\r\n        },\r\n        get state() {\r\n            return _windowState;\r\n        },\r\n        get isCollapsed() {\r\n            return isCollapsed;\r\n        },\r\n        get isVisible() {\r\n            return _isVisible;\r\n        },\r\n        get isLocked() {\r\n            return _isLocked;\r\n        },\r\n        get context() {\r\n            return _context;\r\n        },\r\n        get bounds() {\r\n            return _bounds;\r\n        },\r\n        get isFocused() {\r\n            return _focus;\r\n        },\r\n        get frameColor() {\r\n            return _frameColor;\r\n        },\r\n        get opened() {\r\n            return resultWindow.id !== undefined;\r\n        },\r\n        get group() {\r\n            return _group;\r\n        },\r\n        get groupId() {\r\n            return _groupId;\r\n        },\r\n        get topNeighbours() {\r\n            return getNeighboursByDirection(\"top\");\r\n        },\r\n        get leftNeighbours() {\r\n            return getNeighboursByDirection(\"left\");\r\n        },\r\n        get rightNeighbours() {\r\n            return getNeighboursByDirection(\"right\");\r\n        },\r\n        get bottomNeighbours() {\r\n            return getNeighboursByDirection(\"bottom\");\r\n        },\r\n        get isGroupHeaderVisible() {\r\n            return _isGroupHeaderVisible;\r\n        },\r\n        get activityId() {\r\n            if (_context._t42) {\r\n                return _context._t42.activityId;\r\n            }\r\n            var info = getWindowInfo();\r\n            if (!info) {\r\n                return undefined;\r\n            }\r\n            return info.activityId;\r\n        },\r\n        get activityWindowId() {\r\n            if (_context._t42) {\r\n                return _context._t42.activityWindowId;\r\n            }\r\n            var info = getWindowInfo();\r\n            if (!info) {\r\n                return undefined;\r\n            }\r\n            return info.activityWindowId;\r\n        },\r\n        get windowType() {\r\n            return options.windowType || \"electron\";\r\n        },\r\n        maximize: maximize,\r\n        restore: restore,\r\n        minimize: minimize,\r\n        maximizeRestore: maximizeRestore,\r\n        collapse: collapse,\r\n        expand: expand,\r\n        toggleCollapse: toggleCollapse,\r\n        focus: focus,\r\n        activate: activate,\r\n        moveResize: moveResize,\r\n        setTitle: setTitle,\r\n        setStyle: setStyle,\r\n        navigate: navigate,\r\n        addFrameButton: addFrameButton,\r\n        removeFrameButton: removeFrameButton,\r\n        setVisible: setVisible,\r\n        close: close,\r\n        snap: snap,\r\n        showLoader: showLoader,\r\n        hideLoader: hideLoader,\r\n        updateContext: updateContext,\r\n        lock: lock,\r\n        unlock: unlock,\r\n        getIcon: getIcon,\r\n        setIcon: setIcon,\r\n        setFrameColor: setFrameColor,\r\n        attachTab: attachTab,\r\n        detachTab: detachTab,\r\n        setTabHeaderVisible: setTabHeaderVisible,\r\n        onClose: onClose,\r\n        onUrlChanged: onUrlChanged,\r\n        onTitleChanged: onTitleChanged,\r\n        onFrameButtonAdded: onFrameButtonAdded,\r\n        onFrameButtonRemoved: onFrameButtonRemoved,\r\n        onFrameButtonClicked: onFrameButtonClicked,\r\n        onCollapsed: onCollapsed,\r\n        onExpanded: onExpanded,\r\n        onMinimized: onMinimized,\r\n        onMaximized: onMaximized,\r\n        onNormal: onNormal,\r\n        onAttached: onAttached,\r\n        onDetached: onDetached,\r\n        onVisibilityChanged: onVisibilityChanged,\r\n        onContextUpdated: onContextUpdated,\r\n        onLockingChanged: onLockingChanged,\r\n        onBoundsChanged: onBoundsChanged,\r\n        onFrameColorChanged: onFrameColorChanged,\r\n        onFocusChanged: onFocusChanged,\r\n        onGroupChanged: onGroupChanged,\r\n        onWindowAttached: onWindowAttached,\r\n        onWindowDetached: onWindowDetached,\r\n        onTabSelectionChanged: onTabSelectionChanged,\r\n        onTabHeaderVisibilityChanged: onTabHeaderVisibilityChanged,\r\n        get tabs() {\r\n            return getAllTabs();\r\n        },\r\n        get isTabHeaderVisible() {\r\n            return _isTabHeaderVisible;\r\n        },\r\n        get isTabSelected() {\r\n            return _isTabSelected;\r\n        },\r\n    };\r\n    //#endregion \"API\"\r\n    //#endregion \"Group Events\"\r\n    var events = {\r\n        handleWindowClose: handleWindowClose,\r\n        handleWindowChangeState: handleWindowChangeState,\r\n        handleTitleChanged: handleTitleChanged,\r\n        handleVisibilityChanged: handleVisibilityChanged,\r\n        handleUrlChanged: handleUrlChanged,\r\n        handleWindowSettingsChanged: handleWindowSettingsChanged,\r\n        handleContextUpdated: handleContextUpdated,\r\n        handleFrameIsLockedChanged: handleFrameIsLockedChanged,\r\n        handleBoundsChanged: handleBoundsChanged,\r\n        handleFocusChanged: handleFocusChanged,\r\n        handleFrameButtonAdded: handleFrameButtonAdded,\r\n        handleFrameButtonRemoved: handleFrameButtonRemoved,\r\n        handleFrameButtonClicked: handleFrameButtonClicked,\r\n        handleFrameColorChanged: handleFrameColorChanged,\r\n        handleFrameAttached: handleFrameAttached,\r\n        handleFrameSelectionChanged: handleFrameSelectionChanged,\r\n        handleCompositionChanged: handleCompositionChanged,\r\n        handleGroupHeaderVisibilityChanged: handleGroupHeaderVisibilityChanged,\r\n        handleTabHeaderVisibilityChanged: handleTabHeaderVisibilityChanged,\r\n        handleGroupChanged: handleGroupChanged,\r\n        handleGroupAssociation: handleGroupAssociation,\r\n        handleAttached: handleAttached,\r\n        handleDetached: handleDetached,\r\n        handleWindowAttached: handleWindowAttached,\r\n        handleWindowDetached: handleWindowDetached,\r\n    };\r\n    return {\r\n        API: resultWindow,\r\n        Events: events,\r\n    };\r\n});\r\n//# sourceMappingURL=window.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/windows/window.js\n// module id = 24\n// module chunks = 0","module.exports = require(\"events\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"events\"\n// module id = 25\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 26\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 27\n// module chunks = 0","module.exports = require(\"https\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"https\"\n// module id = 28\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 29\n// module chunks = 0","module.exports = require(\"stream\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"stream\"\n// module id = 30\n// module chunks = 0","module.exports = require(\"tls\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"tls\"\n// module id = 31\n// module chunks = 0","module.exports = require(\"url\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"url\"\n// module id = 32\n// module chunks = 0","module.exports = require(\"util\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"util\"\n// module id = 33\n// module chunks = 0","module.exports = require(\"zlib\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"zlib\"\n// module id = 34\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tick42_glue_core_1 = require(\"tick42-glue-core\");\r\nvar main_1 = require(\"./activity/main\");\r\nvar main_2 = require(\"./app-manager/main\");\r\nvar main_3 = require(\"./windows/main\");\r\nvar main_4 = require(\"./layouts/main\");\r\nvar pjson = require(\"../package.json\");\r\nvar config_1 = require(\"./config\");\r\nvar utils_1 = require(\"./utils\");\r\nexports.default = (function (options) {\r\n    var gdMajorVersion = utils_1.default.getGDMajorVersion();\r\n    // get config object\r\n    // basically selecting some properties (and defaulting them)\r\n    // it's used to extract things like layouts, appManager, activities etc things\r\n    // that glueCore itself doesn't know about\r\n    options = options || {};\r\n    var glueConfig = config_1.default(options);\r\n    options.gateway = options.gateway || {};\r\n    // Init the GLUE namespace\r\n    var hc = typeof window !== \"undefined\" && window.htmlContainer;\r\n    var _appManager;\r\n    var _activity;\r\n    var _windows;\r\n    // dependency graph:\r\n    //   windows: agm, appManager (via getter)\r\n    //   activities: contexts, agm, logger, windows, appManager (via getter)\r\n    //   appManager: agm, windows, logger, activities\r\n    //   layouts: agm, appManager, logger\r\n    function createWindows(core) {\r\n        if (glueConfig.windows) {\r\n            var windowsLogger = getLibLogger(\"windows\", core.logger, glueConfig.windows);\r\n            _windows = main_3.default(core.agm, windowsLogger, function () {\r\n                return _appManager;\r\n            }, gdMajorVersion);\r\n            debugLog(_windows);\r\n            return _windows;\r\n        }\r\n    }\r\n    function createActivities(core) {\r\n        if (glueConfig.activities) {\r\n            if ((gdMajorVersion === 2) ||\r\n                (main_1.ActivityModule.checkIsUsingGW3Implementation &&\r\n                    main_1.ActivityModule.checkIsUsingGW3Implementation(core.connection))) {\r\n                var activityLogger = getLibLogger(\"activity\", core.logger, glueConfig.activities);\r\n                _activity = new main_1.ActivityModule({\r\n                    connection: core.connection,\r\n                    contexts: core.contexts,\r\n                    agm: core.agm,\r\n                    logger: activityLogger,\r\n                    logLevel: \"info\",\r\n                    disableAutoAnnounce: false,\r\n                    disposeRequestHandling: \"ignore\",\r\n                    announcementInfo: null,\r\n                    windows: _windows,\r\n                    appManagerGetter: function () {\r\n                        return _appManager;\r\n                    },\r\n                    mode: glueConfig.activities.mode,\r\n                    typesToTrack: glueConfig.activities.typesToTrack,\r\n                    activityId: typeof window !== \"undefined\" && window.glue42gd && window.glue42gd.activityInfo && window.glue42gd.activityInfo.activityId,\r\n                    gdMajorVersion: gdMajorVersion\r\n                }).api;\r\n                debugLog(_activity);\r\n                return _activity;\r\n            }\r\n        }\r\n    }\r\n    function createAppManager(core) {\r\n        if (!glueConfig.appManager) {\r\n            return;\r\n        }\r\n        var logger = getLibLogger(\"appManager\", core.logger, glueConfig.appManager);\r\n        // AppManager v3\r\n        _appManager = main_2.default({\r\n            agm: core.agm,\r\n            windows: _windows,\r\n            logger: logger,\r\n            activities: _activity,\r\n            mode: glueConfig.appManager.mode,\r\n            gdMajorVersion: gdMajorVersion\r\n        });\r\n        debugLog(_appManager);\r\n        return _appManager;\r\n    }\r\n    function createLayouts(core) {\r\n        if (!glueConfig.layouts) {\r\n            return;\r\n        }\r\n        var logger = getLibLogger(\"layouts\", core.logger, glueConfig.layouts);\r\n        var lay = main_4.default({\r\n            agm: core.agm,\r\n            appManager: _appManager,\r\n            activityGetter: function () { return _activity; },\r\n            logger: logger,\r\n            mode: glueConfig.layouts.mode,\r\n        });\r\n        debugLog(lay);\r\n        return lay;\r\n    }\r\n    function getLibLogger(loggerName, logger, config) {\r\n        var newLogger = logger.subLogger(loggerName);\r\n        if (config && config.logger) {\r\n            var loggerConfig = config.logger;\r\n            if (loggerConfig.console) {\r\n                newLogger.consoleLevel(loggerConfig.console);\r\n            }\r\n            if (loggerConfig.publish) {\r\n                newLogger.publishLevel(loggerConfig.publish);\r\n            }\r\n            if (loggerConfig.metrics) {\r\n                newLogger.metricsLevel(loggerConfig.metrics);\r\n            }\r\n        }\r\n        return newLogger;\r\n    }\r\n    var ext = {\r\n        // define extra libraries for glue-core to raise\r\n        libs: [\r\n            { name: \"windows\", create: createWindows },\r\n            { name: \"activities\", create: createActivities },\r\n            { name: \"appManager\", create: createAppManager },\r\n            { name: \"layouts\", create: createLayouts },\r\n        ],\r\n        version: pjson.version,\r\n        enrichGlue: function (glue) {\r\n            // put some data to config\r\n            glue.config.activities = glueConfig.activities;\r\n            glue.config.windows = glueConfig.windows;\r\n            glue.config.appManager = glueConfig.appManager;\r\n            glue.config.layouts = glueConfig.layouts;\r\n        },\r\n    };\r\n    var currentLog = [];\r\n    if (typeof window !== \"undefined\") {\r\n        if (!window.glueFactoryLog) {\r\n            window.glueFactoryLog = [];\r\n        }\r\n        window.glueFactoryLog.push(currentLog);\r\n    }\r\n    function debugLog(entry) {\r\n        currentLog.push(entry);\r\n    }\r\n    return tick42_glue_core_1.default(options, ext);\r\n});\r\n//# sourceMappingURL=glue.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/glue.js\n// module id = 35\n// module chunks = 0","module.exports = {\"name\":\"tick42-glue\",\"description\":\"Tick42 GLUE\",\"version\":\"4.2.4\",\"main\":\"./dist/node/tick42-glue.js\",\"browser\":\"./dist/web/tick42-glue.js\",\"types\":\"./glue.d.ts\",\"docName\":\"Glue\",\"scripts\":{\"init-dev-mode\":\"node ./build/scripts/init-dev-mode.js\",\"remove-installed-dependencies\":\"node ./build/scripts/remove-installed-dependencies.js\",\"clean\":\"node ./build/scripts/clean.js\",\"file-versionify\":\"node ./build/scripts/file-versionify.js\",\"pre:build\":\"npm run tslint && tsc && set NODE_ENV=development && npm run clean\",\"tslint\":\"tslint -t codeFrame ./src/**/*.ts\",\"tslint:fix\":\"tslint -t codeFrame --fix ./src/**/*.ts\",\"watch\":\"onchange ./src/**/*.ts -- npm run build:dev\",\"build:dev\":\"npm run pre:build && set NODE_ENV=development && webpack && npm run file-versionify\",\"prepublish\":\"npm run build:prod && npm run test:only\",\"build:prod\":\"npm run pre:build && set NODE_ENV=development && webpack && set NODE_ENV=production && webpack && npm run file-versionify\",\"test\":\"npm run build:dev && mocha ./tests\",\"test:only\":\"mocha ./tests\",\"generate-docs\":\"glue-js-documentation-builder build-reference --project g4e --modules ./glue.d.ts,./node_modules/tick42-glue-core/glue.d.ts\"},\"repository\":{\"type\":\"git\",\"url\":\"https://stash.tick42.com:8443/scm/ofgw/js-glue.git\"},\"author\":{\"name\":\"Tick42\",\"url\":\"http://www.glue42.com\"},\"license\":\"ISC\",\"dependencies\":{\"callback-registry\":\"^2.4.0\",\"es6-promise\":\"^4.1.1\",\"object-assign\":\"^4.1.1\",\"shortid\":\"^2.2.8\",\"tick42-glue-core\":\"^4.1.5\",\"tick42-promisify\":\"^1.0.3\"},\"devDependencies\":{\"@types/object-assign\":\"^4.0.30\",\"@types/shortid\":\"0.0.29\",\"@types/node\":\"^10.7.1\",\"chai\":\"^4.1.0\",\"glue-js-documentation-builder\":\"*\",\"mocha\":\"^2.4.5\",\"onchange\":\"3.*\",\"pre-commit\":\"^1.1.3\",\"readline-sync\":\"^1.4.5\",\"shelljs\":\"^0.6.0\",\"tick42-gateway\":\"^0.2.2\",\"tick42-webpack-config\":\"4.1.6\",\"tslint\":\"^5.5.0\",\"typescript\":\"^3.0.1\",\"webpack\":\"2.3.3\"},\"bundleDependencies\":[\"tick42-glue-core\",\"tick42-promisify\"]}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./package.json\n// module id = 36\n// module chunks = 0","/**\n * Secure random string generator with custom alphabet.\n *\n * Alphabet must contain 256 symbols or less. Otherwise, the generator\n * will not be secure.\n *\n * @param {generator} random The random bytes generator.\n * @param {string} alphabet Symbols to be used in new random string.\n * @param {size} size The number of symbols in new random string.\n *\n * @return {string} Random string.\n *\n * @example\n * const format = require('nanoid/format')\n *\n * function random (size) {\n *   const result = []\n *   for (let i = 0; i < size; i++) {\n *     result.push(randomByte())\n *   }\n *   return result\n * }\n *\n * format(random, \"abcdef\", 5) //=> \"fbaef\"\n *\n * @name format\n * @function\n */\nmodule.exports = function (random, alphabet, size) {\n  var mask = (2 << Math.log(alphabet.length - 1) / Math.LN2) - 1\n  var step = Math.ceil(1.6 * mask * size / alphabet.length)\n\n  var id = ''\n  while (true) {\n    var bytes = random(step)\n    for (var i = 0; i < step; i++) {\n      var byte = bytes[i] & mask\n      if (alphabet[byte]) {\n        id += alphabet[byte]\n        if (id.length === size) return id\n      }\n    }\n  }\n}\n\n/**\n * @callback generator\n * @param {number} bytes The number of bytes to generate.\n * @return {number[]} Random bytes.\n */\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/nanoid/format.js\n// module id = 37\n// module chunks = 0","var crypto = require('crypto')\n\nif (crypto.randomFillSync) {\n  var buffers = { }\n  module.exports = function (bytes) {\n    var buffer = buffers[bytes]\n    if (!buffer) {\n      buffer = Buffer.allocUnsafe(bytes)\n      if (bytes <= 255) buffers[bytes] = buffer\n    }\n    return crypto.randomFillSync(buffer)\n  }\n} else {\n  module.exports = crypto.randomBytes\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/nanoid/random.js\n// module id = 38\n// module chunks = 0","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/object-assign/index.js\n// module id = 39\n// module chunks = 0","'use strict';\nmodule.exports = require('./lib/index');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/shortid/index.js\n// module id = 40\n// module chunks = 0","'use strict';\n\nvar generate = require('./generate');\nvar alphabet = require('./alphabet');\n\n// Ignore all milliseconds before a certain time to reduce the size of the date entropy without sacrificing uniqueness.\n// This number should be updated every year or so to keep the generated id short.\n// To regenerate `new Date() - 0` and bump the version. Always bump the version!\nvar REDUCE_TIME = 1459707606518;\n\n// don't change unless we change the algos or REDUCE_TIME\n// must be an integer and less than 16\nvar version = 6;\n\n// Counter is used when shortid is called multiple times in one second.\nvar counter;\n\n// Remember the last time shortid was called in case counter is needed.\nvar previousSeconds;\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction build(clusterWorkerId) {\n    var str = '';\n\n    var seconds = Math.floor((Date.now() - REDUCE_TIME) * 0.001);\n\n    if (seconds === previousSeconds) {\n        counter++;\n    } else {\n        counter = 0;\n        previousSeconds = seconds;\n    }\n\n    str = str + generate(version);\n    str = str + generate(clusterWorkerId);\n    if (counter > 0) {\n        str = str + generate(counter);\n    }\n    str = str + generate(seconds);\n    return str;\n}\n\nmodule.exports = build;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/shortid/lib/build.js\n// module id = 41\n// module chunks = 0","'use strict';\n\nvar alphabet = require('./alphabet');\nvar random = require('./random/random-byte');\nvar format = require('nanoid/format');\n\nfunction generate(number) {\n    var loopCounter = 0;\n    var done;\n\n    var str = '';\n\n    while (!done) {\n        str = str + format(random, alphabet.get(), 1);\n        done = number < (Math.pow(16, loopCounter + 1 ) );\n        loopCounter++;\n    }\n    return str;\n}\n\nmodule.exports = generate;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/shortid/lib/generate.js\n// module id = 42\n// module chunks = 0","'use strict';\n\nvar alphabet = require('./alphabet');\nvar build = require('./build');\nvar isValid = require('./is-valid');\n\n// if you are using cluster or multiple servers use this to make each instance\n// has a unique value for worker\n// Note: I don't know if this is automatically set when using third\n// party cluster solutions such as pm2.\nvar clusterWorkerId = require('./util/cluster-worker-id') || 0;\n\n/**\n * Set the seed.\n * Highly recommended if you don't want people to try to figure out your id schema.\n * exposed as shortid.seed(int)\n * @param seed Integer value to seed the random alphabet.  ALWAYS USE THE SAME SEED or you might get overlaps.\n */\nfunction seed(seedValue) {\n    alphabet.seed(seedValue);\n    return module.exports;\n}\n\n/**\n * Set the cluster worker or machine id\n * exposed as shortid.worker(int)\n * @param workerId worker must be positive integer.  Number less than 16 is recommended.\n * returns shortid module so it can be chained.\n */\nfunction worker(workerId) {\n    clusterWorkerId = workerId;\n    return module.exports;\n}\n\n/**\n *\n * sets new characters to use in the alphabet\n * returns the shuffled alphabet\n */\nfunction characters(newCharacters) {\n    if (newCharacters !== undefined) {\n        alphabet.characters(newCharacters);\n    }\n\n    return alphabet.shuffled();\n}\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction generate() {\n  return build(clusterWorkerId);\n}\n\n// Export all other functions as properties of the generate function\nmodule.exports = generate;\nmodule.exports.generate = generate;\nmodule.exports.seed = seed;\nmodule.exports.worker = worker;\nmodule.exports.characters = characters;\nmodule.exports.isValid = isValid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/shortid/lib/index.js\n// module id = 43\n// module chunks = 0","'use strict';\nvar alphabet = require('./alphabet');\n\nfunction isShortId(id) {\n    if (!id || typeof id !== 'string' || id.length < 6 ) {\n        return false;\n    }\n\n    var nonAlphabetic = new RegExp('[^' +\n      alphabet.get().replace(/[|\\\\{}()[\\]^$+*?.-]/g, '\\\\$&') +\n    ']');\n    return !nonAlphabetic.test(id);\n}\n\nmodule.exports = isShortId;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/shortid/lib/is-valid.js\n// module id = 44\n// module chunks = 0","module.exports = require('nanoid/random');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/shortid/lib/random/random-byte.js\n// module id = 45\n// module chunks = 0","'use strict';\n\n// Found this seed-based random generator somewhere\n// Based on The Central Randomizer 1.3 (C) 1997 by Paul Houle (houle@msc.cornell.edu)\n\nvar seed = 1;\n\n/**\n * return a random number based on a seed\n * @param seed\n * @returns {number}\n */\nfunction getNextValue() {\n    seed = (seed * 9301 + 49297) % 233280;\n    return seed/(233280.0);\n}\n\nfunction setSeed(_seed_) {\n    seed = _seed_;\n}\n\nmodule.exports = {\n    nextValue: getNextValue,\n    seed: setSeed\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/shortid/lib/random/random-from-seed.js\n// module id = 46\n// module chunks = 0","'use strict';\n\nvar cluster = require('cluster');\n\nvar clusterId = 0;\nif (!cluster.isMaster && cluster.worker) {\n    clusterId = cluster.worker.id;\n}\nmodule.exports = parseInt(process.env.NODE_UNIQUE_ID || clusterId, 10);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/shortid/lib/util/cluster-worker-id.js\n// module id = 47\n// module chunks = 0","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"util\"), require(\"events\"), require(\"crypto\"), require(\"fs\"), require(\"http\"), require(\"url\"), require(\"cluster\"), require(\"https\"), require(\"path\"), require(\"stream\"), require(\"tls\"), require(\"zlib\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"tick42-glue-core\", [\"util\", \"events\", \"crypto\", \"fs\", \"http\", \"url\", \"cluster\", \"https\", \"path\", \"stream\", \"tls\", \"zlib\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"tick42-glue-core\"] = factory(require(\"util\"), require(\"events\"), require(\"crypto\"), require(\"fs\"), require(\"http\"), require(\"url\"), require(\"cluster\"), require(\"https\"), require(\"path\"), require(\"stream\"), require(\"tls\"), require(\"zlib\"));\n\telse\n\t\troot[\"tick42-glue-core\"] = factory(root[\"util\"], root[\"events\"], root[\"crypto\"], root[\"fs\"], root[\"http\"], root[\"url\"], root[\"cluster\"], root[\"https\"], root[\"path\"], root[\"stream\"], root[\"tls\"], root[\"zlib\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_6__, __WEBPACK_EXTERNAL_MODULE_12__, __WEBPACK_EXTERNAL_MODULE_27__, __WEBPACK_EXTERNAL_MODULE_28__, __WEBPACK_EXTERNAL_MODULE_29__, __WEBPACK_EXTERNAL_MODULE_114__, __WEBPACK_EXTERNAL_MODULE_115__, __WEBPACK_EXTERNAL_MODULE_116__, __WEBPACK_EXTERNAL_MODULE_117__, __WEBPACK_EXTERNAL_MODULE_118__, __WEBPACK_EXTERNAL_MODULE_119__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 96);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.default = {\r\n    DEFAULT: 0,\r\n    STRING: 1,\r\n    NUMBER: 2,\r\n    COUNT: 3,\r\n    RATE: 4,\r\n    STATISTICS: 6,\r\n    TIMESTAMP: 7,\r\n    ADDRESS: 8,\r\n    TIMESPAN: 10,\r\n    OBJECT: 11\r\n};\r\n//# sourceMappingURL=metric-types.js.map\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nfunction createRegistry(options) {\r\n    if (options && options.errorHandling\r\n        && typeof options.errorHandling !== \"function\"\r\n        && options.errorHandling !== \"log\"\r\n        && options.errorHandling !== \"silent\"\r\n        && options.errorHandling !== \"throw\") {\r\n        throw new Error(\"Invalid options passed to createRegistry. Prop errorHandling should be [\\\"log\\\" | \\\"silent\\\" | \\\"throw\\\" | (err) => void], but \" + typeof options.errorHandling + \" was passed\");\r\n    }\r\n    var _userErrorHandler = options && typeof options.errorHandling === \"function\" && options.errorHandling;\r\n    var callbacks = {};\r\n    function add(key, callback) {\r\n        var callbacksForKey = callbacks[key];\r\n        if (!callbacksForKey) {\r\n            callbacksForKey = [];\r\n            callbacks[key] = callbacksForKey;\r\n        }\r\n        callbacksForKey.push(callback);\r\n        return function () {\r\n            var allForKey = callbacks[key];\r\n            if (!allForKey) {\r\n                return;\r\n            }\r\n            allForKey = allForKey.reduce(function (acc, element, index) {\r\n                if (!(element === callback && acc.length === index)) {\r\n                    acc.push(element);\r\n                }\r\n                return acc;\r\n            }, []);\r\n            callbacks[key] = allForKey;\r\n        };\r\n    }\r\n    function execute(key) {\r\n        var argumentsArr = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            argumentsArr[_i - 1] = arguments[_i];\r\n        }\r\n        var callbacksForKey = callbacks[key];\r\n        if (!callbacksForKey || callbacksForKey.length === 0) {\r\n            return [];\r\n        }\r\n        var results = [];\r\n        callbacksForKey.forEach(function (callback) {\r\n            try {\r\n                var result = callback.apply(undefined, argumentsArr);\r\n                results.push(result);\r\n            }\r\n            catch (err) {\r\n                results.push(undefined);\r\n                _handleError(err, key);\r\n            }\r\n        });\r\n        return results;\r\n    }\r\n    function _handleError(exceptionArtifact, key) {\r\n        var errParam = exceptionArtifact instanceof Error ? exceptionArtifact : new Error(exceptionArtifact);\r\n        if (_userErrorHandler) {\r\n            _userErrorHandler(errParam);\r\n            return;\r\n        }\r\n        var msg = \"[ERROR] callback-registry: User callback for key \\\"\" + key + \"\\\" failed: \" + errParam.stack;\r\n        if (options) {\r\n            switch (options.errorHandling) {\r\n                case \"log\":\r\n                    return console.error(msg);\r\n                case \"silent\":\r\n                    return;\r\n                case \"throw\":\r\n                    throw new Error(msg);\r\n            }\r\n        }\r\n        console.error(msg);\r\n    }\r\n    function clear() {\r\n        callbacks = {};\r\n    }\r\n    return {\r\n        add: add,\r\n        execute: execute,\r\n        clear: clear\r\n    };\r\n}\r\n;\r\ncreateRegistry.default = createRegistry;\r\nmodule.exports = createRegistry;\r\n//# sourceMappingURL=index.js.map\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.default = {\r\n    validate: function (definition, parent, transport) {\r\n        if (definition === null || typeof definition !== \"object\") {\r\n            throw new Error(\"Missing definition\");\r\n        }\r\n        if (parent === null || typeof parent !== \"object\") {\r\n            throw new Error(\"Missing parent\");\r\n        }\r\n        if (transport === null || typeof transport !== \"object\") {\r\n            throw new Error(\"Missing transport\");\r\n        }\r\n    },\r\n};\r\n//# sourceMappingURL=helpers.js.map\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"util\");\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar randomFromSeed = __webpack_require__(40);\n\nvar ORIGINAL = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-';\nvar alphabet;\nvar previousSeed;\n\nvar shuffled;\n\nfunction reset() {\n    shuffled = false;\n}\n\nfunction setCharacters(_alphabet_) {\n    if (!_alphabet_) {\n        if (alphabet !== ORIGINAL) {\n            alphabet = ORIGINAL;\n            reset();\n        }\n        return;\n    }\n\n    if (_alphabet_ === alphabet) {\n        return;\n    }\n\n    if (_alphabet_.length !== ORIGINAL.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. You submitted ' + _alphabet_.length + ' characters: ' + _alphabet_);\n    }\n\n    var unique = _alphabet_.split('').filter(function(item, ind, arr){\n       return ind !== arr.lastIndexOf(item);\n    });\n\n    if (unique.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. These characters were not unique: ' + unique.join(', '));\n    }\n\n    alphabet = _alphabet_;\n    reset();\n}\n\nfunction characters(_alphabet_) {\n    setCharacters(_alphabet_);\n    return alphabet;\n}\n\nfunction setSeed(seed) {\n    randomFromSeed.seed(seed);\n    if (previousSeed !== seed) {\n        reset();\n        previousSeed = seed;\n    }\n}\n\nfunction shuffle() {\n    if (!alphabet) {\n        setCharacters(ORIGINAL);\n    }\n\n    var sourceArray = alphabet.split('');\n    var targetArray = [];\n    var r = randomFromSeed.nextValue();\n    var characterIndex;\n\n    while (sourceArray.length > 0) {\n        r = randomFromSeed.nextValue();\n        characterIndex = Math.floor(r * sourceArray.length);\n        targetArray.push(sourceArray.splice(characterIndex, 1)[0]);\n    }\n    return targetArray.join('');\n}\n\nfunction getShuffled() {\n    if (shuffled) {\n        return shuffled;\n    }\n    shuffled = shuffle();\n    return shuffled;\n}\n\n/**\n * lookup shuffled letter\n * @param index\n * @returns {string}\n */\nfunction lookup(index) {\n    var alphabetShuffled = getShuffled();\n    return alphabetShuffled[index];\n}\n\nfunction get () {\n  return alphabet || ORIGINAL;\n}\n\nmodule.exports = {\n    get: get,\n    characters: characters,\n    seed: setSeed,\n    lookup: lookup,\n    shuffled: getShuffled\n};\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\nvar zlib = __webpack_require__(119);\n\nvar AVAILABLE_WINDOW_BITS = [8, 9, 10, 11, 12, 13, 14, 15];\nvar DEFAULT_WINDOW_BITS = 15;\nvar DEFAULT_MEM_LEVEL = 8;\n\nPerMessageDeflate.extensionName = 'permessage-deflate';\n\n/**\n * Per-message Compression Extensions implementation\n */\n\nfunction PerMessageDeflate(options, isServer) {\n  this._options = options || {};\n  this._isServer = !!isServer;\n  this._inflate = null;\n  this._deflate = null;\n  this.params = null;\n}\n\n/**\n * Create extension parameters offer\n *\n * @api public\n */\n\nPerMessageDeflate.prototype.offer = function() {\n  var params = {};\n  if (this._options.serverNoContextTakeover) {\n    params.server_no_context_takeover = true;\n  }\n  if (this._options.clientNoContextTakeover) {\n    params.client_no_context_takeover = true;\n  }\n  if (this._options.serverMaxWindowBits) {\n    params.server_max_window_bits = this._options.serverMaxWindowBits;\n  }\n  if (this._options.clientMaxWindowBits) {\n    params.client_max_window_bits = this._options.clientMaxWindowBits;\n  } else if (this._options.clientMaxWindowBits == null) {\n    params.client_max_window_bits = true;\n  }\n  return params;\n};\n\n/**\n * Accept extension offer\n *\n * @api public\n */\n\nPerMessageDeflate.prototype.accept = function(paramsList) {\n  paramsList = this.normalizeParams(paramsList);\n\n  var params;\n  if (this._isServer) {\n    params = this.acceptAsServer(paramsList);\n  } else {\n    params = this.acceptAsClient(paramsList);\n  }\n\n  this.params = params;\n  return params;\n};\n\n/**\n * Accept extension offer from client\n *\n * @api private\n */\n\nPerMessageDeflate.prototype.acceptAsServer = function(paramsList) {\n  var accepted = {};\n  var result = paramsList.some(function(params) {\n    accepted = {};\n    if (this._options.serverNoContextTakeover === false && params.server_no_context_takeover) {\n      return;\n    }\n    if (this._options.serverMaxWindowBits === false && params.server_max_window_bits) {\n      return;\n    }\n    if (typeof this._options.serverMaxWindowBits === 'number' &&\n        typeof params.server_max_window_bits === 'number' &&\n        this._options.serverMaxWindowBits > params.server_max_window_bits) {\n      return;\n    }\n    if (typeof this._options.clientMaxWindowBits === 'number' && !params.client_max_window_bits) {\n      return;\n    }\n\n    if (this._options.serverNoContextTakeover || params.server_no_context_takeover) {\n      accepted.server_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover) {\n      accepted.client_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover !== false && params.client_no_context_takeover) {\n      accepted.client_no_context_takeover = true;\n    }\n    if (typeof this._options.serverMaxWindowBits === 'number') {\n      accepted.server_max_window_bits = this._options.serverMaxWindowBits;\n    } else if (typeof params.server_max_window_bits === 'number') {\n      accepted.server_max_window_bits = params.server_max_window_bits;\n    }\n    if (typeof this._options.clientMaxWindowBits === 'number') {\n      accepted.client_max_window_bits = this._options.clientMaxWindowBits;\n    } else if (this._options.clientMaxWindowBits !== false && typeof params.client_max_window_bits === 'number') {\n      accepted.client_max_window_bits = params.client_max_window_bits;\n    }\n    return true;\n  }, this);\n\n  if (!result) {\n    throw new Error('Doesn\\'t support the offered configuration');\n  }\n\n  return accepted;\n};\n\n/**\n * Accept extension response from server\n *\n * @api privaye\n */\n\nPerMessageDeflate.prototype.acceptAsClient = function(paramsList) {\n  var params = paramsList[0];\n  if (this._options.clientNoContextTakeover != null) {\n    if (this._options.clientNoContextTakeover === false && params.client_no_context_takeover) {\n      throw new Error('Invalid value for \"client_no_context_takeover\"');\n    }\n  }\n  if (this._options.clientMaxWindowBits != null) {\n    if (this._options.clientMaxWindowBits === false && params.client_max_window_bits) {\n      throw new Error('Invalid value for \"client_max_window_bits\"');\n    }\n    if (typeof this._options.clientMaxWindowBits === 'number' &&\n        (!params.client_max_window_bits || params.client_max_window_bits > this._options.clientMaxWindowBits)) {\n      throw new Error('Invalid value for \"client_max_window_bits\"');\n    }\n  }\n  return params;\n};\n\n/**\n * Normalize extensions parameters\n *\n * @api private\n */\n\nPerMessageDeflate.prototype.normalizeParams = function(paramsList) {\n  return paramsList.map(function(params) {\n    Object.keys(params).forEach(function(key) {\n      var value = params[key];\n      if (value.length > 1) {\n        throw new Error('Multiple extension parameters for ' + key);\n      }\n\n      value = value[0];\n\n      switch (key) {\n      case 'server_no_context_takeover':\n      case 'client_no_context_takeover':\n        if (value !== true) {\n          throw new Error('invalid extension parameter value for ' + key + ' (' + value + ')');\n        }\n        params[key] = true;\n        break;\n      case 'server_max_window_bits':\n      case 'client_max_window_bits':\n        if (typeof value === 'string') {\n          value = parseInt(value, 10);\n          if (!~AVAILABLE_WINDOW_BITS.indexOf(value)) {\n            throw new Error('invalid extension parameter value for ' + key + ' (' + value + ')');\n          }\n        }\n        if (!this._isServer && value === true) {\n          throw new Error('Missing extension parameter value for ' + key);\n        }\n        params[key] = value;\n        break;\n      default:\n        throw new Error('Not defined extension parameter (' + key + ')');\n      }\n    }, this);\n    return params;\n  }, this);\n};\n\n/**\n * Decompress message\n *\n * @api public\n */\n\nPerMessageDeflate.prototype.decompress = function (data, fin, callback) {\n  var endpoint = this._isServer ? 'client' : 'server';\n\n  if (!this._inflate) {\n    var maxWindowBits = this.params[endpoint + '_max_window_bits'];\n    this._inflate = zlib.createInflateRaw({\n      windowBits: 'number' === typeof maxWindowBits ? maxWindowBits : DEFAULT_WINDOW_BITS\n    });\n  }\n\n  var self = this;\n  var buffers = [];\n\n  this._inflate.on('error', onError).on('data', onData);\n  this._inflate.write(data);\n  if (fin) {\n    this._inflate.write(new Buffer([0x00, 0x00, 0xff, 0xff]));\n  }\n  this._inflate.flush(function() {\n    cleanup();\n    callback(null, Buffer.concat(buffers));\n  });\n\n  function onError(err) {\n    cleanup();\n    callback(err);\n  }\n\n  function onData(data) {\n    buffers.push(data);\n  }\n\n  function cleanup() {\n    self._inflate.removeListener('error', onError);\n    self._inflate.removeListener('data', onData);\n    if (fin && self.params[endpoint + '_no_context_takeover']) {\n      self._inflate = null;\n    }\n  }\n};\n\n/**\n * Compress message\n *\n * @api public\n */\n\nPerMessageDeflate.prototype.compress = function (data, fin, callback) {\n  var endpoint = this._isServer ? 'server' : 'client';\n\n  if (!this._deflate) {\n    var maxWindowBits = this.params[endpoint + '_max_window_bits'];\n    this._deflate = zlib.createDeflateRaw({\n      flush: zlib.Z_SYNC_FLUSH,\n      windowBits: 'number' === typeof maxWindowBits ? maxWindowBits : DEFAULT_WINDOW_BITS,\n      memLevel: this._options.memLevel || DEFAULT_MEM_LEVEL\n    });\n  }\n\n  var self = this;\n  var buffers = [];\n\n  this._deflate.on('error', onError).on('data', onData);\n  this._deflate.write(data);\n  this._deflate.flush(function() {\n    cleanup();\n    var data = Buffer.concat(buffers);\n    if (fin) {\n      data = data.slice(0, data.length - 4);\n    }\n    callback(null, data);\n  });\n\n  function onError(err) {\n    cleanup();\n    callback(err);\n  }\n\n  function onData(data) {\n    buffers.push(data);\n  }\n\n  function cleanup() {\n    self._deflate.removeListener('error', onError);\n    self._deflate.removeListener('data', onData);\n    if (fin && self.params[endpoint + '_no_context_takeover']) {\n      self._deflate = null;\n    }\n  }\n};\n\nmodule.exports = PerMessageDeflate;\n\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"events\");\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nmodule.exports = __webpack_require__(37);\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction default_1(promise, successCallback, errorCallback) {\r\n    if (typeof successCallback !== \"function\" && typeof errorCallback !== \"function\") {\r\n        return promise;\r\n    }\r\n    if (typeof successCallback !== \"function\") {\r\n        successCallback = function () { };\r\n    }\r\n    else if (typeof errorCallback !== \"function\") {\r\n        errorCallback = function () { };\r\n    }\r\n    promise.then(successCallback, errorCallback);\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=promisify.js.map\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ServerSubscription = (function () {\r\n    function ServerSubscription(protocol, repoMethod, subscription) {\r\n        this.protocol = protocol;\r\n        this.repoMethod = repoMethod;\r\n        this.subscription = subscription;\r\n    }\r\n    Object.defineProperty(ServerSubscription.prototype, \"stream\", {\r\n        get: function () { return this.repoMethod.stream; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ServerSubscription.prototype, \"arguments\", {\r\n        get: function () { return this.subscription.arguments || {}; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ServerSubscription.prototype, \"branchKey\", {\r\n        get: function () { return this.subscription.branchKey; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ServerSubscription.prototype, \"instance\", {\r\n        get: function () { return this.subscription.instance; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ServerSubscription.prototype.close = function () {\r\n        this.protocol.server.closeSingleSubscription(this.repoMethod, this.subscription);\r\n    };\r\n    ServerSubscription.prototype.push = function (data) {\r\n        this.protocol.server.pushDataToSingle(this.repoMethod, this.subscription, data);\r\n    };\r\n    return ServerSubscription;\r\n}());\r\nexports.default = ServerSubscription;\r\n//# sourceMappingURL=subscription.js.map\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar msg = __webpack_require__(25);\r\nexports.ContextMessageReplaySpec = {\r\n    get name() {\r\n        return \"context\";\r\n    },\r\n    get types() {\r\n        return [\r\n            msg.GW_MESSAGE_CREATE_CONTEXT,\r\n            msg.GW_MESSAGE_ACTIVITY_CREATED,\r\n            msg.GW_MESSAGE_ACTIVITY_DESTROYED,\r\n            msg.GW_MESSAGE_CONTEXT_CREATED,\r\n            msg.GW_MESSAGE_CONTEXT_ADDED,\r\n            msg.GW_MESSAGE_SUBSCRIBE_CONTEXT,\r\n            msg.GW_MESSAGE_SUBSCRIBED_CONTEXT,\r\n            msg.GW_MESSAGE_UNSUBSCRIBE_CONTEXT,\r\n            msg.GW_MESSAGE_DESTROY_CONTEXT,\r\n            msg.GW_MESSAGE_CONTEXT_DESTROYED,\r\n            msg.GW_MESSAGE_UPDATE_CONTEXT,\r\n            msg.GW_MESSAGE_CONTEXT_UPDATED,\r\n            msg.GW_MESSAGE_JOINED_ACTIVITY\r\n        ];\r\n    }\r\n};\r\n//# sourceMappingURL=contextMessageReplaySpec.js.map\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Utils = (function () {\r\n    function Utils() {\r\n    }\r\n    Utils.getGDMajorVersion = function () {\r\n        if (typeof window === \"undefined\") {\r\n            return -1;\r\n        }\r\n        if (!window.glueDesktop) {\r\n            return -1;\r\n        }\r\n        if (!window.glueDesktop.version) {\r\n            return -1;\r\n        }\r\n        var ver = Number(window.glueDesktop.version.substr(0, 1));\r\n        return isNaN(ver) ? -1 : ver;\r\n    };\r\n    Utils.isNode = function () {\r\n        try {\r\n            return Object.prototype.toString.call(global.process) === \"[object process]\";\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    };\r\n    return Utils;\r\n}());\r\nexports.default = Utils;\r\n//# sourceMappingURL=utils.js.map\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"crypto\");\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports) {\n\nmodule.exports = {\"name\":\"tick42-glue-core\",\"version\":\"4.1.5\",\"description\":\"Glue42 core library including logger, connection, agm and metrics\",\"main\":\"./dist/node/tick42-glue-core.js\",\"types\":\"./glue.d.ts\",\"browser\":\"./dist/web/tick42-glue-core.js\",\"scripts\":{\"init-dev-mode\":\"node ./build/scripts/init-dev-mode.js\",\"remove-installed-dependencies\":\"node ./build/scripts/remove-installed-dependencies.js\",\"clean\":\"node ./build/scripts/clean.js\",\"pre:build\":\"npm run clean && npm run tslint && tsc && set NODE_ENV=development\",\"file-versionify\":\"node ./build/scripts/file-versionify.js\",\"tslint\":\"tslint -t codeFrame ./src/**.ts\",\"tslint:fix\":\"tslint -t codeFrame --fix ./src/**.ts\",\"watch\":\"onchange ./src/**/*.ts -- npm run build:dev\",\"build:dev\":\"npm run pre:build && set NODE_ENV=development && webpack && npm run file-versionify\",\"build:prod\":\"npm run pre:build && set NODE_ENV=development && webpack && set NODE_ENV=production && webpack && npm run file-versionify\",\"docs\":\"typedoc --options typedoc.json ./src\",\"prepublish\":\"npm run build:prod && npm run test:only\",\"test\":\"npm run build:dev && npm run test:only\",\"test:only\":\"mocha ./tests/ --recursive\",\"test:core\":\"mocha ./tests/core\",\"test:agm\":\"mocha ./tests/agm\"},\"repository\":{\"type\":\"git\",\"url\":\"https://stash.tick42.com/scm/tg/js-glue-core.git\"},\"author\":{\"name\":\"Tick42\",\"url\":\"http://www.glue42.com\"},\"license\":\"ISC\",\"dependencies\":{\"callback-registry\":\"^2.4.0\",\"es6-promise\":\"^4.1.0\",\"shortid\":\"^2.2.6\",\"util-deprecate\":\"^1.0.2\",\"ws\":\"^0.7.2\"},\"devDependencies\":{\"@types/node\":\"^10.7.0\",\"@types/shortid\":\"0.0.29\",\"archiver\":\"^1.3.0\",\"babel-core\":\"^6.25.0\",\"babel-loader\":\"^6.4.1\",\"babel-plugin-add-module-exports\":\"^0.2.1\",\"babel-preset-es2015\":\"^6.16.0\",\"babel-preset-stage-2\":\"^6.22.0\",\"chai\":\"^4.0.2\",\"deep-equal\":\"^1.0.1\",\"mocha\":\"^2.5.3\",\"onchange\":\"3.*\",\"pre-commit\":\"^1.1.3\",\"readline-sync\":\"^1.4.5\",\"shelljs\":\"^0.6.0\",\"tick42-gateway\":\"^0.2.2\",\"tick42-webpack-config\":\"4.1.6\",\"tslint\":\"^5.11.0\",\"typescript\":\"^3.0.1\",\"webpack\":\"2.3.3\"}}\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports) {\n\nfunction webpackEmptyContext(req) {\n\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 14;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(__filename) {\n/**\n * Module dependencies.\n */\n\nvar fs = __webpack_require__(27)\n  , path = __webpack_require__(116)\n  , join = path.join\n  , dirname = path.dirname\n  , exists = fs.existsSync || path.existsSync\n  , defaults = {\n        arrow: process.env.NODE_BINDINGS_ARROW || ' → '\n      , compiled: process.env.NODE_BINDINGS_COMPILED_DIR || 'compiled'\n      , platform: process.platform\n      , arch: process.arch\n      , version: process.versions.node\n      , bindings: 'bindings.node'\n      , try: [\n          // node-gyp's linked version in the \"build\" dir\n          [ 'module_root', 'build', 'bindings' ]\n          // node-waf and gyp_addon (a.k.a node-gyp)\n        , [ 'module_root', 'build', 'Debug', 'bindings' ]\n        , [ 'module_root', 'build', 'Release', 'bindings' ]\n          // Debug files, for development (legacy behavior, remove for node v0.9)\n        , [ 'module_root', 'out', 'Debug', 'bindings' ]\n        , [ 'module_root', 'Debug', 'bindings' ]\n          // Release files, but manually compiled (legacy behavior, remove for node v0.9)\n        , [ 'module_root', 'out', 'Release', 'bindings' ]\n        , [ 'module_root', 'Release', 'bindings' ]\n          // Legacy from node-waf, node <= 0.4.x\n        , [ 'module_root', 'build', 'default', 'bindings' ]\n          // Production \"Release\" buildtype binary (meh...)\n        , [ 'module_root', 'compiled', 'version', 'platform', 'arch', 'bindings' ]\n        ]\n    }\n\n/**\n * The main `bindings()` function loads the compiled bindings for a given module.\n * It uses V8's Error API to determine the parent filename that this function is\n * being invoked from, which is then used to find the root directory.\n */\n\nfunction bindings (opts) {\n\n  // Argument surgery\n  if (typeof opts == 'string') {\n    opts = { bindings: opts }\n  } else if (!opts) {\n    opts = {}\n  }\n  opts.__proto__ = defaults\n\n  // Get the module root\n  if (!opts.module_root) {\n    opts.module_root = exports.getRoot(exports.getFileName())\n  }\n\n  // Ensure the given bindings name ends with .node\n  if (path.extname(opts.bindings) != '.node') {\n    opts.bindings += '.node'\n  }\n\n  var tries = []\n    , i = 0\n    , l = opts.try.length\n    , n\n    , b\n    , err\n\n  for (; i<l; i++) {\n    n = join.apply(null, opts.try[i].map(function (p) {\n      return opts[p] || p\n    }))\n    tries.push(n)\n    try {\n      b = opts.path ? /*require.resolve*/(!(function webpackMissingModule() { var e = new Error(\"Cannot find module \\\".\\\"\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())) : !(function webpackMissingModule() { var e = new Error(\"Cannot find module \\\".\\\"\"); e.code = 'MODULE_NOT_FOUND'; throw e; }())\n      if (!opts.path) {\n        b.path = n\n      }\n      return b\n    } catch (e) {\n      if (!/not find/i.test(e.message)) {\n        throw e\n      }\n    }\n  }\n\n  err = new Error('Could not locate the bindings file. Tried:\\n'\n    + tries.map(function (a) { return opts.arrow + a }).join('\\n'))\n  err.tries = tries\n  throw err\n}\nmodule.exports = exports = bindings\n\n\n/**\n * Gets the filename of the JavaScript file that invokes this function.\n * Used to help find the root directory of a module.\n * Optionally accepts an filename argument to skip when searching for the invoking filename\n */\n\nexports.getFileName = function getFileName (calling_file) {\n  var origPST = Error.prepareStackTrace\n    , origSTL = Error.stackTraceLimit\n    , dummy = {}\n    , fileName\n\n  Error.stackTraceLimit = 10\n\n  Error.prepareStackTrace = function (e, st) {\n    for (var i=0, l=st.length; i<l; i++) {\n      fileName = st[i].getFileName()\n      if (fileName !== __filename) {\n        if (calling_file) {\n            if (fileName !== calling_file) {\n              return\n            }\n        } else {\n          return\n        }\n      }\n    }\n  }\n\n  // run the 'prepareStackTrace' function above\n  Error.captureStackTrace(dummy)\n  dummy.stack\n\n  // cleanup\n  Error.prepareStackTrace = origPST\n  Error.stackTraceLimit = origSTL\n\n  return fileName\n}\n\n/**\n * Gets the root directory of a module, given an arbitrary filename\n * somewhere in the module tree. The \"root directory\" is the directory\n * containing the `package.json` file.\n *\n *   In:  /home/nate/node-native-module/lib/index.js\n *   Out: /home/nate/node-native-module\n */\n\nexports.getRoot = function getRoot (file) {\n  var dir = dirname(file)\n    , prev\n  while (true) {\n    if (dir === '.') {\n      // Avoids an infinite loop in rare cases, like the REPL\n      dir = process.cwd()\n    }\n    if (exists(join(dir, 'package.json')) || exists(join(dir, 'node_modules'))) {\n      // Found the 'package.json' file or 'node_modules' dir; we're done\n      return dir\n    }\n    if (prev === dir) {\n      // Got to the top\n      throw new Error('Could not find module root given file: \"' + file\n                    + '\". Do you have a `package.json` file? ')\n    }\n    // Try the parent dir next\n    prev = dir\n    dir = join(dir, '..')\n  }\n}\n\n/* WEBPACK VAR INJECTION */}.call(exports, \"/index.js\"))\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar fs = __webpack_require__(27);\n\nfunction Options(defaults) {\n  var internalValues = {};\n  var values = this.value = {};\n  Object.keys(defaults).forEach(function(key) {\n    internalValues[key] = defaults[key];\n    Object.defineProperty(values, key, {\n      get: function() { return internalValues[key]; },\n      configurable: false,\n      enumerable: true\n    });\n  });\n  this.reset = function() {\n    Object.keys(defaults).forEach(function(key) {\n      internalValues[key] = defaults[key];\n    });\n    return this;\n  };\n  this.merge = function(options, required) {\n    options = options || {};\n    if (Object.prototype.toString.call(required) === '[object Array]') {\n      var missing = [];\n      for (var i = 0, l = required.length; i < l; ++i) {\n        var key = required[i];\n        if (!(key in options)) {\n          missing.push(key);\n        }\n      }\n      if (missing.length > 0) {\n        if (missing.length > 1) {\n          throw new Error('options ' +\n            missing.slice(0, missing.length - 1).join(', ') + ' and ' +\n            missing[missing.length - 1] + ' must be defined');\n        }\n        else throw new Error('option ' + missing[0] + ' must be defined');\n      }\n    }\n    Object.keys(options).forEach(function(key) {\n      if (key in internalValues) {\n        internalValues[key] = options[key];\n      }\n    });\n    return this;\n  };\n  this.copy = function(keys) {\n    var obj = {};\n    Object.keys(defaults).forEach(function(key) {\n      if (keys.indexOf(key) !== -1) {\n        obj[key] = values[key];\n      }\n    });\n    return obj;\n  };\n  this.read = function(filename, cb) {\n    if (typeof cb == 'function') {\n      var self = this;\n      fs.readFile(filename, function(error, data) {\n        if (error) return cb(error);\n        var conf = JSON.parse(data);\n        self.merge(conf);\n        cb();\n      });\n    }\n    else {\n      var conf = JSON.parse(fs.readFileSync(filename));\n      this.merge(conf);\n    }\n    return this;\n  };\n  this.isDefined = function(key) {\n    return typeof values[key] != 'undefined';\n  };\n  this.isDefinedAndNonNull = function(key) {\n    return typeof values[key] != 'undefined' && values[key] !== null;\n  };\n  Object.freeze(values);\n  Object.freeze(this);\n}\n\nmodule.exports = Options;\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\ntry {\n  module.exports = __webpack_require__(32);\n} catch (e) {\n  module.exports = __webpack_require__(47);\n}\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nmodule.exports = {\n  isValidErrorCode: function(code) {\n    return (code >= 1000 && code <= 1011 && code != 1004 && code != 1005 && code != 1006) ||\n         (code >= 3000 && code <= 4999);\n  },\n  1000: 'normal',\n  1001: 'going away',\n  1002: 'protocol error',\n  1003: 'unsupported data',\n  1004: 'reserved',\n  1005: 'reserved for extensions',\n  1006: 'reserved for extensions',\n  1007: 'inconsistent or invalid data',\n  1008: 'policy violation',\n  1009: 'message too big',\n  1010: 'extension handshake missing',\n  1011: 'an unexpected condition prevented the request from being fulfilled',\n};\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\nvar util = __webpack_require__(3);\n\n/**\n * Module exports.\n */\n\nexports.parse = parse;\nexports.format = format;\n\n/**\n * Parse extensions header value\n */\n\nfunction parse(value) {\n  value = value || '';\n\n  var extensions = {};\n\n  value.split(',').forEach(function(v) {\n    var params = v.split(';');\n    var token = params.shift().trim();\n    var paramsList = extensions[token] = extensions[token] || [];\n    var parsedParams = {};\n\n    params.forEach(function(param) {\n      var parts = param.trim().split('=');\n      var key = parts[0];\n      var value = parts[1];\n      if (typeof value === 'undefined') {\n        value = true;\n      } else {\n        // unquote value\n        if (value[0] === '\"') {\n          value = value.slice(1);\n        }\n        if (value[value.length - 1] === '\"') {\n          value = value.slice(0, value.length - 1);\n        }\n      }\n      (parsedParams[key] = parsedParams[key] || []).push(value);\n    });\n\n    paramsList.push(parsedParams);\n  });\n\n  return extensions;\n}\n\n/**\n * Format extensions header value\n */\n\nfunction format(value) {\n  return Object.keys(value).map(function(token) {\n    var paramsList = value[token];\n    if (!util.isArray(paramsList)) {\n      paramsList = [paramsList];\n    }\n    return paramsList.map(function(params) {\n      return [token].concat(Object.keys(params).map(function(k) {\n        var p = params[k];\n        if (!util.isArray(p)) p = [p];\n        return p.map(function(v) {\n          return v === true ? k : k + '=' + v;\n        }).join('; ');\n      })).join('; ');\n    }).join(', ');\n  }).join(', ');\n}\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar util = __webpack_require__(3)\n  , Validation = __webpack_require__(51).Validation\n  , ErrorCodes = __webpack_require__(18)\n  , BufferPool = __webpack_require__(46)\n  , bufferUtil = __webpack_require__(17).BufferUtil\n  , PerMessageDeflate = __webpack_require__(5);\n\n/**\n * HyBi Receiver implementation\n */\n\nfunction Receiver (extensions) {\n  // memory pool for fragmented messages\n  var fragmentedPoolPrevUsed = -1;\n  this.fragmentedBufferPool = new BufferPool(1024, function(db, length) {\n    return db.used + length;\n  }, function(db) {\n    return fragmentedPoolPrevUsed = fragmentedPoolPrevUsed >= 0 ?\n      (fragmentedPoolPrevUsed + db.used) / 2 :\n      db.used;\n  });\n\n  // memory pool for unfragmented messages\n  var unfragmentedPoolPrevUsed = -1;\n  this.unfragmentedBufferPool = new BufferPool(1024, function(db, length) {\n    return db.used + length;\n  }, function(db) {\n    return unfragmentedPoolPrevUsed = unfragmentedPoolPrevUsed >= 0 ?\n      (unfragmentedPoolPrevUsed + db.used) / 2 :\n      db.used;\n  });\n\n  this.extensions = extensions || {};\n  this.state = {\n    activeFragmentedOperation: null,\n    lastFragment: false,\n    masked: false,\n    opcode: 0,\n    fragmentedOperation: false\n  };\n  this.overflow = [];\n  this.headerBuffer = new Buffer(10);\n  this.expectOffset = 0;\n  this.expectBuffer = null;\n  this.expectHandler = null;\n  this.currentMessage = [];\n  this.messageHandlers = [];\n  this.expectHeader(2, this.processPacket);\n  this.dead = false;\n  this.processing = false;\n\n  this.onerror = function() {};\n  this.ontext = function() {};\n  this.onbinary = function() {};\n  this.onclose = function() {};\n  this.onping = function() {};\n  this.onpong = function() {};\n}\n\nmodule.exports = Receiver;\n\n/**\n * Add new data to the parser.\n *\n * @api public\n */\n\nReceiver.prototype.add = function(data) {\n  var dataLength = data.length;\n  if (dataLength == 0) return;\n  if (this.expectBuffer == null) {\n    this.overflow.push(data);\n    return;\n  }\n  var toRead = Math.min(dataLength, this.expectBuffer.length - this.expectOffset);\n  fastCopy(toRead, data, this.expectBuffer, this.expectOffset);\n  this.expectOffset += toRead;\n  if (toRead < dataLength) {\n    this.overflow.push(data.slice(toRead));\n  }\n  while (this.expectBuffer && this.expectOffset == this.expectBuffer.length) {\n    var bufferForHandler = this.expectBuffer;\n    this.expectBuffer = null;\n    this.expectOffset = 0;\n    this.expectHandler.call(this, bufferForHandler);\n  }\n};\n\n/**\n * Releases all resources used by the receiver.\n *\n * @api public\n */\n\nReceiver.prototype.cleanup = function() {\n  this.dead = true;\n  this.overflow = null;\n  this.headerBuffer = null;\n  this.expectBuffer = null;\n  this.expectHandler = null;\n  this.unfragmentedBufferPool = null;\n  this.fragmentedBufferPool = null;\n  this.state = null;\n  this.currentMessage = null;\n  this.onerror = null;\n  this.ontext = null;\n  this.onbinary = null;\n  this.onclose = null;\n  this.onping = null;\n  this.onpong = null;\n};\n\n/**\n * Waits for a certain amount of header bytes to be available, then fires a callback.\n *\n * @api private\n */\n\nReceiver.prototype.expectHeader = function(length, handler) {\n  if (length == 0) {\n    handler(null);\n    return;\n  }\n  this.expectBuffer = this.headerBuffer.slice(this.expectOffset, this.expectOffset + length);\n  this.expectHandler = handler;\n  var toRead = length;\n  while (toRead > 0 && this.overflow.length > 0) {\n    var fromOverflow = this.overflow.pop();\n    if (toRead < fromOverflow.length) this.overflow.push(fromOverflow.slice(toRead));\n    var read = Math.min(fromOverflow.length, toRead);\n    fastCopy(read, fromOverflow, this.expectBuffer, this.expectOffset);\n    this.expectOffset += read;\n    toRead -= read;\n  }\n};\n\n/**\n * Waits for a certain amount of data bytes to be available, then fires a callback.\n *\n * @api private\n */\n\nReceiver.prototype.expectData = function(length, handler) {\n  if (length == 0) {\n    handler(null);\n    return;\n  }\n  this.expectBuffer = this.allocateFromPool(length, this.state.fragmentedOperation);\n  this.expectHandler = handler;\n  var toRead = length;\n  while (toRead > 0 && this.overflow.length > 0) {\n    var fromOverflow = this.overflow.pop();\n    if (toRead < fromOverflow.length) this.overflow.push(fromOverflow.slice(toRead));\n    var read = Math.min(fromOverflow.length, toRead);\n    fastCopy(read, fromOverflow, this.expectBuffer, this.expectOffset);\n    this.expectOffset += read;\n    toRead -= read;\n  }\n};\n\n/**\n * Allocates memory from the buffer pool.\n *\n * @api private\n */\n\nReceiver.prototype.allocateFromPool = function(length, isFragmented) {\n  return (isFragmented ? this.fragmentedBufferPool : this.unfragmentedBufferPool).get(length);\n};\n\n/**\n * Start processing a new packet.\n *\n * @api private\n */\n\nReceiver.prototype.processPacket = function (data) {\n  if (this.extensions[PerMessageDeflate.extensionName]) {\n    if ((data[0] & 0x30) != 0) {\n      this.error('reserved fields (2, 3) must be empty', 1002);\n      return;\n    }\n  } else {\n    if ((data[0] & 0x70) != 0) {\n      this.error('reserved fields must be empty', 1002);\n      return;\n    }\n  }\n  this.state.lastFragment = (data[0] & 0x80) == 0x80;\n  this.state.masked = (data[1] & 0x80) == 0x80;\n  var compressed = (data[0] & 0x40) == 0x40;\n  var opcode = data[0] & 0xf;\n  if (opcode === 0) {\n    if (compressed) {\n      this.error('continuation frame cannot have the Per-message Compressed bits', 1002);\n      return;\n    }\n    // continuation frame\n    this.state.fragmentedOperation = true;\n    this.state.opcode = this.state.activeFragmentedOperation;\n    if (!(this.state.opcode == 1 || this.state.opcode == 2)) {\n      this.error('continuation frame cannot follow current opcode', 1002);\n      return;\n    }\n  }\n  else {\n    if (opcode < 3 && this.state.activeFragmentedOperation != null) {\n      this.error('data frames after the initial data frame must have opcode 0', 1002);\n      return;\n    }\n    if (opcode >= 8 && compressed) {\n      this.error('control frames cannot have the Per-message Compressed bits', 1002);\n      return;\n    }\n    this.state.compressed = compressed;\n    this.state.opcode = opcode;\n    if (this.state.lastFragment === false) {\n      this.state.fragmentedOperation = true;\n      this.state.activeFragmentedOperation = opcode;\n    }\n    else this.state.fragmentedOperation = false;\n  }\n  var handler = opcodes[this.state.opcode];\n  if (typeof handler == 'undefined') this.error('no handler for opcode ' + this.state.opcode, 1002);\n  else {\n    handler.start.call(this, data);\n  }\n};\n\n/**\n * Endprocessing a packet.\n *\n * @api private\n */\n\nReceiver.prototype.endPacket = function() {\n  if (!this.state.fragmentedOperation) this.unfragmentedBufferPool.reset(true);\n  else if (this.state.lastFragment) this.fragmentedBufferPool.reset(false);\n  this.expectOffset = 0;\n  this.expectBuffer = null;\n  this.expectHandler = null;\n  if (this.state.lastFragment && this.state.opcode === this.state.activeFragmentedOperation) {\n    // end current fragmented operation\n    this.state.activeFragmentedOperation = null;\n  }\n  this.state.lastFragment = false;\n  this.state.opcode = this.state.activeFragmentedOperation != null ? this.state.activeFragmentedOperation : 0;\n  this.state.masked = false;\n  this.expectHeader(2, this.processPacket);\n};\n\n/**\n * Reset the parser state.\n *\n * @api private\n */\n\nReceiver.prototype.reset = function() {\n  if (this.dead) return;\n  this.state = {\n    activeFragmentedOperation: null,\n    lastFragment: false,\n    masked: false,\n    opcode: 0,\n    fragmentedOperation: false\n  };\n  this.fragmentedBufferPool.reset(true);\n  this.unfragmentedBufferPool.reset(true);\n  this.expectOffset = 0;\n  this.expectBuffer = null;\n  this.expectHandler = null;\n  this.overflow = [];\n  this.currentMessage = [];\n  this.messageHandlers = [];\n};\n\n/**\n * Unmask received data.\n *\n * @api private\n */\n\nReceiver.prototype.unmask = function (mask, buf, binary) {\n  if (mask != null && buf != null) bufferUtil.unmask(buf, mask);\n  if (binary) return buf;\n  return buf != null ? buf.toString('utf8') : '';\n};\n\n/**\n * Concatenates a list of buffers.\n *\n * @api private\n */\n\nReceiver.prototype.concatBuffers = function(buffers) {\n  var length = 0;\n  for (var i = 0, l = buffers.length; i < l; ++i) length += buffers[i].length;\n  var mergedBuffer = new Buffer(length);\n  bufferUtil.merge(mergedBuffer, buffers);\n  return mergedBuffer;\n};\n\n/**\n * Handles an error\n *\n * @api private\n */\n\nReceiver.prototype.error = function (reason, protocolErrorCode) {\n  this.reset();\n  this.onerror(reason, protocolErrorCode);\n  return this;\n};\n\n/**\n * Execute message handler buffers\n *\n * @api private\n */\n\nReceiver.prototype.flush = function() {\n  if (this.processing || this.dead) return;\n\n  var handler = this.messageHandlers.shift();\n  if (!handler) return;\n\n  this.processing = true;\n  var self = this;\n\n  handler(function() {\n    self.processing = false;\n    self.flush();\n  });\n};\n\n/**\n * Apply extensions to message\n *\n * @api private\n */\n\nReceiver.prototype.applyExtensions = function(messageBuffer, fin, compressed, callback) {\n  var self = this;\n  if (compressed) {\n    this.extensions[PerMessageDeflate.extensionName].decompress(messageBuffer, fin, function(err, buffer) {\n      if (self.dead) return;\n      if (err) {\n        callback(new Error('invalid compressed data'));\n        return;\n      }\n      callback(null, buffer);\n    });\n  } else {\n    callback(null, messageBuffer);\n  }\n};\n\n/**\n * Buffer utilities\n */\n\nfunction readUInt16BE(start) {\n  return (this[start]<<8) +\n         this[start+1];\n}\n\nfunction readUInt32BE(start) {\n  return (this[start]<<24) +\n         (this[start+1]<<16) +\n         (this[start+2]<<8) +\n         this[start+3];\n}\n\nfunction fastCopy(length, srcBuffer, dstBuffer, dstOffset) {\n  switch (length) {\n    default: srcBuffer.copy(dstBuffer, dstOffset, 0, length); break;\n    case 16: dstBuffer[dstOffset+15] = srcBuffer[15];\n    case 15: dstBuffer[dstOffset+14] = srcBuffer[14];\n    case 14: dstBuffer[dstOffset+13] = srcBuffer[13];\n    case 13: dstBuffer[dstOffset+12] = srcBuffer[12];\n    case 12: dstBuffer[dstOffset+11] = srcBuffer[11];\n    case 11: dstBuffer[dstOffset+10] = srcBuffer[10];\n    case 10: dstBuffer[dstOffset+9] = srcBuffer[9];\n    case 9: dstBuffer[dstOffset+8] = srcBuffer[8];\n    case 8: dstBuffer[dstOffset+7] = srcBuffer[7];\n    case 7: dstBuffer[dstOffset+6] = srcBuffer[6];\n    case 6: dstBuffer[dstOffset+5] = srcBuffer[5];\n    case 5: dstBuffer[dstOffset+4] = srcBuffer[4];\n    case 4: dstBuffer[dstOffset+3] = srcBuffer[3];\n    case 3: dstBuffer[dstOffset+2] = srcBuffer[2];\n    case 2: dstBuffer[dstOffset+1] = srcBuffer[1];\n    case 1: dstBuffer[dstOffset] = srcBuffer[0];\n  }\n}\n\nfunction clone(obj) {\n  var cloned = {};\n  for (var k in obj) {\n    if (obj.hasOwnProperty(k)) {\n      cloned[k] = obj[k];\n    }\n  }\n  return cloned;\n}\n\n/**\n * Opcode handlers\n */\n\nvar opcodes = {\n  // text\n  '1': {\n    start: function(data) {\n      var self = this;\n      // decode length\n      var firstLength = data[1] & 0x7f;\n      if (firstLength < 126) {\n        opcodes['1'].getData.call(self, firstLength);\n      }\n      else if (firstLength == 126) {\n        self.expectHeader(2, function(data) {\n          opcodes['1'].getData.call(self, readUInt16BE.call(data, 0));\n        });\n      }\n      else if (firstLength == 127) {\n        self.expectHeader(8, function(data) {\n          if (readUInt32BE.call(data, 0) != 0) {\n            self.error('packets with length spanning more than 32 bit is currently not supported', 1008);\n            return;\n          }\n          opcodes['1'].getData.call(self, readUInt32BE.call(data, 4));\n        });\n      }\n    },\n    getData: function(length) {\n      var self = this;\n      if (self.state.masked) {\n        self.expectHeader(4, function(data) {\n          var mask = data;\n          self.expectData(length, function(data) {\n            opcodes['1'].finish.call(self, mask, data);\n          });\n        });\n      }\n      else {\n        self.expectData(length, function(data) {\n          opcodes['1'].finish.call(self, null, data);\n        });\n      }\n    },\n    finish: function(mask, data) {\n      var self = this;\n      var packet = this.unmask(mask, data, true) || new Buffer(0);\n      var state = clone(this.state);\n      this.messageHandlers.push(function(callback) {\n        self.applyExtensions(packet, state.lastFragment, state.compressed, function(err, buffer) {\n          if (err) return self.error(err.message, 1007);\n          if (buffer != null) self.currentMessage.push(buffer);\n\n          if (state.lastFragment) {\n            var messageBuffer = self.concatBuffers(self.currentMessage);\n            self.currentMessage = [];\n            if (!Validation.isValidUTF8(messageBuffer)) {\n              self.error('invalid utf8 sequence', 1007);\n              return;\n            }\n            self.ontext(messageBuffer.toString('utf8'), {masked: state.masked, buffer: messageBuffer});\n          }\n          callback();\n        });\n      });\n      this.flush();\n      this.endPacket();\n    }\n  },\n  // binary\n  '2': {\n    start: function(data) {\n      var self = this;\n      // decode length\n      var firstLength = data[1] & 0x7f;\n      if (firstLength < 126) {\n        opcodes['2'].getData.call(self, firstLength);\n      }\n      else if (firstLength == 126) {\n        self.expectHeader(2, function(data) {\n          opcodes['2'].getData.call(self, readUInt16BE.call(data, 0));\n        });\n      }\n      else if (firstLength == 127) {\n        self.expectHeader(8, function(data) {\n          if (readUInt32BE.call(data, 0) != 0) {\n            self.error('packets with length spanning more than 32 bit is currently not supported', 1008);\n            return;\n          }\n          opcodes['2'].getData.call(self, readUInt32BE.call(data, 4, true));\n        });\n      }\n    },\n    getData: function(length) {\n      var self = this;\n      if (self.state.masked) {\n        self.expectHeader(4, function(data) {\n          var mask = data;\n          self.expectData(length, function(data) {\n            opcodes['2'].finish.call(self, mask, data);\n          });\n        });\n      }\n      else {\n        self.expectData(length, function(data) {\n          opcodes['2'].finish.call(self, null, data);\n        });\n      }\n    },\n    finish: function(mask, data) {\n      var self = this;\n      var packet = this.unmask(mask, data, true) || new Buffer(0);\n      var state = clone(this.state);\n      this.messageHandlers.push(function(callback) {\n        self.applyExtensions(packet, state.lastFragment, state.compressed, function(err, buffer) {\n          if (err) return self.error(err.message, 1007);\n          if (buffer != null) self.currentMessage.push(buffer);\n          if (state.lastFragment) {\n            var messageBuffer = self.concatBuffers(self.currentMessage);\n            self.currentMessage = [];\n            self.onbinary(messageBuffer, {masked: state.masked, buffer: messageBuffer});\n          }\n          callback();\n        });\n      });\n      this.flush();\n      this.endPacket();\n    }\n  },\n  // close\n  '8': {\n    start: function(data) {\n      var self = this;\n      if (self.state.lastFragment == false) {\n        self.error('fragmented close is not supported', 1002);\n        return;\n      }\n\n      // decode length\n      var firstLength = data[1] & 0x7f;\n      if (firstLength < 126) {\n        opcodes['8'].getData.call(self, firstLength);\n      }\n      else {\n        self.error('control frames cannot have more than 125 bytes of data', 1002);\n      }\n    },\n    getData: function(length) {\n      var self = this;\n      if (self.state.masked) {\n        self.expectHeader(4, function(data) {\n          var mask = data;\n          self.expectData(length, function(data) {\n            opcodes['8'].finish.call(self, mask, data);\n          });\n        });\n      }\n      else {\n        self.expectData(length, function(data) {\n          opcodes['8'].finish.call(self, null, data);\n        });\n      }\n    },\n    finish: function(mask, data) {\n      var self = this;\n      data = self.unmask(mask, data, true);\n\n      var state = clone(this.state);\n      this.messageHandlers.push(function() {\n        if (data && data.length == 1) {\n          self.error('close packets with data must be at least two bytes long', 1002);\n          return;\n        }\n        var code = data && data.length > 1 ? readUInt16BE.call(data, 0) : 1000;\n        if (!ErrorCodes.isValidErrorCode(code)) {\n          self.error('invalid error code', 1002);\n          return;\n        }\n        var message = '';\n        if (data && data.length > 2) {\n          var messageBuffer = data.slice(2);\n          if (!Validation.isValidUTF8(messageBuffer)) {\n            self.error('invalid utf8 sequence', 1007);\n            return;\n          }\n          message = messageBuffer.toString('utf8');\n        }\n        self.onclose(code, message, {masked: state.masked});\n        self.reset();\n      });\n      this.flush();\n    },\n  },\n  // ping\n  '9': {\n    start: function(data) {\n      var self = this;\n      if (self.state.lastFragment == false) {\n        self.error('fragmented ping is not supported', 1002);\n        return;\n      }\n\n      // decode length\n      var firstLength = data[1] & 0x7f;\n      if (firstLength < 126) {\n        opcodes['9'].getData.call(self, firstLength);\n      }\n      else {\n        self.error('control frames cannot have more than 125 bytes of data', 1002);\n      }\n    },\n    getData: function(length) {\n      var self = this;\n      if (self.state.masked) {\n        self.expectHeader(4, function(data) {\n          var mask = data;\n          self.expectData(length, function(data) {\n            opcodes['9'].finish.call(self, mask, data);\n          });\n        });\n      }\n      else {\n        self.expectData(length, function(data) {\n          opcodes['9'].finish.call(self, null, data);\n        });\n      }\n    },\n    finish: function(mask, data) {\n      var self = this;\n      data = this.unmask(mask, data, true);\n      var state = clone(this.state);\n      this.messageHandlers.push(function(callback) {\n        self.onping(data, {masked: state.masked, binary: true});\n        callback();\n      });\n      this.flush();\n      this.endPacket();\n    }\n  },\n  // pong\n  '10': {\n    start: function(data) {\n      var self = this;\n      if (self.state.lastFragment == false) {\n        self.error('fragmented pong is not supported', 1002);\n        return;\n      }\n\n      // decode length\n      var firstLength = data[1] & 0x7f;\n      if (firstLength < 126) {\n        opcodes['10'].getData.call(self, firstLength);\n      }\n      else {\n        self.error('control frames cannot have more than 125 bytes of data', 1002);\n      }\n    },\n    getData: function(length) {\n      var self = this;\n      if (this.state.masked) {\n        this.expectHeader(4, function(data) {\n          var mask = data;\n          self.expectData(length, function(data) {\n            opcodes['10'].finish.call(self, mask, data);\n          });\n        });\n      }\n      else {\n        this.expectData(length, function(data) {\n          opcodes['10'].finish.call(self, null, data);\n        });\n      }\n    },\n    finish: function(mask, data) {\n      var self = this;\n      data = self.unmask(mask, data, true);\n      var state = clone(this.state);\n      this.messageHandlers.push(function(callback) {\n        self.onpong(data, {masked: state.masked, binary: true});\n        callback();\n      });\n      this.flush();\n      this.endPacket();\n    }\n  }\n}\n\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar events = __webpack_require__(6)\n  , util = __webpack_require__(3)\n  , EventEmitter = events.EventEmitter\n  , ErrorCodes = __webpack_require__(18)\n  , bufferUtil = __webpack_require__(17).BufferUtil\n  , PerMessageDeflate = __webpack_require__(5);\n\n/**\n * HyBi Sender implementation\n */\n\nfunction Sender(socket, extensions) {\n  events.EventEmitter.call(this);\n\n  this._socket = socket;\n  this.extensions = extensions || {};\n  this.firstFragment = true;\n  this.compress = false;\n  this.messageHandlers = [];\n  this.processing = false;\n}\n\n/**\n * Inherits from EventEmitter.\n */\n\nutil.inherits(Sender, events.EventEmitter);\n\n/**\n * Sends a close instruction to the remote party.\n *\n * @api public\n */\n\nSender.prototype.close = function(code, data, mask, cb) {\n  if (typeof code !== 'undefined') {\n    if (typeof code !== 'number' ||\n      !ErrorCodes.isValidErrorCode(code)) throw new Error('first argument must be a valid error code number');\n  }\n  code = code || 1000;\n  var dataBuffer = new Buffer(2 + (data ? Buffer.byteLength(data) : 0));\n  writeUInt16BE.call(dataBuffer, code, 0);\n  if (dataBuffer.length > 2) dataBuffer.write(data, 2);\n\n  var self = this;\n  this.messageHandlers.push(function(callback) {\n    self.frameAndSend(0x8, dataBuffer, true, mask);\n    callback();\n    if (typeof cb == 'function') cb();\n  });\n  this.flush();\n};\n\n/**\n * Sends a ping message to the remote party.\n *\n * @api public\n */\n\nSender.prototype.ping = function(data, options) {\n  var mask = options && options.mask;\n  var self = this;\n  this.messageHandlers.push(function(callback) {\n    self.frameAndSend(0x9, data || '', true, mask);\n    callback();\n  });\n  this.flush();\n};\n\n/**\n * Sends a pong message to the remote party.\n *\n * @api public\n */\n\nSender.prototype.pong = function(data, options) {\n  var mask = options && options.mask;\n  var self = this;\n  this.messageHandlers.push(function(callback) {\n    self.frameAndSend(0xa, data || '', true, mask);\n    callback();\n  });\n  this.flush();\n};\n\n/**\n * Sends text or binary data to the remote party.\n *\n * @api public\n */\n\nSender.prototype.send = function(data, options, cb) {\n  var finalFragment = options && options.fin === false ? false : true;\n  var mask = options && options.mask;\n  var compress = options && options.compress;\n  var opcode = options && options.binary ? 2 : 1;\n  if (this.firstFragment === false) {\n    opcode = 0;\n    compress = false;\n  } else {\n    this.firstFragment = false;\n    this.compress = compress;\n  }\n  if (finalFragment) this.firstFragment = true\n\n  var compressFragment = this.compress;\n\n  var self = this;\n  this.messageHandlers.push(function(callback) {\n    self.applyExtensions(data, finalFragment, compressFragment, function(err, data) {\n      if (err) {\n        if (typeof cb == 'function') cb(err);\n        else self.emit('error', err);\n        return;\n      }\n      self.frameAndSend(opcode, data, finalFragment, mask, compress, cb);\n      callback();\n    });\n  });\n  this.flush();\n};\n\n/**\n * Frames and sends a piece of data according to the HyBi WebSocket protocol.\n *\n * @api private\n */\n\nSender.prototype.frameAndSend = function(opcode, data, finalFragment, maskData, compressed, cb) {\n  var canModifyData = false;\n\n  if (!data) {\n    try {\n      this._socket.write(new Buffer([opcode | (finalFragment ? 0x80 : 0), 0 | (maskData ? 0x80 : 0)].concat(maskData ? [0, 0, 0, 0] : [])), 'binary', cb);\n    }\n    catch (e) {\n      if (typeof cb == 'function') cb(e);\n      else this.emit('error', e);\n    }\n    return;\n  }\n\n  if (!Buffer.isBuffer(data)) {\n    canModifyData = true;\n    if (data && (typeof data.byteLength !== 'undefined' || typeof data.buffer !== 'undefined')) {\n      data = getArrayBuffer(data);\n    } else {\n      data = new Buffer(data);\n    }\n  }\n\n  var dataLength = data.length\n    , dataOffset = maskData ? 6 : 2\n    , secondByte = dataLength;\n\n  if (dataLength >= 65536) {\n    dataOffset += 8;\n    secondByte = 127;\n  }\n  else if (dataLength > 125) {\n    dataOffset += 2;\n    secondByte = 126;\n  }\n\n  var mergeBuffers = dataLength < 32768 || (maskData && !canModifyData);\n  var totalLength = mergeBuffers ? dataLength + dataOffset : dataOffset;\n  var outputBuffer = new Buffer(totalLength);\n  outputBuffer[0] = finalFragment ? opcode | 0x80 : opcode;\n  if (compressed) outputBuffer[0] |= 0x40;\n\n  switch (secondByte) {\n    case 126:\n      writeUInt16BE.call(outputBuffer, dataLength, 2);\n      break;\n    case 127:\n      writeUInt32BE.call(outputBuffer, 0, 2);\n      writeUInt32BE.call(outputBuffer, dataLength, 6);\n  }\n\n  if (maskData) {\n    outputBuffer[1] = secondByte | 0x80;\n    var mask = this._randomMask || (this._randomMask = getRandomMask());\n    outputBuffer[dataOffset - 4] = mask[0];\n    outputBuffer[dataOffset - 3] = mask[1];\n    outputBuffer[dataOffset - 2] = mask[2];\n    outputBuffer[dataOffset - 1] = mask[3];\n    if (mergeBuffers) {\n      bufferUtil.mask(data, mask, outputBuffer, dataOffset, dataLength);\n      try {\n        this._socket.write(outputBuffer, 'binary', cb);\n      }\n      catch (e) {\n        if (typeof cb == 'function') cb(e);\n        else this.emit('error', e);\n      }\n    }\n    else {\n      bufferUtil.mask(data, mask, data, 0, dataLength);\n      try {\n        this._socket.write(outputBuffer, 'binary');\n        this._socket.write(data, 'binary', cb);\n      }\n      catch (e) {\n        if (typeof cb == 'function') cb(e);\n        else this.emit('error', e);\n      }\n    }\n  }\n  else {\n    outputBuffer[1] = secondByte;\n    if (mergeBuffers) {\n      data.copy(outputBuffer, dataOffset);\n      try {\n        this._socket.write(outputBuffer, 'binary', cb);\n      }\n      catch (e) {\n        if (typeof cb == 'function') cb(e);\n        else this.emit('error', e);\n      }\n    }\n    else {\n      try {\n        this._socket.write(outputBuffer, 'binary');\n        this._socket.write(data, 'binary', cb);\n      }\n      catch (e) {\n        if (typeof cb == 'function') cb(e);\n        else this.emit('error', e);\n      }\n    }\n  }\n};\n\n/**\n * Execute message handler buffers\n *\n * @api private\n */\n\nSender.prototype.flush = function() {\n  if (this.processing) return;\n\n  var handler = this.messageHandlers.shift();\n  if (!handler) return;\n\n  this.processing = true;\n\n  var self = this;\n\n  handler(function() {\n    self.processing = false;\n    self.flush();\n  });\n};\n\n/**\n * Apply extensions to message\n *\n * @api private\n */\n\nSender.prototype.applyExtensions = function(data, fin, compress, callback) {\n  if (compress && data) {\n    this.extensions[PerMessageDeflate.extensionName].compress(data, fin, callback);\n  } else {\n    callback(null, data);\n  }\n};\n\nmodule.exports = Sender;\n\nfunction writeUInt16BE(value, offset) {\n  this[offset] = (value & 0xff00)>>8;\n  this[offset+1] = value & 0xff;\n}\n\nfunction writeUInt32BE(value, offset) {\n  this[offset] = (value & 0xff000000)>>24;\n  this[offset+1] = (value & 0xff0000)>>16;\n  this[offset+2] = (value & 0xff00)>>8;\n  this[offset+3] = value & 0xff;\n}\n\nfunction getArrayBuffer(data) {\n  // data is either an ArrayBuffer or ArrayBufferView.\n  var array = new Uint8Array(data.buffer || data)\n    , l = data.byteLength || data.length\n    , o = data.byteOffset || 0\n    , buffer = new Buffer(l);\n  for (var i = 0; i < l; ++i) {\n    buffer[i] = array[o+i];\n  }\n  return buffer;\n}\n\nfunction getRandomMask() {\n  return new Buffer([\n    ~~(Math.random() * 255),\n    ~~(Math.random() * 255),\n    ~~(Math.random() * 255),\n    ~~(Math.random() * 255)\n  ]);\n}\n\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar url = __webpack_require__(29)\n  , util = __webpack_require__(3)\n  , http = __webpack_require__(28)\n  , https = __webpack_require__(115)\n  , crypto = __webpack_require__(12)\n  , stream = __webpack_require__(117)\n  , Ultron = __webpack_require__(42)\n  , Options = __webpack_require__(16)\n  , Sender = __webpack_require__(21)\n  , Receiver = __webpack_require__(20)\n  , SenderHixie = __webpack_require__(49)\n  , ReceiverHixie = __webpack_require__(48)\n  , Extensions = __webpack_require__(19)\n  , PerMessageDeflate = __webpack_require__(5)\n  , EventEmitter = __webpack_require__(6).EventEmitter;\n\n/**\n * Constants\n */\n\n// Default protocol version\n\nvar protocolVersion = 13;\n\n// Close timeout\n\nvar closeTimeout = 30 * 1000; // Allow 30 seconds to terminate the connection cleanly\n\n/**\n * WebSocket implementation\n *\n * @constructor\n * @param {String} address Connection address.\n * @param {String|Array} protocols WebSocket protocols.\n * @param {Object} options Additional connection options.\n * @api public\n */\nfunction WebSocket(address, protocols, options) {\n  EventEmitter.call(this);\n\n  if (protocols && !Array.isArray(protocols) && 'object' === typeof protocols) {\n    // accept the \"options\" Object as the 2nd argument\n    options = protocols;\n    protocols = null;\n  }\n\n  if ('string' === typeof protocols) {\n    protocols = [ protocols ];\n  }\n\n  if (!Array.isArray(protocols)) {\n    protocols = [];\n  }\n\n  this._socket = null;\n  this._ultron = null;\n  this._closeReceived = false;\n  this.bytesReceived = 0;\n  this.readyState = null;\n  this.supports = {};\n  this.extensions = {};\n\n  if (Array.isArray(address)) {\n    initAsServerClient.apply(this, address.concat(options));\n  } else {\n    initAsClient.apply(this, [address, protocols, options]);\n  }\n}\n\n/**\n * Inherits from EventEmitter.\n */\nutil.inherits(WebSocket, EventEmitter);\n\n/**\n * Ready States\n */\n[\"CONNECTING\", \"OPEN\", \"CLOSING\", \"CLOSED\"].forEach(function each(state, index) {\n    WebSocket.prototype[state] = WebSocket[state] = index;\n});\n\n/**\n * Gracefully closes the connection, after sending a description message to the server\n *\n * @param {Object} data to be sent to the server\n * @api public\n */\nWebSocket.prototype.close = function close(code, data) {\n  if (this.readyState === WebSocket.CLOSED) return;\n\n  if (this.readyState === WebSocket.CONNECTING) {\n    this.readyState = WebSocket.CLOSED;\n    return;\n  }\n\n  if (this.readyState === WebSocket.CLOSING) {\n    if (this._closeReceived && this._isServer) {\n      this.terminate();\n    }\n    return;\n  }\n\n  var self = this;\n  try {\n    this.readyState = WebSocket.CLOSING;\n    this._closeCode = code;\n    this._closeMessage = data;\n    var mask = !this._isServer;\n    this._sender.close(code, data, mask, function(err) {\n      if (err) self.emit('error', err);\n\n      if (self._closeReceived && self._isServer) {\n        self.terminate();\n      } else {\n        // ensure that the connection is cleaned up even when no response of closing handshake.\n        clearTimeout(self._closeTimer);\n        self._closeTimer = setTimeout(cleanupWebsocketResources.bind(self, true), closeTimeout);\n      }\n    });\n  } catch (e) {\n    this.emit('error', e);\n  }\n};\n\n/**\n * Pause the client stream\n *\n * @api public\n */\nWebSocket.prototype.pause = function pauser() {\n  if (this.readyState !== WebSocket.OPEN) throw new Error('not opened');\n\n  return this._socket.pause();\n};\n\n/**\n * Sends a ping\n *\n * @param {Object} data to be sent to the server\n * @param {Object} Members - mask: boolean, binary: boolean\n * @param {boolean} dontFailWhenClosed indicates whether or not to throw if the connection isnt open\n * @api public\n */\nWebSocket.prototype.ping = function ping(data, options, dontFailWhenClosed) {\n  if (this.readyState !== WebSocket.OPEN) {\n    if (dontFailWhenClosed === true) return;\n    throw new Error('not opened');\n  }\n\n  options = options || {};\n\n  if (typeof options.mask === 'undefined') options.mask = !this._isServer;\n\n  this._sender.ping(data, options);\n};\n\n/**\n * Sends a pong\n *\n * @param {Object} data to be sent to the server\n * @param {Object} Members - mask: boolean, binary: boolean\n * @param {boolean} dontFailWhenClosed indicates whether or not to throw if the connection isnt open\n * @api public\n */\nWebSocket.prototype.pong = function(data, options, dontFailWhenClosed) {\n  if (this.readyState !== WebSocket.OPEN) {\n    if (dontFailWhenClosed === true) return;\n    throw new Error('not opened');\n  }\n\n  options = options || {};\n\n  if (typeof options.mask === 'undefined') options.mask = !this._isServer;\n\n  this._sender.pong(data, options);\n};\n\n/**\n * Resume the client stream\n *\n * @api public\n */\nWebSocket.prototype.resume = function resume() {\n  if (this.readyState !== WebSocket.OPEN) throw new Error('not opened');\n\n  return this._socket.resume();\n};\n\n/**\n * Sends a piece of data\n *\n * @param {Object} data to be sent to the server\n * @param {Object} Members - mask: boolean, binary: boolean, compress: boolean\n * @param {function} Optional callback which is executed after the send completes\n * @api public\n */\n\nWebSocket.prototype.send = function send(data, options, cb) {\n  if (typeof options === 'function') {\n    cb = options;\n    options = {};\n  }\n\n  if (this.readyState !== WebSocket.OPEN) {\n    if (typeof cb === 'function') cb(new Error('not opened'));\n    else throw new Error('not opened');\n    return;\n  }\n\n  if (!data) data = '';\n  if (this._queue) {\n    var self = this;\n    this._queue.push(function() { self.send(data, options, cb); });\n    return;\n  }\n\n  options = options || {};\n  options.fin = true;\n\n  if (typeof options.binary === 'undefined') {\n    options.binary = (data instanceof ArrayBuffer || data instanceof Buffer ||\n      data instanceof Uint8Array ||\n      data instanceof Uint16Array ||\n      data instanceof Uint32Array ||\n      data instanceof Int8Array ||\n      data instanceof Int16Array ||\n      data instanceof Int32Array ||\n      data instanceof Float32Array ||\n      data instanceof Float64Array);\n  }\n\n  if (typeof options.mask === 'undefined') options.mask = !this._isServer;\n  if (typeof options.compress === 'undefined') options.compress = true;\n  if (!this.extensions[PerMessageDeflate.extensionName]) {\n    options.compress = false;\n  }\n\n  var readable = typeof stream.Readable === 'function'\n    ? stream.Readable\n    : stream.Stream;\n\n  if (data instanceof readable) {\n    startQueue(this);\n    var self = this;\n\n    sendStream(this, data, options, function send(error) {\n      process.nextTick(function tock() {\n        executeQueueSends(self);\n      });\n\n      if (typeof cb === 'function') cb(error);\n    });\n  } else {\n    this._sender.send(data, options, cb);\n  }\n};\n\n/**\n * Streams data through calls to a user supplied function\n *\n * @param {Object} Members - mask: boolean, binary: boolean, compress: boolean\n * @param {function} 'function (error, send)' which is executed on successive ticks of which send is 'function (data, final)'.\n * @api public\n */\nWebSocket.prototype.stream = function stream(options, cb) {\n  if (typeof options === 'function') {\n    cb = options;\n    options = {};\n  }\n\n  var self = this;\n\n  if (typeof cb !== 'function') throw new Error('callback must be provided');\n\n  if (this.readyState !== WebSocket.OPEN) {\n    if (typeof cb === 'function') cb(new Error('not opened'));\n    else throw new Error('not opened');\n    return;\n  }\n\n  if (this._queue) {\n    this._queue.push(function () { self.stream(options, cb); });\n    return;\n  }\n\n  options = options || {};\n\n  if (typeof options.mask === 'undefined') options.mask = !this._isServer;\n  if (typeof options.compress === 'undefined') options.compress = true;\n  if (!this.extensions[PerMessageDeflate.extensionName]) {\n    options.compress = false;\n  }\n\n  startQueue(this);\n\n  function send(data, final) {\n    try {\n      if (self.readyState !== WebSocket.OPEN) throw new Error('not opened');\n      options.fin = final === true;\n      self._sender.send(data, options);\n      if (!final) process.nextTick(cb.bind(null, null, send));\n      else executeQueueSends(self);\n    } catch (e) {\n      if (typeof cb === 'function') cb(e);\n      else {\n        delete self._queue;\n        self.emit('error', e);\n      }\n    }\n  }\n\n  process.nextTick(cb.bind(null, null, send));\n};\n\n/**\n * Immediately shuts down the connection\n *\n * @api public\n */\nWebSocket.prototype.terminate = function terminate() {\n  if (this.readyState === WebSocket.CLOSED) return;\n\n  if (this._socket) {\n    this.readyState = WebSocket.CLOSING;\n\n    // End the connection\n    try { this._socket.end(); }\n    catch (e) {\n      // Socket error during end() call, so just destroy it right now\n      cleanupWebsocketResources.call(this, true);\n      return;\n    }\n\n    // Add a timeout to ensure that the connection is completely\n    // cleaned up within 30 seconds, even if the clean close procedure\n    // fails for whatever reason\n    // First cleanup any pre-existing timeout from an earlier \"terminate\" call,\n    // if one exists.  Otherwise terminate calls in quick succession will leak timeouts\n    // and hold the program open for `closeTimout` time.\n    if (this._closeTimer) { clearTimeout(this._closeTimer); }\n    this._closeTimer = setTimeout(cleanupWebsocketResources.bind(this, true), closeTimeout);\n  } else if (this.readyState === WebSocket.CONNECTING) {\n    cleanupWebsocketResources.call(this, true);\n  }\n};\n\n/**\n * Expose bufferedAmount\n *\n * @api public\n */\nObject.defineProperty(WebSocket.prototype, 'bufferedAmount', {\n  get: function get() {\n    var amount = 0;\n    if (this._socket) {\n      amount = this._socket.bufferSize || 0;\n    }\n    return amount;\n  }\n});\n\n/**\n * Emulates the W3C Browser based WebSocket interface using function members.\n *\n * @see http://dev.w3.org/html5/websockets/#the-websocket-interface\n * @api public\n */\n['open', 'error', 'close', 'message'].forEach(function(method) {\n  Object.defineProperty(WebSocket.prototype, 'on' + method, {\n    /**\n     * Returns the current listener\n     *\n     * @returns {Mixed} the set function or undefined\n     * @api public\n     */\n    get: function get() {\n      var listener = this.listeners(method)[0];\n      return listener ? (listener._listener ? listener._listener : listener) : undefined;\n    },\n\n    /**\n     * Start listening for events\n     *\n     * @param {Function} listener the listener\n     * @returns {Mixed} the set function or undefined\n     * @api public\n     */\n    set: function set(listener) {\n      this.removeAllListeners(method);\n      this.addEventListener(method, listener);\n    }\n  });\n});\n\n/**\n * Emulates the W3C Browser based WebSocket interface using addEventListener.\n *\n * @see https://developer.mozilla.org/en/DOM/element.addEventListener\n * @see http://dev.w3.org/html5/websockets/#the-websocket-interface\n * @api public\n */\nWebSocket.prototype.addEventListener = function(method, listener) {\n  var target = this;\n\n  function onMessage (data, flags) {\n    listener.call(target, new MessageEvent(data, flags.binary ? 'Binary' : 'Text', target));\n  }\n\n  function onClose (code, message) {\n    listener.call(target, new CloseEvent(code, message, target));\n  }\n\n  function onError (event) {\n    event.target = target;\n    listener.call(target, event);\n  }\n\n  function onOpen () {\n    listener.call(target, new OpenEvent(target));\n  }\n\n  if (typeof listener === 'function') {\n    if (method === 'message') {\n      // store a reference so we can return the original function from the\n      // addEventListener hook\n      onMessage._listener = listener;\n      this.on(method, onMessage);\n    } else if (method === 'close') {\n      // store a reference so we can return the original function from the\n      // addEventListener hook\n      onClose._listener = listener;\n      this.on(method, onClose);\n    } else if (method === 'error') {\n      // store a reference so we can return the original function from the\n      // addEventListener hook\n      onError._listener = listener;\n      this.on(method, onError);\n    } else if (method === 'open') {\n      // store a reference so we can return the original function from the\n      // addEventListener hook\n      onOpen._listener = listener;\n      this.on(method, onOpen);\n    } else {\n      this.on(method, listener);\n    }\n  }\n};\n\nmodule.exports = WebSocket;\n\n/**\n * W3C MessageEvent\n *\n * @see http://www.w3.org/TR/html5/comms.html\n * @constructor\n * @api private\n */\nfunction MessageEvent(dataArg, typeArg, target) {\n  this.data = dataArg;\n  this.type = typeArg;\n  this.target = target;\n}\n\n/**\n * W3C CloseEvent\n *\n * @see http://www.w3.org/TR/html5/comms.html\n * @constructor\n * @api private\n */\nfunction CloseEvent(code, reason, target) {\n  this.wasClean = (typeof code === 'undefined' || code === 1000);\n  this.code = code;\n  this.reason = reason;\n  this.target = target;\n}\n\n/**\n * W3C OpenEvent\n *\n * @see http://www.w3.org/TR/html5/comms.html\n * @constructor\n * @api private\n */\nfunction OpenEvent(target) {\n  this.target = target;\n}\n\n/**\n * Entirely private apis,\n * which may or may not be bound to a sepcific WebSocket instance.\n */\nfunction initAsServerClient(req, socket, upgradeHead, options) {\n  options = new Options({\n    protocolVersion: protocolVersion,\n    protocol: null,\n    extensions: {}\n  }).merge(options);\n\n  // expose state properties\n  this.protocol = options.value.protocol;\n  this.protocolVersion = options.value.protocolVersion;\n  this.extensions = options.value.extensions;\n  this.supports.binary = (this.protocolVersion !== 'hixie-76');\n  this.upgradeReq = req;\n  this.readyState = WebSocket.CONNECTING;\n  this._isServer = true;\n\n  // establish connection\n  if (options.value.protocolVersion === 'hixie-76') {\n    establishConnection.call(this, ReceiverHixie, SenderHixie, socket, upgradeHead);\n  } else {\n    establishConnection.call(this, Receiver, Sender, socket, upgradeHead);\n  }\n}\n\nfunction initAsClient(address, protocols, options) {\n  options = new Options({\n    origin: null,\n    protocolVersion: protocolVersion,\n    host: null,\n    headers: null,\n    protocol: protocols.join(','),\n    agent: null,\n\n    // ssl-related options\n    pfx: null,\n    key: null,\n    passphrase: null,\n    cert: null,\n    ca: null,\n    ciphers: null,\n    rejectUnauthorized: null,\n    perMessageDeflate: true\n  }).merge(options);\n\n  if (options.value.protocolVersion !== 8 && options.value.protocolVersion !== 13) {\n    throw new Error('unsupported protocol version');\n  }\n\n  // verify URL and establish http class\n  var serverUrl = url.parse(address);\n  var isUnixSocket = serverUrl.protocol === 'ws+unix:';\n  if (!serverUrl.host && !isUnixSocket) throw new Error('invalid url');\n  var isSecure = serverUrl.protocol === 'wss:' || serverUrl.protocol === 'https:';\n  var httpObj = isSecure ? https : http;\n  var port = serverUrl.port || (isSecure ? 443 : 80);\n  var auth = serverUrl.auth;\n\n  // prepare extensions\n  var extensionsOffer = {};\n  var perMessageDeflate;\n  if (options.value.perMessageDeflate) {\n    perMessageDeflate = new PerMessageDeflate(typeof options.value.perMessageDeflate !== true ? options.value.perMessageDeflate : {}, false);\n    extensionsOffer[PerMessageDeflate.extensionName] = perMessageDeflate.offer();\n  }\n\n  // expose state properties\n  this._isServer = false;\n  this.url = address;\n  this.protocolVersion = options.value.protocolVersion;\n  this.supports.binary = (this.protocolVersion !== 'hixie-76');\n\n  // begin handshake\n  var key = new Buffer(options.value.protocolVersion + '-' + Date.now()).toString('base64');\n  var shasum = crypto.createHash('sha1');\n  shasum.update(key + '258EAFA5-E914-47DA-95CA-C5AB0DC85B11');\n  var expectedServerKey = shasum.digest('base64');\n\n  var agent = options.value.agent;\n\n  var headerHost = serverUrl.hostname;\n  // Append port number to Host header, only if specified in the url\n  // and non-default\n  if (serverUrl.port) {\n    if ((isSecure && (port !== 443)) || (!isSecure && (port !== 80))){\n      headerHost = headerHost + ':' + port;\n    }\n  }\n\n  var requestOptions = {\n    port: port,\n    host: serverUrl.hostname,\n    headers: {\n      'Connection': 'Upgrade',\n      'Upgrade': 'websocket',\n      'Host': headerHost,\n      'Sec-WebSocket-Version': options.value.protocolVersion,\n      'Sec-WebSocket-Key': key\n    }\n  };\n\n  // If we have basic auth.\n  if (auth) {\n    requestOptions.headers.Authorization = 'Basic ' + new Buffer(auth).toString('base64');\n  }\n\n  if (options.value.protocol) {\n    requestOptions.headers['Sec-WebSocket-Protocol'] = options.value.protocol;\n  }\n\n  if (options.value.host) {\n    requestOptions.headers.Host = options.value.host;\n  }\n\n  if (options.value.headers) {\n    for (var header in options.value.headers) {\n       if (options.value.headers.hasOwnProperty(header)) {\n        requestOptions.headers[header] = options.value.headers[header];\n       }\n    }\n  }\n\n  if (Object.keys(extensionsOffer).length) {\n    requestOptions.headers['Sec-WebSocket-Extensions'] = Extensions.format(extensionsOffer);\n  }\n\n  if (options.isDefinedAndNonNull('pfx')\n   || options.isDefinedAndNonNull('key')\n   || options.isDefinedAndNonNull('passphrase')\n   || options.isDefinedAndNonNull('cert')\n   || options.isDefinedAndNonNull('ca')\n   || options.isDefinedAndNonNull('ciphers')\n   || options.isDefinedAndNonNull('rejectUnauthorized')) {\n\n    if (options.isDefinedAndNonNull('pfx')) requestOptions.pfx = options.value.pfx;\n    if (options.isDefinedAndNonNull('key')) requestOptions.key = options.value.key;\n    if (options.isDefinedAndNonNull('passphrase')) requestOptions.passphrase = options.value.passphrase;\n    if (options.isDefinedAndNonNull('cert')) requestOptions.cert = options.value.cert;\n    if (options.isDefinedAndNonNull('ca')) requestOptions.ca = options.value.ca;\n    if (options.isDefinedAndNonNull('ciphers')) requestOptions.ciphers = options.value.ciphers;\n    if (options.isDefinedAndNonNull('rejectUnauthorized')) requestOptions.rejectUnauthorized = options.value.rejectUnauthorized;\n\n    if (!agent) {\n        // global agent ignores client side certificates\n        agent = new httpObj.Agent(requestOptions);\n    }\n  }\n\n  requestOptions.path = serverUrl.path || '/';\n\n  if (agent) {\n    requestOptions.agent = agent;\n  }\n\n  if (isUnixSocket) {\n    requestOptions.socketPath = serverUrl.pathname;\n  }\n  if (options.value.origin) {\n    if (options.value.protocolVersion < 13) requestOptions.headers['Sec-WebSocket-Origin'] = options.value.origin;\n    else requestOptions.headers.Origin = options.value.origin;\n  }\n\n  var self = this;\n  var req = httpObj.request(requestOptions);\n\n  req.on('error', function onerror(error) {\n    self.emit('error', error);\n    cleanupWebsocketResources.call(self, error);\n  });\n\n  req.once('response', function response(res) {\n    var error;\n\n    if (!self.emit('unexpected-response', req, res)) {\n      error = new Error('unexpected server response (' + res.statusCode + ')');\n      req.abort();\n      self.emit('error', error);\n    }\n\n    cleanupWebsocketResources.call(self, error);\n  });\n\n  req.once('upgrade', function upgrade(res, socket, upgradeHead) {\n    if (self.readyState === WebSocket.CLOSED) {\n      // client closed before server accepted connection\n      self.emit('close');\n      self.removeAllListeners();\n      socket.end();\n      return;\n    }\n\n    var serverKey = res.headers['sec-websocket-accept'];\n    if (typeof serverKey === 'undefined' || serverKey !== expectedServerKey) {\n      self.emit('error', 'invalid server key');\n      self.removeAllListeners();\n      socket.end();\n      return;\n    }\n\n    var serverProt = res.headers['sec-websocket-protocol'];\n    var protList = (options.value.protocol || \"\").split(/, */);\n    var protError = null;\n\n    if (!options.value.protocol && serverProt) {\n      protError = 'server sent a subprotocol even though none requested';\n    } else if (options.value.protocol && !serverProt) {\n      protError = 'server sent no subprotocol even though requested';\n    } else if (serverProt && protList.indexOf(serverProt) === -1) {\n      protError = 'server responded with an invalid protocol';\n    }\n\n    if (protError) {\n      self.emit('error', protError);\n      self.removeAllListeners();\n      socket.end();\n      return;\n    } else if (serverProt) {\n      self.protocol = serverProt;\n    }\n\n    var serverExtensions = Extensions.parse(res.headers['sec-websocket-extensions']);\n    if (perMessageDeflate && serverExtensions[PerMessageDeflate.extensionName]) {\n      try {\n        perMessageDeflate.accept(serverExtensions[PerMessageDeflate.extensionName]);\n      } catch (err) {\n        self.emit('error', 'invalid extension parameter');\n        self.removeAllListeners();\n        socket.end();\n        return;\n      }\n      self.extensions[PerMessageDeflate.extensionName] = perMessageDeflate;\n    }\n\n    establishConnection.call(self, Receiver, Sender, socket, upgradeHead);\n\n    // perform cleanup on http resources\n    req.removeAllListeners();\n    req = null;\n    agent = null;\n  });\n\n  req.end();\n  this.readyState = WebSocket.CONNECTING;\n}\n\nfunction establishConnection(ReceiverClass, SenderClass, socket, upgradeHead) {\n  var ultron = this._ultron = new Ultron(socket);\n  this._socket = socket;\n\n  socket.setTimeout(0);\n  socket.setNoDelay(true);\n  var self = this;\n  this._receiver = new ReceiverClass(this.extensions);\n\n  // socket cleanup handlers\n  ultron.on('end', cleanupWebsocketResources.bind(this));\n  ultron.on('close', cleanupWebsocketResources.bind(this));\n  ultron.on('error', cleanupWebsocketResources.bind(this));\n\n  // ensure that the upgradeHead is added to the receiver\n  function firstHandler(data) {\n    if (self.readyState !== WebSocket.OPEN && self.readyState !== WebSocket.CLOSING) return;\n\n    if (upgradeHead && upgradeHead.length > 0) {\n      self.bytesReceived += upgradeHead.length;\n      var head = upgradeHead;\n      upgradeHead = null;\n      self._receiver.add(head);\n    }\n\n    dataHandler = realHandler;\n\n    if (data) {\n      self.bytesReceived += data.length;\n      self._receiver.add(data);\n    }\n  }\n\n  // subsequent packets are pushed straight to the receiver\n  function realHandler(data) {\n    if (data) self.bytesReceived += data.length;\n    self._receiver.add(data);\n  }\n\n  var dataHandler = firstHandler;\n\n  // if data was passed along with the http upgrade,\n  // this will schedule a push of that on to the receiver.\n  // this has to be done on next tick, since the caller\n  // hasn't had a chance to set event handlers on this client\n  // object yet.\n  process.nextTick(firstHandler);\n\n  // receiver event handlers\n  self._receiver.ontext = function ontext(data, flags) {\n    flags = flags || {};\n\n    self.emit('message', data, flags);\n  };\n\n  self._receiver.onbinary = function onbinary(data, flags) {\n    flags = flags || {};\n\n    flags.binary = true;\n    self.emit('message', data, flags);\n  };\n\n  self._receiver.onping = function onping(data, flags) {\n    flags = flags || {};\n\n    self.pong(data, {\n      mask: !self._isServer,\n      binary: flags.binary === true\n    }, true);\n\n    self.emit('ping', data, flags);\n  };\n\n  self._receiver.onpong = function onpong(data, flags) {\n    self.emit('pong', data, flags || {});\n  };\n\n  self._receiver.onclose = function onclose(code, data, flags) {\n    flags = flags || {};\n\n    self._closeReceived = true;\n    self.close(code, data);\n  };\n\n  self._receiver.onerror = function onerror(reason, errorCode) {\n    // close the connection when the receiver reports a HyBi error code\n    self.close(typeof errorCode !== 'undefined' ? errorCode : 1002, '');\n    self.emit('error', reason, errorCode);\n  };\n\n  // finalize the client\n  this._sender = new SenderClass(socket, this.extensions);\n  this._sender.on('error', function onerror(error) {\n    self.close(1002, '');\n    self.emit('error', error);\n  });\n\n  this.readyState = WebSocket.OPEN;\n  this.emit('open');\n\n  ultron.on('data', dataHandler);\n}\n\nfunction startQueue(instance) {\n  instance._queue = instance._queue || [];\n}\n\nfunction executeQueueSends(instance) {\n  var queue = instance._queue;\n  if (typeof queue === 'undefined') return;\n\n  delete instance._queue;\n  for (var i = 0, l = queue.length; i < l; ++i) {\n    queue[i]();\n  }\n}\n\nfunction sendStream(instance, stream, options, cb) {\n  stream.on('data', function incoming(data) {\n    if (instance.readyState !== WebSocket.OPEN) {\n      if (typeof cb === 'function') cb(new Error('not opened'));\n      else {\n        delete instance._queue;\n        instance.emit('error', new Error('not opened'));\n      }\n      return;\n    }\n\n    options.fin = false;\n    instance._sender.send(data, options);\n  });\n\n  stream.on('end', function end() {\n    if (instance.readyState !== WebSocket.OPEN) {\n      if (typeof cb === 'function') cb(new Error('not opened'));\n      else {\n        delete instance._queue;\n        instance.emit('error', new Error('not opened'));\n      }\n      return;\n    }\n\n    options.fin = true;\n    instance._sender.send(null, options);\n\n    if (typeof cb === 'function') cb(null);\n  });\n}\n\nfunction cleanupWebsocketResources(error) {\n  if (this.readyState === WebSocket.CLOSED) return;\n\n  var emitClose = this.readyState !== WebSocket.CONNECTING;\n  this.readyState = WebSocket.CLOSED;\n\n  clearTimeout(this._closeTimer);\n  this._closeTimer = null;\n\n  if (emitClose) {\n    this.emit('close', this._closeCode || 1000, this._closeMessage || '');\n  }\n\n  if (this._socket) {\n    if (this._ultron) this._ultron.destroy();\n    this._socket.on('error', function onerror() {\n      try { this.destroy(); }\n      catch (e) {}\n    });\n\n    try {\n      if (!error) this._socket.end();\n      else this._socket.destroy();\n    } catch (e) { /* Ignore termination errors */ }\n\n    this._socket = null;\n    this._ultron = null;\n  }\n\n  if (this._sender) {\n    this._sender.removeAllListeners();\n    this._sender = null;\n  }\n\n  if (this._receiver) {\n    this._receiver.cleanup();\n    this._receiver = null;\n  }\n\n  this.removeAllListeners();\n  this.on('error', function onerror() {}); // catch all errors after this\n  delete this._queue;\n}\n\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar shortid = __webpack_require__(7);\r\nexports.default = shortid;\r\n//# sourceMappingURL=random.js.map\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar ConnectionImpl = (function () {\r\n    function ConnectionImpl(settings) {\r\n        this.messageHandlers = {};\r\n        this.ids = 1;\r\n        this.registry = callback_registry_1.default();\r\n        this._connected = false;\r\n        this._settings = settings;\r\n        this._logger = settings.logger;\r\n    }\r\n    ConnectionImpl.prototype.init = function (transport, protocol) {\r\n        this._protocol = protocol;\r\n        this._transport = transport;\r\n        this._transport.onConnectedChanged(this.handleConnectionChanged.bind(this));\r\n        this._transport.onMessage(this.handleTransportMessage.bind(this));\r\n    };\r\n    ConnectionImpl.prototype.send = function (product, type, message, id, options) {\r\n        if (this._transport.isObjectBasedTransport) {\r\n            var msg = this._protocol.createObjectMessage(product, type, message, id);\r\n            return this._transport.sendObject(msg, product, type, options);\r\n        }\r\n        else {\r\n            var strMessage = this._protocol.createStringMessage(product, type, message, id);\r\n            return this._transport.send(strMessage, product, type, options);\r\n        }\r\n    };\r\n    ConnectionImpl.prototype.on = function (product, type, messageHandler) {\r\n        type = type.toLowerCase();\r\n        if (this.messageHandlers[type] === undefined) {\r\n            this.messageHandlers[type] = {};\r\n        }\r\n        var id = this.ids++;\r\n        this.messageHandlers[type][id] = messageHandler;\r\n        return {\r\n            type: type,\r\n            id: id,\r\n        };\r\n    };\r\n    ConnectionImpl.prototype.off = function (info) {\r\n        delete this.messageHandlers[info.type.toLowerCase()][info.id];\r\n    };\r\n    Object.defineProperty(ConnectionImpl.prototype, \"isConnected\", {\r\n        get: function () {\r\n            return this._connected;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ConnectionImpl.prototype.connected = function (callback) {\r\n        if (this._connected) {\r\n            callback(this._settings.ws || this._settings.http);\r\n        }\r\n        return this.registry.add(\"connected\", callback);\r\n    };\r\n    ConnectionImpl.prototype.disconnected = function (callback) {\r\n        return this.registry.add(\"disconnected\", callback);\r\n    };\r\n    ConnectionImpl.prototype.login = function (authRequest) {\r\n        this._transport.open();\r\n        return this._protocol.login(authRequest);\r\n    };\r\n    ConnectionImpl.prototype.logout = function () {\r\n        this._protocol.logout();\r\n        this._transport.close();\r\n    };\r\n    ConnectionImpl.prototype.loggedIn = function (callback) {\r\n        return this._protocol.loggedIn(callback);\r\n    };\r\n    Object.defineProperty(ConnectionImpl.prototype, \"protocolVersion\", {\r\n        get: function () {\r\n            return this._settings.protocolVersion || 1;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ConnectionImpl.prototype.toAPI = function () {\r\n        var that = this;\r\n        return {\r\n            send: that.send.bind(that),\r\n            on: that.on.bind(that),\r\n            off: that.off.bind(that),\r\n            login: that.login.bind(that),\r\n            logout: that.logout.bind(that),\r\n            loggedIn: that.loggedIn.bind(that),\r\n            connected: that.connected.bind(that),\r\n            disconnected: that.disconnected.bind(that),\r\n            get protocolVersion() {\r\n                return that.protocolVersion;\r\n            }\r\n        };\r\n    };\r\n    ConnectionImpl.prototype.distributeMessage = function (message, type) {\r\n        var _this = this;\r\n        var handlers = this.messageHandlers[type.toLowerCase()];\r\n        if (handlers !== undefined) {\r\n            Object.keys(handlers).forEach(function (handlerId) {\r\n                var handler = handlers[handlerId];\r\n                if (handler !== undefined) {\r\n                    try {\r\n                        handler(message);\r\n                    }\r\n                    catch (error) {\r\n                        _this._logger.error(\"Message handler failed with \" + error.stack);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n    ConnectionImpl.prototype.handleConnectionChanged = function (connected) {\r\n        if (this._connected === connected) {\r\n            return;\r\n        }\r\n        this._connected = connected;\r\n        if (connected) {\r\n            this.registry.execute(\"connected\");\r\n        }\r\n        else {\r\n            this.registry.execute(\"disconnected\");\r\n        }\r\n    };\r\n    ConnectionImpl.prototype.handleTransportMessage = function (msg) {\r\n        var msgObj;\r\n        if (typeof msg === \"string\") {\r\n            msgObj = this._protocol.processStringMessage(msg);\r\n        }\r\n        else {\r\n            msgObj = this._protocol.processObjectMessage(msg);\r\n        }\r\n        this.distributeMessage(msgObj.msg, msgObj.msgType);\r\n    };\r\n    return ConnectionImpl;\r\n}());\r\nexports.default = ConnectionImpl;\r\n//# sourceMappingURL=connection.js.map\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.GW_MESSAGE_CREATE_CONTEXT = \"create-context\";\r\nexports.GW_MESSAGE_ACTIVITY_CREATED = \"created\";\r\nexports.GW_MESSAGE_ACTIVITY_DESTROYED = \"destroyed\";\r\nexports.GW_MESSAGE_CONTEXT_CREATED = \"context-created\";\r\nexports.GW_MESSAGE_CONTEXT_ADDED = \"context-added\";\r\nexports.GW_MESSAGE_SUBSCRIBE_CONTEXT = \"subscribe-context\";\r\nexports.GW_MESSAGE_SUBSCRIBED_CONTEXT = \"subscribed-context\";\r\nexports.GW_MESSAGE_UNSUBSCRIBE_CONTEXT = \"unsubscribe-context\";\r\nexports.GW_MESSAGE_DESTROY_CONTEXT = \"destroy-context\";\r\nexports.GW_MESSAGE_CONTEXT_DESTROYED = \"context-destroyed\";\r\nexports.GW_MESSAGE_UPDATE_CONTEXT = \"update-context\";\r\nexports.GW_MESSAGE_CONTEXT_UPDATED = \"context-updated\";\r\nexports.GW_MESSAGE_JOINED_ACTIVITY = \"joined\";\r\n//# sourceMappingURL=gw3Messages.js.map\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar connection = {\r\n    protocolVersion: -1,\r\n    send: function (product, type, message, id, options) {\r\n        return Promise.resolve(undefined);\r\n    },\r\n    on: function (product, type, messageHandler) {\r\n        return { type: \"1\", id: 1 };\r\n    },\r\n    off: function (info) {\r\n    },\r\n    login: function (message) {\r\n        return undefined;\r\n    },\r\n    logout: function () {\r\n    },\r\n    loggedIn: function (callback) {\r\n        return undefined;\r\n    },\r\n    connected: function (callback) {\r\n        return undefined;\r\n    },\r\n    disconnected: function (callback) {\r\n        return undefined;\r\n    },\r\n};\r\nexports.default = connection;\r\n//# sourceMappingURL=dummyConnection.js.map\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"fs\");\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"http\");\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"url\");\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar main_1 = __webpack_require__(110);\r\nvar main_2 = __webpack_require__(79);\r\nvar main_3 = __webpack_require__(95);\r\nvar main_4 = __webpack_require__(61);\r\nvar config_1 = __webpack_require__(77);\r\nvar dummyConnection_1 = __webpack_require__(26);\r\nvar timer_1 = __webpack_require__(113);\r\nvar utils_1 = __webpack_require__(11);\r\nvar dummyConnection_2 = __webpack_require__(26);\r\nvar main_5 = __webpack_require__(92);\r\nvar contextMessageReplaySpec_1 = __webpack_require__(10);\r\nvar main_6 = __webpack_require__(76);\r\nvar GlueCore = function (userConfig, ext) {\r\n    var gdVersion = -1;\r\n    var hc;\r\n    var glue42gd;\r\n    if (typeof window !== \"undefined\") {\r\n        gdVersion = utils_1.default.getGDMajorVersion();\r\n        if (gdVersion === 2) {\r\n            hc = window.htmlContainer;\r\n        }\r\n        else if (gdVersion >= 3) {\r\n            glue42gd = window.glue42gd;\r\n        }\r\n    }\r\n    var glueInitTimer = timer_1.default();\r\n    userConfig = userConfig || {};\r\n    ext = ext || {};\r\n    var internalConfig = config_1.default(userConfig, ext, hc, glue42gd, gdVersion);\r\n    var _connection;\r\n    var _agm;\r\n    var _logger;\r\n    var _rootMetrics;\r\n    var _metrics;\r\n    var _contexts;\r\n    var _channels;\r\n    var libs = {};\r\n    function registerLib(name, inner, t) {\r\n        inner.initStartTime = t.startTime;\r\n        if (inner.ready) {\r\n            inner.ready().then(function () {\r\n                inner.initTime = t.stop();\r\n                inner.initEndTime = t.endTime;\r\n            });\r\n        }\r\n        else {\r\n            inner.initTime = t.stop();\r\n            inner.initEndTime = t.endTime;\r\n        }\r\n        libs[name] = inner;\r\n        GlueCore[name] = inner;\r\n    }\r\n    function setupConnection() {\r\n        var initTimer = timer_1.default();\r\n        internalConfig.connection.logger = _logger.subLogger(\"connection\");\r\n        _connection = main_2.default(internalConfig.connection);\r\n        var authPromise = Promise.resolve(internalConfig.auth);\r\n        if (internalConfig.connection && !internalConfig.auth) {\r\n            var protocolVersion = internalConfig.connection.protocolVersion;\r\n            if (!protocolVersion || protocolVersion === 1) {\r\n                registerLib(\"connection\", _connection, initTimer);\r\n                return Promise.resolve({});\r\n            }\r\n            if (protocolVersion === 2) {\r\n                return Promise.reject(\"You need to provide auth information\");\r\n            }\r\n            if (protocolVersion === 3) {\r\n                if (glue42gd) {\r\n                    authPromise = glue42gd.getGWToken().then(function (token) {\r\n                        return {\r\n                            gatewayToken: token\r\n                        };\r\n                    });\r\n                }\r\n                else {\r\n                    authPromise = Promise.reject(\"You need to provide auth information\");\r\n                }\r\n            }\r\n        }\r\n        return authPromise\r\n            .then(function (authConfig) {\r\n            var authRequest;\r\n            if (typeof authConfig === \"string\" || typeof authConfig === \"number\") {\r\n                authRequest = {\r\n                    token: authConfig\r\n                };\r\n            }\r\n            else if (Object.prototype.toString.call(authConfig) === \"[object Object]\") {\r\n                authRequest = authConfig;\r\n            }\r\n            else {\r\n                throw new Error(\"Invalid auth object - \" + JSON.stringify(authConfig));\r\n            }\r\n            return authRequest;\r\n        })\r\n            .then(function (authRequest) {\r\n            return _connection.login(authRequest);\r\n        })\r\n            .then(function (identity) {\r\n            if (identity) {\r\n                if (identity.machine) {\r\n                    internalConfig.agm.instance.machine = identity.machine;\r\n                }\r\n                if (identity.user) {\r\n                    internalConfig.agm.instance.user = identity.user;\r\n                }\r\n            }\r\n            registerLib(\"connection\", _connection, initTimer);\r\n            return internalConfig;\r\n        })\r\n            .catch(function () {\r\n            if (_connection) {\r\n                _connection.logout();\r\n            }\r\n            return internalConfig;\r\n        });\r\n    }\r\n    function setupLogger() {\r\n        var initTimer = timer_1.default();\r\n        var loggerConfig = {\r\n            identity: internalConfig.identity,\r\n            getConnection: function () {\r\n                return _connection || dummyConnection_1.default;\r\n            },\r\n            publish: internalConfig.logger.publish || \"off\",\r\n            console: internalConfig.logger.console || \"info\",\r\n            metrics: (internalConfig.metrics && internalConfig.logger.metrics) || \"off\"\r\n        };\r\n        _logger = main_3.default(loggerConfig);\r\n        registerLib(\"logger\", _logger, initTimer);\r\n        return Promise.resolve(undefined);\r\n    }\r\n    function setupMetrics() {\r\n        if (internalConfig.metrics) {\r\n            var initTimer = timer_1.default();\r\n            _rootMetrics = main_1.default({\r\n                identity: internalConfig.metrics.identity,\r\n                connection: internalConfig.metrics ? _connection : dummyConnection_1.default,\r\n                logger: _logger.subLogger(\"metrics\")\r\n            });\r\n            _metrics = _rootMetrics.subSystem(\"App\");\r\n            var reportingSystem_1 = _metrics.subSystem(\"reporting\");\r\n            var def_1 = {\r\n                name: \"features\",\r\n                conflation: 1,\r\n            };\r\n            var _featureMetric_1;\r\n            _metrics.featureMetric = function (name, action, payload) {\r\n                if (typeof name === \"undefined\" || name === \"\") {\r\n                    throw new Error(\"name is mandatory\");\r\n                }\r\n                else if (typeof action === \"undefined\" || action === \"\") {\r\n                    throw new Error(\"action is mandatory\");\r\n                }\r\n                else if (typeof payload === \"undefined\" || payload === \"\") {\r\n                    throw new Error(\"payload is mandatory\");\r\n                }\r\n                if (!_featureMetric_1) {\r\n                    _featureMetric_1 = reportingSystem_1.objectMetric(def_1, { name: name, action: action, payload: payload });\r\n                }\r\n                else {\r\n                    _featureMetric_1.update({\r\n                        name: name,\r\n                        action: action,\r\n                        payload: payload\r\n                    });\r\n                }\r\n            };\r\n            _logger.metricsLevel(\"warn\", _metrics.parent.subSystem(\"LogEvents\"));\r\n            registerLib(\"metrics\", _metrics, initTimer);\r\n        }\r\n        return Promise.resolve(undefined);\r\n    }\r\n    function setupAGM() {\r\n        var initTimer = timer_1.default();\r\n        var agmConfig = {\r\n            instance: internalConfig.agm.instance,\r\n            connection: _connection,\r\n            logger: _logger.subLogger(\"agm\"),\r\n            forceGW: internalConfig.connection && internalConfig.connection.force,\r\n            gdVersion: gdVersion,\r\n        };\r\n        return new Promise(function (resolve, reject) {\r\n            main_4.default(agmConfig)\r\n                .then(function (agmLib) {\r\n                _agm = agmLib;\r\n                registerLib(\"agm\", _agm, initTimer);\r\n                resolve(internalConfig);\r\n            })\r\n                .catch(function (err) {\r\n                return reject(err);\r\n            });\r\n        });\r\n    }\r\n    function setupContexts() {\r\n        var hasActivities = (internalConfig.activities && dummyConnection_2.default.protocolVersion === 3);\r\n        var needsContexts = internalConfig.contexts || hasActivities;\r\n        if (needsContexts) {\r\n            var initTimer = timer_1.default();\r\n            _contexts = new main_5.ContextsModule({\r\n                connection: _connection,\r\n                logger: _logger.subLogger(\"contexts\"),\r\n                gdMajorVersion: gdVersion\r\n            });\r\n            registerLib(\"contexts\", _contexts, initTimer);\r\n            return _contexts;\r\n        }\r\n        else {\r\n            var replayer = dummyConnection_2.default.replayer;\r\n            if (replayer) {\r\n                replayer.drain(contextMessageReplaySpec_1.ContextMessageReplaySpec.name, null);\r\n            }\r\n        }\r\n    }\r\n    function setupChannels() {\r\n        var initTimer = timer_1.default();\r\n        _channels = main_6.factory(_contexts, _agm);\r\n        registerLib(\"channels\", _channels, initTimer);\r\n        return Promise.resolve(undefined);\r\n    }\r\n    function setupExternalLibs(externalLibs) {\r\n        try {\r\n            externalLibs.forEach(function (lib) {\r\n                setupExternalLib(lib.name, lib.create);\r\n            });\r\n            return Promise.resolve();\r\n        }\r\n        catch (e) {\r\n            return Promise.reject(e);\r\n        }\r\n    }\r\n    function setupExternalLib(name, createCallback) {\r\n        var initTimer = timer_1.default();\r\n        var lib = createCallback(libs);\r\n        if (lib) {\r\n            registerLib(name, lib, initTimer);\r\n        }\r\n    }\r\n    function waitForLibs() {\r\n        var libsReadyPromises = Object.keys(libs).map(function (key) {\r\n            var lib = libs[key];\r\n            return lib.ready ?\r\n                lib.ready() : Promise.resolve();\r\n        });\r\n        return Promise.all(libsReadyPromises);\r\n    }\r\n    function constructGlueObject() {\r\n        var feedbackFunc = function () {\r\n            if (!_agm) {\r\n                return;\r\n            }\r\n            _agm.invoke(\"T42.ACS.Feedback\", {}, \"best\");\r\n        };\r\n        var info = { glueVersion: internalConfig.version };\r\n        glueInitTimer.stop();\r\n        var glue = {\r\n            feedback: feedbackFunc,\r\n            info: info,\r\n            version: internalConfig.version,\r\n            userConfig: userConfig,\r\n            done: function () {\r\n                _connection.logout();\r\n                return Promise.resolve();\r\n            }\r\n        };\r\n        glue.performance = {\r\n            get browser() {\r\n                return window.performance.timing.toJSON();\r\n            },\r\n            get memory() {\r\n                return window.performance.memory;\r\n            },\r\n            get initTimes() {\r\n                var result = Object.keys(glue)\r\n                    .filter(function (key) {\r\n                    if (key === \"initTimes\") {\r\n                        return false;\r\n                    }\r\n                    return glue[key].initTime;\r\n                })\r\n                    .map(function (key) {\r\n                    return {\r\n                        name: key,\r\n                        time: glue[key].initTime,\r\n                        startTime: glue[key].initStartTime,\r\n                        endTime: glue[key].initEndTime\r\n                    };\r\n                });\r\n                result.push({\r\n                    name: \"glue\",\r\n                    startTime: glueInitTimer.startTime,\r\n                    endTime: glueInitTimer.endTime,\r\n                    time: glueInitTimer.period\r\n                });\r\n                return result;\r\n            }\r\n        };\r\n        Object.keys(libs).forEach(function (key) {\r\n            var lib = libs[key];\r\n            glue[key] = lib;\r\n            info[key] = lib.version;\r\n        });\r\n        if (hc && hc.perfDataNeeded && hc.updatePerfData) {\r\n            var delay = hc.perfDataDelay || 100;\r\n            setTimeout(function () {\r\n                hc.updatePerfData(glue.performance);\r\n            }, delay);\r\n        }\r\n        glue.config = {};\r\n        if (ext.enrichGlue) {\r\n            ext.enrichGlue(glue);\r\n        }\r\n        Object.keys(internalConfig).forEach(function (k) {\r\n            glue.config[k] = internalConfig[k];\r\n        });\r\n        if (ext.extOptions) {\r\n            Object.keys(ext.extOptions).forEach(function (k) {\r\n                glue.config[k] = ext.extOptions[k];\r\n            });\r\n        }\r\n        return glue;\r\n    }\r\n    return setupLogger()\r\n        .then(setupConnection)\r\n        .then(function () { return Promise.all([setupMetrics(), setupAGM(), setupContexts()]); })\r\n        .then(function () { return setupChannels(); })\r\n        .then(function () {\r\n        return setupExternalLibs(internalConfig.libs || []);\r\n    })\r\n        .then(waitForLibs)\r\n        .then(constructGlueObject)\r\n        .catch(function (err) {\r\n        return Promise.reject({\r\n            err: err,\r\n            libs: libs\r\n        });\r\n    });\r\n};\r\nexports.default = GlueCore;\r\n//# sourceMappingURL=glue.js.map\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * bufferutil: WebSocket buffer utils\n * Copyright(c) 2015 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nmodule.exports.BufferUtil = {\n  merge: function(mergedBuffer, buffers) {\n    var offset = 0;\n\n    for (var i = 0, l = buffers.length; i < l; ++i) {\n      var buf = buffers[i];\n      buf.copy(mergedBuffer, offset);\n      offset += buf.length;\n    }\n  },\n  mask: function(source, mask, output, offset, length) {\n    var maskNum = mask.readUInt32LE(0, true);\n    var i = 0;\n\n    for (; i < length - 3; i += 4) {\n      var num = maskNum ^ source.readUInt32LE(i, true);\n      if (num < 0) num = 4294967296 + num;\n      output.writeUInt32LE(num, offset + i, true);\n    }\n\n    switch (length % 4) {\n      case 3: output[offset + i + 2] = source[i + 2] ^ mask[2];\n      case 2: output[offset + i + 1] = source[i + 1] ^ mask[1];\n      case 1: output[offset + i] = source[i] ^ mask[0];\n    }\n  },\n  unmask: function(data, mask) {\n    var maskNum = mask.readUInt32LE(0, true);\n    var length = data.length;\n    var i = 0;\n\n    for (; i < length - 3; i += 4) {\n      var num = maskNum ^ data.readUInt32LE(i, true);\n      if (num < 0) num = 4294967296 + num;\n      data.writeUInt32LE(num, i, true);\n    }\n\n    switch (length % 4) {\n      case 3: data[i + 2] = data[i + 2] ^ mask[2];\n      case 2: data[i + 1] = data[i + 1] ^ mask[1];\n      case 1: data[i] = data[i] ^ mask[0];\n    }\n  }\n};\n\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\ntry {\n  module.exports = __webpack_require__(15)('bufferutil');\n} catch (e) {\n  module.exports = __webpack_require__(31);\n}\n\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports) {\n\n/**\n * Secure random string generator with custom alphabet.\n *\n * Alphabet must contain 256 symbols or less. Otherwise, the generator\n * will not be secure.\n *\n * @param {generator} random The random bytes generator.\n * @param {string} alphabet Symbols to be used in new random string.\n * @param {size} size The number of symbols in new random string.\n *\n * @return {string} Random string.\n *\n * @example\n * const format = require('nanoid/format')\n *\n * function random (size) {\n *   const result = []\n *   for (let i = 0; i < size; i++) {\n *     result.push(randomByte())\n *   }\n *   return result\n * }\n *\n * format(random, \"abcdef\", 5) //=> \"fbaef\"\n *\n * @name format\n * @function\n */\nmodule.exports = function (random, alphabet, size) {\n  var mask = (2 << Math.log(alphabet.length - 1) / Math.LN2) - 1\n  var step = Math.ceil(1.6 * mask * size / alphabet.length)\n\n  var id = ''\n  while (true) {\n    var bytes = random(step)\n    for (var i = 0; i < step; i++) {\n      var byte = bytes[i] & mask\n      if (alphabet[byte]) {\n        id += alphabet[byte]\n        if (id.length === size) return id\n      }\n    }\n  }\n}\n\n/**\n * @callback generator\n * @param {number} bytes The number of bytes to generate.\n * @return {number[]} Random bytes.\n */\n\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar crypto = __webpack_require__(12)\n\nif (crypto.randomFillSync) {\n  module.exports = function (bytes) {\n    return crypto.randomFillSync(Buffer.allocUnsafe(bytes))\n  }\n} else {\n  module.exports = crypto.randomBytes\n}\n\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar generate = __webpack_require__(36);\nvar alphabet = __webpack_require__(4);\n\n// Ignore all milliseconds before a certain time to reduce the size of the date entropy without sacrificing uniqueness.\n// This number should be updated every year or so to keep the generated id short.\n// To regenerate `new Date() - 0` and bump the version. Always bump the version!\nvar REDUCE_TIME = 1459707606518;\n\n// don't change unless we change the algos or REDUCE_TIME\n// must be an integer and less than 16\nvar version = 6;\n\n// Counter is used when shortid is called multiple times in one second.\nvar counter;\n\n// Remember the last time shortid was called in case counter is needed.\nvar previousSeconds;\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction build(clusterWorkerId) {\n    var str = '';\n\n    var seconds = Math.floor((Date.now() - REDUCE_TIME) * 0.001);\n\n    if (seconds === previousSeconds) {\n        counter++;\n    } else {\n        counter = 0;\n        previousSeconds = seconds;\n    }\n\n    str = str + generate(version);\n    str = str + generate(clusterWorkerId);\n    if (counter > 0) {\n        str = str + generate(counter);\n    }\n    str = str + generate(seconds);\n    return str;\n}\n\nmodule.exports = build;\n\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar alphabet = __webpack_require__(4);\nvar random = __webpack_require__(39);\nvar format = __webpack_require__(33);\n\nfunction generate(number) {\n    var loopCounter = 0;\n    var done;\n\n    var str = '';\n\n    while (!done) {\n        str = str + format(random, alphabet.get(), 1);\n        done = number < (Math.pow(16, loopCounter + 1 ) );\n        loopCounter++;\n    }\n    return str;\n}\n\nmodule.exports = generate;\n\n\n/***/ }),\n/* 37 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar alphabet = __webpack_require__(4);\nvar build = __webpack_require__(35);\nvar isValid = __webpack_require__(38);\n\n// if you are using cluster or multiple servers use this to make each instance\n// has a unique value for worker\n// Note: I don't know if this is automatically set when using third\n// party cluster solutions such as pm2.\nvar clusterWorkerId = __webpack_require__(41) || 0;\n\n/**\n * Set the seed.\n * Highly recommended if you don't want people to try to figure out your id schema.\n * exposed as shortid.seed(int)\n * @param seed Integer value to seed the random alphabet.  ALWAYS USE THE SAME SEED or you might get overlaps.\n */\nfunction seed(seedValue) {\n    alphabet.seed(seedValue);\n    return module.exports;\n}\n\n/**\n * Set the cluster worker or machine id\n * exposed as shortid.worker(int)\n * @param workerId worker must be positive integer.  Number less than 16 is recommended.\n * returns shortid module so it can be chained.\n */\nfunction worker(workerId) {\n    clusterWorkerId = workerId;\n    return module.exports;\n}\n\n/**\n *\n * sets new characters to use in the alphabet\n * returns the shuffled alphabet\n */\nfunction characters(newCharacters) {\n    if (newCharacters !== undefined) {\n        alphabet.characters(newCharacters);\n    }\n\n    return alphabet.shuffled();\n}\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction generate() {\n  return build(clusterWorkerId);\n}\n\n// Export all other functions as properties of the generate function\nmodule.exports = generate;\nmodule.exports.generate = generate;\nmodule.exports.seed = seed;\nmodule.exports.worker = worker;\nmodule.exports.characters = characters;\nmodule.exports.isValid = isValid;\n\n\n/***/ }),\n/* 38 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar alphabet = __webpack_require__(4);\n\nfunction isShortId(id) {\n    if (!id || typeof id !== 'string' || id.length < 6 ) {\n        return false;\n    }\n\n    var nonAlphabetic = new RegExp('[^' +\n      alphabet.get().replace(/[|\\\\{}()[\\]^$+*?.-]/g, '\\\\$&') +\n    ']');\n    return !nonAlphabetic.test(id);\n}\n\nmodule.exports = isShortId;\n\n\n/***/ }),\n/* 39 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(34);\n\n\n/***/ }),\n/* 40 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n// Found this seed-based random generator somewhere\n// Based on The Central Randomizer 1.3 (C) 1997 by Paul Houle (houle@msc.cornell.edu)\n\nvar seed = 1;\n\n/**\n * return a random number based on a seed\n * @param seed\n * @returns {number}\n */\nfunction getNextValue() {\n    seed = (seed * 9301 + 49297) % 233280;\n    return seed/(233280.0);\n}\n\nfunction setSeed(_seed_) {\n    seed = _seed_;\n}\n\nmodule.exports = {\n    nextValue: getNextValue,\n    seed: setSeed\n};\n\n\n/***/ }),\n/* 41 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar cluster = __webpack_require__(114);\n\nvar clusterId = 0;\nif (!cluster.isMaster && cluster.worker) {\n    clusterId = cluster.worker.id;\n}\nmodule.exports = parseInt(process.env.NODE_UNIQUE_ID || clusterId, 10);\n\n\n/***/ }),\n/* 42 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * An auto incrementing id which we can use to create \"unique\" Ultron instances\n * so we can track the event emitters that are added through the Ultron\n * interface.\n *\n * @type {Number}\n * @private\n */\nvar id = 0;\n\n/**\n * Ultron is high-intelligence robot. It gathers intelligence so it can start improving\n * upon his rudimentary design. It will learn from your EventEmitting patterns\n * and exterminate them.\n *\n * @constructor\n * @param {EventEmitter} ee EventEmitter instance we need to wrap.\n * @api public\n */\nfunction Ultron(ee) {\n  if (!(this instanceof Ultron)) return new Ultron(ee);\n\n  this.id = id++;\n  this.ee = ee;\n}\n\n/**\n * Register a new EventListener for the given event.\n *\n * @param {String} event Name of the event.\n * @param {Functon} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @returns {Ultron}\n * @api public\n */\nUltron.prototype.on = function on(event, fn, context) {\n  fn.__ultron = this.id;\n  this.ee.on(event, fn, context);\n\n  return this;\n};\n/**\n * Add an EventListener that's only called once.\n *\n * @param {String} event Name of the event.\n * @param {Function} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @returns {Ultron}\n * @api public\n */\nUltron.prototype.once = function once(event, fn, context) {\n  fn.__ultron = this.id;\n  this.ee.once(event, fn, context);\n\n  return this;\n};\n\n/**\n * Remove the listeners we assigned for the given event.\n *\n * @returns {Ultron}\n * @api public\n */\nUltron.prototype.remove = function remove() {\n  var args = arguments\n    , event;\n\n  //\n  // When no event names are provided we assume that we need to clear all the\n  // events that were assigned through us.\n  //\n  if (args.length === 1 && 'string' === typeof args[0]) {\n    args = args[0].split(/[, ]+/);\n  } else if (!args.length) {\n    args = [];\n\n    for (event in this.ee._events) {\n      if (has.call(this.ee._events, event)) args.push(event);\n    }\n  }\n\n  for (var i = 0; i < args.length; i++) {\n    var listeners = this.ee.listeners(args[i]);\n\n    for (var j = 0; j < listeners.length; j++) {\n      event = listeners[j];\n\n      //\n      // Once listeners have a `listener` property that stores the real listener\n      // in the EventEmitter that ships with Node.js.\n      //\n      if (event.listener) {\n        if (event.listener.__ultron !== this.id) continue;\n        delete event.listener.__ultron;\n      } else {\n        if (event.__ultron !== this.id) continue;\n        delete event.__ultron;\n      }\n\n      this.ee.removeListener(args[i], event);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Destroy the Ultron instance, remove all listeners and release all references.\n *\n * @returns {Boolean}\n * @api public\n */\nUltron.prototype.destroy = function destroy() {\n  if (!this.ee) return false;\n\n  this.remove();\n  this.ee = null;\n\n  return true;\n};\n\n//\n// Expose the module.\n//\nmodule.exports = Ultron;\n\n\n/***/ }),\n/* 43 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * UTF-8 validate: UTF-8 validation for WebSockets.\n * Copyright(c) 2015 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nmodule.exports.Validation = {\n  isValidUTF8: function(buffer) {\n    return true;\n  }\n};\n\n\n/***/ }),\n/* 44 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\ntry {\n  module.exports = __webpack_require__(15)('validation');\n} catch (e) {\n  module.exports = __webpack_require__(43);\n}\n\n\n/***/ }),\n/* 45 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar WS = module.exports = __webpack_require__(22);\n\nWS.Server = __webpack_require__(52);\nWS.Sender = __webpack_require__(21);\nWS.Receiver = __webpack_require__(20);\n\n/**\n * Create a new WebSocket server.\n *\n * @param {Object} options Server options\n * @param {Function} fn Optional connection listener.\n * @returns {WS.Server}\n * @api public\n */\nWS.createServer = function createServer(options, fn) {\n  var server = new WS.Server(options);\n\n  if (typeof fn === 'function') {\n    server.on('connection', fn);\n  }\n\n  return server;\n};\n\n/**\n * Create a new WebSocket connection.\n *\n * @param {String} address The URL/address we need to connect to.\n * @param {Function} fn Open listener.\n * @returns {WS}\n * @api public\n */\nWS.connect = WS.createConnection = function connect(address, fn) {\n  var client = new WS(address);\n\n  if (typeof fn === 'function') {\n    client.on('open', fn);\n  }\n\n  return client;\n};\n\n\n/***/ }),\n/* 46 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar util = __webpack_require__(3);\n\nfunction BufferPool(initialSize, growStrategy, shrinkStrategy) {\n  if (typeof initialSize === 'function') {\n    shrinkStrategy = growStrategy;\n    growStrategy = initialSize;\n    initialSize = 0;\n  }\n  else if (typeof initialSize === 'undefined') {\n    initialSize = 0;\n  }\n  this._growStrategy = (growStrategy || function(db, size) {\n    return db.used + size;\n  }).bind(null, this);\n  this._shrinkStrategy = (shrinkStrategy || function(db) {\n    return initialSize;\n  }).bind(null, this);\n  this._buffer = initialSize ? new Buffer(initialSize) : null;\n  this._offset = 0;\n  this._used = 0;\n  this._changeFactor = 0;\n  this.__defineGetter__('size', function(){\n    return this._buffer == null ? 0 : this._buffer.length;\n  });\n  this.__defineGetter__('used', function(){\n    return this._used;\n  });\n}\n\nBufferPool.prototype.get = function(length) {\n  if (this._buffer == null || this._offset + length > this._buffer.length) {\n    var newBuf = new Buffer(this._growStrategy(length));\n    this._buffer = newBuf;\n    this._offset = 0;\n  }\n  this._used += length;\n  var buf = this._buffer.slice(this._offset, this._offset + length);\n  this._offset += length;\n  return buf;\n}\n\nBufferPool.prototype.reset = function(forceNewBuffer) {\n  var len = this._shrinkStrategy();\n  if (len < this.size) this._changeFactor -= 1;\n  if (forceNewBuffer || this._changeFactor < -2) {\n    this._changeFactor = 0;\n    this._buffer = len ? new Buffer(len) : null;\n  }\n  this._offset = 0;\n  this._used = 0;\n}\n\nmodule.exports = BufferPool;\n\n\n/***/ }),\n/* 47 */\n/***/ (function(module, exports) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nmodule.exports.BufferUtil = {\n  merge: function(mergedBuffer, buffers) {\n    var offset = 0;\n    for (var i = 0, l = buffers.length; i < l; ++i) {\n      var buf = buffers[i];\n      buf.copy(mergedBuffer, offset);\n      offset += buf.length;\n    }\n  },\n  mask: function(source, mask, output, offset, length) {\n    var maskNum = mask.readUInt32LE(0, true);\n    var i = 0;\n    for (; i < length - 3; i += 4) {\n      var num = maskNum ^ source.readUInt32LE(i, true);\n      if (num < 0) num = 4294967296 + num;\n      output.writeUInt32LE(num, offset + i, true);\n    }\n    switch (length % 4) {\n      case 3: output[offset + i + 2] = source[i + 2] ^ mask[2];\n      case 2: output[offset + i + 1] = source[i + 1] ^ mask[1];\n      case 1: output[offset + i] = source[i] ^ mask[0];\n      case 0:;\n    }\n  },\n  unmask: function(data, mask) {\n    var maskNum = mask.readUInt32LE(0, true);\n    var length = data.length;\n    var i = 0;\n    for (; i < length - 3; i += 4) {\n      var num = maskNum ^ data.readUInt32LE(i, true);\n      if (num < 0) num = 4294967296 + num;\n      data.writeUInt32LE(num, i, true);\n    }\n    switch (length % 4) {\n      case 3: data[i + 2] = data[i + 2] ^ mask[2];\n      case 2: data[i + 1] = data[i + 1] ^ mask[1];\n      case 1: data[i] = data[i] ^ mask[0];\n      case 0:;\n    }\n  }\n}\n\n\n/***/ }),\n/* 48 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar util = __webpack_require__(3);\n\n/**\n * State constants\n */\n\nvar EMPTY = 0\n  , BODY = 1;\nvar BINARYLENGTH = 2\n  , BINARYBODY = 3;\n\n/**\n * Hixie Receiver implementation\n */\n\nfunction Receiver () {\n  this.state = EMPTY;\n  this.buffers = [];\n  this.messageEnd = -1;\n  this.spanLength = 0;\n  this.dead = false;\n\n  this.onerror = function() {};\n  this.ontext = function() {};\n  this.onbinary = function() {};\n  this.onclose = function() {};\n  this.onping = function() {};\n  this.onpong = function() {};\n}\n\nmodule.exports = Receiver;\n\n/**\n * Add new data to the parser.\n *\n * @api public\n */\n\nReceiver.prototype.add = function(data) {\n  var self = this;\n  function doAdd() {\n    if (self.state === EMPTY) {\n      if (data.length == 2 && data[0] == 0xFF && data[1] == 0x00) {\n        self.reset();\n        self.onclose();\n        return;\n      }\n      if (data[0] === 0x80) {\n        self.messageEnd = 0;\n        self.state = BINARYLENGTH;\n        data = data.slice(1);\n      } else {\n\n      if (data[0] !== 0x00) {\n        self.error('payload must start with 0x00 byte', true);\n        return;\n      }\n      data = data.slice(1);\n      self.state = BODY;\n\n      }\n    }\n    if (self.state === BINARYLENGTH) {\n      var i = 0;\n      while ((i < data.length) && (data[i] & 0x80)) {\n        self.messageEnd = 128 * self.messageEnd + (data[i] & 0x7f);\n        ++i;\n      }\n      if (i < data.length) {\n        self.messageEnd = 128 * self.messageEnd + (data[i] & 0x7f);\n        self.state = BINARYBODY;\n        ++i;\n      }\n      if (i > 0)\n        data = data.slice(i);\n    }\n    if (self.state === BINARYBODY) {\n      var dataleft = self.messageEnd - self.spanLength;\n      if (data.length >= dataleft) {\n        // consume the whole buffer to finish the frame\n        self.buffers.push(data);\n        self.spanLength += dataleft;\n        self.messageEnd = dataleft;\n        return self.parse();\n      }\n      // frame's not done even if we consume it all\n      self.buffers.push(data);\n      self.spanLength += data.length;\n      return;\n    }\n    self.buffers.push(data);\n    if ((self.messageEnd = bufferIndex(data, 0xFF)) != -1) {\n      self.spanLength += self.messageEnd;\n      return self.parse();\n    }\n    else self.spanLength += data.length;\n  }\n  while(data) data = doAdd();\n};\n\n/**\n * Releases all resources used by the receiver.\n *\n * @api public\n */\n\nReceiver.prototype.cleanup = function() {\n  this.dead = true;\n  this.state = EMPTY;\n  this.buffers = [];\n};\n\n/**\n * Process buffered data.\n *\n * @api public\n */\n\nReceiver.prototype.parse = function() {\n  var output = new Buffer(this.spanLength);\n  var outputIndex = 0;\n  for (var bi = 0, bl = this.buffers.length; bi < bl - 1; ++bi) {\n    var buffer = this.buffers[bi];\n    buffer.copy(output, outputIndex);\n    outputIndex += buffer.length;\n  }\n  var lastBuffer = this.buffers[this.buffers.length - 1];\n  if (this.messageEnd > 0) lastBuffer.copy(output, outputIndex, 0, this.messageEnd);\n  if (this.state !== BODY) --this.messageEnd;\n  var tail = null;\n  if (this.messageEnd < lastBuffer.length - 1) {\n    tail = lastBuffer.slice(this.messageEnd + 1);\n  }\n  this.reset();\n  this.ontext(output.toString('utf8'));\n  return tail;\n};\n\n/**\n * Handles an error\n *\n * @api private\n */\n\nReceiver.prototype.error = function (reason, terminate) {\n  this.reset();\n  this.onerror(reason, terminate);\n  return this;\n};\n\n/**\n * Reset parser state\n *\n * @api private\n */\n\nReceiver.prototype.reset = function (reason) {\n  if (this.dead) return;\n  this.state = EMPTY;\n  this.buffers = [];\n  this.messageEnd = -1;\n  this.spanLength = 0;\n};\n\n/**\n * Internal api\n */\n\nfunction bufferIndex(buffer, byte) {\n  for (var i = 0, l = buffer.length; i < l; ++i) {\n    if (buffer[i] === byte) return i;\n  }\n  return -1;\n}\n\n\n/***/ }),\n/* 49 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar events = __webpack_require__(6)\n  , util = __webpack_require__(3)\n  , EventEmitter = events.EventEmitter;\n\n/**\n * Hixie Sender implementation\n */\n\nfunction Sender(socket) {\n  events.EventEmitter.call(this);\n\n  this.socket = socket;\n  this.continuationFrame = false;\n  this.isClosed = false;\n}\n\nmodule.exports = Sender;\n\n/**\n * Inherits from EventEmitter.\n */\n\nutil.inherits(Sender, events.EventEmitter);\n\n/**\n * Frames and writes data.\n *\n * @api public\n */\n\nSender.prototype.send = function(data, options, cb) {\n  if (this.isClosed) return;\n\n  var isString = typeof data == 'string'\n    , length = isString ? Buffer.byteLength(data) : data.length\n    , lengthbytes = (length > 127) ? 2 : 1 // assume less than 2**14 bytes\n    , writeStartMarker = this.continuationFrame == false\n    , writeEndMarker = !options || !(typeof options.fin != 'undefined' && !options.fin)\n    , buffer = new Buffer((writeStartMarker ? ((options && options.binary) ? (1 + lengthbytes) : 1) : 0) + length + ((writeEndMarker && !(options && options.binary)) ? 1 : 0))\n    , offset = writeStartMarker ? 1 : 0;\n\n  if (writeStartMarker) {\n    if (options && options.binary) {\n      buffer.write('\\x80', 'binary');\n      // assume length less than 2**14 bytes\n      if (lengthbytes > 1)\n        buffer.write(String.fromCharCode(128+length/128), offset++, 'binary');\n      buffer.write(String.fromCharCode(length&0x7f), offset++, 'binary');\n    } else\n      buffer.write('\\x00', 'binary');\n  }\n\n  if (isString) buffer.write(data, offset, 'utf8');\n  else data.copy(buffer, offset, 0);\n\n  if (writeEndMarker) {\n    if (options && options.binary) {\n      // sending binary, not writing end marker\n    } else\n      buffer.write('\\xff', offset + length, 'binary');\n    this.continuationFrame = false;\n  }\n  else this.continuationFrame = true;\n\n  try {\n    this.socket.write(buffer, 'binary', cb);\n  } catch (e) {\n    this.error(e.toString());\n  }\n};\n\n/**\n * Sends a close instruction to the remote party.\n *\n * @api public\n */\n\nSender.prototype.close = function(code, data, mask, cb) {\n  if (this.isClosed) return;\n  this.isClosed = true;\n  try {\n    if (this.continuationFrame) this.socket.write(new Buffer([0xff], 'binary'));\n    this.socket.write(new Buffer([0xff, 0x00]), 'binary', cb);\n  } catch (e) {\n    this.error(e.toString());\n  }\n};\n\n/**\n * Sends a ping message to the remote party. Not available for hixie.\n *\n * @api public\n */\n\nSender.prototype.ping = function(data, options) {};\n\n/**\n * Sends a pong message to the remote party. Not available for hixie.\n *\n * @api public\n */\n\nSender.prototype.pong = function(data, options) {};\n\n/**\n * Handles an error\n *\n * @api private\n */\n\nSender.prototype.error = function (reason) {\n  this.emit('error', reason);\n  return this;\n};\n\n\n/***/ }),\n/* 50 */\n/***/ (function(module, exports) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n \nmodule.exports.Validation = {\n  isValidUTF8: function(buffer) {\n    return true;\n  }\n};\n\n\n\n/***/ }),\n/* 51 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\ntry {\n  module.exports = __webpack_require__(44);\n} catch (e) {\n  module.exports = __webpack_require__(50);\n}\n\n\n/***/ }),\n/* 52 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\n\nvar util = __webpack_require__(3)\n  , events = __webpack_require__(6)\n  , http = __webpack_require__(28)\n  , crypto = __webpack_require__(12)\n  , Options = __webpack_require__(16)\n  , WebSocket = __webpack_require__(22)\n  , Extensions = __webpack_require__(19)\n  , PerMessageDeflate = __webpack_require__(5)\n  , tls = __webpack_require__(118)\n  , url = __webpack_require__(29);\n\n/**\n * WebSocket Server implementation\n */\n\nfunction WebSocketServer(options, callback) {\n  events.EventEmitter.call(this);\n\n  options = new Options({\n    host: '0.0.0.0',\n    port: null,\n    server: null,\n    verifyClient: null,\n    handleProtocols: null,\n    path: null,\n    noServer: false,\n    disableHixie: false,\n    clientTracking: true,\n    perMessageDeflate: true\n  }).merge(options);\n\n  if (!options.isDefinedAndNonNull('port') && !options.isDefinedAndNonNull('server') && !options.value.noServer) {\n    throw new TypeError('`port` or a `server` must be provided');\n  }\n\n  var self = this;\n\n  if (options.isDefinedAndNonNull('port')) {\n    this._server = http.createServer(function (req, res) {\n      res.writeHead(200, {'Content-Type': 'text/plain'});\n      res.end('Not implemented');\n    });\n    this._server.listen(options.value.port, options.value.host, callback);\n    this._closeServer = function() { if (self._server) self._server.close(); };\n  }\n  else if (options.value.server) {\n    this._server = options.value.server;\n    if (options.value.path) {\n      // take note of the path, to avoid collisions when multiple websocket servers are\n      // listening on the same http server\n      if (this._server._webSocketPaths && options.value.server._webSocketPaths[options.value.path]) {\n        throw new Error('two instances of WebSocketServer cannot listen on the same http server path');\n      }\n      if (typeof this._server._webSocketPaths !== 'object') {\n        this._server._webSocketPaths = {};\n      }\n      this._server._webSocketPaths[options.value.path] = 1;\n    }\n  }\n  if (this._server) this._server.once('listening', function() { self.emit('listening'); });\n\n  if (typeof this._server != 'undefined') {\n    this._server.on('error', function(error) {\n      self.emit('error', error)\n    });\n    this._server.on('upgrade', function(req, socket, upgradeHead) {\n      //copy upgradeHead to avoid retention of large slab buffers used in node core\n      var head = new Buffer(upgradeHead.length);\n      upgradeHead.copy(head);\n\n      self.handleUpgrade(req, socket, head, function(client) {\n        self.emit('connection'+req.url, client);\n        self.emit('connection', client);\n      });\n    });\n  }\n\n  this.options = options.value;\n  this.path = options.value.path;\n  this.clients = [];\n}\n\n/**\n * Inherits from EventEmitter.\n */\n\nutil.inherits(WebSocketServer, events.EventEmitter);\n\n/**\n * Immediately shuts down the connection.\n *\n * @api public\n */\n\nWebSocketServer.prototype.close = function() {\n  // terminate all associated clients\n  var error = null;\n  try {\n    for (var i = 0, l = this.clients.length; i < l; ++i) {\n      this.clients[i].terminate();\n    }\n  }\n  catch (e) {\n    error = e;\n  }\n\n  // remove path descriptor, if any\n  if (this.path && this._server._webSocketPaths) {\n    delete this._server._webSocketPaths[this.path];\n    if (Object.keys(this._server._webSocketPaths).length == 0) {\n      delete this._server._webSocketPaths;\n    }\n  }\n\n  // close the http server if it was internally created\n  try {\n    if (typeof this._closeServer !== 'undefined') {\n      this._closeServer();\n    }\n  }\n  finally {\n    delete this._server;\n  }\n  if (error) throw error;\n}\n\n/**\n * Handle a HTTP Upgrade request.\n *\n * @api public\n */\n\nWebSocketServer.prototype.handleUpgrade = function(req, socket, upgradeHead, cb) {\n  // check for wrong path\n  if (this.options.path) {\n    var u = url.parse(req.url);\n    if (u && u.pathname !== this.options.path) return;\n  }\n\n  if (typeof req.headers.upgrade === 'undefined' || req.headers.upgrade.toLowerCase() !== 'websocket') {\n    abortConnection(socket, 400, 'Bad Request');\n    return;\n  }\n\n  if (req.headers['sec-websocket-key1']) handleHixieUpgrade.apply(this, arguments);\n  else handleHybiUpgrade.apply(this, arguments);\n}\n\nmodule.exports = WebSocketServer;\n\n/**\n * Entirely private apis,\n * which may or may not be bound to a sepcific WebSocket instance.\n */\n\nfunction handleHybiUpgrade(req, socket, upgradeHead, cb) {\n  // handle premature socket errors\n  var errorHandler = function() {\n    try { socket.destroy(); } catch (e) {}\n  }\n  socket.on('error', errorHandler);\n\n  // verify key presence\n  if (!req.headers['sec-websocket-key']) {\n    abortConnection(socket, 400, 'Bad Request');\n    return;\n  }\n\n  // verify version\n  var version = parseInt(req.headers['sec-websocket-version']);\n  if ([8, 13].indexOf(version) === -1) {\n    abortConnection(socket, 400, 'Bad Request');\n    return;\n  }\n\n  // verify protocol\n  var protocols = req.headers['sec-websocket-protocol'];\n\n  // verify client\n  var origin = version < 13 ?\n    req.headers['sec-websocket-origin'] :\n    req.headers['origin'];\n\n  // handle extensions offer\n  var extensionsOffer = Extensions.parse(req.headers['sec-websocket-extensions']);\n\n  // handler to call when the connection sequence completes\n  var self = this;\n  var completeHybiUpgrade2 = function(protocol) {\n\n    // calc key\n    var key = req.headers['sec-websocket-key'];\n    var shasum = crypto.createHash('sha1');\n    shasum.update(key + \"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\");\n    key = shasum.digest('base64');\n\n    var headers = [\n        'HTTP/1.1 101 Switching Protocols'\n      , 'Upgrade: websocket'\n      , 'Connection: Upgrade'\n      , 'Sec-WebSocket-Accept: ' + key\n    ];\n\n    if (typeof protocol != 'undefined') {\n      headers.push('Sec-WebSocket-Protocol: ' + protocol);\n    }\n\n    var extensions = {};\n    try {\n      extensions = acceptExtensions.call(self, extensionsOffer);\n    } catch (err) {\n      abortConnection(socket, 400, 'Bad Request');\n      return;\n    }\n\n    if (Object.keys(extensions).length) {\n      var serverExtensions = {};\n      Object.keys(extensions).forEach(function(token) {\n        serverExtensions[token] = [extensions[token].params]\n      });\n      headers.push('Sec-WebSocket-Extensions: ' + Extensions.format(serverExtensions));\n    }\n\n    // allows external modification/inspection of handshake headers\n    self.emit('headers', headers);\n\n    socket.setTimeout(0);\n    socket.setNoDelay(true);\n    try {\n      socket.write(headers.concat('', '').join('\\r\\n'));\n    }\n    catch (e) {\n      // if the upgrade write fails, shut the connection down hard\n      try { socket.destroy(); } catch (e) {}\n      return;\n    }\n\n    var client = new WebSocket([req, socket, upgradeHead], {\n      protocolVersion: version,\n      protocol: protocol,\n      extensions: extensions\n    });\n\n    if (self.options.clientTracking) {\n      self.clients.push(client);\n      client.on('close', function() {\n        var index = self.clients.indexOf(client);\n        if (index != -1) {\n          self.clients.splice(index, 1);\n        }\n      });\n    }\n\n    // signal upgrade complete\n    socket.removeListener('error', errorHandler);\n    cb(client);\n  }\n\n  // optionally call external protocol selection handler before\n  // calling completeHybiUpgrade2\n  var completeHybiUpgrade1 = function() {\n    // choose from the sub-protocols\n    if (typeof self.options.handleProtocols == 'function') {\n        var protList = (protocols || \"\").split(/, */);\n        var callbackCalled = false;\n        var res = self.options.handleProtocols(protList, function(result, protocol) {\n          callbackCalled = true;\n          if (!result) abortConnection(socket, 401, 'Unauthorized');\n          else completeHybiUpgrade2(protocol);\n        });\n        if (!callbackCalled) {\n            // the handleProtocols handler never called our callback\n            abortConnection(socket, 501, 'Could not process protocols');\n        }\n        return;\n    } else {\n        if (typeof protocols !== 'undefined') {\n            completeHybiUpgrade2(protocols.split(/, */)[0]);\n        }\n        else {\n            completeHybiUpgrade2();\n        }\n    }\n  }\n\n  // optionally call external client verification handler\n  if (typeof this.options.verifyClient == 'function') {\n    var info = {\n      origin: origin,\n      secure: typeof req.connection.authorized !== 'undefined' || typeof req.connection.encrypted !== 'undefined',\n      req: req\n    };\n    if (this.options.verifyClient.length == 2) {\n      this.options.verifyClient(info, function(result, code, name) {\n        if (typeof code === 'undefined') code = 401;\n        if (typeof name === 'undefined') name = http.STATUS_CODES[code];\n\n        if (!result) abortConnection(socket, code, name);\n        else completeHybiUpgrade1();\n      });\n      return;\n    }\n    else if (!this.options.verifyClient(info)) {\n      abortConnection(socket, 401, 'Unauthorized');\n      return;\n    }\n  }\n\n  completeHybiUpgrade1();\n}\n\nfunction handleHixieUpgrade(req, socket, upgradeHead, cb) {\n  // handle premature socket errors\n  var errorHandler = function() {\n    try { socket.destroy(); } catch (e) {}\n  }\n  socket.on('error', errorHandler);\n\n  // bail if options prevent hixie\n  if (this.options.disableHixie) {\n    abortConnection(socket, 401, 'Hixie support disabled');\n    return;\n  }\n\n  // verify key presence\n  if (!req.headers['sec-websocket-key2']) {\n    abortConnection(socket, 400, 'Bad Request');\n    return;\n  }\n\n  var origin = req.headers['origin']\n    , self = this;\n\n  // setup handshake completion to run after client has been verified\n  var onClientVerified = function() {\n    var wshost;\n    if (!req.headers['x-forwarded-host'])\n        wshost = req.headers.host;\n    else\n        wshost = req.headers['x-forwarded-host'];\n    var location = ((req.headers['x-forwarded-proto'] === 'https' || socket.encrypted) ? 'wss' : 'ws') + '://' + wshost + req.url\n      , protocol = req.headers['sec-websocket-protocol'];\n\n    // handshake completion code to run once nonce has been successfully retrieved\n    var completeHandshake = function(nonce, rest) {\n      // calculate key\n      var k1 = req.headers['sec-websocket-key1']\n        , k2 = req.headers['sec-websocket-key2']\n        , md5 = crypto.createHash('md5');\n\n      [k1, k2].forEach(function (k) {\n        var n = parseInt(k.replace(/[^\\d]/g, ''))\n          , spaces = k.replace(/[^ ]/g, '').length;\n        if (spaces === 0 || n % spaces !== 0){\n          abortConnection(socket, 400, 'Bad Request');\n          return;\n        }\n        n /= spaces;\n        md5.update(String.fromCharCode(\n          n >> 24 & 0xFF,\n          n >> 16 & 0xFF,\n          n >> 8  & 0xFF,\n          n       & 0xFF));\n      });\n      md5.update(nonce.toString('binary'));\n\n      var headers = [\n          'HTTP/1.1 101 Switching Protocols'\n        , 'Upgrade: WebSocket'\n        , 'Connection: Upgrade'\n        , 'Sec-WebSocket-Location: ' + location\n      ];\n      if (typeof protocol != 'undefined') headers.push('Sec-WebSocket-Protocol: ' + protocol);\n      if (typeof origin != 'undefined') headers.push('Sec-WebSocket-Origin: ' + origin);\n\n      socket.setTimeout(0);\n      socket.setNoDelay(true);\n      try {\n        // merge header and hash buffer\n        var headerBuffer = new Buffer(headers.concat('', '').join('\\r\\n'));\n        var hashBuffer = new Buffer(md5.digest('binary'), 'binary');\n        var handshakeBuffer = new Buffer(headerBuffer.length + hashBuffer.length);\n        headerBuffer.copy(handshakeBuffer, 0);\n        hashBuffer.copy(handshakeBuffer, headerBuffer.length);\n\n        // do a single write, which - upon success - causes a new client websocket to be setup\n        socket.write(handshakeBuffer, 'binary', function(err) {\n          if (err) return; // do not create client if an error happens\n          var client = new WebSocket([req, socket, rest], {\n            protocolVersion: 'hixie-76',\n            protocol: protocol\n          });\n          if (self.options.clientTracking) {\n            self.clients.push(client);\n            client.on('close', function() {\n              var index = self.clients.indexOf(client);\n              if (index != -1) {\n                self.clients.splice(index, 1);\n              }\n            });\n          }\n\n          // signal upgrade complete\n          socket.removeListener('error', errorHandler);\n          cb(client);\n        });\n      }\n      catch (e) {\n        try { socket.destroy(); } catch (e) {}\n        return;\n      }\n    }\n\n    // retrieve nonce\n    var nonceLength = 8;\n    if (upgradeHead && upgradeHead.length >= nonceLength) {\n      var nonce = upgradeHead.slice(0, nonceLength);\n      var rest = upgradeHead.length > nonceLength ? upgradeHead.slice(nonceLength) : null;\n      completeHandshake.call(self, nonce, rest);\n    }\n    else {\n      // nonce not present in upgradeHead, so we must wait for enough data\n      // data to arrive before continuing\n      var nonce = new Buffer(nonceLength);\n      upgradeHead.copy(nonce, 0);\n      var received = upgradeHead.length;\n      var rest = null;\n      var handler = function (data) {\n        var toRead = Math.min(data.length, nonceLength - received);\n        if (toRead === 0) return;\n        data.copy(nonce, received, 0, toRead);\n        received += toRead;\n        if (received == nonceLength) {\n          socket.removeListener('data', handler);\n          if (toRead < data.length) rest = data.slice(toRead);\n          completeHandshake.call(self, nonce, rest);\n        }\n      }\n      socket.on('data', handler);\n    }\n  }\n\n  // verify client\n  if (typeof this.options.verifyClient == 'function') {\n    var info = {\n      origin: origin,\n      secure: typeof req.connection.authorized !== 'undefined' || typeof req.connection.encrypted !== 'undefined',\n      req: req\n    };\n    if (this.options.verifyClient.length == 2) {\n      var self = this;\n      this.options.verifyClient(info, function(result, code, name) {\n        if (typeof code === 'undefined') code = 401;\n        if (typeof name === 'undefined') name = http.STATUS_CODES[code];\n\n        if (!result) abortConnection(socket, code, name);\n        else onClientVerified.apply(self);\n      });\n      return;\n    }\n    else if (!this.options.verifyClient(info)) {\n      abortConnection(socket, 401, 'Unauthorized');\n      return;\n    }\n  }\n\n  // no client verification required\n  onClientVerified();\n}\n\nfunction acceptExtensions(offer) {\n  var extensions = {};\n  var options = this.options.perMessageDeflate;\n  if (options && offer[PerMessageDeflate.extensionName]) {\n    var perMessageDeflate = new PerMessageDeflate(options !== true ? options : {}, true);\n    perMessageDeflate.accept(offer[PerMessageDeflate.extensionName]);\n    extensions[PerMessageDeflate.extensionName] = perMessageDeflate;\n  }\n  return extensions;\n}\n\nfunction abortConnection(socket, code, name) {\n  try {\n    var response = [\n      'HTTP/1.1 ' + code + ' ' + name,\n      'Content-type: text/html'\n    ];\n    socket.write(response.concat('', '').join('\\r\\n'));\n  }\n  catch (e) { /* ignore errors - we've aborted this connection */ }\n  finally {\n    // ensure that an early aborted connection is shut down completely\n    try { socket.destroy(); } catch (e) {}\n  }\n}\n\n\n/***/ }),\n/* 53 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar client_1 = __webpack_require__(54);\r\nvar server_1 = __webpack_require__(70);\r\nvar AGMImpl = (function () {\r\n    function AGMImpl(protocol, clientRepository, serverRepository, instance, configuration) {\r\n        this.protocol = protocol;\r\n        this.clientRepository = clientRepository;\r\n        this.serverRepository = serverRepository;\r\n        this.instance = instance;\r\n        this.configuration = configuration;\r\n        this.client = new client_1.default(protocol, clientRepository, instance, configuration);\r\n        this.server = new server_1.default(protocol, serverRepository, instance, configuration);\r\n    }\r\n    AGMImpl.prototype.serverRemoved = function (callback) {\r\n        return this.client.serverRemoved(callback);\r\n    };\r\n    AGMImpl.prototype.serverAdded = function (callback) {\r\n        return this.client.serverAdded(callback);\r\n    };\r\n    AGMImpl.prototype.serverMethodRemoved = function (callback) {\r\n        return this.client.serverMethodRemoved(callback);\r\n    };\r\n    AGMImpl.prototype.serverMethodAdded = function (callback) {\r\n        return this.client.serverMethodAdded(callback);\r\n    };\r\n    AGMImpl.prototype.methodRemoved = function (callback) {\r\n        return this.client.methodRemoved(callback);\r\n    };\r\n    AGMImpl.prototype.methodAdded = function (callback) {\r\n        return this.client.methodAdded(callback);\r\n    };\r\n    AGMImpl.prototype.methodsForInstance = function (instance) {\r\n        return this.client.methodsForInstance(instance);\r\n    };\r\n    AGMImpl.prototype.methods = function (methodFilter) {\r\n        return this.client.methods(methodFilter);\r\n    };\r\n    AGMImpl.prototype.servers = function (methodFilter) {\r\n        return this.client.servers(methodFilter);\r\n    };\r\n    AGMImpl.prototype.subscribe = function (method, options, successCallback, errorCallback) {\r\n        return this.client.subscribe(method, options, successCallback, errorCallback);\r\n    };\r\n    AGMImpl.prototype.createStream = function (streamDef, callbacks, successCallback, errorCallback) {\r\n        return this.server.createStream(streamDef, callbacks, successCallback, errorCallback);\r\n    };\r\n    AGMImpl.prototype.unregister = function (methodFilter) {\r\n        return this.server.unregister(methodFilter);\r\n    };\r\n    AGMImpl.prototype.registerAsync = function (methodDefinition, callback) {\r\n        return this.server.registerAsync(methodDefinition, callback);\r\n    };\r\n    AGMImpl.prototype.register = function (methodDefinition, callback) {\r\n        return this.server.register(methodDefinition, callback);\r\n    };\r\n    AGMImpl.prototype.invoke = function (methodFilter, argumentObj, target, additionalOptions, success, error) {\r\n        return this.client.invoke(methodFilter, argumentObj, target, additionalOptions, success, error);\r\n    };\r\n    AGMImpl.prototype.updateInstance = function (newInstance) {\r\n        if (this.instance.machine === undefined) {\r\n            this.instance.machine = newInstance.MachineName || newInstance.machine;\r\n        }\r\n        if (this.instance.user === undefined) {\r\n            this.instance.user = newInstance.UserName || newInstance.user;\r\n        }\r\n        if (this.instance.environment === undefined) {\r\n            this.instance.environment = newInstance.Environment || newInstance.environment;\r\n        }\r\n        if (this.instance.region === undefined) {\r\n            this.instance.region = newInstance.Region || newInstance.region;\r\n        }\r\n    };\r\n    return AGMImpl;\r\n}());\r\nexports.default = AGMImpl;\r\n//# sourceMappingURL=agm.js.map\n\n/***/ }),\n/* 54 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar invoke_1 = __webpack_require__(55);\r\nvar promisify_1 = __webpack_require__(8);\r\nvar Client = (function () {\r\n    function Client(protocol, repo, instance, configuration) {\r\n        this.protocol = protocol;\r\n        this.repo = repo;\r\n        this.instance = instance;\r\n        this.configuration = configuration;\r\n        this.clientInvocations = new invoke_1.default(protocol);\r\n    }\r\n    Client.prototype.subscribe = function (method, options, successCallback, errorCallback) {\r\n        var _this = this;\r\n        var callProtocolSubscribe = function (targetServers, stream, successProxy, errorProxy) {\r\n            _this.protocol.client.subscribe(stream, options.arguments, targetServers, { methodResponseTimeout: options.waitTimeoutMs }, successProxy, errorProxy);\r\n        };\r\n        var promise = new Promise(function (resolve, reject) {\r\n            var successProxy = function (sub) {\r\n                resolve(sub);\r\n            };\r\n            var errorProxy = function (err) {\r\n                reject(err);\r\n            };\r\n            var methodDef;\r\n            if (typeof method === \"string\") {\r\n                methodDef = { name: method };\r\n            }\r\n            else {\r\n                methodDef = method;\r\n            }\r\n            if (options === undefined) {\r\n                options = {};\r\n            }\r\n            var target = options.target;\r\n            if (target === undefined) {\r\n                target = \"best\";\r\n            }\r\n            if (typeof target === \"string\" && target !== \"all\" && target !== \"best\") {\r\n                reject({ message: '\"' + target + '\" is not a valid target. Valid targets are \"all\", \"best\", or an instance.' });\r\n            }\r\n            if (options.methodResponseTimeout === undefined) {\r\n                options.methodResponseTimeout = options.method_response_timeout;\r\n                if (options.methodResponseTimeout === undefined) {\r\n                    options.methodResponseTimeout = _this.configuration.methodResponseTimeout;\r\n                }\r\n            }\r\n            if (options.waitTimeoutMs === undefined) {\r\n                options.waitTimeoutMs = options.wait_for_method_timeout;\r\n                if (options.waitTimeoutMs === undefined) {\r\n                    options.waitTimeoutMs = _this.configuration.waitTimeoutMs;\r\n                }\r\n            }\r\n            var delayStep = 500;\r\n            var delayTillNow = 0;\r\n            var currentServers = _this.getServerMethodsByFilterAndTarget(methodDef, target);\r\n            if (currentServers.length > 0) {\r\n                callProtocolSubscribe(currentServers, currentServers[0].methods[0], successProxy, errorProxy);\r\n            }\r\n            else {\r\n                var retry_1 = function () {\r\n                    delayTillNow += delayStep;\r\n                    currentServers = _this.getServerMethodsByFilterAndTarget(methodDef, target);\r\n                    if (currentServers.length > 0) {\r\n                        var streamInfo = currentServers[0].methods[0];\r\n                        callProtocolSubscribe(currentServers, streamInfo, successProxy, errorProxy);\r\n                    }\r\n                    else if (delayTillNow >= options.waitTimeoutMs) {\r\n                        var def = typeof method === \"string\" ? { name: method } : method;\r\n                        var info = {\r\n                            id: undefined,\r\n                            info: def,\r\n                            getInfoForUser: function () {\r\n                                return methodDef;\r\n                            },\r\n                            protocolState: undefined,\r\n                        };\r\n                        callProtocolSubscribe(currentServers, info, successProxy, errorProxy);\r\n                    }\r\n                    else {\r\n                        setTimeout(retry_1, delayStep);\r\n                    }\r\n                };\r\n                setTimeout(retry_1, delayStep);\r\n            }\r\n        });\r\n        return promisify_1.default(promise, successCallback, errorCallback);\r\n    };\r\n    Client.prototype.servers = function (methodFilter) {\r\n        return this.getServers(methodFilter).map(function (serverMethodMap) {\r\n            return serverMethodMap.server.getInfoForUser();\r\n        });\r\n    };\r\n    Client.prototype.methods = function (methodFilter) {\r\n        return this.getMethods(methodFilter).map(function (m) {\r\n            return m.getInfoForUser();\r\n        });\r\n    };\r\n    Client.prototype.methodsForInstance = function (instance) {\r\n        return this.getMethodsForInstance(instance).map(function (m) {\r\n            return m.getInfoForUser();\r\n        });\r\n    };\r\n    Client.prototype.methodAdded = function (callback) {\r\n        return this.repo.onMethodAdded(function (method) {\r\n            callback(method.getInfoForUser());\r\n        });\r\n    };\r\n    Client.prototype.methodRemoved = function (callback) {\r\n        return this.repo.onMethodRemoved(function (method) {\r\n            callback(method.getInfoForUser());\r\n        });\r\n    };\r\n    Client.prototype.serverAdded = function (callback) {\r\n        return this.repo.onServerAdded(function (server) {\r\n            callback(server.getInfoForUser());\r\n        });\r\n    };\r\n    Client.prototype.serverRemoved = function (callback) {\r\n        return this.repo.onServerRemoved(function (server, reason) {\r\n            callback(server.getInfoForUser(), reason);\r\n        });\r\n    };\r\n    Client.prototype.serverMethodAdded = function (callback) {\r\n        return this.repo.onServerMethodAdded(function (server, method) {\r\n            callback({ server: server.getInfoForUser(), method: method.getInfoForUser() });\r\n        });\r\n    };\r\n    Client.prototype.serverMethodRemoved = function (callback) {\r\n        return this.repo.onServerMethodRemoved(function (server, method) {\r\n            callback({ server: server.getInfoForUser(), method: method.getInfoForUser() });\r\n        });\r\n    };\r\n    Client.prototype.invoke = function (methodFilter, argumentObj, target, additionalOptions, success, error) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            var successProxy = function (args) {\r\n                resolve(args);\r\n            };\r\n            var errorProxy = function (err) {\r\n                reject(err);\r\n            };\r\n            if (!argumentObj) {\r\n                argumentObj = {};\r\n            }\r\n            if (!target) {\r\n                target = \"best\";\r\n            }\r\n            if (typeof target === \"string\" && target !== \"all\" && target !== \"best\") {\r\n                reject({ message: '\"' + target + '\" is not a valid target. Valid targets are \"all\" and \"best\".' });\r\n            }\r\n            if (!additionalOptions) {\r\n                additionalOptions = {};\r\n            }\r\n            if (additionalOptions.methodResponseTimeoutMs === undefined) {\r\n                additionalOptions.methodResponseTimeoutMs = additionalOptions.method_response_timeout;\r\n                if (additionalOptions.methodResponseTimeoutMs === undefined) {\r\n                    additionalOptions.methodResponseTimeoutMs = _this.configuration.methodResponseTimeout;\r\n                }\r\n            }\r\n            if (additionalOptions.waitTimeoutMs === undefined) {\r\n                additionalOptions.waitTimeoutMs = additionalOptions.wait_for_method_timeout;\r\n                if (additionalOptions.waitTimeoutMs === undefined) {\r\n                    additionalOptions.waitTimeoutMs = _this.configuration.waitTimeoutMs;\r\n                }\r\n            }\r\n            if (additionalOptions.waitTimeoutMs !== undefined && typeof additionalOptions.waitTimeoutMs !== \"number\") {\r\n                reject({ message: '\"' + additionalOptions.waitTimeoutMs + '\" is not a valid number for \\'waitTimeoutMs\\'' });\r\n                return;\r\n            }\r\n            if (typeof argumentObj !== \"object\") {\r\n                reject({ message: \"The method arguments must be an object.\" });\r\n                return;\r\n            }\r\n            if (typeof methodFilter === \"string\") {\r\n                methodFilter = { name: methodFilter };\r\n            }\r\n            var serversMethodMap = _this.getServerMethodsByFilterAndTarget(methodFilter, target);\r\n            if (serversMethodMap.length === 0) {\r\n                _this.invokeUnExisting(methodFilter, argumentObj, target, additionalOptions, successProxy, errorProxy);\r\n            }\r\n            else if (serversMethodMap.length === 1) {\r\n                var serverMethodPair = serversMethodMap[0];\r\n                _this.clientInvocations.invoke(serverMethodPair.methods[0], argumentObj, serverMethodPair.server, additionalOptions, successProxy, errorProxy);\r\n            }\r\n            else {\r\n                _this.invokeOnAll(serversMethodMap, argumentObj, additionalOptions, successProxy, errorProxy);\r\n            }\r\n        });\r\n        return promisify_1.default(promise, success, error);\r\n    };\r\n    Client.prototype.invokeUnExisting = function (methodFilter, argumentObj, target, additionalOptions, success, error) {\r\n        var _this = this;\r\n        var callError = function () {\r\n            error({\r\n                method: methodFilter,\r\n                called_with: argumentObj,\r\n                message: \"Can not find a method matching \" + JSON.stringify(methodFilter) + \" with server filter \" + JSON.stringify(target),\r\n                executed_by: undefined,\r\n                returned: undefined,\r\n                status: undefined,\r\n            });\r\n        };\r\n        if (additionalOptions.waitTimeoutMs === 0) {\r\n            callError();\r\n        }\r\n        else {\r\n            var delayStep_1 = 500;\r\n            var delayTillNow_1 = 0;\r\n            var retry_2 = function () {\r\n                delayTillNow_1 += delayStep_1;\r\n                var serversMethodMap = _this.getServerMethodsByFilterAndTarget(methodFilter, target);\r\n                if (serversMethodMap.length > 0) {\r\n                    _this.invoke(methodFilter, argumentObj, target, additionalOptions, success, error);\r\n                }\r\n                else if (delayTillNow_1 >= additionalOptions.waitTimeoutMs) {\r\n                    callError();\r\n                }\r\n                else {\r\n                    setTimeout(retry_2, delayStep_1);\r\n                }\r\n            };\r\n            setTimeout(retry_2, delayStep_1);\r\n        }\r\n    };\r\n    Client.prototype.invokeOnAll = function (serverMethodsMap, argumentObj, additionalOptions, success, error) {\r\n        var _this = this;\r\n        var successes = [];\r\n        var errors = [];\r\n        var successCallback = function (result) {\r\n            successes.push(result);\r\n            sendResponse();\r\n        };\r\n        var errorCallback = function (err) {\r\n            errors.push(err);\r\n            sendResponse();\r\n        };\r\n        var sendResponse = function () {\r\n            if (successes.length + errors.length < serverMethodsMap.length) {\r\n                return;\r\n            }\r\n            if (successes.length !== 0) {\r\n                var result_1 = successes.reduce(function (obj, invResult) {\r\n                    obj.method = invResult.method;\r\n                    obj.called_with = invResult.called_with;\r\n                    obj.returned = invResult.returned;\r\n                    obj.all_return_values.push({\r\n                        executed_by: invResult.executed_by,\r\n                        returned: invResult.returned,\r\n                        called_with: invResult.called_with,\r\n                        method: invResult.method,\r\n                        message: undefined,\r\n                        status: undefined,\r\n                    });\r\n                    obj.executed_by = invResult.executed_by;\r\n                    return obj;\r\n                }, { all_return_values: [] });\r\n                if (errors.length !== 0) {\r\n                    result_1.all_errors = [];\r\n                    errors.forEach(function (obj) {\r\n                        result_1.all_errors.push({\r\n                            name: obj.method.name,\r\n                            message: obj.message,\r\n                        });\r\n                    });\r\n                }\r\n                success(result_1);\r\n            }\r\n            else if (errors.length !== 0) {\r\n                error(errors.reduce(function (obj, currentError) {\r\n                    obj.method = currentError.method;\r\n                    obj.called_with = currentError.called_with;\r\n                    obj.message = currentError.message;\r\n                    obj.all_errors.push({\r\n                        executed_by: currentError.executed_by,\r\n                        message: currentError.message,\r\n                    });\r\n                    return obj;\r\n                }, { all_errors: [] }));\r\n            }\r\n        };\r\n        serverMethodsMap.forEach(function (serverMethodsPair) {\r\n            _this.clientInvocations.invoke(serverMethodsPair.methods[0], argumentObj, serverMethodsPair.server, additionalOptions, successCallback, errorCallback);\r\n        });\r\n    };\r\n    Client.prototype.filterByTarget = function (target, serverMethodMap) {\r\n        var _this = this;\r\n        var targetServerMethod = [];\r\n        if (typeof target === \"string\") {\r\n            if (target === \"all\") {\r\n                targetServerMethod = serverMethodMap;\r\n            }\r\n            else if (target === \"best\") {\r\n                var matchingMachine = serverMethodMap.filter(function (serverMethodPair) {\r\n                    var serverInfo = serverMethodPair.server.info;\r\n                    return serverInfo.machine === _this.instance.machine;\r\n                })[0];\r\n                if (matchingMachine) {\r\n                    return [matchingMachine];\r\n                }\r\n                targetServerMethod = serverMethodMap[0] !== undefined ? [serverMethodMap[0]] : [];\r\n            }\r\n        }\r\n        else {\r\n            if (!Array.isArray(target)) {\r\n                target = [target];\r\n            }\r\n            if (Array.isArray(target)) {\r\n                targetServerMethod = target.reduce(function (matches, filter) {\r\n                    var myMatches = serverMethodMap.filter(function (serverMethodPair) {\r\n                        return _this.instanceMatch(filter, serverMethodPair.server.info);\r\n                    });\r\n                    return matches.concat(myMatches);\r\n                }, []);\r\n            }\r\n        }\r\n        return targetServerMethod;\r\n    };\r\n    Client.prototype.instanceMatch = function (instanceFilter, instanceDefinition) {\r\n        return this.containsProps(instanceFilter, instanceDefinition);\r\n    };\r\n    Client.prototype.methodMatch = function (methodFilter, methodDefinition) {\r\n        return this.containsProps(methodFilter, methodDefinition);\r\n    };\r\n    Client.prototype.containsProps = function (filter, object) {\r\n        return Object.keys(filter).reduce(function (match, prop) {\r\n            if (!filter[prop] || typeof filter[prop] === \"function\") {\r\n                return match;\r\n            }\r\n            if (filter[prop].constructor === RegExp) {\r\n                if (!filter[prop].test(object[prop])) {\r\n                    return false;\r\n                }\r\n                else {\r\n                    return match;\r\n                }\r\n            }\r\n            else {\r\n                if (String(filter[prop]).toLowerCase() !== String(object[prop]).toLowerCase()) {\r\n                    return false;\r\n                }\r\n                else {\r\n                    return match;\r\n                }\r\n            }\r\n        }, true);\r\n    };\r\n    Client.prototype.getMethods = function (methodFilter) {\r\n        var _this = this;\r\n        if (methodFilter === undefined) {\r\n            return this.repo.getMethods();\r\n        }\r\n        if (typeof methodFilter === \"string\") {\r\n            methodFilter = { name: methodFilter };\r\n        }\r\n        return this.repo.getMethods().filter(function (method) {\r\n            return _this.methodMatch(methodFilter, method.info);\r\n        });\r\n    };\r\n    Client.prototype.getMethodsForInstance = function (instanceFilter) {\r\n        var _this = this;\r\n        var allServers = this.repo.getServers();\r\n        var matchingServers = allServers.filter(function (server) {\r\n            return _this.instanceMatch(instanceFilter, server.info);\r\n        });\r\n        if (matchingServers.length === 0) {\r\n            return [];\r\n        }\r\n        var resultMethodsObject = {};\r\n        if (matchingServers.length === 1) {\r\n            resultMethodsObject = matchingServers[0].methods;\r\n        }\r\n        else {\r\n            matchingServers.forEach(function (server) {\r\n                Object.keys(server.methods).forEach(function (methodKey) {\r\n                    var method = server.methods[methodKey];\r\n                    resultMethodsObject[method.id] = method;\r\n                });\r\n            });\r\n        }\r\n        return Object.keys(resultMethodsObject)\r\n            .map(function (key) {\r\n            return resultMethodsObject[key];\r\n        });\r\n    };\r\n    Client.prototype.getServers = function (methodFilter) {\r\n        var _this = this;\r\n        var servers = this.repo.getServers();\r\n        if (methodFilter === undefined) {\r\n            return servers.map(function (server) {\r\n                return { server: server };\r\n            });\r\n        }\r\n        var methods = this.getMethods(methodFilter);\r\n        if (methods === undefined) {\r\n            return [];\r\n        }\r\n        return servers.reduce(function (prev, current) {\r\n            var methodsForServer = _this.repo.getServerMethodsById(current.id);\r\n            var matchingMethods = methodsForServer.filter(function (method) {\r\n                return _this.methodMatch(methodFilter, method.info);\r\n            });\r\n            if (matchingMethods.length > 0) {\r\n                prev.push({ server: current, methods: matchingMethods });\r\n            }\r\n            return prev;\r\n        }, []);\r\n    };\r\n    Client.prototype.getServerMethodsByFilterAndTarget = function (methodFilter, target) {\r\n        var serversMethodMap = this.getServers(methodFilter);\r\n        return this.filterByTarget(target, serversMethodMap);\r\n    };\r\n    return Client;\r\n}());\r\nexports.default = Client;\r\n//# sourceMappingURL=client.js.map\n\n/***/ }),\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar random_1 = __webpack_require__(23);\r\nvar ClientInvocations = (function () {\r\n    function ClientInvocations(_protocol) {\r\n        var _this = this;\r\n        this._protocol = _protocol;\r\n        this._pendingCallbacks = {};\r\n        _protocol.client.onInvocationResult(function (invocationId, executedBy, status, result, resultMessage) { return _this.processInvocationResult(invocationId, executedBy, status, result, resultMessage); });\r\n    }\r\n    ClientInvocations.prototype.invoke = function (method, argumentsObj, target, stuff, success, error) {\r\n        var invocationId = random_1.default();\r\n        this.registerInvocation(invocationId, {\r\n            method: method,\r\n            calledWith: argumentsObj,\r\n        }, success, error, stuff.methodResponseTimeoutMs);\r\n        this._protocol.client.invoke(invocationId, method, argumentsObj, target, stuff);\r\n    };\r\n    ClientInvocations.prototype.registerInvocation = function (invocationId, invocationInfo, success, error, timeout) {\r\n        var _this = this;\r\n        this._pendingCallbacks[invocationId] = { invocationInfo: invocationInfo, success: success, error: error };\r\n        setTimeout(function () {\r\n            if (_this._pendingCallbacks[invocationId] === undefined) {\r\n                return;\r\n            }\r\n            error({\r\n                method: invocationInfo.method.getInfoForUser(),\r\n                called_with: invocationInfo.calledWith,\r\n                executed_by: undefined,\r\n                status: undefined,\r\n                returned: undefined,\r\n                message: \"Invocation timeout (\" + timeout + \" ms) reached\",\r\n            });\r\n            delete _this._pendingCallbacks[invocationId];\r\n        }, timeout);\r\n    };\r\n    ClientInvocations.prototype.processInvocationResult = function (invocationId, executedBy, status, result, resultMessage) {\r\n        var callback = this._pendingCallbacks[invocationId];\r\n        if (callback === undefined) {\r\n            return;\r\n        }\r\n        if (status === 0 && typeof callback.success === \"function\") {\r\n            callback.success({\r\n                method: callback.invocationInfo.method.getInfoForUser(),\r\n                called_with: callback.invocationInfo.calledWith,\r\n                executed_by: executedBy,\r\n                returned: result,\r\n                message: resultMessage,\r\n                status: status,\r\n            });\r\n        }\r\n        else if (typeof callback.error === \"function\") {\r\n            callback.error({\r\n                method: callback.invocationInfo.method.getInfoForUser(),\r\n                called_with: callback.invocationInfo.calledWith,\r\n                executed_by: executedBy,\r\n                message: resultMessage,\r\n                status: status,\r\n                returned: result,\r\n            });\r\n        }\r\n        delete this._pendingCallbacks[invocationId];\r\n    };\r\n    return ClientInvocations;\r\n}());\r\nexports.default = ClientInvocations;\r\n//# sourceMappingURL=invoke.js.map\n\n/***/ }),\n/* 56 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar ClientRepository = (function () {\r\n    function ClientRepository() {\r\n        this.servers = {};\r\n        this.methodsCount = {};\r\n        this.callbacks = callback_registry_1.default();\r\n    }\r\n    ClientRepository.prototype.addServer = function (info, serverId) {\r\n        var _this = this;\r\n        var current = this.servers[serverId];\r\n        if (current) {\r\n            return current.id;\r\n        }\r\n        var serverEntry = {\r\n            id: serverId,\r\n            info: info,\r\n            methods: {},\r\n            getInfoForUser: function () {\r\n                var serverInfo = _this.createUserServerInfo(serverEntry.info);\r\n                serverInfo.getMethods = function () {\r\n                    return _this.getServerMethodsById(serverEntry.id).map(function (m) {\r\n                        return m.getInfoForUser();\r\n                    });\r\n                };\r\n                serverInfo.getStreams = function () {\r\n                    return _this.getServerMethodsById(serverEntry.id)\r\n                        .filter(function (method) {\r\n                        return method.info.supportsStreaming;\r\n                    })\r\n                        .map(function (m) {\r\n                        return m.getInfoForUser();\r\n                    });\r\n                };\r\n                return serverInfo;\r\n            },\r\n        };\r\n        this.servers[serverId] = serverEntry;\r\n        this.callbacks.execute(\"onServerAdded\", serverEntry);\r\n        return serverId;\r\n    };\r\n    ClientRepository.prototype.removeServerById = function (id, reason) {\r\n        var _this = this;\r\n        var server = this.servers[id];\r\n        Object.keys(server.methods).forEach(function (methodId) {\r\n            _this.removeServerMethod(id, methodId);\r\n        });\r\n        delete this.servers[id];\r\n        this.callbacks.execute(\"onServerRemoved\", server, reason);\r\n    };\r\n    ClientRepository.prototype.addServerMethod = function (serverId, method, protocolState) {\r\n        if (!protocolState) {\r\n            protocolState = {};\r\n        }\r\n        var server = this.servers[serverId];\r\n        if (!server) {\r\n            throw new Error(\"server does not exists\");\r\n        }\r\n        var methodId = this.createMethodId(method);\r\n        if (server.methods[methodId]) {\r\n            return;\r\n        }\r\n        var that = this;\r\n        var methodEntity = {\r\n            id: methodId,\r\n            info: method,\r\n            getInfoForUser: function () {\r\n                var result = that.createUserMethodInfo(methodEntity.info);\r\n                result.getServers = function () {\r\n                    return that.getServersByMethod(methodId);\r\n                };\r\n                return result;\r\n            },\r\n            protocolState: protocolState,\r\n        };\r\n        server.methods[methodId] = methodEntity;\r\n        if (!this.methodsCount[methodId]) {\r\n            this.methodsCount[methodId] = 0;\r\n            this.callbacks.execute(\"onMethodAdded\", methodEntity);\r\n        }\r\n        this.methodsCount[methodId] = this.methodsCount[methodId] + 1;\r\n        this.callbacks.execute(\"onServerMethodAdded\", server, methodEntity);\r\n    };\r\n    ClientRepository.prototype.createMethodId = function (methodInfo) {\r\n        var accepts = methodInfo.accepts !== undefined ? methodInfo.accepts : \"\";\r\n        var returns = methodInfo.returns !== undefined ? methodInfo.returns : \"\";\r\n        return (methodInfo.name + accepts + returns).toLowerCase();\r\n    };\r\n    ClientRepository.prototype.removeServerMethod = function (serverId, methodId) {\r\n        var server = this.servers[serverId];\r\n        if (!server) {\r\n            throw new Error(\"server does not exists\");\r\n        }\r\n        var method = server.methods[methodId];\r\n        delete server.methods[methodId];\r\n        this.methodsCount[methodId] = this.methodsCount[methodId] - 1;\r\n        if (this.methodsCount[methodId] === 0) {\r\n            this.callbacks.execute(\"onMethodRemoved\", method);\r\n        }\r\n        this.callbacks.execute(\"onServerMethodRemoved\", server, method);\r\n    };\r\n    ClientRepository.prototype.getMethods = function () {\r\n        var _this = this;\r\n        var allMethods = {};\r\n        Object.keys(this.servers).forEach(function (serverId) {\r\n            var server = _this.servers[serverId];\r\n            Object.keys(server.methods).forEach(function (methodId) {\r\n                var method = server.methods[methodId];\r\n                allMethods[method.id] = method;\r\n            });\r\n        });\r\n        var methodsAsArray = Object.keys(allMethods).map(function (id) {\r\n            return allMethods[id];\r\n        });\r\n        return methodsAsArray;\r\n    };\r\n    ClientRepository.prototype.getServers = function () {\r\n        var _this = this;\r\n        var allServers = [];\r\n        Object.keys(this.servers).forEach(function (serverId) {\r\n            var server = _this.servers[serverId];\r\n            allServers.push(server);\r\n        });\r\n        return allServers;\r\n    };\r\n    ClientRepository.prototype.getServerMethodsById = function (serverId) {\r\n        var server = this.servers[serverId];\r\n        return Object.keys(server.methods).map(function (id) {\r\n            return server.methods[id];\r\n        });\r\n    };\r\n    ClientRepository.prototype.onServerAdded = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onServerAdded\", callback);\r\n        this.getServers().forEach(function (server) {\r\n            callback(server);\r\n        });\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.onMethodAdded = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onMethodAdded\", callback);\r\n        this.getMethods().forEach(function (method) {\r\n            callback(method);\r\n        });\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.onServerMethodAdded = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onServerMethodAdded\", callback);\r\n        this.getServers().forEach(function (server) {\r\n            var methods = server.methods;\r\n            Object.keys(methods).forEach(function (methodId) {\r\n                callback(server, methods[methodId]);\r\n            });\r\n        });\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.onMethodRemoved = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onMethodRemoved\", callback);\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.onServerRemoved = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onServerRemoved\", callback);\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.onServerMethodRemoved = function (callback) {\r\n        var unsubscribeFunc = this.callbacks.add(\"onServerMethodRemoved\", callback);\r\n        return unsubscribeFunc;\r\n    };\r\n    ClientRepository.prototype.getServerById = function (id) {\r\n        return this.servers[id];\r\n    };\r\n    ClientRepository.prototype.reset = function () {\r\n        this.servers = {};\r\n        this.methodsCount = {};\r\n    };\r\n    ClientRepository.prototype.createUserServerInfo = function (serverInfo) {\r\n        return {\r\n            machine: serverInfo.machine,\r\n            pid: serverInfo.pid,\r\n            user: serverInfo.user,\r\n            application: serverInfo.application,\r\n            environment: serverInfo.environment,\r\n            region: serverInfo.region,\r\n            instance: serverInfo.instance,\r\n            windowId: serverInfo.windowId,\r\n            peerId: serverInfo.peerId,\r\n        };\r\n    };\r\n    ClientRepository.prototype.createUserMethodInfo = function (methodInfo) {\r\n        var result = {\r\n            name: methodInfo.name,\r\n            accepts: methodInfo.accepts,\r\n            returns: methodInfo.returns,\r\n            description: methodInfo.description,\r\n            displayName: methodInfo.displayName,\r\n            objectTypes: methodInfo.objectTypes,\r\n            supportsStreaming: methodInfo.supportsStreaming,\r\n        };\r\n        result.object_types = methodInfo.objectTypes;\r\n        result.display_name = methodInfo.objectTypes;\r\n        result.version = methodInfo.objectTypes;\r\n        return result;\r\n    };\r\n    ClientRepository.prototype.getServersByMethod = function (id) {\r\n        var _this = this;\r\n        var allServers = [];\r\n        Object.keys(this.servers).forEach(function (serverId) {\r\n            var server = _this.servers[serverId];\r\n            Object.keys(server.methods).forEach(function (methodId) {\r\n                if (methodId === id) {\r\n                    allServers.push(server.getInfoForUser());\r\n                }\r\n            });\r\n        });\r\n        return allServers;\r\n    };\r\n    return ClientRepository;\r\n}());\r\nexports.default = ClientRepository;\r\n//# sourceMappingURL=repository.js.map\n\n/***/ }),\n/* 57 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar promisify_1 = __webpack_require__(8);\r\nvar NativeAGM = (function () {\r\n    function NativeAGM(instance, helpers, agmFacade) {\r\n        this.instance = instance;\r\n        this.helpers = helpers;\r\n        this.agmFacade = agmFacade;\r\n        this.protocolVersion = this.agmFacade.protocolVersion;\r\n    }\r\n    NativeAGM.prototype.register = function (name, handler) {\r\n        var methodInfoAsObject = this.helpers.stringToObject(name, \"name\");\r\n        this.helpers.validateMethodInfo(methodInfoAsObject);\r\n        if (this.protocolVersion && this.protocolVersion >= 3) {\r\n            this.agmFacade.register(JSON.stringify(methodInfoAsObject), handler, true);\r\n        }\r\n        else {\r\n            this.agmFacade.register(JSON.stringify(methodInfoAsObject), function (arg, caller) {\r\n                var methodResult = handler(JSON.parse(arg), caller);\r\n                return JSON.stringify(methodResult);\r\n            });\r\n        }\r\n    };\r\n    NativeAGM.prototype.registerAsync = function (name, handler) {\r\n        if (!this.agmFacade.registerAsync) {\r\n            throw new Error(\"not supported in that version of HtmlContainer\");\r\n        }\r\n        var methodInfoAsObject = this.helpers.stringToObject(name, \"name\");\r\n        this.helpers.validateMethodInfo(methodInfoAsObject);\r\n        this.agmFacade.registerAsync(methodInfoAsObject, function (args, instance, tracker) {\r\n            handler(args, instance, function (successArgs) {\r\n                tracker.success(successArgs);\r\n            }, function (error) {\r\n                tracker.error(error);\r\n            });\r\n        });\r\n    };\r\n    NativeAGM.prototype.unregister = function (definition) {\r\n        this.agmFacade.unregister(JSON.stringify(this.helpers.stringToObject(definition, \"name\")));\r\n    };\r\n    NativeAGM.prototype.invoke = function (method, argumentObj, target, options, success, error) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (argumentObj === undefined) {\r\n                argumentObj = {};\r\n            }\r\n            if (typeof argumentObj !== \"object\") {\r\n                reject({ message: \"The method arguments must be an object.\" });\r\n            }\r\n            if (options === undefined) {\r\n                options = {};\r\n            }\r\n            target = _this.helpers.targetArgToObject(target);\r\n            if (_this.agmFacade.invoke2) {\r\n                _this.agmFacade.invoke2(JSON.stringify(_this.helpers.stringToObject(method, \"name\")), argumentObj, JSON.stringify(target), JSON.stringify(options), function (a) {\r\n                    resolve(a);\r\n                }, function (err) {\r\n                    reject(err);\r\n                });\r\n            }\r\n            else {\r\n                var successProxy = void 0;\r\n                var errorProxy = void 0;\r\n                successProxy = function (args) {\r\n                    var parsed = JSON.parse(args);\r\n                    resolve(parsed);\r\n                };\r\n                errorProxy = function (args) {\r\n                    var parsed = JSON.parse(args);\r\n                    reject(parsed);\r\n                };\r\n                _this.agmFacade.invoke(JSON.stringify(_this.helpers.stringToObject(method, \"name\")), JSON.stringify(argumentObj), JSON.stringify(target), JSON.stringify(options), successProxy, errorProxy);\r\n            }\r\n        });\r\n        return promisify_1.default(promise, success, error);\r\n    };\r\n    NativeAGM.prototype.createStream = function (methodDefinition, options, successCallback, errorCallback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (typeof methodDefinition === \"string\") {\r\n                methodDefinition = {\r\n                    name: methodDefinition,\r\n                    getServers: function () { return []; },\r\n                };\r\n            }\r\n            if (!options) {\r\n                options = {\r\n                    subscriptionRequestHandler: undefined,\r\n                    subscriptionAddedHandler: undefined,\r\n                    subscriptionRemovedHandler: undefined,\r\n                };\r\n            }\r\n            _this.agmFacade.createStream2(JSON.stringify(methodDefinition), options.subscriptionRequestHandler, options.subscriptionAddedHandler, options.subscriptionRemovedHandler, function (stream) {\r\n                resolve(stream);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n        return promisify_1.default(promise, successCallback, errorCallback);\r\n    };\r\n    NativeAGM.prototype.subscribe = function (methodDefinition, parameters, successCallback, errorCallback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (typeof methodDefinition === \"undefined\") {\r\n                reject(\"method definition param is required\");\r\n            }\r\n            if (parameters === undefined) {\r\n                parameters = {};\r\n            }\r\n            parameters.args = JSON.stringify(parameters.arguments || {});\r\n            parameters.target = _this.helpers.targetArgToObject(parameters.target);\r\n            var name;\r\n            if (typeof methodDefinition === \"string\") {\r\n                name = methodDefinition;\r\n            }\r\n            else {\r\n                name = methodDefinition.name;\r\n            }\r\n            _this.agmFacade.subscribe2(name, JSON.stringify(parameters), function (sub) {\r\n                resolve(sub);\r\n            }, function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n        return promisify_1.default(promise, successCallback, errorCallback);\r\n    };\r\n    NativeAGM.prototype.servers = function (filter) {\r\n        var _this = this;\r\n        var jsonResult = this.agmFacade.servers(JSON.stringify(this.helpers.stringToObject(filter, \"name\")));\r\n        var parsedResult = this.helpers.agmParse(jsonResult);\r\n        return parsedResult.map(function (server) {\r\n            return _this.transformServerObject(server);\r\n        });\r\n    };\r\n    NativeAGM.prototype.methods = function (filter) {\r\n        var _this = this;\r\n        var jsonResult = this.agmFacade.methods(JSON.stringify(this.helpers.stringToObject(filter, \"name\")));\r\n        var parsedResult = this.helpers.agmParse(jsonResult);\r\n        return parsedResult.map(function (method) {\r\n            return _this.transformMethodObject(method);\r\n        });\r\n    };\r\n    NativeAGM.prototype.methodAdded = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.methodAdded(function (method) {\r\n            if (subscribed) {\r\n                callback(_this.transformMethodObject(method));\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.methodRemoved = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.methodRemoved(function (method) {\r\n            if (subscribed) {\r\n                callback(_this.transformMethodObject(method));\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.serverAdded = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.serverAdded(function (server) {\r\n            if (subscribed) {\r\n                callback(_this.transformServerObject(server));\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.serverRemoved = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.serverRemoved(function (server) {\r\n            if (subscribed) {\r\n                callback(_this.transformServerObject(server));\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.serverMethodAdded = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.serverMethodAdded(function (info) {\r\n            if (subscribed) {\r\n                callback({\r\n                    server: _this.transformServerObject(info.server),\r\n                    method: _this.transformMethodObject(info.method),\r\n                });\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.serverMethodRemoved = function (callback) {\r\n        var _this = this;\r\n        var subscribed = true;\r\n        this.agmFacade.serverMethodRemoved(function (info) {\r\n            if (subscribed) {\r\n                callback({\r\n                    server: _this.transformServerObject(info.server),\r\n                    method: _this.transformMethodObject(info.method),\r\n                });\r\n            }\r\n        });\r\n        return function () {\r\n            subscribed = false;\r\n        };\r\n    };\r\n    NativeAGM.prototype.methodsForInstance = function (server) {\r\n        var jsonResult = this.agmFacade.methodsForInstance(JSON.stringify(server));\r\n        var methods = this.helpers.agmParse(jsonResult);\r\n        return methods.map(this.transformMethodObject);\r\n    };\r\n    NativeAGM.prototype.transformMethodObject = function (method) {\r\n        var _this = this;\r\n        if (!method) {\r\n            return undefined;\r\n        }\r\n        if (!method.displayName) {\r\n            method.displayName = method.display_name;\r\n        }\r\n        if (!method.objectTypes) {\r\n            method.objectTypes = method.object_types;\r\n        }\r\n        method.getServers = function () {\r\n            return _this.servers(method.name);\r\n        };\r\n        return method;\r\n    };\r\n    NativeAGM.prototype.transformServerObject = function (server) {\r\n        var _this = this;\r\n        if (!server) {\r\n            return undefined;\r\n        }\r\n        server.getMethods = function () {\r\n            return _this.methodsForInstance(server);\r\n        };\r\n        server.getStreams = function () {\r\n            return _this.methodsForInstance(server).filter(function (method) {\r\n                return method.supportsStreaming;\r\n            });\r\n        };\r\n        return server;\r\n    };\r\n    return NativeAGM;\r\n}());\r\nexports.NativeAGM = NativeAGM;\r\n//# sourceMappingURL=agm.js.map\n\n/***/ }),\n/* 58 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Helpers = (function () {\r\n    function Helpers(facade) {\r\n        this.facade = facade;\r\n        this.dateTimeIdentifier = facade.jsonValueDatePrefix;\r\n        this.lenOfIdentifier = this.dateTimeIdentifier.length;\r\n    }\r\n    Helpers.prototype.agmParse = function (str) {\r\n        var _this = this;\r\n        return JSON.parse(str, function (k, v) {\r\n            if (typeof v !== \"string\") {\r\n                return v;\r\n            }\r\n            if (v[0] !== _this.dateTimeIdentifier[0]) {\r\n                return v;\r\n            }\r\n            if (v.indexOf(_this.dateTimeIdentifier) !== 0) {\r\n                return v;\r\n            }\r\n            var unixTimestampMs = v.substr(_this.lenOfIdentifier);\r\n            return new Date(parseFloat(unixTimestampMs));\r\n        });\r\n    };\r\n    Helpers.prototype.targetArgToObject = function (target) {\r\n        var _this = this;\r\n        target = target || \"best\";\r\n        if (typeof target === \"string\") {\r\n            if (target !== \"all\" && target !== \"best\") {\r\n                throw new Error(target + \" is not a valid target. Valid targets are 'all' and 'best'\");\r\n            }\r\n            return { target: target };\r\n        }\r\n        else {\r\n            if (!Array.isArray(target)) {\r\n                target = [target];\r\n            }\r\n            target = target.map(function (e) {\r\n                return _this.convertInstanceToRegex(e);\r\n            });\r\n            return { serverFilter: target };\r\n        }\r\n    };\r\n    Helpers.prototype.convertInstanceToRegex = function (instance) {\r\n        var instanceConverted = {};\r\n        Object.keys(instance).forEach(function (key) {\r\n            var propValue = instance[key];\r\n            instanceConverted[key] = propValue;\r\n            if (typeof propValue === \"undefined\" || propValue === null) {\r\n                return;\r\n            }\r\n            if (typeof propValue === \"string\" && propValue !== \"\") {\r\n                instanceConverted[key] = \"^\" + instance[key] + \"$\";\r\n            }\r\n            else if (instance[key].constructor === RegExp) {\r\n                instanceConverted[key] = instance[key].source;\r\n            }\r\n            else {\r\n                instanceConverted[key] = instance[key];\r\n            }\r\n        });\r\n        return instanceConverted;\r\n    };\r\n    Helpers.prototype.validateMethodInfo = function (methodInfo) {\r\n        if (typeof methodInfo === \"undefined\") {\r\n            throw Error(\"methodInfo is required argument\");\r\n        }\r\n        if (!methodInfo.name) {\r\n            throw Error(\"methodInfo object must contain name property\");\r\n        }\r\n        if (methodInfo.objectTypes) {\r\n            methodInfo.object_types = methodInfo.objectTypes;\r\n        }\r\n        if (methodInfo.displayName) {\r\n            methodInfo.display_name = methodInfo.displayName;\r\n        }\r\n    };\r\n    Helpers.prototype.stringToObject = function (param, stringPropName) {\r\n        if (typeof param === \"string\") {\r\n            var obj = {};\r\n            obj[stringPropName] = param;\r\n            return obj;\r\n        }\r\n        return param;\r\n    };\r\n    return Helpers;\r\n}());\r\nexports.Helpers = Helpers;\r\n//# sourceMappingURL=helpers.js.map\n\n/***/ }),\n/* 59 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar agm_1 = __webpack_require__(57);\r\nvar helpers_1 = __webpack_require__(58);\r\nfunction default_1(configuration) {\r\n    var facade = window.htmlContainer.jsAgmFacade;\r\n    var cfgAsString = createConfig(configuration);\r\n    return new Promise(function (resolve, reject) {\r\n        var successInit = function (instance) {\r\n            var nativeAGM = new agm_1.NativeAGM(instance, new helpers_1.Helpers(facade), facade);\r\n            nativeAGM.create_stream = nativeAGM.createStream;\r\n            nativeAGM.methods_for_instance = nativeAGM.methodsForInstance;\r\n            nativeAGM.method_added = nativeAGM.methodAdded;\r\n            nativeAGM.method_removed = nativeAGM.methodRemoved;\r\n            nativeAGM.server_added = nativeAGM.serverAdded;\r\n            nativeAGM.server_removed = nativeAGM.serverRemoved;\r\n            nativeAGM.server_method_added = nativeAGM.serverMethodAdded;\r\n            nativeAGM.server_method_removed = nativeAGM.serverMethodRemoved;\r\n            resolve(nativeAGM);\r\n        };\r\n        if (facade.protocolVersion && facade.protocolVersion >= 5 && facade.initAsync) {\r\n            facade.initAsync(cfgAsString, successInit, function (err) {\r\n                reject(err);\r\n            });\r\n        }\r\n        else {\r\n            var instance = facade.init(cfgAsString);\r\n            successInit(instance);\r\n        }\r\n    });\r\n}\r\nexports.default = default_1;\r\nvar createConfig = function (configuration) {\r\n    if (configuration !== undefined && configuration.metrics !== undefined) {\r\n        configuration.metrics.metricsIdentity = configuration.metrics.identity;\r\n        var metricsConfig = {\r\n            metricsIdentity: configuration.metrics.metricsIdentity,\r\n            path: configuration.metrics.path,\r\n        };\r\n        configuration.metrics = metricsConfig;\r\n    }\r\n    delete configuration.logger;\r\n    return JSON.stringify(configuration);\r\n};\r\n//# sourceMappingURL=native.js.map\n\n/***/ }),\n/* 60 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar random_1 = __webpack_require__(23);\r\nfunction createOwnInstance(userSubmittedProperties, resolvedIdentity, peerId) {\r\n    var document = global.document || global.process;\r\n    var instance = {\r\n        application: document.title + random_1.default(),\r\n        pid: Math.floor(Math.random() * 10000000000),\r\n    };\r\n    instance.peerId = peerId;\r\n    if (typeof userSubmittedProperties === \"object\") {\r\n        if (userSubmittedProperties.application !== undefined) {\r\n            instance.application = userSubmittedProperties.application;\r\n        }\r\n        instance.machine = userSubmittedProperties.machine;\r\n        instance.user = userSubmittedProperties.user;\r\n        instance.environment = userSubmittedProperties.environment;\r\n        instance.region = userSubmittedProperties.region;\r\n    }\r\n    if (typeof resolvedIdentity !== \"undefined\") {\r\n        instance.user = resolvedIdentity.user;\r\n        instance.instance = resolvedIdentity.instance;\r\n        instance.application = resolvedIdentity.application;\r\n        instance.pid = resolvedIdentity.process;\r\n        instance.machine = resolvedIdentity.machine;\r\n        instance.environment = resolvedIdentity.environment;\r\n        instance.region = resolvedIdentity.region;\r\n        instance.windowId = resolvedIdentity.windowId;\r\n    }\r\n    return instance;\r\n}\r\nexports.createOwnInstance = createOwnInstance;\r\n//# sourceMappingURL=instance.js.map\n\n/***/ }),\n/* 61 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar instance_1 = __webpack_require__(60);\r\nvar native_1 = __webpack_require__(59);\r\nvar factory_1 = __webpack_require__(64);\r\nvar agm_1 = __webpack_require__(53);\r\nvar repository_1 = __webpack_require__(56);\r\nvar repository_2 = __webpack_require__(68);\r\nexports.default = (function (configuration) {\r\n    if (!configuration.forceGW && configuration.gdVersion === 2) {\r\n        return native_1.default(configuration);\r\n    }\r\n    if (typeof configuration === \"undefined\") {\r\n        throw new Error(\"configuration is required\");\r\n    }\r\n    if (typeof configuration.connection === \"undefined\") {\r\n        throw new Error(\"configuration.connections is required\");\r\n    }\r\n    var connection = configuration.connection;\r\n    if (typeof configuration.methodResponseTimeout !== \"number\") {\r\n        configuration.methodResponseTimeout = 3000;\r\n    }\r\n    if (typeof configuration.waitTimeoutMs !== \"number\") {\r\n        configuration.waitTimeoutMs = 3000;\r\n    }\r\n    var myIdentity = connection.resolvedIdentity;\r\n    var myInstance = instance_1.createOwnInstance(configuration.instance, myIdentity, connection.peerId);\r\n    var clientRepository = new repository_1.default();\r\n    var serverRepository = new repository_2.default();\r\n    var protocolPromise;\r\n    var agmImpl;\r\n    if (connection.protocolVersion === 3) {\r\n        protocolPromise = factory_1.default(myInstance, connection, clientRepository, serverRepository, configuration, function () { return agmImpl; });\r\n    }\r\n    else {\r\n        throw new Error(\"agm protocol version \" + connection.protocolVersion + \" not supported\");\r\n    }\r\n    return new Promise(function (resolve, reject) {\r\n        protocolPromise.then(function (protocol) {\r\n            agmImpl = new agm_1.default(protocol, clientRepository, serverRepository, myInstance, configuration);\r\n            resolve(agmImpl);\r\n        }).catch(function (err) {\r\n            reject(err);\r\n        });\r\n    });\r\n});\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 62 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar STATUS_AWAITING_ACCEPT = \"awaitingAccept\";\r\nvar STATUS_SUBSCRIBED = \"subscribed\";\r\nvar ERR_MSG_SUB_FAILED = \"Subscription failed.\";\r\nvar ERR_MSG_SUB_REJECTED = \"Subscription rejected.\";\r\nvar ON_CLOSE_MSG_SERVER_INIT = \"ServerInitiated\";\r\nvar ON_CLOSE_MSG_CLIENT_INIT = \"ClientInitiated\";\r\nvar ClientStreaming = (function () {\r\n    function ClientStreaming(instance, session, repository, logger) {\r\n        var _this = this;\r\n        this.instance = instance;\r\n        this.session = session;\r\n        this.repository = repository;\r\n        this.logger = logger;\r\n        this.subscriptionsList = {};\r\n        this.subscriptionIdToLocalKeyMap = {};\r\n        this.nextSubLocalKey = 0;\r\n        this.handleErrorSubscribing = function (errorResponse) {\r\n            var tag = errorResponse._tag;\r\n            var subLocalKey = tag.subLocalKey;\r\n            var pendingSub = _this.subscriptionsList[subLocalKey];\r\n            if (typeof pendingSub !== \"object\") {\r\n                return;\r\n            }\r\n            pendingSub.trackedServers = pendingSub.trackedServers.filter(function (server) {\r\n                return server.serverId !== tag.serverId;\r\n            });\r\n            if (pendingSub.trackedServers.length <= 0) {\r\n                clearTimeout(pendingSub.timeoutId);\r\n                if (pendingSub.status === STATUS_AWAITING_ACCEPT) {\r\n                    var reason = (typeof errorResponse.reason === \"string\" && errorResponse.reason !== \"\") ?\r\n                        ' Publisher said \"' + errorResponse.reason + '\".' :\r\n                        \" No reason given.\";\r\n                    var callArgs = typeof pendingSub.arguments === \"object\" ?\r\n                        JSON.stringify(pendingSub.arguments) :\r\n                        \"{}\";\r\n                    pendingSub.error({\r\n                        message: ERR_MSG_SUB_REJECTED + reason + \" Called with:\" + callArgs,\r\n                        called_with: pendingSub.arguments,\r\n                        method: pendingSub.method.getInfoForUser(),\r\n                    });\r\n                }\r\n                else if (pendingSub.status === STATUS_SUBSCRIBED) {\r\n                    _this.callOnClosedHandlers(pendingSub);\r\n                }\r\n                delete _this.subscriptionsList[subLocalKey];\r\n            }\r\n        };\r\n        this.handleSubscribed = function (msg) {\r\n            var subLocalKey = msg._tag.subLocalKey;\r\n            var pendingSub = _this.subscriptionsList[subLocalKey];\r\n            if (typeof pendingSub !== \"object\") {\r\n                return;\r\n            }\r\n            var serverId = msg._tag.serverId;\r\n            var acceptingServer = pendingSub.trackedServers\r\n                .filter(function (server) {\r\n                return server.serverId === serverId;\r\n            })[0];\r\n            if (typeof acceptingServer !== \"object\") {\r\n                return;\r\n            }\r\n            acceptingServer.subscriptionId = msg.subscription_id;\r\n            _this.subscriptionIdToLocalKeyMap[msg.subscription_id] = subLocalKey;\r\n            var isFirstResponse = (pendingSub.status === STATUS_AWAITING_ACCEPT);\r\n            pendingSub.status = STATUS_SUBSCRIBED;\r\n            var that = _this;\r\n            if (isFirstResponse) {\r\n                pendingSub.success({\r\n                    onData: function (dataCallback) {\r\n                        if (typeof dataCallback !== \"function\") {\r\n                            throw new TypeError(\"The data callback must be a function.\");\r\n                        }\r\n                        pendingSub.handlers.onData.push(dataCallback);\r\n                        if (pendingSub.handlers.onData.length === 1 && pendingSub.queued.data.length > 0) {\r\n                            pendingSub.queued.data.forEach(function (dataItem) {\r\n                                dataCallback(dataItem);\r\n                            });\r\n                        }\r\n                    },\r\n                    onClosed: function (closedCallback) {\r\n                        if (typeof closedCallback !== \"function\") {\r\n                            throw new TypeError(\"The callback must be a function.\");\r\n                        }\r\n                        pendingSub.handlers.onClosed.push(closedCallback);\r\n                    },\r\n                    onFailed: function () {\r\n                    },\r\n                    close: function () { return that.closeSubscription(subLocalKey); },\r\n                    requestArguments: pendingSub.arguments,\r\n                    serverInstance: that.repository.getServerById(serverId).getInfoForUser(),\r\n                    stream: pendingSub.method.info,\r\n                });\r\n            }\r\n        };\r\n        this.handleEventData = function (msg) {\r\n            var subLocalKey = _this.subscriptionIdToLocalKeyMap[msg.subscription_id];\r\n            if (typeof subLocalKey === \"undefined\") {\r\n                return;\r\n            }\r\n            var subscription = _this.subscriptionsList[subLocalKey];\r\n            if (typeof subscription !== \"object\") {\r\n                return;\r\n            }\r\n            var trackedServersFound = subscription.trackedServers.filter(function (server) {\r\n                return server.subscriptionId === msg.subscription_id;\r\n            });\r\n            if (trackedServersFound.length !== 1) {\r\n                return;\r\n            }\r\n            var isPrivateData = msg.oob && msg.snapshot;\r\n            var sendingServerId = trackedServersFound[0].serverId;\r\n            var receivedStreamData = function () {\r\n                return {\r\n                    data: msg.data,\r\n                    server: _this.repository.getServerById(sendingServerId).getInfoForUser(),\r\n                    requestArguments: subscription.arguments || {},\r\n                    message: null,\r\n                    private: isPrivateData,\r\n                };\r\n            };\r\n            var onDataHandlers = subscription.handlers.onData;\r\n            var queuedData = subscription.queued.data;\r\n            if (onDataHandlers.length > 0) {\r\n                onDataHandlers.forEach(function (callback) {\r\n                    if (typeof callback === \"function\") {\r\n                        callback(receivedStreamData());\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                queuedData.push(receivedStreamData());\r\n            }\r\n        };\r\n        this.handleSubscriptionCancelled = function (msg) {\r\n            var subLocalKey = _this.subscriptionIdToLocalKeyMap[msg.subscription_id];\r\n            if (typeof subLocalKey === \"undefined\") {\r\n                return;\r\n            }\r\n            var subscription = _this.subscriptionsList[subLocalKey];\r\n            if (typeof subscription !== \"object\") {\r\n                return;\r\n            }\r\n            var expectedNewLength = subscription.trackedServers.length - 1;\r\n            subscription.trackedServers = subscription.trackedServers.filter(function (server) {\r\n                if (server.subscriptionId === msg.subscription_id) {\r\n                    subscription.queued.closers.push(server.serverId);\r\n                    return false;\r\n                }\r\n                else {\r\n                    return true;\r\n                }\r\n            });\r\n            if (subscription.trackedServers.length !== expectedNewLength) {\r\n                return;\r\n            }\r\n            if (subscription.trackedServers.length <= 0) {\r\n                clearTimeout(subscription.timeoutId);\r\n                _this.callOnClosedHandlers(subscription);\r\n                delete _this.subscriptionsList[subLocalKey];\r\n            }\r\n            delete _this.subscriptionIdToLocalKeyMap[msg.subscription_id];\r\n        };\r\n        session.on(\"subscribed\", this.handleSubscribed);\r\n        session.on(\"event\", this.handleEventData);\r\n        session.on(\"subscription-cancelled\", this.handleSubscriptionCancelled);\r\n    }\r\n    ClientStreaming.prototype.subscribe = function (streamingMethod, argumentObj, targetServers, stuff, success, error) {\r\n        var _this = this;\r\n        if (targetServers.length === 0) {\r\n            error({\r\n                method: streamingMethod.getInfoForUser(),\r\n                called_with: argumentObj,\r\n                message: ERR_MSG_SUB_FAILED + \" No available servers matched the target params.\",\r\n            });\r\n            return;\r\n        }\r\n        var subLocalKey = this.getNextSubscriptionLocalKey();\r\n        var pendingSub = this.registerSubscription(subLocalKey, streamingMethod, argumentObj, success, error, stuff.methodResponseTimeout);\r\n        if (typeof pendingSub !== \"object\") {\r\n            error({\r\n                method: streamingMethod.getInfoForUser(),\r\n                called_with: argumentObj,\r\n                message: ERR_MSG_SUB_FAILED + \" Unable to register the user callbacks.\",\r\n            });\r\n            return;\r\n        }\r\n        targetServers.forEach(function (target) {\r\n            var serverId = target.server.id;\r\n            pendingSub.trackedServers.push({\r\n                serverId: serverId,\r\n                subscriptionId: undefined,\r\n            });\r\n            var msg = {\r\n                type: \"subscribe\",\r\n                server_id: serverId,\r\n                method_id: streamingMethod.protocolState.id,\r\n                arguments_kv: argumentObj,\r\n            };\r\n            _this.session.send(msg, { serverId: serverId, subLocalKey: subLocalKey })\r\n                .then(function (m) { return _this.handleSubscribed(m); })\r\n                .catch(function (err) { return _this.handleErrorSubscribing(err); });\r\n        });\r\n    };\r\n    ClientStreaming.prototype.getNextSubscriptionLocalKey = function () {\r\n        var current = this.nextSubLocalKey;\r\n        this.nextSubLocalKey += 1;\r\n        return current;\r\n    };\r\n    ClientStreaming.prototype.registerSubscription = function (subLocalKey, method, args, success, error, timeout) {\r\n        var _this = this;\r\n        this.subscriptionsList[subLocalKey] = {\r\n            status: STATUS_AWAITING_ACCEPT,\r\n            method: method,\r\n            arguments: args,\r\n            success: success,\r\n            error: error,\r\n            trackedServers: [],\r\n            handlers: {\r\n                onData: [],\r\n                onClosed: [],\r\n            },\r\n            queued: {\r\n                data: [],\r\n                closers: [],\r\n            },\r\n            timeoutId: undefined,\r\n        };\r\n        this.subscriptionsList[subLocalKey].timeoutId = setTimeout(function () {\r\n            if (_this.subscriptionsList[subLocalKey] === undefined) {\r\n                return;\r\n            }\r\n            var pendingSub = _this.subscriptionsList[subLocalKey];\r\n            if (pendingSub.status === STATUS_AWAITING_ACCEPT) {\r\n                error({\r\n                    method: method.getInfoForUser(),\r\n                    called_with: args,\r\n                    message: ERR_MSG_SUB_FAILED + \" Subscription attempt timed out after \" + timeout + \" ms.\",\r\n                });\r\n                delete _this.subscriptionsList[subLocalKey];\r\n            }\r\n            else if (pendingSub.status === STATUS_SUBSCRIBED && pendingSub.trackedServers.length > 0) {\r\n                pendingSub.trackedServers = pendingSub.trackedServers.filter(function (server) {\r\n                    return (typeof server.subscriptionId !== \"undefined\");\r\n                });\r\n                delete pendingSub.timeoutId;\r\n                if (pendingSub.trackedServers.length <= 0) {\r\n                    _this.callOnClosedHandlers(pendingSub);\r\n                    delete _this.subscriptionsList[subLocalKey];\r\n                }\r\n            }\r\n        }, timeout);\r\n        return this.subscriptionsList[subLocalKey];\r\n    };\r\n    ClientStreaming.prototype.callOnClosedHandlers = function (subscription, reason) {\r\n        var closersCount = subscription.queued.closers.length;\r\n        var closingServerId = (closersCount > 0) ? subscription.queued.closers[closersCount - 1] : null;\r\n        var closingServer = null;\r\n        if (typeof closingServerId === \"number\") {\r\n            closingServer = this.repository.getServerById(closingServerId).getInfoForUser();\r\n        }\r\n        subscription.handlers.onClosed.forEach(function (callback) {\r\n            if (typeof callback !== \"function\") {\r\n                return;\r\n            }\r\n            callback({\r\n                message: reason || ON_CLOSE_MSG_SERVER_INIT,\r\n                requestArguments: subscription.arguments,\r\n                server: closingServer,\r\n                stream: subscription.method,\r\n            });\r\n        });\r\n    };\r\n    ClientStreaming.prototype.closeSubscription = function (subLocalKey) {\r\n        var _this = this;\r\n        var subscription = this.subscriptionsList[subLocalKey];\r\n        if (typeof subscription !== \"object\") {\r\n            return;\r\n        }\r\n        subscription.trackedServers.forEach(function (server) {\r\n            if (typeof server.subscriptionId === \"undefined\") {\r\n                return;\r\n            }\r\n            _this.session.sendFireAndForget({\r\n                type: \"unsubscribe\",\r\n                subscription_id: server.subscriptionId,\r\n                reason_uri: \"\",\r\n                reason: ON_CLOSE_MSG_CLIENT_INIT,\r\n            });\r\n            delete _this.subscriptionIdToLocalKeyMap[server.subscriptionId];\r\n        });\r\n        subscription.trackedServers = [];\r\n        this.callOnClosedHandlers(subscription, ON_CLOSE_MSG_CLIENT_INIT);\r\n        delete this.subscriptionsList[subLocalKey];\r\n    };\r\n    return ClientStreaming;\r\n}());\r\nexports.default = ClientStreaming;\r\n//# sourceMappingURL=client-streaming.js.map\n\n/***/ }),\n/* 63 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar client_streaming_1 = __webpack_require__(62);\r\nvar ClientProtocol = (function () {\r\n    function ClientProtocol(instance, session, repository, logger) {\r\n        var _this = this;\r\n        this.instance = instance;\r\n        this.session = session;\r\n        this.repository = repository;\r\n        this.logger = logger;\r\n        this.callbacks = callback_registry_1.default();\r\n        session.on(\"peer-added\", function (msg) { return _this.handlePeerAdded(msg); });\r\n        session.on(\"peer-removed\", function (msg) { return _this.handlePeerRemoved(msg); });\r\n        session.on(\"methods-added\", function (msg) { return _this.handleMethodsAddedMessage(msg); });\r\n        session.on(\"methods-removed\", function (msg) { return _this.handleMethodsRemovedMessage(msg); });\r\n        this.streaming = new client_streaming_1.default(instance, session, repository, logger);\r\n    }\r\n    ClientProtocol.prototype.subscribe = function (stream, args, targetServers, options, success, error) {\r\n        this.streaming.subscribe(stream, args, targetServers, options, success, error);\r\n    };\r\n    ClientProtocol.prototype.invoke = function (id, method, args, target) {\r\n        var _this = this;\r\n        var serverId = target.id;\r\n        var methodId = method.protocolState.id;\r\n        var msg = {\r\n            type: \"call\",\r\n            server_id: serverId,\r\n            method_id: methodId,\r\n            arguments_kv: args,\r\n        };\r\n        this.session.send(msg, { invocationId: id, serverId: serverId })\r\n            .then(function (m) { return _this.handleResultMessage(m); })\r\n            .catch(function (err) { return _this.handleInvocationError(err); });\r\n    };\r\n    ClientProtocol.prototype.onInvocationResult = function (callback) {\r\n        this.callbacks.add(\"onResult\", callback);\r\n    };\r\n    ClientProtocol.prototype.handlePeerAdded = function (msg) {\r\n        var newPeerId = msg.new_peer_id;\r\n        var remoteId = msg.identity;\r\n        var pid = Number(remoteId.process);\r\n        var serverInfo = {\r\n            machine: remoteId.machine,\r\n            pid: isNaN(pid) ? remoteId.process : pid,\r\n            instance: remoteId.instance,\r\n            application: remoteId.application,\r\n            environment: remoteId.environment,\r\n            region: remoteId.region,\r\n            user: remoteId.user,\r\n            windowId: remoteId.windowId,\r\n            peerId: newPeerId,\r\n        };\r\n        this.repository.addServer(serverInfo, newPeerId);\r\n    };\r\n    ClientProtocol.prototype.handlePeerRemoved = function (msg) {\r\n        var removedPeerId = msg.removed_id;\r\n        var reason = msg.reason;\r\n        this.repository.removeServerById(removedPeerId, reason);\r\n    };\r\n    ClientProtocol.prototype.handleMethodsAddedMessage = function (msg) {\r\n        var _this = this;\r\n        var serverId = msg.server_id;\r\n        var methods = msg.methods;\r\n        methods.forEach(function (method) {\r\n            var methodInfo = {\r\n                name: method.name,\r\n                displayName: method.display_name,\r\n                description: method.description,\r\n                version: method.version,\r\n                objectTypes: method.object_types,\r\n                accepts: method.input_signature,\r\n                returns: method.result_signature,\r\n                supportsStreaming: typeof method.flags !== \"undefined\" ? method.flags.streaming : false,\r\n            };\r\n            _this.repository.addServerMethod(serverId, methodInfo, { id: method.id });\r\n        });\r\n    };\r\n    ClientProtocol.prototype.handleMethodsRemovedMessage = function (msg) {\r\n        var _this = this;\r\n        var serverId = msg.server_id;\r\n        var methodIdList = msg.methods;\r\n        var server = this.repository.getServerById(serverId);\r\n        var serverMethodKeys = Object.keys(server.methods);\r\n        serverMethodKeys.forEach(function (methodKey) {\r\n            var method = server.methods[methodKey];\r\n            if (methodIdList.indexOf(method.protocolState.id) > -1) {\r\n                _this.repository.removeServerMethod(serverId, methodKey);\r\n            }\r\n        });\r\n    };\r\n    ClientProtocol.prototype.handleResultMessage = function (msg) {\r\n        var invocationId = msg._tag.invocationId;\r\n        var result = msg.result;\r\n        var serverId = msg._tag.serverId;\r\n        var server = this.repository.getServerById(serverId);\r\n        this.callbacks.execute(\"onResult\", invocationId, server.getInfoForUser(), 0, result, \"\");\r\n    };\r\n    ClientProtocol.prototype.handleInvocationError = function (msg) {\r\n        this.logger.debug(\"handle invocation error \" + JSON.stringify(msg));\r\n        var invocationId = msg._tag.invocationId;\r\n        var serverId = msg._tag.serverId;\r\n        var server = this.repository.getServerById(serverId);\r\n        var message = msg.reason;\r\n        var context = msg.context;\r\n        this.callbacks.execute(\"onResult\", invocationId, server.getInfoForUser(), 1, context, message);\r\n    };\r\n    return ClientProtocol;\r\n}());\r\nexports.default = ClientProtocol;\r\n//# sourceMappingURL=client.js.map\n\n/***/ }),\n/* 64 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar server_1 = __webpack_require__(66);\r\nvar client_1 = __webpack_require__(63);\r\nfunction default_1(instance, connection, clientRepository, serverRepository, libConfig, getAGM) {\r\n    var logger = libConfig.logger.subLogger(\"gw3-protocol\");\r\n    var resolveReadyPromise;\r\n    var readyPromise = new Promise(function (resolve) {\r\n        resolveReadyPromise = resolve;\r\n    });\r\n    var session = connection.domain(\"agm\", logger.subLogger(\"domain\"), [\"subscribed\"]);\r\n    var server = new server_1.default(instance, session, clientRepository, serverRepository, logger.subLogger(\"server\"));\r\n    var client = new client_1.default(instance, session, clientRepository, logger.subLogger(\"client\"));\r\n    function handleReconnect() {\r\n        logger.info(\"reconnected - will replay registered methods and subscriptions\");\r\n        clientRepository.reset();\r\n        clientRepository.addServer(instance, connection.peerId);\r\n        var registeredMethods = serverRepository.getList();\r\n        serverRepository.reset();\r\n        registeredMethods.forEach(function (method) {\r\n            var def = method.definition;\r\n            if (method.theFunction.userCallback) {\r\n                getAGM().register(def, method.theFunction.userCallback);\r\n            }\r\n            else if (method.theFunction.userCallbackAsync) {\r\n                getAGM().registerAsync(def, method.theFunction.userCallbackAsync);\r\n            }\r\n        });\r\n    }\r\n    function handleInitialJoin() {\r\n        clientRepository.addServer(instance, connection.peerId);\r\n        resolveReadyPromise({\r\n            client: client,\r\n            server: server,\r\n        });\r\n        resolveReadyPromise = undefined;\r\n    }\r\n    session.onJoined(function (reconnect) {\r\n        if (reconnect) {\r\n            handleReconnect();\r\n        }\r\n        else {\r\n            handleInitialJoin();\r\n        }\r\n    });\r\n    session.join();\r\n    return readyPromise;\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=factory.js.map\n\n/***/ }),\n/* 65 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar SUBSCRIPTION_REQUEST = \"onSubscriptionRequest\";\r\nvar SUBSCRIPTION_ADDED = \"onSubscriptionAdded\";\r\nvar SUBSCRIPTION_REMOVED = \"onSubscriptionRemoved\";\r\nvar ServerStreaming = (function () {\r\n    function ServerStreaming(instance, session, repository, serverRepository, logger) {\r\n        var _this = this;\r\n        this.instance = instance;\r\n        this.session = session;\r\n        this.repository = repository;\r\n        this.serverRepository = serverRepository;\r\n        this.logger = logger;\r\n        this.ERR_URI_SUBSCRIPTION_FAILED = \"com.tick42.agm.errors.subscription.failure\";\r\n        this.callbacks = callback_registry_1.default();\r\n        this.nextStreamId = 0;\r\n        session.on(\"add-interest\", function (msg) { _this.handleAddInterest(msg); });\r\n        session.on(\"remove-interest\", function (msg) { _this.handleRemoveInterest(msg); });\r\n    }\r\n    ServerStreaming.prototype.acceptRequestOnBranch = function (requestContext, streamingMethod, branch) {\r\n        if (typeof branch !== \"string\") {\r\n            branch = \"\";\r\n        }\r\n        if (typeof streamingMethod.protocolState.subscriptionsMap !== \"object\") {\r\n            throw new TypeError(\"The streaming method is missing its subscriptions.\");\r\n        }\r\n        if (!Array.isArray(streamingMethod.protocolState.branchKeyToStreamIdMap)) {\r\n            throw new TypeError(\"The streaming method is missing its branches.\");\r\n        }\r\n        var streamId = this.getStreamId(streamingMethod, branch);\r\n        var key = requestContext.msg.subscription_id;\r\n        var subscription = {\r\n            id: key,\r\n            arguments: requestContext.arguments,\r\n            instance: requestContext.instance,\r\n            branchKey: branch,\r\n            streamId: streamId,\r\n            subscribeMsg: requestContext.msg,\r\n        };\r\n        streamingMethod.protocolState.subscriptionsMap[key] = subscription;\r\n        this.session.sendFireAndForget({\r\n            type: \"accepted\",\r\n            subscription_id: key,\r\n            stream_id: streamId,\r\n        });\r\n        this.callbacks.execute(SUBSCRIPTION_ADDED, subscription, streamingMethod);\r\n    };\r\n    ServerStreaming.prototype.rejectRequest = function (requestContext, streamingMethod, reason) {\r\n        if (typeof reason !== \"string\") {\r\n            reason = \"\";\r\n        }\r\n        this.sendSubscriptionFailed(\"Subscription rejected by user. \" + reason, requestContext.msg.subscription_id);\r\n    };\r\n    ServerStreaming.prototype.pushData = function (streamingMethod, data, branches) {\r\n        var _this = this;\r\n        if (typeof streamingMethod !== \"object\" || !Array.isArray(streamingMethod.protocolState.branchKeyToStreamIdMap)) {\r\n            return;\r\n        }\r\n        if (typeof data !== \"object\") {\r\n            throw new Error(\"Invalid arguments. Data must be an object.\");\r\n        }\r\n        if (typeof branches === \"string\") {\r\n            branches = [branches];\r\n        }\r\n        else if (!Array.isArray(branches) || branches.length <= 0) {\r\n            branches = null;\r\n        }\r\n        var streamIdList = streamingMethod.protocolState.branchKeyToStreamIdMap\r\n            .filter(function (br) {\r\n            return (branches === null || (Boolean(br) && typeof br.key === \"string\" && branches.indexOf(br.key) >= 0));\r\n        }).map(function (br) {\r\n            return br.streamId;\r\n        });\r\n        streamIdList.forEach(function (streamId) {\r\n            var publishMessage = {\r\n                type: \"publish\",\r\n                stream_id: streamId,\r\n                data: data,\r\n            };\r\n            _this.session.sendFireAndForget(publishMessage);\r\n        });\r\n    };\r\n    ServerStreaming.prototype.pushDataToSingle = function (method, subscription, data) {\r\n        if (typeof data !== \"object\") {\r\n            throw new Error(\"Invalid arguments. Data must be an object.\");\r\n        }\r\n        var postMessage = {\r\n            type: \"post\",\r\n            subscription_id: subscription.id,\r\n            data: data,\r\n        };\r\n        this.session.sendFireAndForget(postMessage);\r\n    };\r\n    ServerStreaming.prototype.closeSingleSubscription = function (streamingMethod, subscription) {\r\n        delete streamingMethod.protocolState.subscriptionsMap[subscription.id];\r\n        var dropSubscriptionMessage = {\r\n            type: \"drop-subscription\",\r\n            subscription_id: subscription.id,\r\n            reason: \"Server dropping a single subscription\",\r\n        };\r\n        this.session.sendFireAndForget(dropSubscriptionMessage);\r\n        var subscriber = subscription.instance;\r\n        this.callbacks.execute(SUBSCRIPTION_REMOVED, subscription, streamingMethod);\r\n    };\r\n    ServerStreaming.prototype.closeMultipleSubscriptions = function (streamingMethod, branchKey) {\r\n        var _this = this;\r\n        if (typeof streamingMethod !== \"object\" || typeof streamingMethod.protocolState.subscriptionsMap !== \"object\") {\r\n            return;\r\n        }\r\n        var subscriptionsToClose = Object.keys(streamingMethod.protocolState.subscriptionsMap)\r\n            .map(function (key) {\r\n            return streamingMethod.protocolState.subscriptionsMap[key];\r\n        });\r\n        if (typeof branchKey === \"string\") {\r\n            subscriptionsToClose = subscriptionsToClose.filter(function (sub) {\r\n                return sub.branchKey === branchKey;\r\n            });\r\n        }\r\n        subscriptionsToClose.forEach(function (subscription) {\r\n            delete streamingMethod.protocolState.subscriptionsMap[subscription.id];\r\n            var drop = {\r\n                type: \"drop-subscription\",\r\n                subscription_id: subscription.id,\r\n                reason: \"Server dropping all subscriptions on stream_id: \" + subscription.streamId,\r\n            };\r\n            _this.session.sendFireAndForget(drop);\r\n        });\r\n    };\r\n    ServerStreaming.prototype.getSubscriptionList = function (streamingMethod, branchKey) {\r\n        if (typeof streamingMethod !== \"object\") {\r\n            return [];\r\n        }\r\n        var subscriptions = [];\r\n        var allSubscriptions = Object.keys(streamingMethod.protocolState.subscriptionsMap)\r\n            .map(function (key) {\r\n            return streamingMethod.protocolState.subscriptionsMap[key];\r\n        });\r\n        if (typeof branchKey !== \"string\") {\r\n            subscriptions = allSubscriptions;\r\n        }\r\n        else {\r\n            subscriptions = allSubscriptions.filter(function (sub) {\r\n                return sub.branchKey === branchKey;\r\n            });\r\n        }\r\n        return subscriptions;\r\n    };\r\n    ServerStreaming.prototype.getBranchList = function (streamingMethod) {\r\n        if (typeof streamingMethod !== \"object\") {\r\n            return [];\r\n        }\r\n        var allSubscriptions = Object.keys(streamingMethod.protocolState.subscriptionsMap)\r\n            .map(function (key) {\r\n            return streamingMethod.protocolState.subscriptionsMap[key];\r\n        });\r\n        var keysWithDuplicates = allSubscriptions.map(function (sub) {\r\n            var result = null;\r\n            if (typeof sub === \"object\" && typeof sub.branchKey === \"string\") {\r\n                result = sub.branchKey;\r\n            }\r\n            return result;\r\n        });\r\n        var seen = [];\r\n        var branchArray = keysWithDuplicates.filter(function (bKey) {\r\n            if (bKey === null || seen.indexOf(bKey) >= 0) {\r\n                return false;\r\n            }\r\n            seen.push(bKey);\r\n            return true;\r\n        });\r\n        return branchArray;\r\n    };\r\n    ServerStreaming.prototype.onSubAdded = function (callback) {\r\n        this.onSubscriptionLifetimeEvent(SUBSCRIPTION_ADDED, callback);\r\n    };\r\n    ServerStreaming.prototype.onSubRequest = function (callback) {\r\n        this.onSubscriptionLifetimeEvent(SUBSCRIPTION_REQUEST, callback);\r\n    };\r\n    ServerStreaming.prototype.onSubRemoved = function (callback) {\r\n        this.onSubscriptionLifetimeEvent(SUBSCRIPTION_REMOVED, callback);\r\n    };\r\n    ServerStreaming.prototype.handleRemoveInterest = function (msg) {\r\n        var streamingMethod = this.serverRepository.getById(msg.method_id);\r\n        if (typeof msg.subscription_id !== \"string\" ||\r\n            typeof streamingMethod !== \"object\" ||\r\n            typeof streamingMethod.protocolState.subscriptionsMap[msg.subscription_id] !== \"object\") {\r\n            return;\r\n        }\r\n        var subscription = streamingMethod.protocolState.subscriptionsMap[msg.subscription_id];\r\n        delete streamingMethod.protocolState.subscriptionsMap[msg.subscription_id];\r\n        this.callbacks.execute(SUBSCRIPTION_REMOVED, subscription, streamingMethod);\r\n    };\r\n    ServerStreaming.prototype.onSubscriptionLifetimeEvent = function (eventName, handlerFunc) {\r\n        this.callbacks.add(eventName, handlerFunc);\r\n    };\r\n    ServerStreaming.prototype.getNextStreamId = function () {\r\n        return this.nextStreamId++ + \"\";\r\n    };\r\n    ServerStreaming.prototype.handleAddInterest = function (msg) {\r\n        var caller = this.repository.getServerById(msg.caller_id);\r\n        var instance = (typeof caller.getInfoForUser === \"function\") ? caller.getInfoForUser() : null;\r\n        var requestContext = {\r\n            msg: msg,\r\n            arguments: msg.arguments_kv || {},\r\n            instance: instance,\r\n        };\r\n        var streamingMethod = this.serverRepository.getById(msg.method_id);\r\n        if (streamingMethod === undefined) {\r\n            var errorMsg = \"No method with id \" + msg.method_id + \" on this server.\";\r\n            this.sendSubscriptionFailed(errorMsg, msg.subscription_id);\r\n            return;\r\n        }\r\n        if (streamingMethod.protocolState.subscriptionsMap &&\r\n            streamingMethod.protocolState.subscriptionsMap[msg.subscription_id]) {\r\n            this.sendSubscriptionFailed(\"A subscription with id \" + msg.subscription_id + \" already exists.\", msg.subscription_id);\r\n            return;\r\n        }\r\n        this.callbacks.execute(SUBSCRIPTION_REQUEST, requestContext, streamingMethod);\r\n    };\r\n    ServerStreaming.prototype.sendSubscriptionFailed = function (reason, subscriptionId) {\r\n        var errorMessage = {\r\n            type: \"error\",\r\n            reason_uri: this.ERR_URI_SUBSCRIPTION_FAILED,\r\n            reason: reason,\r\n            request_id: subscriptionId,\r\n        };\r\n        this.session.sendFireAndForget(errorMessage);\r\n    };\r\n    ServerStreaming.prototype.getStreamId = function (streamingMethod, branchKey) {\r\n        if (typeof branchKey !== \"string\") {\r\n            branchKey = \"\";\r\n        }\r\n        var needleBranch = streamingMethod.protocolState.branchKeyToStreamIdMap.filter(function (branch) {\r\n            return branch.key === branchKey;\r\n        })[0];\r\n        var streamId = (needleBranch ? needleBranch.streamId : undefined);\r\n        if (typeof streamId !== \"string\" || streamId === \"\") {\r\n            streamId = this.getNextStreamId();\r\n            streamingMethod.protocolState.branchKeyToStreamIdMap.push({ key: branchKey, streamId: streamId });\r\n        }\r\n        return streamId;\r\n    };\r\n    return ServerStreaming;\r\n}());\r\nexports.default = ServerStreaming;\r\n//# sourceMappingURL=server-streaming.js.map\n\n/***/ }),\n/* 66 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar server_streaming_1 = __webpack_require__(65);\r\nvar ServerProtocol = (function () {\r\n    function ServerProtocol(instance, session, clientRepository, serverRepository, logger) {\r\n        var _this = this;\r\n        this.session = session;\r\n        this.clientRepository = clientRepository;\r\n        this.serverRepository = serverRepository;\r\n        this.logger = logger;\r\n        this.callbacks = callback_registry_1.default();\r\n        this.streaming = new server_streaming_1.default(instance, session, clientRepository, serverRepository, logger);\r\n        this.session.on(\"invoke\", function (msg) { return _this.handleInvokeMessage(msg); });\r\n    }\r\n    ServerProtocol.prototype.createStream = function (repoMethod, success, error) {\r\n        var isStreaming = true;\r\n        repoMethod.protocolState.subscriptionsMap = {};\r\n        repoMethod.protocolState.branchKeyToStreamIdMap = [];\r\n        this.register(repoMethod, success, error, isStreaming);\r\n    };\r\n    ServerProtocol.prototype.register = function (repoMethod, success, error, isStreaming) {\r\n        var _this = this;\r\n        var methodDef = repoMethod.definition;\r\n        repoMethod.protocolState.registrationCallbacks = {\r\n            success: success,\r\n            fail: error,\r\n        };\r\n        var flags = { streaming: isStreaming || false };\r\n        this.logger.debug('registering method \"' + methodDef.name + '\"');\r\n        var registerMsg = {\r\n            type: \"register\",\r\n            methods: [{\r\n                    id: repoMethod.repoId,\r\n                    name: methodDef.name,\r\n                    display_name: methodDef.displayName,\r\n                    description: methodDef.description,\r\n                    version: methodDef.version,\r\n                    flags: flags,\r\n                    object_types: methodDef.objectTypes || methodDef.object_types,\r\n                    input_signature: methodDef.accepts,\r\n                    result_signature: methodDef.returns,\r\n                    restrictions: undefined,\r\n                }],\r\n        };\r\n        this.session.send(registerMsg, { methodId: repoMethod.repoId })\r\n            .then(function (msg) { return _this.handleRegisteredMessage(msg); })\r\n            .catch(function (err) { return _this.handleErrorRegister(err); });\r\n    };\r\n    ServerProtocol.prototype.onInvoked = function (callback) {\r\n        this.callbacks.add(\"onInvoked\", callback);\r\n    };\r\n    ServerProtocol.prototype.methodInvocationResult = function (method, invocationId, err, result) {\r\n        var msg;\r\n        if (err) {\r\n            msg = {\r\n                type: \"error\",\r\n                request_id: invocationId,\r\n                reason_uri: \"agm.errors.client_error\",\r\n                reason: err,\r\n                context: result,\r\n                peer_id: undefined,\r\n            };\r\n        }\r\n        else {\r\n            msg = {\r\n                type: \"yield\",\r\n                invocation_id: invocationId,\r\n                peer_id: this.session.peerId,\r\n                result: result,\r\n                request_id: undefined,\r\n            };\r\n        }\r\n        this.session.sendFireAndForget(msg);\r\n    };\r\n    ServerProtocol.prototype.unregister = function (method) {\r\n        var msg = {\r\n            type: \"unregister\",\r\n            methods: [method.repoId],\r\n        };\r\n        this.session.send(msg);\r\n    };\r\n    ServerProtocol.prototype.getBranchList = function (method) {\r\n        return this.streaming.getBranchList(method);\r\n    };\r\n    ServerProtocol.prototype.getSubscriptionList = function (method, branchKey) {\r\n        return this.streaming.getSubscriptionList(method, branchKey);\r\n    };\r\n    ServerProtocol.prototype.closeAllSubscriptions = function (method, branchKey) {\r\n        this.streaming.closeMultipleSubscriptions(method, branchKey);\r\n    };\r\n    ServerProtocol.prototype.pushData = function (method, data, branches) {\r\n        this.streaming.pushData(method, data, branches);\r\n    };\r\n    ServerProtocol.prototype.pushDataToSingle = function (method, subscription, data) {\r\n        this.streaming.pushDataToSingle(method, subscription, data);\r\n    };\r\n    ServerProtocol.prototype.closeSingleSubscription = function (method, subscription) {\r\n        this.streaming.closeSingleSubscription(method, subscription);\r\n    };\r\n    ServerProtocol.prototype.acceptRequestOnBranch = function (requestContext, method, branch) {\r\n        this.streaming.acceptRequestOnBranch(requestContext, method, branch);\r\n    };\r\n    ServerProtocol.prototype.rejectRequest = function (requestContext, method, reason) {\r\n        this.streaming.rejectRequest(requestContext, method, reason);\r\n    };\r\n    ServerProtocol.prototype.onSubRequest = function (callback) {\r\n        this.streaming.onSubRequest(callback);\r\n    };\r\n    ServerProtocol.prototype.onSubAdded = function (callback) {\r\n        this.streaming.onSubAdded(callback);\r\n    };\r\n    ServerProtocol.prototype.onSubRemoved = function (callback) {\r\n        this.streaming.onSubRemoved(callback);\r\n    };\r\n    ServerProtocol.prototype.handleRegisteredMessage = function (msg) {\r\n        var methodId = msg._tag.methodId;\r\n        var repoMethod = this.serverRepository.getById(methodId);\r\n        if (repoMethod && repoMethod.protocolState.registrationCallbacks) {\r\n            this.logger.debug(\"registered method \" + repoMethod.definition.name + \" with id \" + methodId);\r\n            repoMethod.protocolState.registrationCallbacks.success();\r\n        }\r\n    };\r\n    ServerProtocol.prototype.handleErrorRegister = function (msg) {\r\n        this.logger.warn(JSON.stringify(msg));\r\n        var methodId = msg._tag.methodId;\r\n        var repoMethod = this.serverRepository.getById(methodId);\r\n        if (repoMethod && repoMethod.protocolState.registrationCallbacks) {\r\n            this.logger.debug(\"failed to register method \" + repoMethod.definition.name + \" with id \" + methodId);\r\n            repoMethod.protocolState.registrationCallbacks.fail();\r\n        }\r\n    };\r\n    ServerProtocol.prototype.handleInvokeMessage = function (msg) {\r\n        var invocationId = msg.invocation_id;\r\n        var callerId = msg.caller_id;\r\n        var methodId = msg.method_id;\r\n        var args = msg.arguments_kv;\r\n        this.logger.debug('received invocation for method id \"' + methodId + '\" from peer ' + callerId);\r\n        var methodList = this.serverRepository.getList();\r\n        var method = methodList.filter(function (m) {\r\n            return m.repoId === methodId;\r\n        })[0];\r\n        if (method === undefined) {\r\n            return;\r\n        }\r\n        var client = this.clientRepository.getServerById(callerId);\r\n        var invocationArgs = { args: args, instance: client.getInfoForUser() };\r\n        this.callbacks.execute(\"onInvoked\", method, invocationId, invocationArgs);\r\n    };\r\n    return ServerProtocol;\r\n}());\r\nexports.default = ServerProtocol;\r\n//# sourceMappingURL=server.js.map\n\n/***/ }),\n/* 67 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar subscription_1 = __webpack_require__(9);\r\nvar ServerBranch = (function () {\r\n    function ServerBranch(key, protocol, repoMethod) {\r\n        this.key = key;\r\n        this.protocol = protocol;\r\n        this.repoMethod = repoMethod;\r\n    }\r\n    ServerBranch.prototype.subscriptions = function () {\r\n        var _this = this;\r\n        var subList = this.protocol.server.getSubscriptionList(this.repoMethod, this.key);\r\n        return subList.map(function (sub) {\r\n            return new subscription_1.default(_this.protocol, _this.repoMethod, sub);\r\n        });\r\n    };\r\n    ServerBranch.prototype.close = function () {\r\n        this.protocol.server.closeAllSubscriptions(this.repoMethod, this.key);\r\n    };\r\n    ServerBranch.prototype.push = function (data) {\r\n        this.protocol.server.pushData(this.repoMethod, data, [this.key]);\r\n    };\r\n    return ServerBranch;\r\n}());\r\nexports.default = ServerBranch;\r\n//# sourceMappingURL=branch.js.map\n\n/***/ }),\n/* 68 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ServerRepository = (function () {\r\n    function ServerRepository() {\r\n        this.nextId = 0;\r\n        this.methods = [];\r\n    }\r\n    ServerRepository.prototype.add = function (method) {\r\n        if (typeof method !== \"object\") {\r\n            return;\r\n        }\r\n        if (method.repoId !== undefined) {\r\n            return;\r\n        }\r\n        method.repoId = String(this.nextId);\r\n        this.nextId += 1;\r\n        this.methods.push(method);\r\n        return method;\r\n    };\r\n    ServerRepository.prototype.remove = function (repoId) {\r\n        if (typeof repoId !== \"string\") {\r\n            return new TypeError(\"Expecting a string\");\r\n        }\r\n        this.methods = this.methods.filter(function (m) {\r\n            return m.repoId !== repoId;\r\n        });\r\n    };\r\n    ServerRepository.prototype.getById = function (id) {\r\n        if (typeof id !== \"string\") {\r\n            return undefined;\r\n        }\r\n        return this.methods.filter(function (m) {\r\n            return m.repoId === id;\r\n        })[0];\r\n    };\r\n    ServerRepository.prototype.getList = function () {\r\n        return this.methods.map(function (m) { return m; });\r\n    };\r\n    ServerRepository.prototype.length = function () {\r\n        return this.methods.length;\r\n    };\r\n    ServerRepository.prototype.reset = function () {\r\n        this.methods = [];\r\n    };\r\n    return ServerRepository;\r\n}());\r\nexports.default = ServerRepository;\r\n//# sourceMappingURL=repository.js.map\n\n/***/ }),\n/* 69 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Request = (function () {\r\n    function Request(protocol, repoMethod, requestContext) {\r\n        this.protocol = protocol;\r\n        this.repoMethod = repoMethod;\r\n        this.requestContext = requestContext;\r\n        this.arguments = requestContext.arguments;\r\n        this.instance = requestContext.instance;\r\n    }\r\n    Request.prototype.accept = function () {\r\n        this.protocol.server.acceptRequestOnBranch(this.requestContext, this.repoMethod, \"\");\r\n    };\r\n    Request.prototype.acceptOnBranch = function (branch) {\r\n        this.protocol.server.acceptRequestOnBranch(this.requestContext, this.repoMethod, branch);\r\n    };\r\n    Request.prototype.reject = function (reason) {\r\n        this.protocol.server.rejectRequest(this.requestContext, this.repoMethod, reason);\r\n    };\r\n    return Request;\r\n}());\r\nexports.default = Request;\r\n//# sourceMappingURL=request.js.map\n\n/***/ }),\n/* 70 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar promisify_1 = __webpack_require__(8);\r\nvar streaming_1 = __webpack_require__(72);\r\nvar stream_1 = __webpack_require__(71);\r\nvar Server = (function () {\r\n    function Server(protocol, serverRepository, instance, configuration) {\r\n        this.protocol = protocol;\r\n        this.serverRepository = serverRepository;\r\n        this.instance = instance;\r\n        this.configuration = configuration;\r\n        this.invocations = 0;\r\n        this.streaming = new streaming_1.default(protocol, this);\r\n        this.protocol.server.onInvoked(this.onMethodInvoked.bind(this));\r\n    }\r\n    Server.prototype.register = function (methodDefinition, callback) {\r\n        var wrappedCallbackFunction = function (context, resultCallback) {\r\n            try {\r\n                var result = callback(context.args, context.instance);\r\n                resultCallback(null, result);\r\n            }\r\n            catch (e) {\r\n                resultCallback(e, e);\r\n            }\r\n        };\r\n        wrappedCallbackFunction.userCallback = callback;\r\n        this.registerCore(methodDefinition, wrappedCallbackFunction);\r\n    };\r\n    Server.prototype.registerAsync = function (methodDefinition, callback) {\r\n        var wrappedCallback = function (context, resultCallback) {\r\n            try {\r\n                callback(context.args, context.instance, function (result) {\r\n                    resultCallback(null, result);\r\n                }, function (e) {\r\n                    resultCallback(e, e);\r\n                });\r\n            }\r\n            catch (e) {\r\n                resultCallback(e, null);\r\n            }\r\n        };\r\n        wrappedCallback.userCallbackAsync = callback;\r\n        this.registerCore(methodDefinition, wrappedCallback);\r\n    };\r\n    Server.prototype.createStream = function (streamDef, callbacks, successCallback, errorCallback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (typeof streamDef === \"string\") {\r\n                if (streamDef === \"\") {\r\n                    reject(\"Invalid stream name - can not be empty\");\r\n                }\r\n                streamDef = { name: streamDef };\r\n            }\r\n            streamDef.supportsStreaming = true;\r\n            if (!callbacks) {\r\n                callbacks = {};\r\n            }\r\n            if (typeof callbacks.subscriptionRequestHandler !== \"function\") {\r\n                callbacks.subscriptionRequestHandler = function (request) {\r\n                    request.accept();\r\n                };\r\n            }\r\n            var repoMethod = {\r\n                definition: streamDef,\r\n                streamCallbacks: callbacks,\r\n                protocolState: {},\r\n            };\r\n            _this.serverRepository.add(repoMethod);\r\n            _this.protocol.server.createStream(repoMethod, function () {\r\n                var streamFrontObject = new stream_1.default(_this.protocol, repoMethod, _this);\r\n                repoMethod.stream = streamFrontObject;\r\n                resolve(streamFrontObject);\r\n            }, function (err) {\r\n                _this.serverRepository.remove(repoMethod.repoId);\r\n                reject(err);\r\n            });\r\n        });\r\n        return promisify_1.default(promise, successCallback, errorCallback);\r\n    };\r\n    Server.prototype.unregister = function (methodFilter) {\r\n        var _this = this;\r\n        if (typeof methodFilter === \"string\") {\r\n            methodFilter = { name: methodFilter };\r\n        }\r\n        var methodsToBeRemoved = this.serverRepository.getList().filter(function (method) {\r\n            return _this.containsProps(methodFilter, method.definition);\r\n        });\r\n        methodsToBeRemoved.forEach(function (method) {\r\n            _this.serverRepository.remove(method.repoId);\r\n            _this.protocol.server.unregister(method);\r\n        });\r\n    };\r\n    Server.prototype.registerCore = function (methodDefinition, theFunction) {\r\n        var _this = this;\r\n        if (typeof methodDefinition === \"string\") {\r\n            methodDefinition = { name: methodDefinition };\r\n        }\r\n        var repoMethod = this.serverRepository.add({\r\n            definition: methodDefinition,\r\n            theFunction: theFunction,\r\n            protocolState: {},\r\n        });\r\n        this.protocol.server.register(repoMethod, function () { }, function () {\r\n            _this.serverRepository.remove(repoMethod.repoId);\r\n        });\r\n    };\r\n    Server.prototype.containsProps = function (filter, object) {\r\n        var match = true;\r\n        Object.keys(filter).forEach(function (prop) {\r\n            if (filter[prop] !== object[prop]) {\r\n                match = false;\r\n            }\r\n        });\r\n        return match;\r\n    };\r\n    Server.prototype.onMethodInvoked = function (methodToExecute, invocationId, invocationArgs) {\r\n        var _this = this;\r\n        if (!methodToExecute) {\r\n            return;\r\n        }\r\n        methodToExecute.theFunction(invocationArgs, function (err, result) {\r\n            if (err) {\r\n                if (typeof err.message === \"string\") {\r\n                    err = err.message;\r\n                }\r\n                else if (typeof err !== \"string\") {\r\n                    err = \"<>\";\r\n                }\r\n            }\r\n            if (!result || typeof result !== \"object\" || result.constructor === Array) {\r\n                result = { _result: result };\r\n            }\r\n            _this.protocol.server.methodInvocationResult(methodToExecute, invocationId, err, result);\r\n        });\r\n    };\r\n    return Server;\r\n}());\r\nexports.default = Server;\r\n//# sourceMappingURL=server.js.map\n\n/***/ }),\n/* 71 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar subscription_1 = __webpack_require__(9);\r\nvar branch_1 = __webpack_require__(67);\r\nvar ServerStream = (function () {\r\n    function ServerStream(protocol, repoMethod, server) {\r\n        this.protocol = protocol;\r\n        this.repoMethod = repoMethod;\r\n        this.server = server;\r\n        this.def = repoMethod.definition;\r\n    }\r\n    Object.defineProperty(ServerStream.prototype, \"name\", {\r\n        get: function () { return this.def.name; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ServerStream.prototype.branches = function (key) {\r\n        var _this = this;\r\n        var bList = this.protocol.server.getBranchList(this.repoMethod);\r\n        if (key) {\r\n            if (bList.indexOf(key) > -1) {\r\n                return new branch_1.default(key, this.protocol, this.repoMethod);\r\n            }\r\n            return undefined;\r\n        }\r\n        else {\r\n            return bList.map(function (branchKey) {\r\n                return new branch_1.default(branchKey, _this.protocol, _this.repoMethod);\r\n            });\r\n        }\r\n    };\r\n    ServerStream.prototype.subscriptions = function () {\r\n        var _this = this;\r\n        var subList = this.protocol.server.getSubscriptionList(this.repoMethod);\r\n        return subList.map(function (sub) {\r\n            return new subscription_1.default(_this.protocol, _this.repoMethod, sub);\r\n        });\r\n    };\r\n    Object.defineProperty(ServerStream.prototype, \"definition\", {\r\n        get: function () {\r\n            var def2 = this.def;\r\n            return {\r\n                accepts: def2.accepts,\r\n                description: def2.description,\r\n                displayName: def2.displayName,\r\n                name: def2.name,\r\n                objectTypes: def2.objectTypes,\r\n                returns: def2.returns,\r\n                supportsStreaming: def2.supportsStreaming,\r\n            };\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ServerStream.prototype.close = function () {\r\n        this.protocol.server.closeAllSubscriptions(this.repoMethod);\r\n        this.server.unregister(this.repoMethod.definition);\r\n    };\r\n    ServerStream.prototype.push = function (data, branches) {\r\n        if (typeof branches !== \"string\" && !Array.isArray(branches) && branches !== undefined) {\r\n            throw new Error(\"invalid branches should be string or string array\");\r\n        }\r\n        if (typeof data !== \"object\") {\r\n            throw new Error(\"Invalid arguments. Data must be an object.\");\r\n        }\r\n        this.protocol.server.pushData(this.repoMethod, data, branches);\r\n    };\r\n    return ServerStream;\r\n}());\r\nexports.default = ServerStream;\r\n//# sourceMappingURL=stream.js.map\n\n/***/ }),\n/* 72 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar subscription_1 = __webpack_require__(9);\r\nvar request_1 = __webpack_require__(69);\r\nvar ServerStreaming = (function () {\r\n    function ServerStreaming(protocol, server) {\r\n        var _this = this;\r\n        this.protocol = protocol;\r\n        this.server = server;\r\n        protocol.server.onSubRequest(function (rc, rm) { return _this.handleSubRequest(rc, rm); });\r\n        protocol.server.onSubAdded(function (sub, rm) { return _this.handleSubAdded(sub, rm); });\r\n        protocol.server.onSubRemoved(function (sub, rm) { return _this.handleSubRemoved(sub, rm); });\r\n    }\r\n    ServerStreaming.prototype.handleSubRequest = function (requestContext, repoMethod) {\r\n        if (!(repoMethod &&\r\n            repoMethod.streamCallbacks &&\r\n            typeof repoMethod.streamCallbacks.subscriptionRequestHandler === \"function\")) {\r\n            return;\r\n        }\r\n        var request = new request_1.default(this.protocol, repoMethod, requestContext);\r\n        repoMethod.streamCallbacks.subscriptionRequestHandler(request);\r\n    };\r\n    ServerStreaming.prototype.handleSubAdded = function (subscription, repoMethod) {\r\n        if (!(repoMethod &&\r\n            repoMethod.streamCallbacks &&\r\n            typeof repoMethod.streamCallbacks.subscriptionAddedHandler === \"function\")) {\r\n            return;\r\n        }\r\n        var sub = new subscription_1.default(this.protocol, repoMethod, subscription);\r\n        repoMethod.streamCallbacks.subscriptionAddedHandler(sub);\r\n    };\r\n    ServerStreaming.prototype.handleSubRemoved = function (subscription, repoMethod) {\r\n        if (!(repoMethod &&\r\n            repoMethod.streamCallbacks &&\r\n            typeof repoMethod.streamCallbacks.subscriptionRemovedHandler === \"function\")) {\r\n            return;\r\n        }\r\n        var sub = new subscription_1.default(this.protocol, repoMethod, subscription);\r\n        repoMethod.streamCallbacks.subscriptionRemovedHandler(sub);\r\n    };\r\n    return ServerStreaming;\r\n}());\r\nexports.default = ServerStreaming;\r\n//# sourceMappingURL=streaming.js.map\n\n/***/ }),\n/* 73 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction setupAGM(agm, channels) {\r\n    var windowId;\r\n    if (typeof window !== \"undefined\") {\r\n        if (window.htmlContainer) {\r\n            windowId = window.htmlContainer.windowId;\r\n        }\r\n        else if (window.glue42gd) {\r\n            windowId = window.glue42gd.windowId;\r\n        }\r\n    }\r\n    if (!windowId) {\r\n        return;\r\n    }\r\n    agm.invoke(\"T42.Channels.Announce\", { swId: windowId, instance: agm.instance.instance });\r\n    agm.register(\"T42.Channels.Command\", function (args) {\r\n        var command = args.command;\r\n        if (!command) {\r\n            throw new Error('missing command argument');\r\n        }\r\n        if (command === 'join') {\r\n            var id = args.channel;\r\n            if (!id) {\r\n                throw new Error('missing argument id');\r\n            }\r\n            channels.join(id);\r\n            return;\r\n        }\r\n        if (command === 'leave') {\r\n            channels.leave();\r\n            return;\r\n        }\r\n        if (command === 'get') {\r\n            var id = channels.current();\r\n            return { id: id };\r\n        }\r\n        throw new Error(\"unknown command \" + command);\r\n    });\r\n}\r\nexports.setupAGM = setupAGM;\r\n//# sourceMappingURL=agm.js.map\n\n/***/ }),\n/* 74 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar ChannelsImpl = (function () {\r\n    function ChannelsImpl(shared) {\r\n        this.shared = shared;\r\n        this.subsKey = \"subs\";\r\n        this.changedKey = \"changed\";\r\n        this.registry = callback_registry_1.default();\r\n        this.shared.subscribe(this.handler.bind(this));\r\n    }\r\n    ChannelsImpl.prototype.current = function () {\r\n        return this.currentContext;\r\n    };\r\n    ChannelsImpl.prototype.subscribe = function (callback) {\r\n        return this.registry.add(this.subsKey, callback);\r\n    };\r\n    ChannelsImpl.prototype.publish = function (data) {\r\n        if (!this.currentContext) {\r\n            throw new Error(\"not joined to any channel\");\r\n        }\r\n        return this.shared.update(this.currentContext, { data: data });\r\n    };\r\n    ChannelsImpl.prototype.join = function (id) {\r\n        this.currentContext = id;\r\n        this.registry.execute(this.changedKey, id);\r\n        return this.shared.switchChannel(id);\r\n    };\r\n    ChannelsImpl.prototype.leave = function () {\r\n        this.currentContext = undefined;\r\n        this.registry.execute(this.changedKey, undefined);\r\n        return this.shared.unsubscribe();\r\n    };\r\n    ChannelsImpl.prototype.all = function () {\r\n        return this.shared.all();\r\n    };\r\n    ChannelsImpl.prototype.changed = function (callback) {\r\n        this.registry.add(this.changedKey, callback);\r\n    };\r\n    ChannelsImpl.prototype.meta = function (name, meta) {\r\n        throw new Error(\"Method not implemented.\");\r\n    };\r\n    ChannelsImpl.prototype.add = function (info) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var context;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!info) {\r\n                            throw new Error(\"info argument can not be undefined\");\r\n                        }\r\n                        if (!info.name) {\r\n                            throw new Error(\"info.name is missing\");\r\n                        }\r\n                        context = {\r\n                            name: info.name,\r\n                            meta: info.meta || {},\r\n                            data: info.data || {}\r\n                        };\r\n                        return [4, this.shared.add(info.name, context)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2, context];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ChannelsImpl.prototype.remove = function (id) {\r\n        throw new Error(\"Method not implemented.\");\r\n    };\r\n    ChannelsImpl.prototype.onChannelAdded = function (cb) {\r\n        throw new Error(\"Method not implemented.\");\r\n    };\r\n    ChannelsImpl.prototype.onChannelRemoved = function (cb) {\r\n        throw new Error(\"Method not implemented.\");\r\n    };\r\n    ChannelsImpl.prototype.apps = function (channelId) {\r\n        throw new Error(\"Method not implemented.\");\r\n    };\r\n    ChannelsImpl.prototype.handler = function (context) {\r\n        this.registry.execute(this.subsKey, context.data, context);\r\n    };\r\n    return ChannelsImpl;\r\n}());\r\nexports.ChannelsImpl = ChannelsImpl;\r\n//# sourceMappingURL=channels.js.map\n\n/***/ }),\n/* 75 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CONTEXT_PREFIX = \"___channel___\";\r\nvar SharedContextSubscriber = (function () {\r\n    function SharedContextSubscriber(contexts) {\r\n        this.contexts = contexts;\r\n        this.unsubscribeFunc = undefined;\r\n        this.current = undefined;\r\n    }\r\n    SharedContextSubscriber.prototype.subscribe = function (callback) {\r\n        this.callback = callback;\r\n    };\r\n    SharedContextSubscriber.prototype.switchChannel = function (name) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var sharedContextName, _a;\r\n            var _this = this;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        this.unsubscribe();\r\n                        this.current = name;\r\n                        sharedContextName = this.createContextName(name);\r\n                        _a = this;\r\n                        return [4, this.contexts.subscribe(sharedContextName, function (data) {\r\n                                if (_this.callback) {\r\n                                    _this.callback(data);\r\n                                }\r\n                            })];\r\n                    case 1:\r\n                        _a.unsubscribeFunc = _b.sent();\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    SharedContextSubscriber.prototype.unsubscribe = function () {\r\n        if (this.unsubscribeFunc) {\r\n            this.unsubscribeFunc();\r\n        }\r\n        return Promise.resolve();\r\n    };\r\n    SharedContextSubscriber.prototype.add = function (id, data) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var name;\r\n            return __generator(this, function (_a) {\r\n                name = this.createContextName(id);\r\n                return [2, this.contexts.set(name, data)];\r\n            });\r\n        });\r\n    };\r\n    SharedContextSubscriber.prototype.all = function () {\r\n        var allContexts = this.contexts.all();\r\n        var channels = allContexts.filter(function (c) { return c.startsWith(CONTEXT_PREFIX); });\r\n        var ids = channels.map(function (c) { return c.substr(CONTEXT_PREFIX.length); });\r\n        return Promise.resolve(ids);\r\n    };\r\n    SharedContextSubscriber.prototype.update = function (id, data) {\r\n        var name = this.createContextName(id);\r\n        return this.contexts.update(name, data);\r\n    };\r\n    SharedContextSubscriber.prototype.createContextName = function (id) {\r\n        return CONTEXT_PREFIX + id;\r\n    };\r\n    return SharedContextSubscriber;\r\n}());\r\nexports.SharedContextSubscriber = SharedContextSubscriber;\r\n//# sourceMappingURL=contexts.js.map\n\n/***/ }),\n/* 76 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar agm_1 = __webpack_require__(73);\r\nvar contexts_1 = __webpack_require__(75);\r\nvar channels_1 = __webpack_require__(74);\r\nfunction factory(contexts, agm) {\r\n    var sharedContexts = new contexts_1.SharedContextSubscriber(contexts);\r\n    var channels = new channels_1.ChannelsImpl(sharedContexts);\r\n    agm_1.setupAGM(agm, channels);\r\n    return {\r\n        subscribe: channels.subscribe.bind(channels),\r\n        publish: channels.publish.bind(channels),\r\n        all: channels.all.bind(channels),\r\n        current: channels.current.bind(channels),\r\n        join: channels.join.bind(channels),\r\n        leave: channels.leave.bind(channels),\r\n        add: channels.add.bind(channels),\r\n        changed: channels.changed.bind(channels),\r\n        ready: function () { return contexts.ready(); }\r\n    };\r\n}\r\nexports.factory = factory;\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 77 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar shortid_1 = __webpack_require__(7);\r\nvar utils_1 = __webpack_require__(11);\r\nvar contextMessageReplaySpec_1 = __webpack_require__(10);\r\nvar pjson = __webpack_require__(13);\r\nfunction default_1(configuration, ext, hc, glue42gd, gdVersion) {\r\n    if (typeof window !== \"undefined\") {\r\n        global = global || window;\r\n    }\r\n    global = global || {};\r\n    var uid = shortid_1.generate();\r\n    var masterConfig = global.GLUE_CONFIG || {};\r\n    var dynamicDefaults = global.GLUE_DEFAULT_CONFIG || {};\r\n    var hardDefaults = getHardDefaults();\r\n    var metricsIdentity = {\r\n        system: getConfigProp(\"metrics\", \"system\"),\r\n        service: getConfigProp(\"metrics\", \"service\"),\r\n        instance: getConfigProp(\"metrics\", \"instance\")\r\n    };\r\n    function getMetrics() {\r\n        return ifNotFalse(getConfigProp(\"metrics\"), {\r\n            identity: metricsIdentity\r\n        });\r\n    }\r\n    function getGateway() {\r\n        var force = getConfigProp(\"gateway\", \"force\");\r\n        var gw = hc === undefined || force;\r\n        if (gw) {\r\n            var gwConfig = getConfigProp(\"gateway\");\r\n            var protocolVersion = getConfigProp(\"gateway\", \"protocolVersion\");\r\n            var reconnectInterval = getConfigProp(\"gateway\", \"reconnectInterval\");\r\n            var reconnectAttempts = getConfigProp(\"gateway\", \"reconnectAttempts\");\r\n            var ws = gwConfig.ws;\r\n            var http = gwConfig.http;\r\n            var inproc = gwConfig.inproc;\r\n            if (!ws && !http && !inproc) {\r\n                if (utils_1.default.isNode() || (\"WebSocket\" in window && window.WebSocket.CLOSING === 2)) {\r\n                    ws = getConfigProp(\"gateway\", \"ws\");\r\n                }\r\n                else {\r\n                    http = getConfigProp(\"gateway\", \"http\");\r\n                }\r\n            }\r\n            var windowId = void 0;\r\n            var pid = void 0;\r\n            if (hc) {\r\n                windowId = hc.windowId;\r\n            }\r\n            else if (typeof glue42gd !== \"undefined\") {\r\n                windowId = glue42gd.windowId;\r\n                pid = glue42gd.pid;\r\n            }\r\n            else if (utils_1.default.isNode()) {\r\n                pid = process.pid;\r\n            }\r\n            var replaySpecs = getConfigProp(\"gateway\", \"replaySpecs\") || [];\r\n            replaySpecs.push(contextMessageReplaySpec_1.ContextMessageReplaySpec);\r\n            return {\r\n                identity: {\r\n                    application: getApplication(),\r\n                    windowId: windowId,\r\n                    process: pid,\r\n                },\r\n                reconnectInterval: reconnectInterval,\r\n                ws: ws,\r\n                http: http,\r\n                gw: inproc,\r\n                protocolVersion: protocolVersion,\r\n                reconnectAttempts: reconnectAttempts,\r\n                force: true,\r\n                replaySpecs: replaySpecs,\r\n                gdVersion: gdVersion,\r\n            };\r\n        }\r\n        return { gdVersion: gdVersion };\r\n    }\r\n    function getLogger() {\r\n        return getConfigProp(\"logger\");\r\n    }\r\n    function getAgm() {\r\n        return ifNotFalse(configuration.agm, {\r\n            instance: {\r\n                application: getApplication()\r\n            }\r\n        });\r\n    }\r\n    function getContexts() {\r\n        return true;\r\n    }\r\n    function getApplication() {\r\n        return getConfigProp(\"application\");\r\n    }\r\n    function getAuth() {\r\n        return getConfigProp(\"auth\");\r\n    }\r\n    function getHardDefaults() {\r\n        function getMetricsDefaults() {\r\n            var documentTitle = typeof document !== \"undefined\" ? document.title : \"unknown\";\r\n            documentTitle = documentTitle || \"none\";\r\n            if (typeof hc === \"undefined\") {\r\n                return {\r\n                    system: \"Connect.Browser\",\r\n                    service: configuration.application || documentTitle,\r\n                    instance: \"~\" + uid\r\n                };\r\n            }\r\n            if (typeof hc.metricsFacade.getIdentity !== \"undefined\") {\r\n                var identity = hc.metricsFacade.getIdentity();\r\n                return {\r\n                    system: identity.system,\r\n                    service: identity.service,\r\n                    instance: identity.instance\r\n                };\r\n            }\r\n            return {\r\n                system: \"HtmlContainer.\" + hc.containerName,\r\n                service: \"JS.\" + hc.browserWindowName,\r\n                instance: \"~\" + hc.machineName\r\n            };\r\n        }\r\n        function getGatewayDefaults() {\r\n            var defaultProtocol = 3;\r\n            var gatewayURL = \"localhost:8385\";\r\n            var defaultWs = \"ws://\" + gatewayURL;\r\n            var defaultHttp = \"http://\" + gatewayURL;\r\n            if (glue42gd) {\r\n                defaultProtocol = 3;\r\n                defaultWs = glue42gd.gwURL;\r\n            }\r\n            return {\r\n                ws: defaultWs,\r\n                http: defaultHttp,\r\n                protocolVersion: defaultProtocol,\r\n                reconnectInterval: 1000\r\n            };\r\n        }\r\n        function getDefaultApplicationName() {\r\n            if (hc) {\r\n                return hc.containerName + \".\" + hc.browserWindowName;\r\n            }\r\n            if (glue42gd) {\r\n                return glue42gd.appName;\r\n            }\r\n            if (typeof window !== \"undefined\" && typeof document !== \"undefined\") {\r\n                return (window.agm_application || document.title) + uid;\r\n            }\r\n            else {\r\n                return \"NodeJS\" + uid;\r\n            }\r\n        }\r\n        function getDefaultLogger() {\r\n            return {\r\n                publish: \"off\",\r\n                console: \"info\",\r\n                metrics: \"off\",\r\n            };\r\n        }\r\n        return {\r\n            application: getDefaultApplicationName(),\r\n            metrics: getMetricsDefaults(),\r\n            agm: {},\r\n            gateway: getGatewayDefaults(),\r\n            logger: getDefaultLogger(),\r\n        };\r\n    }\r\n    function getConfigProp(prop1, prop2) {\r\n        var masterConfigProp1 = masterConfig[prop1];\r\n        var userProp1 = configuration[prop1];\r\n        var dynamicDefaultsProp1 = dynamicDefaults[prop1];\r\n        var hardDefaultsProp1 = hardDefaults[prop1];\r\n        if (prop2) {\r\n            if (masterConfigProp1 && masterConfigProp1[prop2] !== undefined) {\r\n                return masterConfigProp1[prop2];\r\n            }\r\n            if (userProp1 && userProp1[prop2] !== undefined) {\r\n                return userProp1[prop2];\r\n            }\r\n            if (dynamicDefaultsProp1 && dynamicDefaultsProp1[prop2] !== undefined) {\r\n                return dynamicDefaultsProp1[prop2];\r\n            }\r\n            if (hardDefaultsProp1 && hardDefaultsProp1[prop2] !== undefined) {\r\n                return hardDefaultsProp1[prop2];\r\n            }\r\n        }\r\n        else {\r\n            if (masterConfigProp1 !== undefined) {\r\n                return masterConfigProp1;\r\n            }\r\n            if (userProp1 !== undefined) {\r\n                return userProp1;\r\n            }\r\n            if (dynamicDefaultsProp1 !== undefined) {\r\n                return dynamicDefaultsProp1;\r\n            }\r\n            if (hardDefaultsProp1 !== undefined) {\r\n                return hardDefaultsProp1;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    function ifNotFalse(what, then) {\r\n        if (typeof what === \"boolean\" && !what) {\r\n            return undefined;\r\n        }\r\n        else {\r\n            return then;\r\n        }\r\n    }\r\n    return {\r\n        identity: metricsIdentity,\r\n        application: getApplication(),\r\n        auth: getAuth(),\r\n        logger: getLogger(),\r\n        connection: getGateway(),\r\n        metrics: getMetrics(),\r\n        agm: getAgm(),\r\n        contexts: getContexts(),\r\n        version: ext.version || pjson.version,\r\n        libs: ext.libs\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=config.js.map\n\n/***/ }),\n/* 78 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar connection_1 = __webpack_require__(24);\r\nvar messageReplayer_1 = __webpack_require__(80);\r\nvar GW3ConnectionImpl = (function (_super) {\r\n    __extends(GW3ConnectionImpl, _super);\r\n    function GW3ConnectionImpl(settings) {\r\n        var _this = _super.call(this, settings) || this;\r\n        if (settings.replaySpecs &&\r\n            settings.replaySpecs.length) {\r\n            _this.replayer = new messageReplayer_1.MessageReplayerImpl(settings.replaySpecs);\r\n        }\r\n        return _this;\r\n    }\r\n    GW3ConnectionImpl.prototype.init = function (transport, protocol) {\r\n        _super.prototype.init.call(this, transport, protocol);\r\n        if (this.replayer) {\r\n            this.replayer.init(this);\r\n        }\r\n        this.gw3Protocol = protocol;\r\n    };\r\n    GW3ConnectionImpl.prototype.toAPI = function () {\r\n        var that = this;\r\n        var superAPI = _super.prototype.toAPI.call(this);\r\n        return {\r\n            domain: that.domain.bind(that),\r\n            get peerId() { return that.peerId; },\r\n            get token() { return that.token; },\r\n            get info() { return that.info; },\r\n            get resolvedIdentity() { return that.resolvedIdentity; },\r\n            get availableDomains() { return that.availableDomains; },\r\n            get gatewayToken() { return that.gatewayToken; },\r\n            get replayer() { return that.replayer; },\r\n            on: superAPI.on,\r\n            send: superAPI.send,\r\n            off: superAPI.off,\r\n            login: superAPI.login,\r\n            logout: superAPI.logout,\r\n            loggedIn: superAPI.loggedIn,\r\n            connected: superAPI.connected,\r\n            disconnected: superAPI.disconnected,\r\n            authToken: that.authToken.bind(that),\r\n            get protocolVersion() { return superAPI.protocolVersion; },\r\n        };\r\n    };\r\n    GW3ConnectionImpl.prototype.domain = function (domain, logger, successMessages, errorMessages) {\r\n        return this.gw3Protocol.domain(domain, logger, successMessages, errorMessages);\r\n    };\r\n    GW3ConnectionImpl.prototype.authToken = function () {\r\n        return this.gw3Protocol.authToken();\r\n    };\r\n    return GW3ConnectionImpl;\r\n}(connection_1.default));\r\nexports.default = GW3ConnectionImpl;\r\n//# sourceMappingURL=gw3Connection.js.map\n\n/***/ }),\n/* 79 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar connection_1 = __webpack_require__(24);\r\nvar gw3_1 = __webpack_require__(81);\r\nvar hc_1 = __webpack_require__(83);\r\nvar ws_1 = __webpack_require__(86);\r\nvar gw3Connection_1 = __webpack_require__(78);\r\nvar hc_2 = __webpack_require__(84);\r\nvar inproc_1 = __webpack_require__(85);\r\nexports.default = (function (settings) {\r\n    settings = settings || {};\r\n    settings.reconnectAttempts = settings.reconnectAttempts || 10;\r\n    settings.reconnectInterval = settings.reconnectInterval || 500;\r\n    var connection = new connection_1.default(settings);\r\n    var logger = settings.logger;\r\n    if (!logger) {\r\n        throw new Error(\"please pass a logger object\");\r\n    }\r\n    var protocol = new hc_1.default();\r\n    var transport = new hc_2.default();\r\n    var outsideHC = settings.gdVersion !== 2 || settings.force;\r\n    if (outsideHC) {\r\n        if (settings.gw && settings.gw.facade && settings.gw.token && settings.protocolVersion === 3) {\r\n            transport = new inproc_1.default(settings.gw.token, settings.gw.facade, logger.subLogger(\"inproc\"));\r\n        }\r\n        else if (settings.ws !== undefined) {\r\n            transport = new ws_1.default(settings, logger.subLogger(\"ws\"));\r\n        }\r\n        else {\r\n            throw new Error(\"No connection information specified\");\r\n        }\r\n        if (settings.protocolVersion === 3) {\r\n            var gw3Connection = new gw3Connection_1.default(settings);\r\n            var gw3Port = gw3_1.default(gw3Connection, settings, logger.subLogger(\"gw3\"));\r\n            gw3Connection.init(transport, gw3Port);\r\n            return gw3Connection.toAPI();\r\n        }\r\n        else {\r\n            throw new Error(\"protocolVersion 3 or greater supported\");\r\n        }\r\n    }\r\n    connection.init(transport, protocol);\r\n    return connection.toAPI();\r\n});\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 80 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar MessageReplayerImpl = (function () {\r\n    function MessageReplayerImpl(specs) {\r\n        this.specsNames = [];\r\n        this.messages = {};\r\n        this.subs = {};\r\n        this.subsRefCount = {};\r\n        this.specs = {};\r\n        for (var _i = 0, specs_1 = specs; _i < specs_1.length; _i++) {\r\n            var spec = specs_1[_i];\r\n            this.specs[spec.name] = spec;\r\n            this.specsNames.push(spec.name);\r\n        }\r\n    }\r\n    MessageReplayerImpl.prototype.init = function (connection) {\r\n        var _this = this;\r\n        this.connection = connection;\r\n        for (var _i = 0, _a = this.specsNames; _i < _a.length; _i++) {\r\n            var name_1 = _a[_i];\r\n            var _loop_1 = function (type) {\r\n                var refCount = this_1.subsRefCount[type];\r\n                if (!refCount) {\r\n                    refCount = 0;\r\n                }\r\n                refCount += 1;\r\n                this_1.subsRefCount[type] = refCount;\r\n                if (refCount > 1) {\r\n                    return \"continue\";\r\n                }\r\n                var sub = connection.on(\"glue-core\", type, function (msg) { return _this.processMessage(type, msg); });\r\n                this_1.subs[type] = sub;\r\n            };\r\n            var this_1 = this;\r\n            for (var _b = 0, _c = this.specs[name_1].types; _b < _c.length; _b++) {\r\n                var type = _c[_b];\r\n                _loop_1(type);\r\n            }\r\n        }\r\n    };\r\n    MessageReplayerImpl.prototype.processMessage = function (type, msg) {\r\n        if (this.isDone || !msg) {\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = this.specsNames; _i < _a.length; _i++) {\r\n            var name_2 = _a[_i];\r\n            if (this.specs[name_2].types.indexOf(type) !== -1) {\r\n                var messages = this.messages[name_2] || [];\r\n                this.messages[name_2] = messages;\r\n                messages.push(msg);\r\n            }\r\n        }\r\n    };\r\n    MessageReplayerImpl.prototype.drain = function (name, callback) {\r\n        if (callback) {\r\n            (this.messages[name] || []).forEach(callback);\r\n        }\r\n        delete this.messages[name];\r\n        for (var _i = 0, _a = this.specs[name].types; _i < _a.length; _i++) {\r\n            var type = _a[_i];\r\n            this.subsRefCount[type] -= 1;\r\n            if (this.subsRefCount[type] <= 0) {\r\n                this.connection.off(this.subs[type]);\r\n                delete this.subs[type];\r\n                delete this.subsRefCount[type];\r\n            }\r\n        }\r\n        delete this.specs[name];\r\n        if (!this.specs.length) {\r\n            this.isDone = true;\r\n        }\r\n    };\r\n    return MessageReplayerImpl;\r\n}());\r\nexports.MessageReplayerImpl = MessageReplayerImpl;\r\n//# sourceMappingURL=messageReplayer.js.map\n\n/***/ }),\n/* 81 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gw3Domain_1 = __webpack_require__(82);\r\nvar callback_registry_1 = __webpack_require__(1);\r\nfunction default_1(connection, settings, logger) {\r\n    var datePrefix = \"#T42_DATE#\";\r\n    var datePrefixLen = datePrefix.length;\r\n    var dateMinLen = datePrefixLen + 1;\r\n    var datePrefixFirstChar = datePrefix[0];\r\n    var registry = callback_registry_1.default();\r\n    var globalDomain;\r\n    var isLoggedIn = false;\r\n    var shouldTryLogin = true;\r\n    var initialLogin = true;\r\n    var initialLoginAttempts = 3;\r\n    var initialLoginAttemptsInterval = 500;\r\n    var pingTimer;\r\n    var sessions = [];\r\n    var loginConfig;\r\n    connection.disconnected(handleDisconnected.bind(this));\r\n    ping();\r\n    function processStringMessage(message) {\r\n        var msg = JSON.parse(message, function (key, value) {\r\n            if (typeof value !== \"string\") {\r\n                return value;\r\n            }\r\n            if (value.length < dateMinLen) {\r\n                return value;\r\n            }\r\n            if (value[0] !== datePrefixFirstChar) {\r\n                return value;\r\n            }\r\n            if (value.substring(0, datePrefixLen) !== datePrefix) {\r\n                return value;\r\n            }\r\n            try {\r\n                var milliseconds = parseInt(value.substring(datePrefixLen, value.length), 10);\r\n                if (isNaN(milliseconds)) {\r\n                    return value;\r\n                }\r\n                return new Date(milliseconds);\r\n            }\r\n            catch (ex) {\r\n                return value;\r\n            }\r\n        });\r\n        return {\r\n            msg: msg,\r\n            msgType: msg.type,\r\n        };\r\n    }\r\n    function createStringMessage(product, type, message, id) {\r\n        var oldToJson = Date.prototype.toJSON;\r\n        try {\r\n            Date.prototype.toJSON = function () {\r\n                return datePrefix + this.getTime();\r\n            };\r\n            var result = JSON.stringify(message);\r\n            return result;\r\n        }\r\n        finally {\r\n            Date.prototype.toJSON = oldToJson;\r\n        }\r\n    }\r\n    function processObjectMessage(message) {\r\n        if (!message.type) {\r\n            throw new Error(\"Object should have type property\");\r\n        }\r\n        return {\r\n            msg: message,\r\n            msgType: message.type,\r\n        };\r\n    }\r\n    function createObjectMessage(product, type, message, id) {\r\n        return message;\r\n    }\r\n    function login(config) {\r\n        logger.debug(\"logging in...\");\r\n        loginConfig = config;\r\n        if (!loginConfig) {\r\n            loginConfig = { username: \"\", password: \"\" };\r\n        }\r\n        shouldTryLogin = true;\r\n        return new Promise(function (resolve, reject) {\r\n            var authentication = {};\r\n            connection.gatewayToken = config.gatewayToken;\r\n            if (connection.gatewayToken) {\r\n                authentication.method = \"gateway-token\";\r\n                authentication.token = connection.gatewayToken;\r\n            }\r\n            else if (config.token) {\r\n                authentication.method = \"access-token\";\r\n                authentication.token = config.token;\r\n            }\r\n            else if (config.username) {\r\n                authentication.method = \"secret\";\r\n                authentication.login = config.username;\r\n                authentication.secret = config.password;\r\n            }\r\n            else {\r\n                throw new Error(\"invalid auth message\" + JSON.stringify(config));\r\n            }\r\n            var helloMsg = {\r\n                type: \"hello\",\r\n                identity: settings.identity,\r\n                authentication: authentication,\r\n            };\r\n            globalDomain = gw3Domain_1.default(\"global\", connection, logger, [\r\n                \"welcome\",\r\n                \"token\"\r\n            ]);\r\n            var sendOptions = { skipPeerId: true };\r\n            if (initialLogin) {\r\n                sendOptions.retryInterval = settings.reconnectInterval;\r\n                sendOptions.maxRetries = settings.reconnectAttempts;\r\n            }\r\n            globalDomain.send(helloMsg, undefined, sendOptions)\r\n                .then(function (msg) {\r\n                initialLogin = false;\r\n                logger.debug(\"login successful with PeerId \" + msg.peer_id);\r\n                connection.peerId = msg.peer_id;\r\n                connection.resolvedIdentity = msg.resolved_identity;\r\n                connection.availableDomains = msg.available_domains;\r\n                if (msg.options) {\r\n                    connection.token = msg.options.access_token;\r\n                    connection.info = msg.options.info;\r\n                }\r\n                setLoggedIn(true);\r\n                resolve(msg.resolved_identity);\r\n            })\r\n                .catch(function (err) {\r\n                logger.error(\"error sending hello message - \" + err);\r\n                reject(err);\r\n            });\r\n        });\r\n    }\r\n    function logout() {\r\n        logger.debug(\"logging out...\");\r\n        shouldTryLogin = false;\r\n        if (pingTimer) {\r\n            clearTimeout(pingTimer);\r\n        }\r\n        sessions.forEach(function (session) {\r\n            session.leave();\r\n        });\r\n    }\r\n    function loggedIn(callback) {\r\n        if (isLoggedIn) {\r\n            callback();\r\n        }\r\n        return registry.add(\"onLoggedIn\", callback);\r\n    }\r\n    function domain(domainName, domainLogger, successMessages, errorMessages) {\r\n        var session = sessions.filter(function (s) { return s.domain === domainName; })[0];\r\n        if (!session) {\r\n            session = gw3Domain_1.default(domainName, connection, domainLogger, successMessages, errorMessages);\r\n            sessions.push(session);\r\n        }\r\n        return session;\r\n    }\r\n    function handleDisconnected() {\r\n        setLoggedIn(false);\r\n        var tryToLogin = shouldTryLogin;\r\n        if (tryToLogin && initialLogin) {\r\n            if (initialLoginAttempts <= 0) {\r\n                return;\r\n            }\r\n            initialLoginAttempts--;\r\n        }\r\n        logger.debug(\"disconnected - will try new login?\" + shouldTryLogin);\r\n        if (shouldTryLogin) {\r\n            connection.login(loginConfig)\r\n                .catch(function () {\r\n                setTimeout(handleDisconnected, 1000);\r\n            });\r\n        }\r\n    }\r\n    function setLoggedIn(value) {\r\n        isLoggedIn = value;\r\n        if (isLoggedIn) {\r\n            registry.execute(\"onLoggedIn\");\r\n        }\r\n    }\r\n    function ping() {\r\n        if (!shouldTryLogin) {\r\n            return;\r\n        }\r\n        if (isLoggedIn) {\r\n            connection.send(\"\", \"\", { type: \"ping\" });\r\n        }\r\n        pingTimer = setTimeout(ping, 30 * 1000);\r\n    }\r\n    function authToken() {\r\n        var createTokenReq = {\r\n            type: \"create-token\"\r\n        };\r\n        return globalDomain.send(createTokenReq)\r\n            .then(function (res) {\r\n            return res.token;\r\n        });\r\n    }\r\n    return {\r\n        processStringMessage: processStringMessage,\r\n        createStringMessage: createStringMessage,\r\n        createObjectMessage: createObjectMessage,\r\n        processObjectMessage: processObjectMessage,\r\n        login: login,\r\n        logout: logout,\r\n        loggedIn: loggedIn,\r\n        domain: domain,\r\n        authToken: authToken,\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=gw3.js.map\n\n/***/ }),\n/* 82 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callbackRegistry = __webpack_require__(1);\r\nvar shortid_1 = __webpack_require__(7);\r\nfunction default_1(domain, connection, logger, successMessages, errorMessages) {\r\n    if (domain == null) {\r\n        domain = \"global\";\r\n    }\r\n    var isJoined = false;\r\n    var tryReconnecting = false;\r\n    var _latestOptions;\r\n    var _connectionOn = false;\r\n    var callbacks = callbackRegistry();\r\n    connection.disconnected(handleConnectionDisconnected);\r\n    connection.loggedIn(handleConnectionLoggedIn);\r\n    connection.on(domain, \"success\", function (msg) { return handleSuccessMessage(msg); });\r\n    connection.on(domain, \"error\", function (msg) { return handleErrorMessage(msg); });\r\n    connection.on(domain, \"result\", function (msg) { return handleSuccessMessage(msg); });\r\n    if (successMessages) {\r\n        successMessages.forEach(function (sm) {\r\n            connection.on(domain, sm, function (msg) { return handleSuccessMessage(msg); });\r\n        });\r\n    }\r\n    if (errorMessages) {\r\n        errorMessages.forEach(function (sm) {\r\n            connection.on(domain, sm, function (msg) { return handleErrorMessage(msg); });\r\n        });\r\n    }\r\n    var requestsMap = {};\r\n    function join(options) {\r\n        _latestOptions = options;\r\n        return new Promise(function (resolve, reject) {\r\n            if (isJoined) {\r\n                resolve();\r\n                return;\r\n            }\r\n            var joinPromise;\r\n            if (domain === \"global\") {\r\n                joinPromise = _connectionOn ? Promise.resolve({}) : Promise.reject(\"not connected to gateway\");\r\n            }\r\n            else {\r\n                logger.debug(\"joining \" + domain);\r\n                var joinMsg = {\r\n                    type: \"join\",\r\n                    destination: domain,\r\n                    domain: \"global\",\r\n                    options: options,\r\n                };\r\n                joinPromise = send(joinMsg);\r\n            }\r\n            joinPromise\r\n                .then(function () {\r\n                handleJoined();\r\n                resolve();\r\n            })\r\n                .catch(function (err) {\r\n                logger.debug(\"error joining \" + domain + \" domain: \" + JSON.stringify(err));\r\n                reject(err);\r\n            });\r\n        });\r\n    }\r\n    function leave() {\r\n        if (domain === \"global\") {\r\n            return;\r\n        }\r\n        logger.debug(\"stopping session \" + domain + \"...\");\r\n        var leaveMsg = {\r\n            type: \"leave\",\r\n            destination: domain,\r\n            domain: \"global\",\r\n        };\r\n        send(leaveMsg).then(function () {\r\n            isJoined = false;\r\n            callbacks.execute(\"onLeft\");\r\n        });\r\n    }\r\n    function handleJoined() {\r\n        logger.debug(\"did join \" + domain);\r\n        isJoined = true;\r\n        var wasReconnect = tryReconnecting;\r\n        tryReconnecting = false;\r\n        callbacks.execute(\"onJoined\", wasReconnect);\r\n    }\r\n    function handleConnectionDisconnected() {\r\n        _connectionOn = false;\r\n        logger.warn(\"connection is down\");\r\n        isJoined = false;\r\n        tryReconnecting = true;\r\n        callbacks.execute(\"onLeft\", { disconnected: true });\r\n    }\r\n    function handleConnectionLoggedIn() {\r\n        _connectionOn = true;\r\n        if (tryReconnecting) {\r\n            logger.info(\"connection is now up - trying to reconnect...\");\r\n            join(_latestOptions);\r\n        }\r\n    }\r\n    function onJoined(callback) {\r\n        if (isJoined) {\r\n            callback(false);\r\n        }\r\n        return callbacks.add(\"onJoined\", callback);\r\n    }\r\n    function onLeft(callback) {\r\n        if (!isJoined) {\r\n            callback();\r\n        }\r\n        return callbacks.add(\"onLeft\", callback);\r\n    }\r\n    function handleErrorMessage(msg) {\r\n        if (domain !== msg.domain) {\r\n            return;\r\n        }\r\n        var requestId = msg.request_id;\r\n        var entry = requestsMap[requestId];\r\n        if (!entry) {\r\n            return;\r\n        }\r\n        entry.error(msg);\r\n    }\r\n    function handleSuccessMessage(msg) {\r\n        if (msg.domain !== domain) {\r\n            return;\r\n        }\r\n        var requestId = msg.request_id;\r\n        var entry = requestsMap[requestId];\r\n        if (!entry) {\r\n            return;\r\n        }\r\n        entry.success(msg);\r\n    }\r\n    function getNextRequestId() {\r\n        return shortid_1.generate();\r\n    }\r\n    function send(msg, tag, options) {\r\n        options = options || {};\r\n        msg.request_id = msg.request_id || getNextRequestId();\r\n        msg.domain = msg.domain || domain;\r\n        if (!options.skipPeerId) {\r\n            msg.peer_id = connection.peerId;\r\n        }\r\n        var requestId = msg.request_id;\r\n        return new Promise(function (resolve, reject) {\r\n            requestsMap[requestId] = {\r\n                success: function (successMsg) {\r\n                    delete requestsMap[requestId];\r\n                    successMsg._tag = tag;\r\n                    resolve(successMsg);\r\n                },\r\n                error: function (errorMsg) {\r\n                    logger.warn(\"GW error - \" + JSON.stringify(errorMsg) + \" for request \" + JSON.stringify(msg));\r\n                    delete requestsMap[requestId];\r\n                    errorMsg._tag = tag;\r\n                    reject(errorMsg);\r\n                },\r\n            };\r\n            connection\r\n                .send(domain, domain, msg, undefined, options)\r\n                .catch(function (err) {\r\n                requestsMap[requestId].error({ err: err });\r\n            });\r\n        });\r\n    }\r\n    function sendFireAndForget(msg) {\r\n        msg.request_id = msg.request_id ? msg.request_id : getNextRequestId();\r\n        msg.domain = msg.domain || domain;\r\n        msg.peer_id = connection.peerId;\r\n        connection.send(domain, domain, msg);\r\n    }\r\n    return {\r\n        join: join,\r\n        leave: leave,\r\n        onJoined: onJoined,\r\n        onLeft: onLeft,\r\n        send: send,\r\n        sendFireAndForget: sendFireAndForget,\r\n        on: function (type, callback) {\r\n            connection.on(domain, type, function (msg) {\r\n                if (msg.domain !== domain) {\r\n                    return;\r\n                }\r\n                try {\r\n                    callback(msg);\r\n                }\r\n                catch (e) {\r\n                    logger.error(\"Callback  failed: \" + e + \" \\n msg was: \" + JSON.stringify(msg));\r\n                }\r\n            });\r\n        },\r\n        loggedIn: function (callback) { return connection.loggedIn(callback); },\r\n        connected: function (callback) { return connection.connected(callback); },\r\n        disconnected: function (callback) { return connection.disconnected(callback); },\r\n        get peerId() {\r\n            return connection.peerId;\r\n        },\r\n        get domain() {\r\n            return domain;\r\n        },\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=gw3Domain.js.map\n\n/***/ }),\n/* 83 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar HCProtocol = (function () {\r\n    function HCProtocol() {\r\n    }\r\n    HCProtocol.prototype.processStringMessage = function (message) {\r\n        var messageObj = JSON.parse(message);\r\n        return {\r\n            msg: messageObj,\r\n            msgType: messageObj.type,\r\n        };\r\n    };\r\n    HCProtocol.prototype.createStringMessage = function (product, type, message, id) {\r\n        return JSON.stringify(message);\r\n    };\r\n    HCProtocol.prototype.login = function (message) {\r\n        return Promise.resolve({ application: undefined });\r\n    };\r\n    HCProtocol.prototype.logout = function () {\r\n    };\r\n    HCProtocol.prototype.loggedIn = function (callback) {\r\n        callback();\r\n        return function () {\r\n        };\r\n    };\r\n    HCProtocol.prototype.processObjectMessage = function (message) {\r\n        throw new Error(\"not supported\");\r\n    };\r\n    HCProtocol.prototype.createObjectMessage = function (product, type, message, id) {\r\n        throw new Error(\"not supported\");\r\n    };\r\n    return HCProtocol;\r\n}());\r\nexports.default = HCProtocol;\r\n//# sourceMappingURL=hc.js.map\n\n/***/ }),\n/* 84 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar HCTransport = (function () {\r\n    function HCTransport() {\r\n        this.connectionId = Math.floor(1e10 * Math.random()).toString();\r\n    }\r\n    HCTransport.prototype.send = function (message, product, type) {\r\n        if (product === \"metrics\") {\r\n            window.htmlContainer.metricsFacade.send(type, message);\r\n        }\r\n        else if (product === \"log\") {\r\n            window.htmlContainer.loggingFacade.send(type, message);\r\n        }\r\n        return Promise.resolve(undefined);\r\n    };\r\n    HCTransport.prototype.onConnectedChanged = function (callback) {\r\n        callback(true);\r\n    };\r\n    HCTransport.prototype.onMessage = function (callback) {\r\n    };\r\n    HCTransport.prototype.close = function () {\r\n    };\r\n    HCTransport.prototype.open = function () {\r\n    };\r\n    return HCTransport;\r\n}());\r\nexports.default = HCTransport;\r\n//# sourceMappingURL=hc.js.map\n\n/***/ }),\n/* 85 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar Inproc = (function () {\r\n    function Inproc(token, gw, logger) {\r\n        this.registry = callback_registry_1.default();\r\n        this.gw = gw;\r\n        this.gwToken = token;\r\n        this.logger = logger;\r\n        this.connectToken = this.gw.connect(this.gwToken, this.messageHandler.bind(this));\r\n    }\r\n    Object.defineProperty(Inproc.prototype, \"isObjectBasedTransport\", {\r\n        get: function () {\r\n            return true;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Inproc.prototype.sendObject = function (msg) {\r\n        this.logger.debug(JSON.stringify(msg));\r\n        this.gw.send(this.connectToken, msg);\r\n        return Promise.resolve(undefined);\r\n    };\r\n    Inproc.prototype.send = function (msg, product, type) {\r\n        return Promise.reject(\"not supported\");\r\n    };\r\n    Inproc.prototype.onMessage = function (callback) {\r\n        return this.registry.add(\"onMessage\", callback);\r\n    };\r\n    Inproc.prototype.onConnectedChanged = function (callback) {\r\n        callback(true);\r\n    };\r\n    Inproc.prototype.close = function () {\r\n    };\r\n    Inproc.prototype.open = function () {\r\n    };\r\n    Inproc.prototype.messageHandler = function (msg) {\r\n        if (this.logger.consoleLevel() === \"trace\") {\r\n            this.logger.debug(JSON.stringify(msg));\r\n        }\r\n        this.registry.execute(\"onMessage\", msg);\r\n    };\r\n    return Inproc;\r\n}());\r\nexports.default = Inproc;\r\n//# sourceMappingURL=inproc.js.map\n\n/***/ }),\n/* 86 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar callback_registry_1 = __webpack_require__(1);\r\nvar utils_1 = __webpack_require__(11);\r\nvar WebSocket = utils_1.default.isNode() ? __webpack_require__(45) : window.WebSocket;\r\nvar WS = (function () {\r\n    function WS(settings, logger) {\r\n        this._running = true;\r\n        this._initied = false;\r\n        this._registry = callback_registry_1.default();\r\n        this._settings = settings;\r\n        this._logger = logger;\r\n    }\r\n    WS.prototype.onMessage = function (callback) {\r\n        return this._registry.add(\"onMessage\", callback);\r\n    };\r\n    WS.prototype.send = function (msg, product, type, options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            options = options || {};\r\n            _this.waitForSocketConnection(function () {\r\n                try {\r\n                    _this._ws.send(msg);\r\n                    resolve();\r\n                }\r\n                catch (e) {\r\n                    reject(e);\r\n                }\r\n            }, reject, options.maxRetries, options.retryInterval);\r\n        });\r\n    };\r\n    WS.prototype.open = function () {\r\n        this._running = true;\r\n    };\r\n    WS.prototype.close = function () {\r\n        this._running = false;\r\n        this._ws.close();\r\n    };\r\n    WS.prototype.onConnectedChanged = function (callback) {\r\n        return this._registry.add(\"onConnectedChanged\", callback);\r\n    };\r\n    WS.prototype.initiateSocket = function () {\r\n        var _this = this;\r\n        this._logger.debug(\"initiating _ws to \" + this._settings.ws + \"...\");\r\n        this._ws = new WebSocket(this._settings.ws);\r\n        this._ws.onerror = function (err) {\r\n            _this.notifyStatusChanged(false, err);\r\n        };\r\n        this._ws.onclose = function () {\r\n            _this._logger.debug(\"_ws closed\");\r\n            _this.notifyStatusChanged(false);\r\n        };\r\n        this._ws.onopen = function () {\r\n            _this._logger.debug(\"_ws opened\");\r\n            _this.notifyStatusChanged(true);\r\n        };\r\n        this._ws.onmessage = function (message) {\r\n            _this._registry.execute(\"onMessage\", message.data);\r\n        };\r\n    };\r\n    WS.prototype.waitForSocketConnection = function (callback, failed, retriesLeft, retryInterval) {\r\n        var _this = this;\r\n        if (!callback) {\r\n            callback = function () { };\r\n        }\r\n        if (!failed) {\r\n            failed = function () { };\r\n        }\r\n        if (retryInterval === undefined) {\r\n            retryInterval = this._settings.reconnectInterval;\r\n        }\r\n        if (retriesLeft !== undefined) {\r\n            if (retriesLeft === 0) {\r\n                failed(\"wait for socket on \" + this._settings.ws + \" failed - no more retries left\");\r\n                return;\r\n            }\r\n            this._logger.debug(\"will retry \" + retriesLeft + \" more times (every \" + retryInterval + \" ms)\");\r\n        }\r\n        if (!this._running) {\r\n            failed(\"wait for socket on \" + this._settings.ws + \" failed - socket closed by user\");\r\n            return;\r\n        }\r\n        if (!this._ws || this._ws.readyState > 1) {\r\n            this.initiateSocket();\r\n        }\r\n        else if (this._ws.readyState === 1) {\r\n            return callback();\r\n        }\r\n        setTimeout(function () {\r\n            var retries = retriesLeft === undefined ? undefined : retriesLeft - 1;\r\n            _this.waitForSocketConnection(callback, failed, retries, retryInterval);\r\n        }, retryInterval);\r\n    };\r\n    WS.prototype.notifyStatusChanged = function (status, reason) {\r\n        this._registry.execute(\"onConnectedChanged\", status, reason);\r\n    };\r\n    return WS;\r\n}());\r\nexports.default = WS;\r\n//# sourceMappingURL=ws.js.map\n\n/***/ }),\n/* 87 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gw3ContextData_1 = __webpack_require__(88);\r\nvar helpers_1 = __webpack_require__(91);\r\nvar msg = __webpack_require__(25);\r\nvar contextMessageReplaySpec_1 = __webpack_require__(10);\r\nvar GW3Bridge = (function () {\r\n    function GW3Bridge(config) {\r\n        var _this = this;\r\n        this._contextNameToData = {};\r\n        this._gw3Subscriptions = [];\r\n        this._nextCallbackSubscriptionNumber = 0;\r\n        this._contextNameToId = {};\r\n        this._contextIdToName = {};\r\n        this._connection = config.connection;\r\n        this._logger = config.logger;\r\n        this._gw3Session = this._connection.domain(\"global\", this._logger, [\r\n            msg.GW_MESSAGE_CONTEXT_CREATED,\r\n            msg.GW_MESSAGE_SUBSCRIBED_CONTEXT,\r\n            msg.GW_MESSAGE_CONTEXT_DESTROYED,\r\n            msg.GW_MESSAGE_CONTEXT_UPDATED,\r\n        ]);\r\n        this.subscribeToContextCreatedMessages();\r\n        this.subscribeToContextUpdatedMessages();\r\n        this.subscribeToContextDestroyedMessages();\r\n        this._connection.replayer.drain(contextMessageReplaySpec_1.ContextMessageReplaySpec.name, function (message) {\r\n            var type = message.type;\r\n            if (!type) {\r\n                return;\r\n            }\r\n            if (type === msg.GW_MESSAGE_CONTEXT_CREATED ||\r\n                type === msg.GW_MESSAGE_CONTEXT_ADDED ||\r\n                type === msg.GW_MESSAGE_ACTIVITY_CREATED) {\r\n                _this.handleContextCreatedMessage(message);\r\n            }\r\n            else if (type === msg.GW_MESSAGE_SUBSCRIBED_CONTEXT ||\r\n                type === msg.GW_MESSAGE_CONTEXT_UPDATED ||\r\n                type === msg.GW_MESSAGE_JOINED_ACTIVITY) {\r\n                _this.handleContextUpdatedMessage(message);\r\n            }\r\n            else if (type === msg.GW_MESSAGE_CONTEXT_DESTROYED ||\r\n                type === msg.GW_MESSAGE_ACTIVITY_DESTROYED) {\r\n                _this.handleContextDestroyedMessage(message);\r\n            }\r\n        });\r\n    }\r\n    GW3Bridge.prototype.dispose = function () {\r\n        for (var _i = 0, _a = this._gw3Subscriptions; _i < _a.length; _i++) {\r\n            var sub = _a[_i];\r\n            this._connection.off(sub);\r\n        }\r\n        this._gw3Subscriptions.length = 0;\r\n        for (var contextName in this._contextNameToData) {\r\n            if (this._contextNameToId.hasOwnProperty(contextName)) {\r\n                delete this._contextNameToData[contextName];\r\n            }\r\n        }\r\n    };\r\n    GW3Bridge.prototype.createContext = function (name, data) {\r\n        var _this = this;\r\n        return this._gw3Session\r\n            .send({\r\n            type: msg.GW_MESSAGE_CREATE_CONTEXT,\r\n            domain: \"global\",\r\n            name: name,\r\n            data: data,\r\n            lifetime: \"retained\",\r\n        })\r\n            .then(function (createContextMsg) {\r\n            _this._contextNameToId[name] = createContextMsg.context_id;\r\n            if (!_this._contextIdToName[createContextMsg.context_id]) {\r\n                _this._contextIdToName[createContextMsg.context_id] = name;\r\n                var contextData = _this._contextNameToData[name] || new gw3ContextData_1.GW3ContextData(createContextMsg.context_id, name, true, null);\r\n                contextData.isAnnounced = true;\r\n                contextData.name = name;\r\n                contextData.contextId = createContextMsg.context_id;\r\n                _this._contextNameToData[name] = contextData;\r\n                contextData.context = createContextMsg.data;\r\n                contextData.sentExplicitSubscription = true;\r\n                if (contextData.context) {\r\n                    _this.invokeUpdateCallbacks(contextData, contextData.context);\r\n                }\r\n                return _this.update(name, data).then(function () { return createContextMsg.context_id; });\r\n            }\r\n            return createContextMsg.context_id;\r\n        });\r\n    };\r\n    GW3Bridge.prototype.all = function () {\r\n        var _this = this;\r\n        return Object.keys(this._contextNameToData)\r\n            .filter(function (name) { return _this._contextNameToData[name].isAnnounced; });\r\n    };\r\n    GW3Bridge.prototype.update = function (name, delta) {\r\n        var _this = this;\r\n        var contextData = this._contextNameToData[name];\r\n        if (!contextData || !contextData.isAnnounced) {\r\n            return this.createContext(name, delta);\r\n        }\r\n        var calculatedDelta = this.calculateContextDelta(contextData.context, delta);\r\n        if (!Object.keys(calculatedDelta.added).length\r\n            && !Object.keys(calculatedDelta.updated).length\r\n            && !calculatedDelta.removed.length) {\r\n            return Promise.resolve();\r\n        }\r\n        return this._gw3Session\r\n            .send({\r\n            type: msg.GW_MESSAGE_UPDATE_CONTEXT,\r\n            domain: \"global\",\r\n            context_id: contextData.contextId,\r\n            delta: calculatedDelta,\r\n        })\r\n            .then(function () {\r\n            _this.handleUpdated(contextData, calculatedDelta);\r\n        });\r\n    };\r\n    GW3Bridge.prototype.set = function (name, data) {\r\n        var _this = this;\r\n        var contextData = this._contextNameToData[name];\r\n        if (!contextData || !contextData.isAnnounced) {\r\n            return this.createContext(name, data);\r\n        }\r\n        return this._gw3Session\r\n            .send({\r\n            type: msg.GW_MESSAGE_UPDATE_CONTEXT,\r\n            domain: \"global\",\r\n            context_id: contextData.contextId,\r\n            delta: { reset: data },\r\n        })\r\n            .then(function () {\r\n            _this.handleUpdated(contextData, { reset: data, added: {}, removed: [], updated: {} });\r\n        });\r\n    };\r\n    GW3Bridge.prototype.get = function (name) {\r\n        var _this = this;\r\n        var contextData = this._contextNameToData[name];\r\n        if (!contextData || !contextData.isAnnounced) {\r\n            return new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\r\n                var _this = this;\r\n                return __generator(this, function (_a) {\r\n                    this.subscribe(name, function (data, un) {\r\n                        _this.unsubscribe(un);\r\n                        resolve(data);\r\n                    });\r\n                    return [2];\r\n                });\r\n            }); });\r\n        }\r\n        else {\r\n            return Promise.resolve(contextData.context);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribe = function (name, callback) {\r\n        var thisCallbackSubscriptionNumber = this._nextCallbackSubscriptionNumber;\r\n        this._nextCallbackSubscriptionNumber += 1;\r\n        var contextData = this._contextNameToData[name];\r\n        if (!contextData ||\r\n            !contextData.isAnnounced) {\r\n            contextData = contextData || new gw3ContextData_1.GW3ContextData(undefined, name, false, undefined);\r\n            this._contextNameToData[name] = contextData;\r\n            contextData.updateCallbacks[thisCallbackSubscriptionNumber] = callback;\r\n            return Promise.resolve(thisCallbackSubscriptionNumber);\r\n        }\r\n        var hadCallbacks = contextData.hasCallbacks();\r\n        contextData.updateCallbacks[thisCallbackSubscriptionNumber] = callback;\r\n        if (!hadCallbacks) {\r\n            if (!contextData.joinedActivity) {\r\n                if (contextData.context &&\r\n                    contextData.sentExplicitSubscription) {\r\n                    callback(contextData.context, thisCallbackSubscriptionNumber);\r\n                    return Promise.resolve(thisCallbackSubscriptionNumber);\r\n                }\r\n                return this.sendSubscribe(contextData)\r\n                    .then(function () { return thisCallbackSubscriptionNumber; });\r\n            }\r\n            else {\r\n                callback(contextData.context, thisCallbackSubscriptionNumber);\r\n                return Promise.resolve(thisCallbackSubscriptionNumber);\r\n            }\r\n        }\r\n        else {\r\n            callback(contextData.context, thisCallbackSubscriptionNumber);\r\n            return Promise.resolve(thisCallbackSubscriptionNumber);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.unsubscribe = function (subscriptionKey) {\r\n        for (var _i = 0, _a = Object.keys(this._contextNameToData); _i < _a.length; _i++) {\r\n            var name_1 = _a[_i];\r\n            var contextId = this._contextNameToId[name_1];\r\n            var contextData = this._contextNameToData[name_1];\r\n            if (!contextData) {\r\n                return;\r\n            }\r\n            var hadCallbacks = contextData.hasCallbacks();\r\n            delete contextData.updateCallbacks[subscriptionKey];\r\n            if (contextData.isAnnounced &&\r\n                hadCallbacks &&\r\n                !contextData.hasCallbacks() &&\r\n                contextData.sentExplicitSubscription) {\r\n                this.sendUnsubscribe(contextData);\r\n            }\r\n            if (!contextData.isAnnounced &&\r\n                !contextData.hasCallbacks()) {\r\n                delete this._contextNameToData[name_1];\r\n            }\r\n        }\r\n    };\r\n    GW3Bridge.prototype.handleUpdated = function (contextData, delta) {\r\n        var oldContext = contextData.context;\r\n        contextData.context = helpers_1.applyContextDelta(contextData.context, delta);\r\n        if (this._contextNameToData[contextData.name] === contextData &&\r\n            !helpers_1.deepEqual(oldContext, contextData.context)) {\r\n            this.invokeUpdateCallbacks(contextData, contextData.context);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribeToContextCreatedMessages = function () {\r\n        var createdMessageTypes = [\r\n            msg.GW_MESSAGE_CONTEXT_ADDED,\r\n            msg.GW_MESSAGE_CONTEXT_CREATED,\r\n            msg.GW_MESSAGE_ACTIVITY_CREATED,\r\n        ];\r\n        for (var _i = 0, createdMessageTypes_1 = createdMessageTypes; _i < createdMessageTypes_1.length; _i++) {\r\n            var createdMessageType = createdMessageTypes_1[_i];\r\n            var sub = this._connection.on(\"js-contexts\", createdMessageType, this.handleContextCreatedMessage.bind(this));\r\n            this._gw3Subscriptions.push(sub);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.handleContextCreatedMessage = function (contextCreatedMsg) {\r\n        var createdMessageType = contextCreatedMsg.type;\r\n        if (createdMessageType === msg.GW_MESSAGE_ACTIVITY_CREATED) {\r\n            this._contextNameToId[contextCreatedMsg.activity_id] = contextCreatedMsg.context_id;\r\n            this._contextIdToName[contextCreatedMsg.context_id] = contextCreatedMsg.activity_id;\r\n        }\r\n        else if (createdMessageType === msg.GW_MESSAGE_CONTEXT_ADDED) {\r\n            this._contextNameToId[contextCreatedMsg.name] = contextCreatedMsg.context_id;\r\n            this._contextIdToName[contextCreatedMsg.context_id] = contextCreatedMsg.name;\r\n        }\r\n        else if (createdMessageType === msg.GW_MESSAGE_CONTEXT_CREATED) {\r\n        }\r\n        var name = this._contextIdToName[contextCreatedMsg.context_id];\r\n        if (!name) {\r\n            throw new Error(\"Received created event for context with unknown name: \" + contextCreatedMsg.context_id);\r\n        }\r\n        if (!this._contextNameToId[name]) {\r\n            throw new Error(\"Received created event for context with unknown id: \" + contextCreatedMsg.context_id);\r\n        }\r\n        var contextData = this._contextNameToData[name];\r\n        if (contextData) {\r\n            if (contextData.isAnnounced) {\r\n                return;\r\n            }\r\n            else {\r\n                if (!contextData.hasCallbacks()) {\r\n                    throw new Error(\"Assertion failure: contextData.hasCallbacks()\");\r\n                }\r\n                contextData.isAnnounced = true;\r\n                contextData.contextId = contextCreatedMsg.context_id;\r\n                contextData.activityId = contextCreatedMsg.activity_id;\r\n                if (!contextData.sentExplicitSubscription) {\r\n                    this.sendSubscribe(contextData);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this._contextNameToData[name] = contextData =\r\n                new gw3ContextData_1.GW3ContextData(contextCreatedMsg.context_id, name, true, contextCreatedMsg.activity_id);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribeToContextUpdatedMessages = function () {\r\n        var updatedMessageTypes = [\r\n            msg.GW_MESSAGE_CONTEXT_UPDATED,\r\n            msg.GW_MESSAGE_SUBSCRIBED_CONTEXT,\r\n            msg.GW_MESSAGE_JOINED_ACTIVITY,\r\n        ];\r\n        for (var _i = 0, updatedMessageTypes_1 = updatedMessageTypes; _i < updatedMessageTypes_1.length; _i++) {\r\n            var updatedMessageType = updatedMessageTypes_1[_i];\r\n            var sub = this._connection.on(\"js-contexts\", updatedMessageType, this.handleContextUpdatedMessage.bind(this));\r\n            this._gw3Subscriptions.push(sub);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.handleContextUpdatedMessage = function (contextUpdatedMsg) {\r\n        var updatedMessageType = contextUpdatedMsg.type;\r\n        var contextId = contextUpdatedMsg.context_id;\r\n        var contextData = this._contextNameToData[this._contextIdToName[contextId]];\r\n        var justSeen = !contextData || !contextData.isAnnounced;\r\n        if (updatedMessageType === msg.GW_MESSAGE_JOINED_ACTIVITY) {\r\n            if (!contextData) {\r\n                contextData = new gw3ContextData_1.GW3ContextData(contextId, contextUpdatedMsg.activity_id, true, contextUpdatedMsg.activity_id);\r\n                this._contextNameToData[contextUpdatedMsg.activity_id] = contextData;\r\n                this._contextIdToName[contextId] = contextUpdatedMsg.activity_id;\r\n                this._contextNameToId[contextUpdatedMsg.activity_id] = contextId;\r\n            }\r\n            else {\r\n                contextData.contextId = contextId;\r\n                contextData.isAnnounced = true;\r\n                contextData.activityId = contextUpdatedMsg.activity_id;\r\n            }\r\n            contextData.joinedActivity = true;\r\n        }\r\n        else {\r\n            if (!contextData || !contextData.isAnnounced) {\r\n                if (updatedMessageType === msg.GW_MESSAGE_SUBSCRIBED_CONTEXT) {\r\n                    contextData = contextData || new gw3ContextData_1.GW3ContextData(contextId, contextUpdatedMsg.name, true, null);\r\n                    contextData.sentExplicitSubscription = true;\r\n                    this._contextNameToData[contextUpdatedMsg.name] = contextData;\r\n                    this._contextIdToName[contextId] = contextUpdatedMsg.name;\r\n                    this._contextNameToId[contextUpdatedMsg.name] = contextId;\r\n                }\r\n                else {\r\n                    this._logger.error(\"Received 'update' for unknown context: \" + contextId);\r\n                }\r\n                return;\r\n            }\r\n        }\r\n        var oldContext = contextData.context;\r\n        if (updatedMessageType === msg.GW_MESSAGE_SUBSCRIBED_CONTEXT) {\r\n            contextData.context = contextUpdatedMsg.data || {};\r\n        }\r\n        else if (updatedMessageType === msg.GW_MESSAGE_JOINED_ACTIVITY) {\r\n            contextData.context = contextUpdatedMsg.context_snapshot || {};\r\n        }\r\n        else if (updatedMessageType === msg.GW_MESSAGE_CONTEXT_UPDATED) {\r\n            contextData.context = helpers_1.applyContextDelta(contextData.context, contextUpdatedMsg.delta);\r\n        }\r\n        else {\r\n            throw new Error(\"Unrecognized context update message \" + updatedMessageType);\r\n        }\r\n        if (justSeen ||\r\n            !helpers_1.deepEqual(contextData.context, oldContext) ||\r\n            updatedMessageType === msg.GW_MESSAGE_SUBSCRIBED_CONTEXT) {\r\n            this.invokeUpdateCallbacks(contextData, contextData.context);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.invokeUpdateCallbacks = function (contextData, data) {\r\n        for (var updateCallbackIndex in contextData.updateCallbacks) {\r\n            if (contextData.updateCallbacks.hasOwnProperty(updateCallbackIndex)) {\r\n                try {\r\n                    var updateCallback = contextData.updateCallbacks[updateCallbackIndex];\r\n                    updateCallback(helpers_1.deepClone(data), parseInt(updateCallbackIndex));\r\n                }\r\n                catch (err) {\r\n                    this._logger.debug(\"Callback error: \" + JSON.stringify(err));\r\n                }\r\n            }\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribeToContextDestroyedMessages = function () {\r\n        var destroyedMessageTypes = [\r\n            msg.GW_MESSAGE_CONTEXT_DESTROYED,\r\n            msg.GW_MESSAGE_ACTIVITY_DESTROYED,\r\n        ];\r\n        for (var _i = 0, destroyedMessageTypes_1 = destroyedMessageTypes; _i < destroyedMessageTypes_1.length; _i++) {\r\n            var destroyedMessageType = destroyedMessageTypes_1[_i];\r\n            var sub = this._connection.on(\"js-contexts\", destroyedMessageType, this.handleContextDestroyedMessage.bind(this));\r\n            this._gw3Subscriptions.push(sub);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.handleContextDestroyedMessage = function (destroyedMsg) {\r\n        var destroyedMessageType = destroyedMsg.type;\r\n        var contextId;\r\n        var name;\r\n        if (destroyedMessageType === msg.GW_MESSAGE_ACTIVITY_DESTROYED) {\r\n            name = destroyedMsg.activity_id;\r\n            contextId = this._contextNameToId[name];\r\n            if (!contextId) {\r\n                this._logger.error(\"Received 'destroyed' for unknown activity: \" + destroyedMsg.activity_id);\r\n                return;\r\n            }\r\n        }\r\n        else {\r\n            contextId = destroyedMsg.context_id;\r\n            name = this._contextIdToName[contextId];\r\n            if (!name) {\r\n                this._logger.error(\"Received 'destroyed' for unknown context: \" + destroyedMsg.context_id);\r\n                return;\r\n            }\r\n        }\r\n        delete this._contextIdToName[contextId];\r\n        delete this._contextNameToId[name];\r\n        var contextData = this._contextNameToData[name];\r\n        delete this._contextNameToData[name];\r\n        if (!contextData || !contextData.isAnnounced) {\r\n            this._logger.error(\"Received 'destroyed' for unknown context: \" + contextId);\r\n            return;\r\n        }\r\n    };\r\n    GW3Bridge.prototype.sendSubscribe = function (contextData) {\r\n        contextData.sentExplicitSubscription = true;\r\n        return this._gw3Session\r\n            .send({\r\n            type: msg.GW_MESSAGE_SUBSCRIBE_CONTEXT,\r\n            domain: \"global\",\r\n            context_id: contextData.contextId,\r\n        }).then(function (_) { return undefined; });\r\n    };\r\n    GW3Bridge.prototype.sendUnsubscribe = function (contextData) {\r\n        contextData.sentExplicitSubscription = false;\r\n        return this._gw3Session\r\n            .send({\r\n            type: msg.GW_MESSAGE_UNSUBSCRIBE_CONTEXT,\r\n            domain: \"global\",\r\n            context_id: contextData.contextId,\r\n        }).then(function (_) { return undefined; });\r\n    };\r\n    GW3Bridge.prototype.calculateContextDelta = function (from, to) {\r\n        var delta = { added: {}, updated: {}, removed: [], reset: null };\r\n        if (from) {\r\n            for (var _i = 0, _a = Object.keys(from); _i < _a.length; _i++) {\r\n                var x = _a[_i];\r\n                if (Object.keys(to).indexOf(x) !== -1\r\n                    && to[x] !== null\r\n                    && !helpers_1.deepEqual(from[x], to[x])) {\r\n                    delta.updated[x] = to[x];\r\n                }\r\n            }\r\n        }\r\n        for (var _b = 0, _c = Object.keys(to); _b < _c.length; _b++) {\r\n            var x = _c[_b];\r\n            if (!from || (Object.keys(from).indexOf(x) === -1)) {\r\n                if (to[x] !== null) {\r\n                    delta.added[x] = to[x];\r\n                }\r\n            }\r\n            else if (to[x] === null) {\r\n                delta.removed.push(x);\r\n            }\r\n        }\r\n        return delta;\r\n    };\r\n    return GW3Bridge;\r\n}());\r\nexports.GW3Bridge = GW3Bridge;\r\n//# sourceMappingURL=gw3Bridge.js.map\n\n/***/ }),\n/* 88 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar GW3ContextData = (function () {\r\n    function GW3ContextData(contextId, name, isAnnounced, activityId) {\r\n        this.updateCallbacks = {};\r\n        this.contextId = contextId;\r\n        this.name = name;\r\n        this.isAnnounced = isAnnounced;\r\n        this.activityId = activityId;\r\n        this.context = {};\r\n    }\r\n    GW3ContextData.prototype.hasCallbacks = function () {\r\n        return Object.keys(this.updateCallbacks).length > 0;\r\n    };\r\n    GW3ContextData.prototype.getState = function () {\r\n        if (this.isAnnounced && this.hasCallbacks()) {\r\n            return 3;\r\n        }\r\n        if (this.isAnnounced) {\r\n            return 2;\r\n        }\r\n        if (this.hasCallbacks()) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    return GW3ContextData;\r\n}());\r\nexports.GW3ContextData = GW3ContextData;\r\n//# sourceMappingURL=gw3ContextData.js.map\n\n/***/ }),\n/* 89 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar HCBridge = (function () {\r\n    function HCBridge(config) {\r\n        this._facade = window.htmlContainer.sharedContextFacade;\r\n    }\r\n    HCBridge.prototype.all = function () {\r\n        var allObj = this._facade.all();\r\n        if (!allObj || !allObj.keys) {\r\n            return [];\r\n        }\r\n        return allObj.keys;\r\n    };\r\n    HCBridge.prototype.update = function (name, delta) {\r\n        this._facade.update(name, delta);\r\n        return Promise.resolve();\r\n    };\r\n    HCBridge.prototype.set = function (name, data) {\r\n        this._facade.set(name, data);\r\n        return Promise.resolve();\r\n    };\r\n    HCBridge.prototype.subscribe = function (name, callback) {\r\n        var snapshot = null;\r\n        var key = this._facade.subscribe(name, function (data) {\r\n            if (!key) {\r\n                snapshot = data;\r\n                return;\r\n            }\r\n            if (snapshot) {\r\n                callback(snapshot, key);\r\n                snapshot = null;\r\n            }\r\n            callback(data, key);\r\n        });\r\n        if (snapshot) {\r\n            callback(snapshot, key);\r\n            snapshot = null;\r\n        }\r\n        return Promise.resolve(key);\r\n    };\r\n    HCBridge.prototype.get = function (name) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                this.subscribe(name, function (data, un) {\r\n                    _this.unsubscribe(un);\r\n                    resolve(data);\r\n                });\r\n                return [2];\r\n            });\r\n        }); });\r\n    };\r\n    HCBridge.prototype.unsubscribe = function (key) {\r\n        this._facade.unsubscribe(key);\r\n    };\r\n    return HCBridge;\r\n}());\r\nexports.HCBridge = HCBridge;\r\n//# sourceMappingURL=hcBridge.js.map\n\n/***/ }),\n/* 90 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gw3Bridge_1 = __webpack_require__(87);\r\nvar hcBridge_1 = __webpack_require__(89);\r\nvar ContextsModule = (function () {\r\n    function ContextsModule(config) {\r\n        this.config = config;\r\n        try {\r\n            if (config.gdMajorVersion === 2) {\r\n                var hc = window.htmlContainer;\r\n                if (!hc.sharedContextFacade) {\r\n                    throw new Error(\"Your version of HtmlContainer does not support contexts.\"\r\n                        + \" Get version 1.46.0.0 or later to have that feature.\");\r\n                }\r\n                this._bridge = new hcBridge_1.HCBridge(config);\r\n            }\r\n            else if (config.connection.protocolVersion === 3) {\r\n                this._bridge = new gw3Bridge_1.GW3Bridge(config);\r\n            }\r\n            else {\r\n                throw new Error(\"To use the Contexts library you must run in the\"\r\n                    + \" HTML Container or using a connection to Gateway v3.\");\r\n            }\r\n        }\r\n        catch (err) {\r\n            throw err;\r\n        }\r\n    }\r\n    ContextsModule.prototype.all = function () {\r\n        return this._bridge.all();\r\n    };\r\n    ContextsModule.prototype.update = function (name, delta) {\r\n        this.checkName(name);\r\n        return this._bridge.update(name, delta);\r\n    };\r\n    ContextsModule.prototype.set = function (name, data) {\r\n        this.checkName(name);\r\n        return this._bridge.set(name, data);\r\n    };\r\n    ContextsModule.prototype.subscribe = function (name, callback) {\r\n        var _this = this;\r\n        this.checkName(name);\r\n        return this._bridge\r\n            .subscribe(name, function (data, key) { return callback(data, function () { return _this._bridge.unsubscribe(key); }); })\r\n            .then(function (key) {\r\n            return function () {\r\n                _this._bridge.unsubscribe(key);\r\n            };\r\n        });\r\n    };\r\n    ContextsModule.prototype.get = function (name) {\r\n        return this._bridge.get(name);\r\n    };\r\n    ContextsModule.prototype.ready = function () {\r\n        return Promise.resolve(this);\r\n    };\r\n    ContextsModule.prototype.checkName = function (name) {\r\n        if (typeof name !== \"string\" ||\r\n            name == \"\") {\r\n            throw new Error(\"'name' must be non-empty string, got '\" + name + \"'\");\r\n        }\r\n    };\r\n    return ContextsModule;\r\n}());\r\nexports.ContextsModule = ContextsModule;\r\n//# sourceMappingURL=contextsModule.js.map\n\n/***/ }),\n/* 91 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction applyContextDelta(context, delta) {\r\n    if (delta) {\r\n        if (delta.reset) {\r\n            context = __assign({}, delta.reset);\r\n            return context;\r\n        }\r\n        context = deepClone(context, null);\r\n        var added_1 = delta.added;\r\n        var updated_1 = delta.updated;\r\n        var removed = delta.removed;\r\n        if (added_1) {\r\n            Object.keys(added_1).forEach(function (key) {\r\n                context[key] = added_1[key];\r\n            });\r\n        }\r\n        if (updated_1) {\r\n            Object.keys(updated_1).forEach(function (key) {\r\n                mergeObjectsProperties(key, context, updated_1);\r\n            });\r\n        }\r\n        if (removed) {\r\n            removed.forEach(function (key) {\r\n                delete context[key];\r\n            });\r\n        }\r\n    }\r\n    return context;\r\n}\r\nexports.applyContextDelta = applyContextDelta;\r\nfunction deepClone(obj, hash) {\r\n    hash = hash || new WeakMap();\r\n    if (Object(obj) !== obj) {\r\n        return obj;\r\n    }\r\n    if (obj instanceof Set) {\r\n        return new Set(obj);\r\n    }\r\n    if (hash.has(obj)) {\r\n        return hash.get(obj);\r\n    }\r\n    var result = obj instanceof Date ? new Date(obj)\r\n        : obj instanceof RegExp ? new RegExp(obj.source, obj.flags)\r\n            : obj.constructor ? new obj.constructor()\r\n                : Object.create(null);\r\n    hash.set(obj, result);\r\n    if (obj instanceof Map) {\r\n        Array.from(obj, function (_a) {\r\n            var key = _a[0], val = _a[1];\r\n            return result.set(key, deepClone(val, hash));\r\n        });\r\n    }\r\n    return Object.assign.apply(Object, [result].concat(Object.keys(obj).map(function (key) {\r\n        var _a;\r\n        return (_a = {}, _a[key] = deepClone(obj[key], hash), _a);\r\n    })));\r\n}\r\nexports.deepClone = deepClone;\r\nvar mergeObjectsProperties = function (key, what, withWhat) {\r\n    var right = withWhat[key];\r\n    if (right === undefined) {\r\n        return what;\r\n    }\r\n    var left = what[key];\r\n    if (!left || !right) {\r\n        what[key] = right;\r\n        return what;\r\n    }\r\n    if (typeof left === \"string\" ||\r\n        typeof left === \"number\" ||\r\n        typeof left === \"boolean\" ||\r\n        typeof right === \"string\" ||\r\n        typeof right === \"number\" ||\r\n        typeof right === \"boolean\" ||\r\n        Array.isArray(left) ||\r\n        Array.isArray(right)) {\r\n        what[key] = right;\r\n        return what;\r\n    }\r\n    what[key] = Object.assign({}, left, right);\r\n    return what;\r\n};\r\nfunction deepEqual(x, y) {\r\n    if (x === y) {\r\n        return true;\r\n    }\r\n    if (!(x instanceof Object) || !(y instanceof Object)) {\r\n        return false;\r\n    }\r\n    if (x.constructor !== y.constructor) {\r\n        return false;\r\n    }\r\n    for (var p in x) {\r\n        if (!x.hasOwnProperty(p)) {\r\n            continue;\r\n        }\r\n        if (!y.hasOwnProperty(p)) {\r\n            return false;\r\n        }\r\n        if (x[p] === y[p]) {\r\n            continue;\r\n        }\r\n        if (typeof (x[p]) !== \"object\") {\r\n            return false;\r\n        }\r\n        if (!deepEqual(x[p], y[p])) {\r\n            return false;\r\n        }\r\n    }\r\n    for (var p in y) {\r\n        if (y.hasOwnProperty(p) && !x.hasOwnProperty(p)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nexports.deepEqual = deepEqual;\r\n//# sourceMappingURL=helpers.js.map\n\n/***/ }),\n/* 92 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar contextsModule_1 = __webpack_require__(90);\r\nexports.ContextsModule = contextsModule_1.ContextsModule;\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 93 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LogLevel = (function () {\r\n    function LogLevel() {\r\n    }\r\n    LogLevel.canPublish = function (level, restriction) {\r\n        var levelIdx = LogLevel.order.indexOf(level);\r\n        var restrictionIdx = LogLevel.order.indexOf(restriction);\r\n        return levelIdx >= restrictionIdx;\r\n    };\r\n    LogLevel.off = \"off\";\r\n    LogLevel.trace = \"trace\";\r\n    LogLevel.debug = \"debug\";\r\n    LogLevel.info = \"info\";\r\n    LogLevel.warn = \"warn\";\r\n    LogLevel.error = \"error\";\r\n    LogLevel.order = [LogLevel.trace, LogLevel.debug, LogLevel.info, LogLevel.warn, LogLevel.error, LogLevel.off];\r\n    return LogLevel;\r\n}());\r\nexports.default = LogLevel;\r\n//# sourceMappingURL=levels.js.map\n\n/***/ }),\n/* 94 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar levels_1 = __webpack_require__(93);\r\nvar LoggerImpl = (function () {\r\n    function LoggerImpl(name, parent, metricSystem) {\r\n        this._subloggers = [];\r\n        this._name = name;\r\n        this._parent = parent;\r\n        if (parent) {\r\n            this._path = parent.path + \".\" + name;\r\n        }\r\n        else {\r\n            this._path = name;\r\n        }\r\n        this._loggerFullName = \"[\" + this._path + \"]\";\r\n        if (typeof metricSystem !== \"undefined\") {\r\n            this.metricsLevel(\"warn\", metricSystem.subSystem(name));\r\n        }\r\n    }\r\n    Object.defineProperty(LoggerImpl.prototype, \"name\", {\r\n        get: function () {\r\n            return this._name;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LoggerImpl.prototype, \"path\", {\r\n        get: function () {\r\n            return this._path;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    LoggerImpl.prototype.subLogger = function (name) {\r\n        var existingSub = this._subloggers.filter(function (subLogger) {\r\n            return subLogger.name === name;\r\n        })[0];\r\n        if (existingSub !== undefined) {\r\n            return existingSub;\r\n        }\r\n        Object.keys(this).forEach(function (key) {\r\n            if (key === name) {\r\n                throw new Error(\"This sub logger name is not allowed.\");\r\n            }\r\n        });\r\n        var sub = new LoggerImpl(name, this);\r\n        this._subloggers.push(sub);\r\n        return sub;\r\n    };\r\n    LoggerImpl.prototype.publishLevel = function (level) {\r\n        if (level !== null && level !== undefined) {\r\n            this._publishLevel = level;\r\n        }\r\n        return this._publishLevel || this._parent.publishLevel();\r\n    };\r\n    LoggerImpl.prototype.consoleLevel = function (level) {\r\n        if (level !== null && level !== undefined) {\r\n            this._consoleLevel = level;\r\n        }\r\n        return this._consoleLevel || this._parent.consoleLevel();\r\n    };\r\n    LoggerImpl.prototype.metricsLevel = function (level, metricsSystem) {\r\n        if (level !== null && level !== undefined) {\r\n            this._metricLevel = level;\r\n        }\r\n        if (metricsSystem !== undefined) {\r\n            if (typeof metricsSystem === \"object\" && typeof metricsSystem.objectMetric === \"function\") {\r\n                this._metricSystem = metricsSystem;\r\n            }\r\n            else {\r\n                throw new Error(\"Please specify metric system\");\r\n            }\r\n        }\r\n        return this._metricLevel || this._parent.metricsLevel();\r\n    };\r\n    LoggerImpl.prototype.log = function (message, level) {\r\n        this.publishMessage(level || levels_1.default.info, message);\r\n    };\r\n    LoggerImpl.prototype.trace = function (message) {\r\n        this.log(message, levels_1.default.trace);\r\n    };\r\n    LoggerImpl.prototype.debug = function (message) {\r\n        this.log(message, levels_1.default.debug);\r\n    };\r\n    LoggerImpl.prototype.info = function (message) {\r\n        this.log(message, levels_1.default.info);\r\n    };\r\n    LoggerImpl.prototype.warn = function (message) {\r\n        this.log(message, levels_1.default.warn);\r\n    };\r\n    LoggerImpl.prototype.error = function (message) {\r\n        this.log(message, levels_1.default.error);\r\n    };\r\n    LoggerImpl.prototype.toAPIObject = function () {\r\n        var that = this;\r\n        return {\r\n            name: this.name,\r\n            subLogger: this.subLogger.bind(that),\r\n            publishLevel: this.publishLevel.bind(that),\r\n            consoleLevel: this.consoleLevel.bind(that),\r\n            metricsLevel: this.metricsLevel.bind(that),\r\n            log: this.log.bind(that),\r\n            trace: this.trace.bind(that),\r\n            debug: this.debug.bind(that),\r\n            info: this.info.bind(that),\r\n            warn: this.warn.bind(that),\r\n            error: this.error.bind(that),\r\n        };\r\n    };\r\n    LoggerImpl.prototype.publishMessage = function (level, message) {\r\n        var loggerName = this._loggerFullName;\r\n        if (level === levels_1.default.error) {\r\n            var e = new Error();\r\n            if (e.stack) {\r\n                message = message + \"\\n\" +\r\n                    (e.stack.split(\"\\n\").slice(3).join(\"\\n\"));\r\n            }\r\n        }\r\n        if (levels_1.default.canPublish(level, this.consoleLevel())) {\r\n            var toPrint = loggerName + \": \" + message;\r\n            switch (level) {\r\n                case levels_1.default.trace:\r\n                    console.trace(toPrint);\r\n                    break;\r\n                case levels_1.default.debug:\r\n                    if (console.debug) {\r\n                        console.debug(toPrint);\r\n                    }\r\n                    else {\r\n                        console.log(toPrint);\r\n                    }\r\n                    break;\r\n                case levels_1.default.info:\r\n                    console.info(toPrint);\r\n                    break;\r\n                case levels_1.default.warn:\r\n                    console.warn(toPrint);\r\n                    break;\r\n                case levels_1.default.error:\r\n                    console.error(toPrint);\r\n                    break;\r\n            }\r\n        }\r\n        if (levels_1.default.canPublish(level, this.publishLevel())) {\r\n            LoggerImpl.GetConnection().send(\"log\", \"LogMessage\", {\r\n                instance: LoggerImpl.Instance,\r\n                level: levels_1.default.order.indexOf(level),\r\n                logger: loggerName,\r\n                message: message,\r\n            });\r\n        }\r\n        if (levels_1.default.canPublish(level, this.metricsLevel())) {\r\n            if (this._metricSystem !== undefined) {\r\n                this._metricSystem.objectMetric(\"LogMessage\", {\r\n                    Level: level,\r\n                    Logger: loggerName,\r\n                    Message: message,\r\n                    Time: new Date(),\r\n                });\r\n                if (level === levels_1.default.error) {\r\n                    this._metricSystem.setState(100, message);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return LoggerImpl;\r\n}());\r\nexports.default = LoggerImpl;\r\n//# sourceMappingURL=logger.js.map\n\n/***/ }),\n/* 95 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar logger_1 = __webpack_require__(94);\r\nexports.default = (function (settings) {\r\n    var identity = settings.identity;\r\n    if (!identity) {\r\n        throw new Error(\"identity is missing\");\r\n    }\r\n    var identityStr = identity.system + \"\\\\\" + identity.service + \"\\\\\" + identity.instance;\r\n    logger_1.default.Instance = identityStr;\r\n    logger_1.default.GetConnection = settings.getConnection;\r\n    var mainLogger = new logger_1.default(\"main\");\r\n    mainLogger.publishLevel(settings.publish || \"off\");\r\n    mainLogger.consoleLevel(settings.console || \"info\");\r\n    mainLogger.metricsLevel(settings.metrics || \"off\");\r\n    var apiLogger = mainLogger.toAPIObject();\r\n    return apiLogger;\r\n});\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 96 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar glue_1 = __webpack_require__(30);\r\nvar pjson = __webpack_require__(13);\r\nif (typeof window !== \"undefined\") {\r\n    window.GlueCore = glue_1.default;\r\n}\r\nglue_1.default.default = glue_1.default;\r\nglue_1.default.version = pjson.version;\r\nmodule.exports = glue_1.default;\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 97 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction addressMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var conflation = definition.conflation;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.ADDRESS;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = addressMetric;\r\n//# sourceMappingURL=address.js.map\n\n/***/ }),\n/* 98 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction countMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || 0;\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.COUNT;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    function incrementBy(num) {\r\n        update(_value + num);\r\n    }\r\n    function increment() {\r\n        incrementBy(1);\r\n    }\r\n    function decrement() {\r\n        incrementBy(-1);\r\n    }\r\n    function decrementBy(num) {\r\n        incrementBy(num * -1);\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get path() {\r\n            return _path;\r\n        },\r\n        get value() {\r\n            return _value;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n        incrementBy: incrementBy,\r\n        increment: increment,\r\n        decrement: decrement,\r\n        decrementBy: decrementBy,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = countMetric;\r\n//# sourceMappingURL=count.js.map\n\n/***/ }),\n/* 99 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction numberMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _path = parent.path.slice(0);\r\n    var _value = value || 0;\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.NUMBER;\r\n    _path.push(parent.name);\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    function incrementBy(num) {\r\n        update(_value + num);\r\n    }\r\n    function increment() {\r\n        incrementBy(1);\r\n    }\r\n    function decrement() {\r\n        incrementBy(-1);\r\n    }\r\n    function decrementBy(num) {\r\n        incrementBy(num * -1);\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        type: type,\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n        incrementBy: incrementBy,\r\n        increment: increment,\r\n        decrement: decrement,\r\n        decrementBy: decrementBy,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = numberMetric;\r\n//# sourceMappingURL=number.js.map\n\n/***/ }),\n/* 100 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar metric_types_1 = __webpack_require__(0);\r\nvar helpers_1 = __webpack_require__(2);\r\nfunction objectMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.OBJECT;\r\n    function update(newValue) {\r\n        mergeValues(newValue);\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    function mergeValues(values) {\r\n        return Object.keys(_value).forEach(function (k) {\r\n            if (typeof values[k] !== \"undefined\") {\r\n                _value[k] = values[k];\r\n            }\r\n        });\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = objectMetric;\r\n//# sourceMappingURL=object.js.map\n\n/***/ }),\n/* 101 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction rateMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.RATE;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = rateMetric;\r\n//# sourceMappingURL=rate.js.map\n\n/***/ }),\n/* 102 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction statisticsMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.STATISTICS;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = statisticsMetric;\r\n//# sourceMappingURL=statistics.js.map\n\n/***/ }),\n/* 103 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction stringMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.STRING;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        type: type,\r\n        update: update,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = stringMetric;\r\n//# sourceMappingURL=string.js.map\n\n/***/ }),\n/* 104 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction timespanMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.TIMESPAN;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function start() {\r\n        update(true);\r\n    }\r\n    function stop() {\r\n        update(false);\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        start: start,\r\n        stop: stop,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = timespanMetric;\r\n//# sourceMappingURL=timespan.js.map\n\n/***/ }),\n/* 105 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar helpers_1 = __webpack_require__(2);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction timestampMetric(definition, parent, transport, value) {\r\n    helpers_1.default.validate(definition, parent, transport);\r\n    var _transport = transport;\r\n    var _value = value || \"\";\r\n    var _path = parent.path.slice(0);\r\n    _path.push(parent.name);\r\n    var name = definition.name;\r\n    var description = definition.description;\r\n    var period = definition.period;\r\n    var resolution = definition.resolution;\r\n    var conflation = definition.conflation;\r\n    var system = parent;\r\n    var repo = parent.repo;\r\n    var id = parent.path + \"/\" + name;\r\n    var type = metric_types_1.default.TIMESTAMP;\r\n    function update(newValue) {\r\n        _value = newValue;\r\n        _transport.updateMetric(me);\r\n    }\r\n    function now() {\r\n        update(new Date());\r\n    }\r\n    function getValueType() {\r\n        return undefined;\r\n    }\r\n    var me = {\r\n        name: name,\r\n        description: description,\r\n        period: period,\r\n        resolution: resolution,\r\n        system: system,\r\n        repo: repo,\r\n        id: id,\r\n        type: type,\r\n        conflation: conflation,\r\n        get value() {\r\n            return _value;\r\n        },\r\n        get path() {\r\n            return _path;\r\n        },\r\n        update: update,\r\n        now: now,\r\n        getValueType: getValueType,\r\n    };\r\n    _transport.createMetric(me);\r\n    return me;\r\n}\r\nexports.default = timestampMetric;\r\n//# sourceMappingURL=timestamp.js.map\n\n/***/ }),\n/* 106 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar serializer_1 = __webpack_require__(107);\r\nfunction default_1(connection, config) {\r\n    var DEFAULT_HEARTBEAT_INTERVAL = 3000;\r\n    if (!connection || typeof connection !== \"object\") {\r\n        throw new Error(\"Connection is required parameter\");\r\n    }\r\n    var _connection = connection;\r\n    var heartbeatInterval = config.heartbeatInterval || DEFAULT_HEARTBEAT_INTERVAL;\r\n    var send = function (type, message) {\r\n        _connection.send(\"metrics\", type, message);\r\n    };\r\n    function sendFull(repo) {\r\n        if (!repo.root) {\r\n            return;\r\n        }\r\n        if (repo.root.subSystems.length === 0) {\r\n            return;\r\n        }\r\n        sendFullSystem(repo.root);\r\n    }\r\n    function sendFullSystem(system) {\r\n        createSystem(system);\r\n        system.subSystems.forEach(function (sub) {\r\n            sendFullSystem(sub);\r\n        });\r\n        system.metrics.forEach(function (metric) {\r\n            createMetric(metric);\r\n        });\r\n    }\r\n    function heartbeat(repo) {\r\n        send(\"HeartbeatMetrics\", {\r\n            publishingInterval: heartbeatInterval,\r\n            instance: repo.instance,\r\n        });\r\n    }\r\n    function createSystem(system) {\r\n        if (system.parent !== undefined) {\r\n            send(\"CreateMetricSystem\", {\r\n                id: system.id,\r\n                instance: system.repo.instance,\r\n                definition: {\r\n                    name: system.name,\r\n                    description: system.description,\r\n                    path: system.path,\r\n                },\r\n            });\r\n        }\r\n    }\r\n    function updateSystem(system, state) {\r\n        send(\"UpdateMetricSystem\", {\r\n            id: system.id,\r\n            instance: system.repo.instance,\r\n            state: state,\r\n        });\r\n    }\r\n    function createMetric(metric) {\r\n        send(\"CreateMetric\", serializer_1.default(metric));\r\n    }\r\n    function updateMetric(metric) {\r\n        send(\"UpdateMetric\", serializer_1.default(metric));\r\n    }\r\n    function init(repo) {\r\n        heartbeat(repo);\r\n        _connection.on(\"metrics\", \"MetricsSnapshotRequest\", function (instanceInfo) {\r\n            if (instanceInfo.Instance !== repo.instance) {\r\n                return;\r\n            }\r\n            sendFull(repo);\r\n        });\r\n        if (typeof window !== \"undefined\" && typeof window.htmlContainer === \"undefined\") {\r\n            setInterval(function () {\r\n                heartbeat(repo);\r\n            }, heartbeatInterval);\r\n        }\r\n    }\r\n    var me = {\r\n        createSystem: createSystem,\r\n        updateSystem: updateSystem,\r\n        createMetric: createMetric,\r\n        updateMetric: updateMetric,\r\n        init: init,\r\n    };\r\n    return me;\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=gw1.js.map\n\n/***/ }),\n/* 107 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction metricToMessage(metric) {\r\n    var definition = getMetricDefinition(metric.name, metric.value, metric.path, metric.type, metric.description, metric.period, metric.resolution, metric.conflation);\r\n    function getMetricDefinition(name, value, path, type, description, period, resolution, conflation) {\r\n        var _definition = {\r\n            name: name,\r\n            description: description,\r\n            type: type ? type : getTypeFromValue(value),\r\n            path: path,\r\n            resolution: resolution,\r\n            period: period,\r\n            conflation: conflation,\r\n        };\r\n        if (_definition.type === metric_types_1.default.OBJECT) {\r\n            _definition.Composite = Object.keys(value).reduce(function (arr, key) {\r\n                var val = value[key];\r\n                arr.push(getMetricDefinition(key, val, path));\r\n                return arr;\r\n            }, []);\r\n        }\r\n        return _definition;\r\n    }\r\n    function serializeValue(value, _metric) {\r\n        if (value && value.constructor === Date) {\r\n            return {\r\n                value: {\r\n                    type: _valueTypes.indexOf(\"date\"),\r\n                    value: value.valueOf(),\r\n                    isArray: false,\r\n                },\r\n            };\r\n        }\r\n        if (typeof value === \"object\") {\r\n            return {\r\n                CompositeValue: Object.keys(value).reduce(function (arr, key) {\r\n                    var val = serializeValue(value[key]);\r\n                    val.InnerMetricName = key;\r\n                    arr.push(val);\r\n                    return arr;\r\n                }, []),\r\n            };\r\n        }\r\n        var valueType = _metric ? _metric.getValueType() : undefined;\r\n        valueType = valueType || _valueTypes.indexOf(typeof value);\r\n        return {\r\n            value: {\r\n                type: valueType,\r\n                value: value,\r\n                isArray: false,\r\n            },\r\n        };\r\n    }\r\n    function getTypeFromValue(value) {\r\n        var typeAsString = value.constructor === Date ? \"timestamp\" : typeof value;\r\n        switch (typeAsString) {\r\n            case \"string\":\r\n                return metric_types_1.default.STRING;\r\n            case \"number\":\r\n                return metric_types_1.default.NUMBER;\r\n            case \"timestamp\":\r\n                return metric_types_1.default.TIMESTAMP;\r\n            case \"object\":\r\n                return metric_types_1.default.OBJECT;\r\n        }\r\n        return 0;\r\n    }\r\n    var _valueTypes = [\r\n        \"boolean\",\r\n        \"int\",\r\n        \"number\",\r\n        \"long\",\r\n        \"string\",\r\n        \"date\",\r\n        \"object\",\r\n    ];\r\n    return {\r\n        id: metric.id,\r\n        instance: metric.repo.instance,\r\n        definition: definition,\r\n        value: serializeValue(metric.value, metric),\r\n    };\r\n}\r\nexports.default = metricToMessage;\r\n//# sourceMappingURL=serializer.js.map\n\n/***/ }),\n/* 108 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar serializer_1 = __webpack_require__(109);\r\nfunction default_1(connection, config) {\r\n    if (!connection || typeof connection !== \"object\") {\r\n        throw new Error(\"Connection is required parameter\");\r\n    }\r\n    var joinPromise;\r\n    var session;\r\n    var init = function (repo) {\r\n        var resolveReadyPromise;\r\n        joinPromise = new Promise(function (resolve) {\r\n            resolveReadyPromise = resolve;\r\n        });\r\n        session = connection.domain(\"metrics\", config.logger);\r\n        session.onJoined(function (reconnect) {\r\n            if (!reconnect) {\r\n                resolveReadyPromise();\r\n                resolveReadyPromise = undefined;\r\n            }\r\n            var rootStateMetric = {\r\n                name: \"/State\",\r\n                type: \"object\",\r\n                composite: {\r\n                    Description: {\r\n                        type: \"string\",\r\n                        description: \"\",\r\n                    },\r\n                    Value: {\r\n                        type: \"number\",\r\n                        description: \"\",\r\n                    },\r\n                },\r\n                description: \"System state\",\r\n                context: {},\r\n            };\r\n            var defineRootMetricsMsg = {\r\n                type: \"define\",\r\n                metrics: [rootStateMetric],\r\n            };\r\n            session.send(defineRootMetricsMsg);\r\n            if (reconnect) {\r\n                replayRepo(repo);\r\n            }\r\n        });\r\n        session.join(config.identity);\r\n    };\r\n    var replayRepo = function (repo) {\r\n        replaySystem(repo.root);\r\n    };\r\n    var replaySystem = function (system) {\r\n        createSystem(system);\r\n        system.metrics.forEach(function (m) {\r\n            createMetric(m);\r\n        });\r\n        system.subSystems.forEach(function (ss) {\r\n            replaySystem(ss);\r\n        });\r\n    };\r\n    var createSystem = function (system) {\r\n        if (system.parent === undefined) {\r\n            return;\r\n        }\r\n        joinPromise.then(function () {\r\n            var metric = {\r\n                name: serializer_1.normalizeMetricName(system.path.join(\"/\") + \"/\" + system.name + \"/State\"),\r\n                type: \"object\",\r\n                composite: {\r\n                    Description: {\r\n                        type: \"string\",\r\n                        description: \"\",\r\n                    },\r\n                    Value: {\r\n                        type: \"number\",\r\n                        description: \"\",\r\n                    },\r\n                },\r\n                description: \"System state\",\r\n                context: {},\r\n            };\r\n            var createMetricsMsg = {\r\n                type: \"define\",\r\n                metrics: [metric],\r\n            };\r\n            session.send(createMetricsMsg);\r\n        });\r\n    };\r\n    var updateSystem = function (system, state) {\r\n        joinPromise.then(function () {\r\n            var shadowedUpdateMetric = {\r\n                type: \"publish\",\r\n                values: [{\r\n                        name: serializer_1.normalizeMetricName(system.path.join(\"/\") + \"/\" + system.name + \"/State\"),\r\n                        value: {\r\n                            Description: state.description,\r\n                            Value: state.state,\r\n                        },\r\n                        timestamp: Date.now(),\r\n                    }],\r\n            };\r\n            session.send(shadowedUpdateMetric);\r\n            var stateObj = serializer_1.composeMsgForRootStateMetric(system);\r\n            var rootMetric = {\r\n                type: \"publish\",\r\n                peer_id: connection.peerId,\r\n                values: [{\r\n                        name: \"/State\",\r\n                        value: {\r\n                            Description: stateObj.description,\r\n                            Value: stateObj.value,\r\n                        },\r\n                        timestamp: Date.now(),\r\n                    }],\r\n            };\r\n            session.send(rootMetric);\r\n        });\r\n    };\r\n    var createMetric = function (metric) {\r\n        joinPromise.then(function () {\r\n            var m = serializer_1.serializeMetric(metric);\r\n            var createMetricsMsg = {\r\n                type: \"define\",\r\n                metrics: [m],\r\n            };\r\n            session.send(createMetricsMsg);\r\n            if (typeof metric.value !== \"undefined\") {\r\n                updateMetric(metric);\r\n            }\r\n        });\r\n    };\r\n    var updateMetric = function (metric) {\r\n        joinPromise.then(function () {\r\n            var value = serializer_1.getMetricValueByType(metric);\r\n            var publishMetricsMsg = {\r\n                type: \"publish\",\r\n                values: [{\r\n                        name: serializer_1.normalizeMetricName(metric.path.join(\"/\") + \"/\" + metric.name),\r\n                        value: value,\r\n                        timestamp: Date.now(),\r\n                    }],\r\n            };\r\n            session.send(publishMetricsMsg);\r\n        });\r\n    };\r\n    return {\r\n        init: init,\r\n        createSystem: createSystem,\r\n        updateSystem: updateSystem,\r\n        createMetric: createMetric,\r\n        updateMetric: updateMetric,\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=gw3.js.map\n\n/***/ }),\n/* 109 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction getMetricTypeByValue(metric) {\r\n    if ((metric.value && metric.value.constructor === Date) || metric.type === metric_types_1.default.TIMESPAN || metric.type === metric_types_1.default.TIMESTAMP) {\r\n        return \"timestamp\";\r\n    }\r\n    else if (typeof metric.value === \"number\") {\r\n        return \"number\";\r\n    }\r\n    else if (typeof metric.value === \"string\" || metric.type === metric_types_1.default.STRING || metric.type === metric_types_1.default.RATE) {\r\n        return \"string\";\r\n    }\r\n    else if (typeof metric.value === \"object\") {\r\n        return \"object\";\r\n    }\r\n}\r\nfunction getTypeByValue(value) {\r\n    if (value.constructor === Date) {\r\n        return \"timestamp\";\r\n    }\r\n    else if (typeof value === \"number\") {\r\n        return \"number\";\r\n    }\r\n    else if (typeof value === \"string\") {\r\n        return \"string\";\r\n    }\r\n    else if (typeof value === \"object\") {\r\n        return \"object\";\r\n    }\r\n    else {\r\n        return \"string\";\r\n    }\r\n}\r\nfunction serializeMetric(metric) {\r\n    var serializedMetrics = {};\r\n    var type = getMetricTypeByValue(metric);\r\n    if (type === \"object\") {\r\n        var values = Object.keys(metric.value).reduce(function (memo, key) {\r\n            var innerType = getTypeByValue(metric.value[key]);\r\n            if (innerType === \"object\") {\r\n                var composite = defineNestedComposite(metric.value[key]);\r\n                memo[key] = {\r\n                    type: \"object\",\r\n                    description: \"\",\r\n                    context: {},\r\n                    composite: composite,\r\n                };\r\n            }\r\n            else {\r\n                memo[key] = {\r\n                    type: innerType,\r\n                    description: \"\",\r\n                    context: {},\r\n                };\r\n            }\r\n            return memo;\r\n        }, {});\r\n        serializedMetrics.composite = values;\r\n    }\r\n    serializedMetrics.name = normalizeMetricName(metric.path.join(\"/\") + \"/\" + metric.name);\r\n    serializedMetrics.type = type;\r\n    serializedMetrics.description = metric.description;\r\n    serializedMetrics.context = {};\r\n    return serializedMetrics;\r\n}\r\nexports.serializeMetric = serializeMetric;\r\nfunction defineNestedComposite(values) {\r\n    return Object.keys(values).reduce(function (memo, key) {\r\n        var type = getTypeByValue(values[key]);\r\n        if (type === \"object\") {\r\n            memo[key] = {\r\n                type: \"object\",\r\n                description: \"\",\r\n                context: {},\r\n                composite: defineNestedComposite(values[key]),\r\n            };\r\n        }\r\n        else {\r\n            memo[key] = {\r\n                type: type,\r\n                description: \"\",\r\n                context: {},\r\n            };\r\n        }\r\n        return memo;\r\n    }, {});\r\n}\r\nfunction normalizeMetricName(name) {\r\n    if (typeof name !== \"undefined\" && name.length > 0 && name[0] !== \"/\") {\r\n        return \"/\" + name;\r\n    }\r\n    else {\r\n        return name;\r\n    }\r\n}\r\nexports.normalizeMetricName = normalizeMetricName;\r\nfunction getMetricValueByType(metric) {\r\n    var type = getMetricTypeByValue(metric);\r\n    if (type === \"timestamp\") {\r\n        return Date.now();\r\n    }\r\n    else {\r\n        return publishNestedComposite(metric.value);\r\n    }\r\n}\r\nexports.getMetricValueByType = getMetricValueByType;\r\nfunction publishNestedComposite(values) {\r\n    if (typeof values !== \"object\") {\r\n        return values;\r\n    }\r\n    return Object.keys(values).reduce(function (memo, key) {\r\n        var value = values[key];\r\n        if (typeof value === \"object\" && value.constructor !== Date) {\r\n            memo[key] = publishNestedComposite(value);\r\n        }\r\n        else if (value.constructor === Date) {\r\n            memo[key] = new Date(value).getTime();\r\n        }\r\n        else if (value.constructor === Boolean) {\r\n            memo[key] = value.toString();\r\n        }\r\n        else {\r\n            memo[key] = value;\r\n        }\r\n        return memo;\r\n    }, {});\r\n}\r\nfunction flatten(arr) {\r\n    return arr.reduce(function (flat, toFlatten) {\r\n        return flat.concat(Array.isArray(toFlatten) ? flatten(toFlatten) : toFlatten);\r\n    }, []);\r\n}\r\nfunction getHighestState(arr) {\r\n    return arr.sort(function (a, b) {\r\n        return b.state - a.state;\r\n    })[0];\r\n}\r\nfunction aggregateDescription(arr) {\r\n    var msg = \"\";\r\n    arr.forEach(function (m, idx, a) {\r\n        var path = m.path.join(\".\");\r\n        if (idx === a.length - 1) {\r\n            msg += path + \".\" + m.name + \": \" + m.description;\r\n        }\r\n        else {\r\n            msg += path + \".\" + m.name + \": \" + m.description + \",\";\r\n        }\r\n    });\r\n    if (msg.length > 100) {\r\n        return msg.slice(0, 100) + \"...\";\r\n    }\r\n    else {\r\n        return msg;\r\n    }\r\n}\r\nfunction composeMsgForRootStateMetric(system) {\r\n    var aggregatedState = system.root.getAggregateState();\r\n    var merged = flatten(aggregatedState);\r\n    var highestState = getHighestState(merged);\r\n    var aggregateDesc = aggregateDescription(merged);\r\n    return {\r\n        description: aggregateDesc,\r\n        value: highestState.state,\r\n    };\r\n}\r\nexports.composeMsgForRootStateMetric = composeMsgForRootStateMetric;\r\n//# sourceMappingURL=serializer.js.map\n\n/***/ }),\n/* 110 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gw3_1 = __webpack_require__(108);\r\nvar gw1_1 = __webpack_require__(106);\r\nvar repository_1 = __webpack_require__(111);\r\nexports.default = (function (settings) {\r\n    var options = {\r\n        connection: settings.connection,\r\n        identity: settings.identity,\r\n        logger: settings.logger,\r\n        heartbeatInterval: settings.heartbeatInterval,\r\n        settings: {},\r\n        clickStream: settings.clickStream,\r\n    };\r\n    if (!options.connection || typeof options.connection !== \"object\") {\r\n        throw new Error(\"Connection is required parameter\");\r\n    }\r\n    var _protocol;\r\n    if (options.connection.protocolVersion === 3) {\r\n        _protocol = gw3_1.default(options.connection, settings);\r\n    }\r\n    else {\r\n        _protocol = gw1_1.default(options.connection, settings);\r\n    }\r\n    var repo = repository_1.default(options, _protocol);\r\n    var rootSystem = repo.root;\r\n    return rootSystem;\r\n});\r\n//# sourceMappingURL=main.js.map\n\n/***/ }),\n/* 111 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar system_1 = __webpack_require__(112);\r\nfunction repository(options, protocol) {\r\n    if (!options.identity) {\r\n        throw new Error(\"Identity missing from metrics configuration\");\r\n    }\r\n    if (!options.identity.service || typeof options.identity.service !== \"string\") {\r\n        throw new Error(\"Service missing or invalid in metrics identity configuration\");\r\n    }\r\n    if (!options.identity.system || typeof options.identity.system !== \"string\") {\r\n        throw new Error(\"System missing or invalid in metrics identity configuration\");\r\n    }\r\n    if (!options.identity.instance || typeof options.identity.instance !== \"string\") {\r\n        throw new Error(\"Instance missing or invalid in metrics identity configuration\");\r\n    }\r\n    var identity = options.identity;\r\n    var instance = options.identity.system + \"/\" + options.identity.service + \"/\" + options.identity.instance;\r\n    function _initSystemMetrics(rootSystem, useClickStream) {\r\n        if (typeof navigator !== \"undefined\") {\r\n            rootSystem.stringMetric(\"UserAgent\", navigator.userAgent);\r\n        }\r\n        if (useClickStream && typeof document !== \"undefined\") {\r\n            var clickStream_1 = rootSystem.subSystem(\"ClickStream\");\r\n            var documentClickHandler = function (e) {\r\n                if (!e.target) {\r\n                    return;\r\n                }\r\n                var target = e.target;\r\n                clickStream_1.objectMetric(\"LastBrowserEvent\", {\r\n                    type: \"click\",\r\n                    timestamp: new Date(),\r\n                    target: {\r\n                        className: e.target ? target.className : \"\",\r\n                        id: target.id,\r\n                        type: \"<\" + target.tagName.toLowerCase() + \">\",\r\n                        href: target.href || \"\",\r\n                    },\r\n                });\r\n            };\r\n            clickStream_1.objectMetric(\"Page\", {\r\n                title: document.title,\r\n                page: window.location.href,\r\n            });\r\n            if (document.addEventListener) {\r\n                document.addEventListener(\"click\", documentClickHandler);\r\n            }\r\n            else {\r\n                document.attachEvent(\"onclick\", documentClickHandler);\r\n            }\r\n        }\r\n        var startTime = rootSystem.stringMetric(\"StartTime\", (new Date()).toString());\r\n        var urlMetric = rootSystem.stringMetric(\"StartURL\", \"\");\r\n        var appNameMetric = rootSystem.stringMetric(\"AppName\", \"\");\r\n        if (typeof window !== \"undefined\") {\r\n            if (typeof window.location !== \"undefined\") {\r\n                var startUrl = window.location.href;\r\n                urlMetric.update(startUrl);\r\n            }\r\n            if (typeof window.glue42gd !== \"undefined\") {\r\n                appNameMetric.update(window.glue42gd.appName);\r\n            }\r\n        }\r\n    }\r\n    var me = {\r\n        identity: identity,\r\n        instance: instance,\r\n        get root() {\r\n            return _root;\r\n        },\r\n    };\r\n    protocol.init(me);\r\n    var _root = system_1.default(\"\", me, protocol);\r\n    _initSystemMetrics(_root, options.clickStream || options.clickStream === undefined);\r\n    return me;\r\n}\r\nexports.default = repository;\r\n//# sourceMappingURL=repository.js.map\n\n/***/ }),\n/* 112 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar address_1 = __webpack_require__(97);\r\nvar count_1 = __webpack_require__(98);\r\nvar number_1 = __webpack_require__(99);\r\nvar object_1 = __webpack_require__(100);\r\nvar rate_1 = __webpack_require__(101);\r\nvar statistics_1 = __webpack_require__(102);\r\nvar string_1 = __webpack_require__(103);\r\nvar timespan_1 = __webpack_require__(104);\r\nvar timestamp_1 = __webpack_require__(105);\r\nvar metric_types_1 = __webpack_require__(0);\r\nfunction system(name, repo, protocol, parent, description) {\r\n    if (!repo) {\r\n        throw new Error(\"Repository is required\");\r\n    }\r\n    if (!protocol) {\r\n        throw new Error(\"Transport is required\");\r\n    }\r\n    var _transport = protocol;\r\n    var _name = name;\r\n    var _description = description || \"\";\r\n    var _repo = repo;\r\n    var _parent = parent;\r\n    var _path = _buildPath(parent);\r\n    var _state = {};\r\n    var id = _arrayToString(_path, \"/\") + name;\r\n    var identity = repo.identity;\r\n    var root = repo.root;\r\n    var _subSystems = [];\r\n    var _metrics = [];\r\n    function subSystem(nameSystem, descriptionSystem) {\r\n        if (!nameSystem || nameSystem.length === 0) {\r\n            throw new Error(\"name is required\");\r\n        }\r\n        var match = _subSystems.filter(function (s) { return s.name === nameSystem; });\r\n        if (match.length > 0) {\r\n            return match[0];\r\n        }\r\n        var _system = system(nameSystem, _repo, _transport, me, descriptionSystem);\r\n        _subSystems.push(_system);\r\n        return _system;\r\n    }\r\n    function setState(state, stateDescription) {\r\n        _state = { state: state, description: stateDescription };\r\n        _transport.updateSystem(me, _state);\r\n    }\r\n    function stringMetric(definition, value) {\r\n        return _getOrCreateMetric.call(me, definition, metric_types_1.default.STRING, value, function (metricDef) { return string_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function numberMetric(definition, value) {\r\n        return _getOrCreateMetric.call(me, definition, metric_types_1.default.NUMBER, value, function (metricDef) { return number_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function countMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.COUNT, value, function (metricDef) { return count_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function addressMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.ADDRESS, value, function (metricDef) { return address_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function objectMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.OBJECT, value, function (metricDef) { return object_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function timespanMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.TIMESPAN, value, function (metricDef) { return timespan_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function timestampMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.TIMESTAMP, value, function (metricDef) { return timestamp_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function rateMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.RATE, value, function (metricDef) { return rate_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function statisticsMetric(definition, value) {\r\n        return _getOrCreateMetric.call(this, definition, metric_types_1.default.STATISTICS, value, function (metricDef) { return statistics_1.default(metricDef, me, _transport, value); });\r\n    }\r\n    function _unionToMetricDef(def) {\r\n        var metricDefinition = {};\r\n        if (typeof def === \"string\") {\r\n            metricDefinition.name = def;\r\n        }\r\n        else {\r\n            metricDefinition = def;\r\n        }\r\n        if (metricDefinition.name === undefined) {\r\n            throw new Error(\"Metric name is required\");\r\n        }\r\n        return metricDefinition;\r\n    }\r\n    function _getOrCreateMetric(definition, expectedType, value, createMetric) {\r\n        var metricDefinition = _unionToMetricDef(definition);\r\n        var matching = _metrics.filter(function (shadowedMetric) { return shadowedMetric.name === metricDefinition.name; });\r\n        if (matching.length > 0) {\r\n            var existing = matching[0];\r\n            if (existing.type !== expectedType) {\r\n                throw new Error(\"A metric named \" + metricDefinition.name + \" is already defined with different type.\");\r\n            }\r\n            if (typeof value !== \"undefined\") {\r\n                existing.update(value);\r\n            }\r\n            return existing;\r\n        }\r\n        var metric = createMetric(metricDefinition);\r\n        _metrics.push(metric);\r\n        return metric;\r\n    }\r\n    function _buildPath(shadowedSystem) {\r\n        if (!shadowedSystem || !shadowedSystem.parent) {\r\n            return [];\r\n        }\r\n        var path = _buildPath(shadowedSystem.parent);\r\n        path.push(shadowedSystem.name);\r\n        return path;\r\n    }\r\n    function _arrayToString(path, separator) {\r\n        return ((path && path.length > 0) ? path.join(separator) : \"\");\r\n    }\r\n    function getAggregateState() {\r\n        var aggState = [];\r\n        if (Object.keys(_state).length > 0) {\r\n            aggState.push({\r\n                name: _name,\r\n                path: _path,\r\n                state: _state.state,\r\n                description: _state.description,\r\n            });\r\n        }\r\n        _subSystems.forEach(function (shadowedSubSystem) {\r\n            var result = shadowedSubSystem.getAggregateState();\r\n            if (result.length > 0) {\r\n                aggState.push.apply(aggState, result);\r\n            }\r\n        });\r\n        return aggState;\r\n    }\r\n    var me = {\r\n        get name() {\r\n            return _name;\r\n        },\r\n        get description() {\r\n            return _description;\r\n        },\r\n        get repo() {\r\n            return _repo;\r\n        },\r\n        get parent() {\r\n            return _parent;\r\n        },\r\n        path: _path,\r\n        id: id,\r\n        identity: identity,\r\n        root: root,\r\n        get subSystems() {\r\n            return _subSystems;\r\n        },\r\n        get metrics() {\r\n            return _metrics;\r\n        },\r\n        subSystem: subSystem,\r\n        getState: function () {\r\n            return _state;\r\n        },\r\n        setState: setState,\r\n        stringMetric: stringMetric,\r\n        statisticsMetric: statisticsMetric,\r\n        rateMetric: rateMetric,\r\n        timestampMetric: timestampMetric,\r\n        timespanMetric: timespanMetric,\r\n        objectMetric: objectMetric,\r\n        addressMetric: addressMetric,\r\n        countMetric: countMetric,\r\n        numberMetric: numberMetric,\r\n        getAggregateState: getAggregateState,\r\n    };\r\n    _transport.createSystem(me);\r\n    return me;\r\n}\r\nexports.default = system;\r\n//# sourceMappingURL=system.js.map\n\n/***/ }),\n/* 113 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction default_1() {\r\n    function now() {\r\n        return new Date().getTime();\r\n    }\r\n    var startTime = now();\r\n    var endTime;\r\n    var period;\r\n    function stop() {\r\n        endTime = now();\r\n        period = now() - startTime;\r\n        return period;\r\n    }\r\n    return {\r\n        get startTime() {\r\n            return startTime;\r\n        },\r\n        get endTime() {\r\n            return endTime;\r\n        },\r\n        get period() {\r\n            return period;\r\n        },\r\n        stop: stop\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=timer.js.map\n\n/***/ }),\n/* 114 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"cluster\");\n\n/***/ }),\n/* 115 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"https\");\n\n/***/ }),\n/* 116 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"path\");\n\n/***/ }),\n/* 117 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"stream\");\n\n/***/ }),\n/* 118 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"tls\");\n\n/***/ }),\n/* 119 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"zlib\");\n\n/***/ })\n/******/ ]);\n});\n//# sourceMappingURL=tick42-glue-core.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/tick42-glue-core/dist/node/tick42-glue-core.js\n// module id = 48\n// module chunks = 0","var isFunction = function isFunction (arg) {return !!(arg && arg.constructor && arg.call && arg.apply);}\r\nvar nextTick = function nextTick (cb) { setTimeout(cb, 0); };\r\n\r\nmodule.exports = function (promise, successCallback, errorCallback) {\r\n    'use strict';\r\n    if (!isFunction(successCallback) && !isFunction(errorCallback)) {\r\n        return promise;\r\n    }\r\n\r\n    if (!isFunction(successCallback)) {\r\n        successCallback = function () {};\r\n    } else if (!isFunction(errorCallback)) {\r\n        errorCallback = function () {};        \r\n    }\r\n\r\n    promise.then(successCallback, errorCallback);\r\n}\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/tick42-promisify/main.js\n// module id = 49\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar promiseExtensions_1 = require(\"./../helpers/promiseExtensions\");\r\nvar activityManagementAPI_1 = require(\"./activityManagementAPI\");\r\nvar activityAGM_1 = require(\"../core/activityAGM\");\r\n/**\r\n * The entry points of activities API - accessible from glue.activities\r\n *\r\n * @module activities\r\n */\r\nvar ActivityAPI = /** @class */ (function () {\r\n    function ActivityAPI(manager, my) {\r\n        this._mgr = manager;\r\n        this._my = my;\r\n        this.all = new activityManagementAPI_1.ActivityManagementAPI(manager, my);\r\n    }\r\n    /**\r\n     * The entry point for your activity code.\r\n     *\r\n     * @function ready\r\n     * @returns {Promise<module:activities>} A promise for activity API\r\n     */\r\n    ActivityAPI.prototype.ready = function (callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            _this._mgr.ready()\r\n                .then(function () {\r\n                resolve(_this);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    Object.defineProperty(ActivityAPI.prototype, \"my\", {\r\n        /**\r\n         * A lightweight, single activity oriented subset of the API which should be used by most activity applications\r\n         *\r\n         * @var {module:my} my\r\n         */\r\n        get: function () {\r\n            return this._my;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityAPI.prototype, \"aware\", {\r\n        /**\r\n         * True if the current window is activity aware - meaning that the window has been created as\r\n         * an activity participant - either a helper or an independent window.\r\n         * Check this after the API is ready.\r\n         *\r\n         * @var {bool} aware\r\n         */\r\n        get: function () {\r\n            return this._my.window !== undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityAPI.prototype, \"inActivity\", {\r\n        /**\r\n         * Returns true if the current window is activity aware and is currently participating in activity\r\n         *\r\n         * @var {bool} inActivity\r\n         */\r\n        get: function () {\r\n            return this.aware && this._my.activity !== undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityAPI.prototype, \"agm\", {\r\n        /**\r\n         * Defines an Activity-specific version of the AGM API which:\r\n         * * restricts method registrations to activity-only windows\r\n         * * restricts method discovery and invocation to activity-only methods, unless you explicitly specify otherwise\r\n         * Other than that, the API is pretty much the same.\r\n         *\r\n         * @var  {module:activityAGM} agm\r\n         *\r\n         */\r\n        get: function () {\r\n            if (!this.aware) {\r\n                // no agm if not activity aware\r\n                return undefined;\r\n            }\r\n            if (!this.inActivity) {\r\n                // if we're not in activity no\r\n                return new activityAGM_1.ActivityAGM(null);\r\n            }\r\n            return this._my.activity.agm;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Returns a list of frame colors that can be used as activity frame colors\r\n     *\r\n     * @returns {string[]}\r\n     */\r\n    ActivityAPI.prototype.getAvailableFrameColors = function () {\r\n        var frameColors;\r\n        var hc = window.htmlContainer;\r\n        if (hc) {\r\n            frameColors = hc.getFrameColors();\r\n        }\r\n        frameColors = frameColors || [];\r\n        return frameColors;\r\n    };\r\n    return ActivityAPI;\r\n}());\r\nexports.ActivityAPI = ActivityAPI;\r\n//# sourceMappingURL=activityAPI.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/API/activityAPI.js\n// module id = 50\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar util = require(\"./../helpers/util\");\r\nvar ActivityManagementAPI = /** @class */ (function () {\r\n    function ActivityManagementAPI(manager, my) {\r\n        this._m = manager;\r\n        this._my = my;\r\n        this.activityTypes = {\r\n            get: this._getActivityTypesWrapper.bind(this),\r\n            register: this._m.registerActivityType.bind(this._m),\r\n            unregister: this._m.unregisterActivityType.bind(this._m),\r\n            subscribe: this._m.subscribeActivityTypeEvents.bind(this._m),\r\n            unsubscribe: undefined,\r\n            initiate: this._m.initiate.bind(this._m)\r\n        };\r\n        this.windowTypes = {\r\n            get: this._getWindowTypesWrapper.bind(this),\r\n            registerFactory: this._m.registerWindowFactory.bind(this._m),\r\n            unregisterFactory: this._m.unregisterWindowFactory.bind(this._m),\r\n            subscribe: this._m.subscribeWindowTypeEvents.bind(this._m),\r\n            unsubscribe: undefined\r\n        };\r\n        this.windows = {\r\n            get: this._m.getWindows.bind(this._m),\r\n            subscribe: this._m.subscribeWindowEvents.bind(this._m),\r\n            announce: this._m.announceWindow.bind(this._m),\r\n            unsubscribe: undefined,\r\n            create: this._m.createWindow.bind(this._m)\r\n        };\r\n        this.instances = {\r\n            get: this._m.getActivities.bind(this._m),\r\n            subscribe: this._m.subscribeActivityEvents.bind(this._m),\r\n            unsubscribe: undefined\r\n        };\r\n    }\r\n    ActivityManagementAPI.prototype.onAttached = function (callback) {\r\n        this._m.subscribeActivitiesAttached(callback);\r\n    };\r\n    ActivityManagementAPI.prototype.onDetached = function (callback) {\r\n        this._m.subscribeActivitiesDetached(callback);\r\n    };\r\n    ActivityManagementAPI.prototype.onActivityFrameColorChanged = function (callback) {\r\n        this._m.subscribeActivityFrameColorChanged(callback);\r\n    };\r\n    ActivityManagementAPI.prototype._getActivityTypesWrapper = function (name) {\r\n        if (util.isUndefined(name)) {\r\n            return this._m.getActivityTypes();\r\n        }\r\n        return this._m.getActivityType(name);\r\n    };\r\n    ActivityManagementAPI.prototype._getWindowTypesWrapper = function (name) {\r\n        if (util.isUndefined(name)) {\r\n            return this._m.getWindowTypes();\r\n        }\r\n        return this._m.getWindowType(name);\r\n    };\r\n    return ActivityManagementAPI;\r\n}());\r\nexports.ActivityManagementAPI = ActivityManagementAPI;\r\n//# sourceMappingURL=activityManagementAPI.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/API/activityManagementAPI.js\n// module id = 51\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar entityEvent_1 = require(\"./../contracts/entityEvent\");\r\nvar logger_1 = require(\"./../helpers/logger\");\r\nvar util = require(\"./../helpers/util\");\r\n/**\r\n * A lightweight, single activity oriented subset of the API which should be used by most activity applications.\r\n * Provides access to the activity of your application (my.activity) and shortcuts to the most commonly used methods\r\n * (e.g. my.createWindow is a shortcut for my.activity.createWindow)\r\n *\r\n * @module my\r\n */\r\nvar ActivityMy = /** @class */ (function () {\r\n    function ActivityMy(manager, windows) {\r\n        var _this = this;\r\n        this._myAttached = [];\r\n        this._myDetached = [];\r\n        this._myAttachedTo = [];\r\n        this._myDetachedFrom = [];\r\n        this._myActivityFrameColorChanged = [];\r\n        this._myActivityJoinedCallbacks = [];\r\n        this._myActivityRemovedCallbacks = [];\r\n        this._myContextUpdateCallbacks = [];\r\n        this._logger = logger_1.Logger.Get(this);\r\n        this._m = manager;\r\n        manager.ready()\r\n            .then(function (am) {\r\n            // Subscribe for events for driving \"my\" logic\r\n            am.subscribeActivityContextChanged(_this._subscribeMyContextChanged.bind(_this));\r\n            am.subscribeWindowEvents(_this._subscribeMyWindowEvent.bind(_this));\r\n            am.subscribeActivitiesAttached(_this._subscribeActivitiesAttached.bind(_this));\r\n            am.subscribeActivitiesDetached(_this._subscribeActivitiesDetached.bind(_this));\r\n            if (windows) {\r\n                windows.onWindowFrameColorChanged(_this._subscribeWindowFrameColorChanged.bind(_this));\r\n            }\r\n        });\r\n    }\r\n    Object.defineProperty(ActivityMy.prototype, \"window\", {\r\n        /**\r\n         * The current activity window; can be undefined (if the window is not part of any activity)\r\n         *\r\n         * @var {Window} window\r\n         */\r\n        get: function () {\r\n            if (util.isUndefinedOrNull(this._w)) {\r\n                var announcedWindows = this._m.announcedWindows;\r\n                if (announcedWindows.length > 0) {\r\n                    this._w = announcedWindows[0];\r\n                }\r\n            }\r\n            return this._w;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityMy.prototype, \"activity\", {\r\n        /**\r\n         * The current activity that the application participates in.\r\n         * Can be undefined (if currently not part of any activity)\r\n         *\r\n         * @var {module:activity} activity\r\n         */\r\n        get: function () {\r\n            var myWin = this.window;\r\n            if (util.isUndefinedOrNull(myWin)) {\r\n                return undefined;\r\n            }\r\n            return myWin.activity;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Creates a new window and joins it to the activity\r\n     *\r\n     * @function createWindow\r\n     * @param {string| windowDefinition} windowType The type of the window to be created\r\n     * @returns {Promise<module:activityWindow>}\r\n     */\r\n    ActivityMy.prototype.createWindow = function (windowType) {\r\n        return this._m.createWindow(this.activity, windowType);\r\n    };\r\n    /**\r\n     * Creates a stacked set of windows and joins them to the\r\n     *\r\n     * @function createStackedWindows\r\n     * @param {string[] | windowDefinition[]} windowTypes The types of the windows to be created\r\n     * @param {number} timeout\r\n     * @returns {Promise<module:activityWindow[]>}\r\n     */\r\n    ActivityMy.prototype.createStackedWindows = function (windowTypes, timeout) {\r\n        return this._m.createStackedWindows(this.activity, windowTypes, timeout);\r\n    };\r\n    Object.defineProperty(ActivityMy.prototype, \"context\", {\r\n        /**\r\n         * The current activity context. To update use my.updateContext, to replace my.setContext\r\n         *\r\n         * @var {object} context\r\n         */\r\n        get: function () {\r\n            var activity = this.activity;\r\n            if (util.isUndefined(activity)) {\r\n                return {};\r\n            }\r\n            return activity.context;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Updates activity context using the properties from the context argument.\r\n     * If old context is {a:1, b:2, c:3} and invoking updateContext({b:3, c:null}) will result a context\r\n     * be {a:1, b:3}\r\n     *\r\n     * @function updateContext\r\n     * @param {object} context\r\n     * @return {Promise<object>}\r\n     */\r\n    ActivityMy.prototype.updateContext = function (context, callback) {\r\n        var activity = this.activity;\r\n        if (util.isUndefined(activity)) {\r\n            return new Promise(function (resolve, reject) {\r\n                reject(\"Not in activity\");\r\n            });\r\n        }\r\n        return activity.updateContext(context, callback);\r\n    };\r\n    /**\r\n     * Replaces the activity context with a new one.\r\n     *\r\n     * @function setContext\r\n     * @param {object} context   The new context\r\n     * @returns {Promise<Object>}\r\n     */\r\n    ActivityMy.prototype.setContext = function (context, callback) {\r\n        var activity = this.activity;\r\n        if (util.isUndefined(activity)) {\r\n            return new Promise(function (resolve, reject) {\r\n                reject(\"Not in activity\");\r\n            });\r\n        }\r\n        return activity.setContext(context, callback);\r\n    };\r\n    ActivityMy.prototype.onActivityJoined = function (callback) {\r\n        this._myActivityJoinedCallbacks.push(callback);\r\n        // replay joined event\r\n        var myWin = this.window;\r\n        if (!util.isUndefinedOrNull(myWin) && !util.isUndefinedOrNull(myWin.activity)) {\r\n            callback(myWin.activity);\r\n        }\r\n    };\r\n    ActivityMy.prototype.onActivityLeft = function (callback) {\r\n        this._myActivityRemovedCallbacks.push(callback);\r\n    };\r\n    /**\r\n     * Subscribe for context updates\r\n     *\r\n     * @function onContextChanged\r\n     * @param {contextChangedHandler} callback Handler function that will receive context related events\r\n     */\r\n    ActivityMy.prototype.onContextChanged = function (callback) {\r\n        this._myContextUpdateCallbacks.push(callback);\r\n        // publish initial event\r\n        var myWin = this.window;\r\n        if (util.isUndefinedOrNull(myWin)) {\r\n            return;\r\n        }\r\n        var activity = myWin.activity;\r\n        if (util.isUndefinedOrNull(activity)) {\r\n            return;\r\n        }\r\n        // NB: either the callback is added before the activity is recorded in the API, or\r\n        // the activity is recorded before the callback\r\n        // in the former case, when the activity is seen, the callback will be invoked in _notifyMyContextChanged\r\n        // in the latter, the callback will be invoked here\r\n        // in both cases, the callback will be invoked at least once as soon as an activity is recorded\r\n        // see \"long analysis for callback behavior in GW3: several cases\" for full explanation\r\n        callback(activity.context, activity.context, [], activity);\r\n    };\r\n    ActivityMy.prototype.clone = function (options, callback) {\r\n        var act = this.activity;\r\n        return this._m.clone(act, options, callback);\r\n    };\r\n    ActivityMy.prototype.attach = function (activity, tag) {\r\n        var activityId;\r\n        if (typeof activity === \"string\") {\r\n            activityId = activity;\r\n        }\r\n        else {\r\n            activityId = activity.id;\r\n        }\r\n        return this._m.attachActivities(activityId, this.activity.id, tag);\r\n    };\r\n    ActivityMy.prototype.onActivityAttached = function (callback) {\r\n        this._myAttached.push(callback);\r\n    };\r\n    ActivityMy.prototype.onActivityDetached = function (callback) {\r\n        this._myDetached.push(callback);\r\n    };\r\n    ActivityMy.prototype.onAttachedToActivity = function (callback) {\r\n        this._myAttachedTo.push(callback);\r\n    };\r\n    ActivityMy.prototype.onDetachedFromActivity = function (callback) {\r\n        this._myDetachedFrom.push(callback);\r\n    };\r\n    Object.defineProperty(ActivityMy.prototype, \"attached\", {\r\n        get: function () {\r\n            if (!this.activity) {\r\n                return [];\r\n            }\r\n            return this.activity.attached;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ActivityMy.prototype.setFrameColor = function (color, callback) {\r\n        if (this.activity) {\r\n            return this.activity.setFrameColor(color, callback);\r\n        }\r\n        else {\r\n            return Promise.resolve(null);\r\n        }\r\n    };\r\n    ActivityMy.prototype.getFrameColor = function () {\r\n        if (this.activity) {\r\n            return this.activity.getFrameColor();\r\n        }\r\n        return \"\";\r\n    };\r\n    ActivityMy.prototype.onFrameColorChanged = function (callback) {\r\n        this._myActivityFrameColorChanged.push(callback);\r\n    };\r\n    ActivityMy.prototype._subscribeMyContextChanged = function (activity, context, delta, removed) {\r\n        var myWin = this.window;\r\n        if (util.isUndefinedOrNull(myWin)) {\r\n            return;\r\n        }\r\n        var myActivity = myWin.activity;\r\n        if (util.isUndefinedOrNull(myActivity)) {\r\n            return;\r\n        }\r\n        // ignore events not related to my activity\r\n        if (activity.id !== myActivity.id) {\r\n            return;\r\n        }\r\n        this._notifyMyContextChanged(activity, context, delta, removed);\r\n    };\r\n    ActivityMy.prototype._subscribeMyWindowEvent = function (activity, window, event) {\r\n        if (util.isUndefinedOrNull(this.window)) {\r\n            return;\r\n        }\r\n        // ignore events not related to my window\r\n        if (this.window.id !== window.id) {\r\n            return;\r\n        }\r\n        if (event === entityEvent_1.EntityEventType.ActivityWindowJoinedActivity) {\r\n            this._notifyMyWindowEvent(activity, this._myActivityJoinedCallbacks);\r\n            // NB: tick42-contexts doesn't raise automatically an update event on join if the snapshot matches\r\n            // the currently recorded data\r\n            // revisited: however, it is pushing an update on subscribe() (which is performed by js-activity)\r\n            // long analysis for callback behavior in GW3: several cases\r\n            // 1 client calls onContextChanged before joined-activity arrives\r\n            // then callback is pushed but onContextChanged callback call is skipped\r\n            //    1-1 js-activity handles joined-activity first; it calls js-context subscribe\r\n            //    1-1-1 js-context has not seen the activity so far so it doesn't invoke an update\r\n            //    however, js-context then handles joined-activity and raises an update\r\n            //    1-1-2 js-context has seen the activity, so it raises an update\r\n            //    js-context then handles joined-activity and doesn't raise a second update unless the received snapshot is\r\n            //    different from the last seen context value (can this even happen?)\r\n            //    1-2 js-context handles joined-activity first\r\n            //    since js-activity is not subscribed, whether it raises an update or not, it's not propagated\r\n            //    js-activity then handles joined-activity, performs a subscribe and js-context raises an update\r\n            // 2 joined-activity arrives, whatever updates are raised by js-activity's subscribe() or js-context's\r\n            // message handler are not propagated since the callback is not pushed, client then calls onContextChanged,\r\n            // and the callback is called inside that\r\n            // also, the callback cannot be invoked first in 1 then 2 or first 2 then 1\r\n            // => in all cases, a callback is called exactly once as soon as (it's subscribed && the activity is joined)\r\n            // (in 1-1-2 it *might* be possible to be called twice, first with a slightly out of date context,\r\n            // then with the joined-activity snapshot, see \"different from the last seen context value\", but it's unlikely,\r\n            // and not a real issue anyway)\r\n            // in the HC case, however, case 1 doesn't work since js-context doesn't raise updates on subscribe() nor\r\n            // joining the activity (#deleteme TODO LATER MINOR: verify), so we need to raise it ourselves\r\n            // 2017-09-08: final revisit (@vnikolov)\r\n            // since SBGW_D-163 allows automatic subscription to contexts of pre-existing activities, 1-1-2 no longer works\r\n            // (we might have already seen the latest state before joined-activity so no update will be raised)\r\n            // for this reason I'm invoking notifyMyContextChanged unconditionally - so we might have multiple\r\n            // invocations; if this turns into a problem we might add a guard inside notifyMyContextChanged that\r\n            // checks we're not raising it twice with the same context value\r\n            //\r\n            // we might also get a duplicate raise if the sender of an update is also subscribed to the context\r\n            // if (this._m.usingHc) {\r\n            this._notifyMyContextChanged(activity, activity.context, null, null);\r\n            // }\r\n            // #deleteme TODO LATER MAJOR: what about the cases when we're not watching foreign activity contexts?\r\n        }\r\n        else if (event === entityEvent_1.EntityEventType.ActivityWindowLeftActivity) {\r\n            this._notifyMyWindowEvent(activity, this._myActivityRemovedCallbacks);\r\n            // #deleteme TODO LATER MINOR: should we send null update here?\r\n        }\r\n    };\r\n    ActivityMy.prototype._notifyMyWindowEvent = function (activity, callbackStore) {\r\n        var _this = this;\r\n        callbackStore.forEach(function (element) {\r\n            try {\r\n                element(activity, event);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._notifyMyContextChanged = function (activity, context, delta, removed) {\r\n        var _this = this;\r\n        delta = delta || {};\r\n        removed = removed || [];\r\n        this._myContextUpdateCallbacks.forEach(function (element) {\r\n            try {\r\n                element(context, delta, removed, activity);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._notifyAttached = function (state) {\r\n        var _this = this;\r\n        this._myAttached.forEach(function (cb) {\r\n            try {\r\n                cb(state);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._notifyDetached = function (state) {\r\n        var _this = this;\r\n        this._myDetached.forEach(function (cb) {\r\n            try {\r\n                cb(state);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._notifyAttachedTo = function (state) {\r\n        var _this = this;\r\n        this._myAttachedTo.forEach(function (cb) {\r\n            try {\r\n                cb(_this.activity, state);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._notifyDetachedFrom = function (detached, existing, state) {\r\n        var _this = this;\r\n        this._myDetachedFrom.forEach(function (cb) {\r\n            try {\r\n                cb(detached, existing, state);\r\n            }\r\n            catch (e) {\r\n                _this._logger.warn(\"error in user callback \" + e);\r\n            }\r\n        });\r\n    };\r\n    ActivityMy.prototype._subscribeActivitiesAttached = function (newAct, state) {\r\n        var myWin = this.window;\r\n        if (util.isUndefinedOrNull(myWin)) {\r\n            return;\r\n        }\r\n        var myActivity = myWin.activity;\r\n        if (util.isUndefinedOrNull(myActivity)) {\r\n            return;\r\n        }\r\n        // ignore events not related to my activity\r\n        if (newAct.id !== myActivity.id) {\r\n            return;\r\n        }\r\n        if (state.windowIds.indexOf(myWin.id) >= 0) {\r\n            this._notifyAttachedTo(state);\r\n            return;\r\n        }\r\n        this._notifyAttached(state);\r\n    };\r\n    ActivityMy.prototype._subscribeActivitiesDetached = function (newAct, oldAct, state) {\r\n        var myWin = this.window;\r\n        if (util.isUndefinedOrNull(myWin)) {\r\n            return;\r\n        }\r\n        var myActivity = myWin.activity;\r\n        if (util.isUndefinedOrNull(myActivity)) {\r\n            return;\r\n        }\r\n        // ignore events not related to my activity\r\n        if (oldAct.id === myActivity.id) {\r\n            this._notifyDetached(state);\r\n        }\r\n        if (newAct.id === myActivity.id) {\r\n            this._notifyDetachedFrom(newAct, oldAct, state);\r\n        }\r\n    };\r\n    ActivityMy.prototype._subscribeWindowFrameColorChanged = function (window) {\r\n        var act = this.activity;\r\n        if (!act) {\r\n            return;\r\n        }\r\n        if (!act.owner) {\r\n            return;\r\n        }\r\n        if (act.owner.underlyingWindow.id === window.id) {\r\n            this._myActivityFrameColorChanged.forEach(function (callback) {\r\n                callback(window.frameColor);\r\n            });\r\n        }\r\n    };\r\n    return ActivityMy;\r\n}());\r\nexports.default = ActivityMy;\r\n//# sourceMappingURL=activityMyAPI.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/API/activityMyAPI.js\n// module id = 52\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gw3Bridge_1 = require(\"./bridges/gw3Bridge\");\r\nvar hcBridge_1 = require(\"./bridges/hcBridge\");\r\nvar activityMyAPI_1 = require(\"./API/activityMyAPI\");\r\nvar activityManager_1 = require(\"./core/activityManager\");\r\nvar activityAPI_1 = require(\"./API/activityAPI\");\r\nvar activityAGM_1 = require(\"./core/activityAGM\");\r\nvar logger_1 = require(\"./helpers/logger\");\r\nvar util = require(\"./helpers/util\");\r\nvar promiseExtensions_1 = require(\"./helpers/promiseExtensions\");\r\n/**\r\n * Activity context update handler - used when we want to subscribe for context changes in a specific activity\r\n *\r\n * @callback contextChangedHandler\r\n * @param {Object} context The full context of the activity after the update\r\n * @param {Object} delta The delta (contains the added/removed keys at top level)\r\n * @param {string[]} removed  Array of keys that were removed from context\r\n * @param {module:activity} activity The activity instance that owns the context\r\n *\r\n */\r\n/**\r\n * @callback windowEventHandler Handler for ActivityWindow events - e.g window joined to activity, window removed from\r\n * activity\r\n * @param {module:activity} activity\r\n * @param {module:activityWindow} window\r\n * @param {string} event 'joined' or 'removed'\r\n */\r\n/**\r\n * @callback activityStatusChangeHandler Handler for activity status changed events\r\n * @param {module:activity} activity\r\n * @param {activityStatus} newStatus\r\n * @param {activityStatus} oldStatus\r\n *\r\n */\r\n/**\r\n * @typedef {Object} windowDefinition\r\n * @property {string} type\r\n * @property {string} name\r\n * @property {Object} arguments\r\n */\r\n/**\r\n * @typedef {Object} bounds\r\n * @param {number} top\r\n * @param {number} left\r\n * @param {number} width\r\n * @param {number} height\r\n *\r\n */\r\n/**\r\n * @typedef {Object} agmInstance\r\n * @param {string} application\r\n * @param {string} pid\r\n * @param {string} machine\r\n * @param {string} user\r\n * @param {string} environment\r\n * @param {string} region\r\n */\r\n// Factory function for activity API\r\nvar ActivityModule = /** @class */ (function () {\r\n    function ActivityModule(config) {\r\n        var _this = this;\r\n        if (!config) {\r\n            throw new Error(\"config can not be null\");\r\n        }\r\n        // set log level\r\n        if (!util.isUndefined(config.logLevel)) {\r\n            logger_1.Logger.Level = config.logLevel;\r\n        }\r\n        if (!util.isUndefinedOrNull(config.logger)) {\r\n            logger_1.Logger.GlueLogger = config.logger;\r\n        }\r\n        // choose the correct bridge\r\n        var bridge;\r\n        this._isUsingHCImplementation = config.gdMajorVersion === 2;\r\n        this._isUsingGW3Implementation = ActivityModule.checkIsUsingGW3Implementation(config.connection);\r\n        if (this._isUsingHCImplementation) {\r\n            bridge = new hcBridge_1.default(undefined, config.windows, config.appManagerGetter, config.mode, config.typesToTrack);\r\n        }\r\n        else if (this._isUsingGW3Implementation) {\r\n            bridge = new gw3Bridge_1.default(config.connection, config.logger, config.contexts, config);\r\n        }\r\n        else {\r\n            throw new Error(\"Unable to instantiate activity bridge implementation\");\r\n        }\r\n        if (!bridge) {\r\n            throw new Error(\"A bridge to native activity is needed to create activity lib.\");\r\n        }\r\n        activityAGM_1.ActivityAGM.AGM = config.agm;\r\n        var activityManager = new activityManager_1.default(bridge, !config.disableAutoAnnounce, config.windows);\r\n        var my = new activityMyAPI_1.default(activityManager, config.windows);\r\n        this._api = new activityAPI_1.ActivityAPI(activityManager, my);\r\n        this._readyPromise = activityManager.ready().then(function (_) { return _this; });\r\n    }\r\n    ActivityModule.checkIsUsingGW3Implementation = function (connection) {\r\n        return connection.protocolVersion === 3;\r\n    };\r\n    Object.defineProperty(ActivityModule.prototype, \"api\", {\r\n        get: function () {\r\n            return this._api;\r\n        },\r\n        set: function (value) {\r\n            this._api = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityModule.prototype, \"isUsingHCImplementation\", {\r\n        get: function () {\r\n            return this._isUsingHCImplementation;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityModule.prototype, \"isUsingGW3Implementation\", {\r\n        get: function () {\r\n            return this._isUsingGW3Implementation;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ActivityModule.prototype.ready = function (callback) {\r\n        return promiseExtensions_1.nodeify(this._readyPromise, callback);\r\n    };\r\n    return ActivityModule;\r\n}());\r\nexports.ActivityModule = ActivityModule;\r\n//# sourceMappingURL=activityModule.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/activityModule.js\n// module id = 53\n// module chunks = 0","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityType_1 = require(\"../entities/activityType\");\r\nvar windowType_1 = require(\"../entities/windowType\");\r\nvar entityEvent_1 = require(\"../contracts/entityEvent\");\r\nvar activity_1 = require(\"../entities/activity\");\r\nvar activityWindow_1 = require(\"../entities/activityWindow\");\r\nvar activityStatus_1 = require(\"../contracts/activityStatus\");\r\nvar gwMessageSuccess = \"success\";\r\nvar gwMmessageError = \"error\";\r\nvar gwMessageAddActivityTypes = \"add-types\";\r\nvar gwMmessageActivityTypesAdded = \"types-added\";\r\nvar gwMessageRemoveActivityTypes = \"remove-types\";\r\nvar gwMessageActivityTypesRemoved = \"types-removed\";\r\nvar gwMessageActivityCreated = \"created\";\r\nvar gwMessageActivityDestroyed = \"destroyed\";\r\nvar gwMessageActivityInitiated = \"initiated\";\r\nvar gwMmessageJoinActivity = \"join-activity\";\r\nvar gwMessageJoinedActivity = \"joined\";\r\nvar gwMessageActivityJoined = \"activity-joined\";\r\nvar gwMessageLeaveActivity = \"leave-activity\";\r\nvar gwMessageActivityLeft = \"left\";\r\nvar gwNmessageMergeActivities = \"merge\";\r\nvar gwMessageSplitActivities = \"split\";\r\nvar gwMessageChildrenChanged = \"children-changed\";\r\nvar gwMessageAddPeerFactories = \"add-peer-factories\";\r\nvar gwMessagePeerFactoriesAdded = \"peer-factories-added\";\r\nvar gwMessageRemovePeerFactories = \"remove-peer-factories\";\r\nvar gwMessagePeerFactoriesRemoved = \"peer-factories-removed\";\r\nvar gwMessageCreateActivity = \"create\";\r\nvar gwMessageCreatePeer = \"create-peer\";\r\nvar gwMessagePeerRequested = \"peer-requested\";\r\nvar gwMessageReady = \"ready\";\r\nvar gwMessagePeerCreated = \"peer-created\";\r\nvar gwMessageDestroyActivity = \"destroy\";\r\nvar gwMessageDisposePeer = \"dispose-peer\";\r\nvar GW3Bridge = /** @class */ (function () {\r\n    function GW3Bridge(connection, logger, contexts, config) {\r\n        var _this = this;\r\n        // callbacks\r\n        this._activityChangeCallbacks = [];\r\n        this._activityTypeStatusChangeCallbacks = [];\r\n        this._activityWindowChangeCallbacks = [];\r\n        this._windowTypeStatusChangeCallbacks = [];\r\n        // state tracking\r\n        this._peerIdAndFactoryIdToPeerType = {};\r\n        this._peerFactoriesRegisteredByUs = {};\r\n        this._gw3Subscriptions = [];\r\n        this._contextSubscriptions = {};\r\n        this._activityTypesInitiatedFromMe = {};\r\n        this._config = config;\r\n        this._connection = connection;\r\n        this._logger = logger;\r\n        this._contexts = contexts;\r\n        this._sessionJoinedPromise = new Promise(function (resolve /*, reject */) {\r\n            _this._sessionJoinedPromiseResolve = resolve;\r\n        });\r\n        this._activityJoinedPromise = new Promise(function (resolve /*, reject */) {\r\n            _this._activityJoinedPromiseResolve = resolve;\r\n        });\r\n        if (!this._config.activityId) {\r\n            this._activityJoinedPromiseResolve({});\r\n        }\r\n        this._gw3Session = connection.domain(\"activity\", logger.subLogger(\"session:com.tick42.activity\"), [\"joined\", \"initiated\", \"peer-created\"]);\r\n    }\r\n    GW3Bridge.activityTypeGwMessageEntityToActivityType = function (entity, description) {\r\n        var nameToWindowType = function (windowName) {\r\n            return new windowType_1.default(windowName, undefined);\r\n        };\r\n        return new activityType_1.default(entity.name, entity.owner_type && nameToWindowType(entity.owner_type), entity.helper_types && entity.helper_types.map(nameToWindowType), description);\r\n    };\r\n    GW3Bridge.peerFactoryGwMessageEntityToWindowType = function (entity) {\r\n        return new windowType_1.default(entity.peer_type, \r\n        /* #deleteme TODO: review - appmanager configuration? */ function (_) { return undefined; });\r\n    };\r\n    GW3Bridge.activityGwMessageToActivity = function (msg, status) {\r\n        var ownerId = msg.owner !== undefined ? msg.owner.peer_id : undefined;\r\n        return new activity_1.default(msg.activity_id, msg.activity_type, status, msg.context_snapshot, ownerId);\r\n    };\r\n    GW3Bridge.activityToActivityStatusChangeEvent = function (act) {\r\n        return new entityEvent_1.EntityEvent(act, new entityEvent_1.ActivityStatusChangeEventContext(act.status, undefined));\r\n    };\r\n    Object.defineProperty(GW3Bridge.prototype, \"bridgeType\", {\r\n        get: function () {\r\n            return \"GW3\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    GW3Bridge.prototype.init = function () {\r\n        var _this = this;\r\n        // activity types\r\n        this.forwardActivityTypeMessagesToStatusEventHandlers();\r\n        // activities\r\n        this.subscribe(gwMessageActivityCreated, this.handleActivityCreatedMessage);\r\n        this.subscribe(gwMessageActivityDestroyed, this.handleActivityDestroyedMessage);\r\n        this.forwardActivityMessagesToStatusEventHandlers();\r\n        this.forwardActivityCreatedAndJoinedActivityToActivityWindowEventHandlers();\r\n        // window types / peer factories\r\n        // NB: this forward must happen before the handlePeerFactoriesRemoved subscription\r\n        // since the latter clears state which is used by peerFactoryIdAndOwnerIdToWindowType\r\n        this.forwardPeerFactoryMessagesToStatusEventHandlers();\r\n        this.forwardPeerFactoryMessagesToPeerFactoryRequests();\r\n        this.subscribe(gwMessagePeerFactoriesAdded, this.handlePeerFactoriesAdded);\r\n        this.subscribe(gwMessagePeerFactoriesRemoved, this.handlePeerFactoriesRemoved);\r\n        // activity windows\r\n        this.forwardActivityWindowMessagesToEventHandlers();\r\n        //\r\n        this.subscribe(gwMessageDisposePeer, \r\n        /*(msg)*/ function () {\r\n            if (_this._config.disposeRequestHandling === \"dispose\") {\r\n                _this.dispose();\r\n                return;\r\n            }\r\n            // #deleteme TODO: review - maybe leave activity before dying?\r\n            if (_this._config.disposeRequestHandling === \"exit\") {\r\n                if (typeof window !== \"undefined\" &&\r\n                    typeof window.close === \"function\") {\r\n                    window.close();\r\n                    return;\r\n                }\r\n                if (typeof process !== \"undefined\" &&\r\n                    typeof process.exit === \"function\") {\r\n                    process.exit();\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n        // #deleteme TODO: logging\r\n        // start domain join handshake\r\n        this._gw3Session.onJoined(function () {\r\n            if (_this._config.mode === \"trackMyOnly\" ||\r\n                _this._config.mode === \"trackMyTypeAndInitiatedFromMe\") {\r\n                _this._sessionJoinedPromiseResolve(_this);\r\n            }\r\n            else {\r\n                _this._gw3Session\r\n                    .send({\r\n                    type: \"subscribe\",\r\n                    activity_types: (_this._config.mode === \"trackAll\" ? [] :\r\n                        _this._config.mode === \"trackTypes\" ? _this._config.typesToTrack : [])\r\n                })\r\n                    .then(function () {\r\n                    _this._sessionJoinedPromiseResolve(_this);\r\n                });\r\n            }\r\n        });\r\n        this._gw3Session.join();\r\n    };\r\n    GW3Bridge.prototype.dispose = function () {\r\n        var _this = this;\r\n        this._gw3Subscriptions.forEach(function (sub) { return sub && _this._connection.off(sub); });\r\n        this._gw3Subscriptions.length = 0;\r\n        // #deleteme todo review\r\n        // this._contexts.dispose();\r\n    };\r\n    // ActivityBridge interface\r\n    GW3Bridge.prototype.ready = function () {\r\n        return Promise.all([this._sessionJoinedPromise, this._activityJoinedPromise]);\r\n    };\r\n    GW3Bridge.prototype.initReady = function () {\r\n        return this._sessionJoinedPromise;\r\n    };\r\n    GW3Bridge.prototype.onActivityTypeStatusChange = function (callback) {\r\n        this._activityTypeStatusChangeCallbacks.push(callback);\r\n    };\r\n    GW3Bridge.prototype.registerActivityType = function (activityTypeName, ownerWindow, helperWindows, config, description) {\r\n        var _this = this;\r\n        var entity = {};\r\n        entity.name = activityTypeName;\r\n        var toActivityPeerConfig = function (windowDefinition) { return ({ type: windowDefinition.type, name: windowDefinition.name, configuration: windowDefinition }); };\r\n        entity.owner_type = toActivityPeerConfig(ownerWindow);\r\n        entity.helper_types = helperWindows.map(toActivityPeerConfig);\r\n        return this._gw3Session\r\n            .send({\r\n            type: gwMessageAddActivityTypes,\r\n            types: [entity]\r\n        })\r\n            .then(function () {\r\n            var activityType = GW3Bridge.activityTypeGwMessageEntityToActivityType(entity, description);\r\n            _this.invokeCallbacks(_this._activityTypeStatusChangeCallbacks, new entityEvent_1.EntityEvent(activityType, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added)), gwMessageAddActivityTypes);\r\n            return activityType;\r\n        });\r\n    };\r\n    GW3Bridge.prototype.unregisterActivityType = function (activityTypeName) {\r\n        var _this = this;\r\n        return this._gw3Session\r\n            .send({\r\n            type: gwMessageRemoveActivityTypes,\r\n            types: [activityTypeName]\r\n        })\r\n            .then(function () {\r\n            var activityType = new activityType_1.default(activityTypeName, undefined, undefined, undefined);\r\n            _this.invokeCallbacks(_this._activityTypeStatusChangeCallbacks, new entityEvent_1.EntityEvent(activityType, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Removed)), gwMessageAddActivityTypes);\r\n        });\r\n    };\r\n    GW3Bridge.prototype.onWindowTypeStatusChange = function (callback) {\r\n        this._windowTypeStatusChangeCallbacks.push(callback);\r\n    };\r\n    // NB: in GW3, peer factories have ids separate from the ids of the peers they create\r\n    // in this implementation we keep the two equal for simplicity\r\n    // NB: we assume only one peer will register a peer factory for a given type; otherwise the\r\n    // add/remove window types event logic will get messy\r\n    GW3Bridge.prototype.registerWindowFactory = function (windowType, factory, parameters) {\r\n        var _this = this;\r\n        if (this._peerFactoriesRegisteredByUs[windowType]) {\r\n            return Promise.reject(new Error(\"Factory for windowType \" + windowType + \" already registered.\"));\r\n        }\r\n        this._peerFactoriesRegisteredByUs[windowType] = factory;\r\n        // #deleteme TODO: review success/failure code paths\r\n        // #deleteme TODO: review - should we create the window type here?\r\n        var entity = {\r\n            id: windowType,\r\n            peer_type: windowType,\r\n            configuration: parameters\r\n        };\r\n        return this._gw3Session.send({\r\n            type: gwMessageAddPeerFactories,\r\n            factories: [entity]\r\n        })\r\n            .then(function () {\r\n            _this.invokeCallbacks(_this._windowTypeStatusChangeCallbacks, new entityEvent_1.EntityEvent(GW3Bridge.peerFactoryGwMessageEntityToWindowType(entity), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added)), gwMessageAddPeerFactories);\r\n        })\r\n            .catch(function () {\r\n            delete _this._peerFactoriesRegisteredByUs[windowType];\r\n        });\r\n    };\r\n    GW3Bridge.prototype.unregisterWindowFactory = function (windowType) {\r\n        var _this = this;\r\n        var factory = this._peerFactoriesRegisteredByUs[windowType];\r\n        if (!factory) {\r\n            return Promise.reject(new Error(\"Factory for windowType \" + windowType + \" not registered.\"));\r\n        }\r\n        delete this._peerFactoriesRegisteredByUs[windowType];\r\n        return this._gw3Session.send({\r\n            type: gwMessageRemovePeerFactories,\r\n            factory_ids: [windowType]\r\n        }).then(function () {\r\n            _this.invokeCallbacks(_this._windowTypeStatusChangeCallbacks, new entityEvent_1.EntityEvent(new windowType_1.default(windowType, undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Removed)), gwMessageAddPeerFactories);\r\n        });\r\n    };\r\n    GW3Bridge.prototype.onActivityStatusChange = function (callback) {\r\n        this._activityChangeCallbacks.push(callback);\r\n    };\r\n    GW3Bridge.prototype.initiateActivity = function (activityType, context, configuration) {\r\n        var _this = this;\r\n        var initiateMsg = {\r\n            type: gwMessageCreateActivity,\r\n            activity_type: activityType,\r\n            initial_context: context,\r\n        };\r\n        if (this.isOverrideTypeDefinition(configuration)) {\r\n            initiateMsg.types_override = {\r\n                owner_type: { type: configuration.owner.type, name: configuration.owner.name, configuration: configuration.owner },\r\n                helper_types: configuration.helpers && configuration.helpers.map(function (wd) { return ({ type: wd.type, name: wd.name, configuration: wd }); })\r\n            };\r\n        }\r\n        else {\r\n            initiateMsg.configuration = configuration && configuration.map(function (wd) { return ({ type: wd.type, name: wd.name, configuration: wd }); });\r\n        }\r\n        return this.sendCreateAndMapResultingMessagesToPromise(initiateMsg, gwMessageActivityInitiated, function (msg, requestId) { return msg.request_id === requestId; }, gwMessageActivityCreated, function (msg, requestId, initMsg) { return msg.activity_id === initMsg.activity_id; }, gwMessageActivityDestroyed, function (msg, requestId, initMsg) { return msg.activity_id === initMsg.activity_id; }, function (msg) { return msg.activity_id; }).then(function (id) {\r\n            if (_this._config.mode === \"trackMyTypeAndInitiatedFromMe\") {\r\n                if (!_this._activityTypesInitiatedFromMe[activityType]) {\r\n                    _this._activityTypesInitiatedFromMe[activityType] = true;\r\n                    return _this._gw3Session\r\n                        .send({\r\n                        type: \"subscribe\",\r\n                        activity_types: [activityType]\r\n                    })\r\n                        .then(function () {\r\n                        return id;\r\n                    });\r\n                }\r\n            }\r\n            return id;\r\n        });\r\n    };\r\n    GW3Bridge.prototype.stopActivity = function (activity) {\r\n        return this._gw3Session.send({\r\n            type: gwMessageDestroyActivity,\r\n            activity_id: activity.id,\r\n            // #deleteme TODO: review - reason?\r\n            reason_uri: \"com.tick42.glue.activity.constants.destroyReason.general\",\r\n            reason: \"Destroying activity\"\r\n        }).then(function (_) { return true; });\r\n    };\r\n    GW3Bridge.prototype.updateActivityContext = function (activity, context, fullReplace, removedKeys) {\r\n        if (fullReplace) {\r\n            // this will currently fail on GW3\r\n            return this._contexts.set(activity.id, context);\r\n        }\r\n        else {\r\n            removedKeys = removedKeys || [];\r\n            for (var _i = 0, removedKeys_1 = removedKeys; _i < removedKeys_1.length; _i++) {\r\n                var x = removedKeys_1[_i];\r\n                context[x] = null;\r\n            }\r\n            return this._contexts.update(activity.id, context);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.announceWindow = function (windowType, activityWindowId) {\r\n        // in the GW3 case we are only joined to an activity after we announce ourselves\r\n        // so all announcement calls should go in 'registerWindow', not here\r\n        // (registerWindow registers a window that's not part of an activity, at least yet)\r\n        throw new Error(\"Invalid operation 'announceWindow' for GW3 protocol\");\r\n    };\r\n    GW3Bridge.prototype.registerWindow = function (type, name, independent) {\r\n        var shouldSendReady = this._connection.gatewayToken;\r\n        var peerId = this._connection.peerId;\r\n        // if running in GD3 (glue42gd is there) we should send ready only if we have the activityInfo object in glue\r\n        if (typeof window !== \"undefined\") {\r\n            var glue42gd = window.glue42gd;\r\n            if (glue42gd) {\r\n                shouldSendReady = glue42gd.activityInfo !== undefined;\r\n            }\r\n        }\r\n        if (shouldSendReady) {\r\n            this._gw3Session.send({\r\n                type: gwMessageReady,\r\n            });\r\n        }\r\n        this.invokeCallbacks(this._activityWindowChangeCallbacks, new entityEvent_1.EntityEvent(new activityWindow_1.default(peerId, name, type, undefined, undefined, independent, this.generateWindowGetter(peerId), undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added)), \"register window\");\r\n        return Promise.resolve(peerId);\r\n    };\r\n    GW3Bridge.prototype.onActivityWindowChange = function (callback) {\r\n        this._activityWindowChangeCallbacks.push(callback);\r\n    };\r\n    GW3Bridge.prototype.createWindow = function (activityId, windowDefinition) {\r\n        var _this = this;\r\n        // if the user hasn't provided a layout option but has some of left,top,width,height\r\n        // insert a layout\r\n        if (!windowDefinition.layout) {\r\n            if (windowDefinition.left || windowDefinition.width || windowDefinition.height || windowDefinition.top) {\r\n                windowDefinition.layout = {\r\n                    mode: \"pixels\",\r\n                    cellSize: 1,\r\n                };\r\n            }\r\n        }\r\n        return this.sendCreateAndMapResultingMessagesToPromise({\r\n            type: gwMessageCreatePeer,\r\n            peer_type: windowDefinition.type,\r\n            configuration: windowDefinition,\r\n            activity_id: activityId,\r\n        }, undefined, undefined, gwMessagePeerCreated, function (msg, requestId) { return msg.request_id === requestId; }, undefined, undefined, function (msg) { return msg.created_id; })\r\n            .then(function (id) {\r\n            return _this.joinActivity(activityId, id)\r\n                .then(function () {\r\n                return id;\r\n            });\r\n        });\r\n    };\r\n    GW3Bridge.prototype.closeWindow = function (id) {\r\n        return this._gw3Session.send({\r\n            destroy_peer_id: id\r\n        }).then(function (_) { return undefined; });\r\n    };\r\n    GW3Bridge.prototype.getAnnouncementInfo = function () {\r\n        var activityId = this._config.activityId || (this._config.announcementInfo && this._config.announcementInfo.activityId);\r\n        var activityWindowType = (this._config.announcementInfo && this._config.announcementInfo.activityWindowType);\r\n        var activityWindowIndependent = (this._config.announcementInfo && this._config.announcementInfo.activityWindowIndependent);\r\n        var activityWindowName = (this._config.announcementInfo && this._config.announcementInfo.activityWindowName);\r\n        if (typeof window !== \"undefined\" &&\r\n            typeof window.location !== \"undefined\" &&\r\n            window.location.search &&\r\n            typeof URLSearchParams === \"function\") {\r\n            var searchParams = new URLSearchParams(location.search.slice(1));\r\n            activityWindowType = activityWindowType || searchParams.get(\"t42PeerType\");\r\n            activityWindowType = activityWindowType || searchParams.get(\"t42ActivityWindowType\");\r\n            if (typeof activityWindowIndependent === \"undefined\") {\r\n                activityWindowIndependent = searchParams.get(\"t42ActivityWindowIndependent\");\r\n            }\r\n            activityWindowName = activityWindowName || searchParams.get(\"t42ActivityWindowName\");\r\n            activityId = activityId || searchParams.get(\"t42ActivityId\");\r\n        }\r\n        activityWindowType = activityWindowType || \"unknown\";\r\n        activityWindowIndependent = activityWindowIndependent || false;\r\n        activityWindowName = activityWindowName || this._connection.peerId;\r\n        return {\r\n            activityWindowId: undefined,\r\n            activityId: activityId,\r\n            activityWindowType: activityWindowType,\r\n            activityWindowIndependent: activityWindowIndependent,\r\n            activityWindowName: activityWindowName,\r\n        };\r\n    };\r\n    GW3Bridge.prototype.joinActivity = function (activityId, windowId) {\r\n        var _this = this;\r\n        return this._gw3Session.send({\r\n            type: gwMmessageJoinActivity,\r\n            target_id: windowId,\r\n            activity_id: activityId\r\n        }).then(function () {\r\n            _this.invokeCallbacks(_this._activityWindowChangeCallbacks, new entityEvent_1.EntityEvent(new activityWindow_1.default(windowId, undefined, undefined, activityId, undefined, undefined, _this.generateWindowGetter(windowId), undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowJoinedActivity)), \"activity joined - ActivityWindow\");\r\n            _this.invokeCallbacks(_this._activityChangeCallbacks, new entityEvent_1.EntityEvent(new activity_1.default(activityId, undefined, new activityStatus_1.ActivityStatus(\"created\", undefined, undefined), undefined, undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Updated)), \"activity joined - Activity\");\r\n        });\r\n    };\r\n    GW3Bridge.prototype.leaveActivity = function (activityId, windowId) {\r\n        var _this = this;\r\n        return this._gw3Session.send({\r\n            type: gwMessageLeaveActivity,\r\n            target_id: windowId,\r\n            activity_id: activityId\r\n        }).then(function () {\r\n            _this.invokeCallbacks(_this._activityWindowChangeCallbacks, new entityEvent_1.EntityEvent(new activityWindow_1.default(windowId, undefined, undefined, null, undefined, undefined, _this.generateWindowGetter(windowId), undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowLeftActivity)), \"activity left - ActivityWindow\");\r\n            _this.invokeCallbacks(_this._activityChangeCallbacks, new entityEvent_1.EntityEvent(new activity_1.default(activityId, undefined, new activityStatus_1.ActivityStatus(\"created\", undefined, undefined), undefined, undefined), new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Updated)), \"activity left - Activity\");\r\n        });\r\n    };\r\n    // purposefully returning empty arrays\r\n    GW3Bridge.prototype.getActivityTypes = function () {\r\n        return Promise.resolve([]);\r\n    };\r\n    GW3Bridge.prototype.getWindowTypes = function () {\r\n        return Promise.resolve([]);\r\n    };\r\n    GW3Bridge.prototype.getActivities = function () {\r\n        return Promise.resolve([]);\r\n    };\r\n    GW3Bridge.prototype.getActivityWindows = function () {\r\n        return Promise.resolve([]);\r\n    };\r\n    // N/A\r\n    // #deleteme TODO: ignore for now\r\n    // POSTPONED\r\n    GW3Bridge.prototype.createStackedWindows = function (id, windowDefinitions, timeout) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.getWindowBounds = function (id) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.setWindowBounds = function (id, bounds) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.activateWindow = function (id, focus) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.setWindowVisibility = function (id, visible) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.cloneActivity = function (id, cloneOptions) {\r\n        return undefined;\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.attachActivities = function (from, to, tag) {\r\n        return this._gw3Session.send({\r\n            type: gwNmessageMergeActivities,\r\n            into: to,\r\n            merge: from\r\n        });\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.detachActivities = function (activityId, newActivityInfo) {\r\n        return this._gw3Session.send({\r\n            type: gwMessageSplitActivities,\r\n            from: activityId,\r\n        }).then(function () { return \"\"; });\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.onActivitiesAttached = function (callback) {\r\n        // POSTPONED\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.onActivitiesDetached = function (callback) {\r\n        // POSTPONED\r\n    };\r\n    GW3Bridge.prototype.onActivityAttachedDescriptorsRefreshed = function (callback) {\r\n        // POSTPONED\r\n    };\r\n    // POSTPONED\r\n    GW3Bridge.prototype.getAttachedDescriptors = function () {\r\n        return Promise.resolve([]);\r\n    };\r\n    // helpers\r\n    // Protocol handling\r\n    GW3Bridge.prototype.getRandomRequestId = function () {\r\n        return this._connection.peerId + \":\" + Math.floor(Math.random() * 1e9) + \"\";\r\n    };\r\n    GW3Bridge.prototype.forwardAddedAndRemovedMessagesToEventHandler = function (addedMessageType, removedMessageType, mapper, handlers) {\r\n        var getGetEntityEvent = function (isAdded) { return function (entity) { return new entityEvent_1.EntityEvent(entity, new entityEvent_1.EntityEventContext(isAdded ?\r\n            entityEvent_1.EntityEventType.Added :\r\n            entityEvent_1.EntityEventType.Removed)); }; };\r\n        var sub1;\r\n        var sub2;\r\n        sub1 = addedMessageType && this.forwardMessageToEventHandler(addedMessageType, function (msg) { return mapper(msg, true); }, getGetEntityEvent(true), handlers);\r\n        sub2 = removedMessageType && this.forwardMessageToEventHandler(removedMessageType, function (msg) { return mapper(msg, false); }, getGetEntityEvent(false), handlers);\r\n        return [sub1, sub2].filter(function (x) { return x; });\r\n    };\r\n    GW3Bridge.prototype.forwardMessageToEventHandler = function (messageType, mapper, getEntityEvent, handler) {\r\n        return this.subscribe(messageType, function (msg) {\r\n            mapper(msg)\r\n                .forEach(function (ent) {\r\n                return handler.forEach(function (h) { return h(getEntityEvent(ent, msg)); });\r\n            });\r\n        });\r\n    };\r\n    GW3Bridge.prototype.sendCreateAndMapResultingMessagesToPromise = function (msg, initiatedMessageType, initiatedMessageFilter, createdMessageType, createdMessageFilter, cancelledMessageType, cancelledMessageFilter, createdMessageToPromiseResolution) {\r\n        var _this = this;\r\n        var reqId = this.getRandomRequestId();\r\n        var resolveCreatedPromise;\r\n        var rejectCreatedPromise;\r\n        var createdPromise = new Promise(function (resolve, reject) {\r\n            resolveCreatedPromise = resolve;\r\n            rejectCreatedPromise = reject;\r\n        });\r\n        var initiatedMessageAck = null;\r\n        var initiatedSubscription;\r\n        var createdSubscription;\r\n        var cancelledSubscription;\r\n        var errorSubscription;\r\n        var dropSubscriptions = function () {\r\n            _this.dropSubscription(initiatedSubscription);\r\n            _this.dropSubscription(createdSubscription);\r\n            _this.dropSubscription(cancelledSubscription);\r\n            _this.dropSubscription(errorSubscription);\r\n        };\r\n        initiatedSubscription = initiatedMessageType &&\r\n            this.subscribe(initiatedMessageType, function (msg4) {\r\n                if (!initiatedMessageFilter(msg4, reqId)) {\r\n                    return;\r\n                }\r\n                initiatedMessageAck = msg4;\r\n                _this.dropSubscription(initiatedSubscription);\r\n            });\r\n        createdSubscription =\r\n            this.subscribe(createdMessageType, function (msg1) {\r\n                if (!createdMessageFilter(msg1, reqId, initiatedMessageAck)) {\r\n                    return;\r\n                }\r\n                resolveCreatedPromise(createdMessageToPromiseResolution(msg1));\r\n            });\r\n        cancelledSubscription = cancelledMessageType &&\r\n            this.subscribe(cancelledMessageType, function (msg2) {\r\n                if (!cancelledMessageFilter(msg2, reqId, initiatedMessageAck)) {\r\n                    return;\r\n                }\r\n                rejectCreatedPromise(msg2);\r\n            });\r\n        errorSubscription = cancelledMessageType &&\r\n            this.subscribe(gwMmessageError, function (msg3) {\r\n                if (msg3.request_id !== reqId) {\r\n                    return;\r\n                }\r\n                rejectCreatedPromise(msg3);\r\n            });\r\n        msg.request_id = reqId;\r\n        var toReturn = this._gw3Session\r\n            .send(msg)\r\n            .then(function () {\r\n            return createdPromise;\r\n        });\r\n        toReturn.then(dropSubscriptions, dropSubscriptions);\r\n        return toReturn;\r\n    };\r\n    // Entity Mapping\r\n    GW3Bridge.prototype.peerFactoryIdAndOwnerIdToWindowType = function (factoryId, ownerId) {\r\n        var peerType = this._peerIdAndFactoryIdToPeerType[ownerId + \":\" + factoryId];\r\n        if (!peerType) {\r\n            return null;\r\n        }\r\n        else {\r\n            return new windowType_1.default(peerType, undefined);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribe = function (messageType, handler) {\r\n        var _this = this;\r\n        var sub = this._connection.on(\r\n        // #deleteme TODO: review first arg\r\n        \"js-activity\", messageType, function (msg) { return handler.bind(_this)(msg); });\r\n        this._gw3Subscriptions.push(sub);\r\n        return sub;\r\n    };\r\n    GW3Bridge.prototype.dropSubscription = function (subscription) {\r\n        if (subscription) {\r\n            this._connection.off(subscription);\r\n            delete this._gw3Subscriptions[this._gw3Subscriptions.indexOf(subscription)];\r\n        }\r\n    };\r\n    GW3Bridge.prototype.invokeCallbacks = function (callbacks, event, description) {\r\n        var _this = this;\r\n        callbacks.forEach(function (cb) {\r\n            try {\r\n                cb(event);\r\n            }\r\n            catch (err) {\r\n                _this._logger.error(\"Error in \" + (description || event.context.type) + \" callback: \" + JSON.stringify(err));\r\n            }\r\n        });\r\n    };\r\n    GW3Bridge.prototype.handleActivityCreatedMessage = function (msg) {\r\n        if (!msg.context_id) {\r\n            this._logger.error(\"Activity created with unknown context_id: \" + msg.activity_id);\r\n        }\r\n        else {\r\n            this.subscribeToContext(msg);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.subscribeToContext = function (msg) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var activityId, _a, _b;\r\n            var _this = this;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        activityId = msg.activity_id;\r\n                        _a = this._contextSubscriptions;\r\n                        _b = activityId;\r\n                        return [4 /*yield*/, this._contexts.subscribe(activityId, function (data) {\r\n                                var event = new entityEvent_1.EntityEvent(new activity_1.default(activityId, undefined, undefined, data, undefined), new entityEvent_1.ActivityContextChangedEventContext(data));\r\n                                _this.invokeCallbacks(_this._activityChangeCallbacks, event, \"context updated\");\r\n                            })];\r\n                    case 1:\r\n                        _a[_b] =\r\n                            _c.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    GW3Bridge.prototype.handleActivityDestroyedMessage = function (msg) {\r\n        var unsubscribeContext = this._contextSubscriptions[msg.activity_id];\r\n        if (typeof unsubscribeContext === \"function\") {\r\n            unsubscribeContext();\r\n        }\r\n        delete this._contextSubscriptions[msg.activity_id];\r\n    };\r\n    GW3Bridge.prototype.handlePeerFactoriesAdded = function (msg) {\r\n        var _this = this;\r\n        msg.factories.forEach(function (entity) {\r\n            _this._peerIdAndFactoryIdToPeerType[msg.owner_id + \":\" + entity.id] = entity.peer_type;\r\n        });\r\n    };\r\n    GW3Bridge.prototype.handlePeerFactoriesRemoved = function (msg) {\r\n        var _this = this;\r\n        msg.factory_ids.forEach(function (factoryId) {\r\n            delete _this._peerIdAndFactoryIdToPeerType[msg.owner_id + \":\" + factoryId];\r\n        });\r\n    };\r\n    GW3Bridge.prototype.forwardActivityTypeMessagesToStatusEventHandlers = function () {\r\n        this.forwardAddedAndRemovedMessagesToEventHandler(gwMmessageActivityTypesAdded, gwMessageActivityTypesRemoved, function (msg, isAdded) { return isAdded\r\n            ? msg.types.map(function (t) { return GW3Bridge.activityTypeGwMessageEntityToActivityType(t, undefined); })\r\n            : msg.types.map(function (t) { return new activityType_1.default(t.name, undefined, undefined, undefined); }); }, this._activityTypeStatusChangeCallbacks);\r\n    };\r\n    GW3Bridge.prototype.forwardActivityCreatedAndJoinedActivityToActivityWindowEventHandlers = function () {\r\n        var _this = this;\r\n        // if we're created as part of this activity, the JOINED ACTIVITY is\r\n        // the first time we'll hear about it; so let's record the participants\r\n        for (var _i = 0, _a = [gwMessageActivityCreated, gwMessageJoinedActivity]; _i < _a.length; _i++) {\r\n            var activityCreatedMessage = _a[_i];\r\n            this.forwardMessageToEventHandler(activityCreatedMessage, function (msg) {\r\n                return ([msg.owner])\r\n                    .concat(msg.participants || [])\r\n                    .map(function (info) { return new activityWindow_1.default(info.peer_id, info.name, info.type, msg.activity_id, undefined, undefined, _this.generateWindowGetter(info.peer_id), undefined); });\r\n            }, function (ent, msg) { return new entityEvent_1.EntityEvent(ent, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowJoinedActivity)); }, this._activityWindowChangeCallbacks);\r\n        }\r\n    };\r\n    GW3Bridge.prototype.forwardActivityMessagesToStatusEventHandlers = function () {\r\n        // see dot-net-activity\\Activity\\ActivityState.cs\r\n        for (var _i = 0, _a = [gwMessageActivityCreated, gwMessageJoinedActivity]; _i < _a.length; _i++) {\r\n            var createdMessage = _a[_i];\r\n            this.forwardMessageToEventHandler(createdMessage, function (msg) { return [GW3Bridge.activityGwMessageToActivity(msg, new activityStatus_1.ActivityStatus(\"started\", \"\", new Date()))]; }, function (ent, msg) { return GW3Bridge.activityToActivityStatusChangeEvent(ent); }, this._activityChangeCallbacks);\r\n        }\r\n        this.forwardMessageToEventHandler(gwMessageActivityDestroyed, function (msg) { return [GW3Bridge.activityGwMessageToActivity(msg, new activityStatus_1.ActivityStatus(\"destroyed\", msg.reason, new Date()))]; }, function (ent, msg) { return GW3Bridge.activityToActivityStatusChangeEvent(ent); }, this._activityChangeCallbacks);\r\n        this.forwardMessageToEventHandler(gwMessageActivityInitiated, function (msg) { return [GW3Bridge.activityGwMessageToActivity(msg, new activityStatus_1.ActivityStatus(\"created\", \"\", new Date()))]; }, function (ent, msg) { return GW3Bridge.activityToActivityStatusChangeEvent(ent); }, this._activityChangeCallbacks);\r\n    };\r\n    GW3Bridge.prototype.forwardPeerFactoryMessagesToStatusEventHandlers = function () {\r\n        var _this = this;\r\n        this.forwardAddedAndRemovedMessagesToEventHandler(gwMessagePeerFactoriesAdded, gwMessagePeerFactoriesRemoved, function (msg, isAdded) { return isAdded\r\n            ? msg.factories.map(GW3Bridge.peerFactoryGwMessageEntityToWindowType)\r\n            : msg.factory_ids.map(function (id) { return _this.peerFactoryIdAndOwnerIdToWindowType(id, msg.owner_id); }).filter(function (x) { return x != null; }); }, this._windowTypeStatusChangeCallbacks);\r\n    };\r\n    GW3Bridge.prototype.forwardPeerFactoryMessagesToPeerFactoryRequests = function () {\r\n        var _this = this;\r\n        this.subscribe(gwMessagePeerRequested, function (msg) {\r\n            var factory = _this._peerFactoriesRegisteredByUs[msg.peer_factory];\r\n            if (!factory) {\r\n                _this._gw3Session.send({\r\n                    type: gwMmessageError,\r\n                    request_id: msg.request_id,\r\n                    reason: \"Unknown peer factory \" + msg.peer_factory\r\n                });\r\n                return;\r\n            }\r\n            try {\r\n                var configuration = msg.configuration || {};\r\n                // NB: peer factories (or whoever they're delegating to) need to support whatever activity\r\n                // environment (GW3, HC) we're targeting when they're creating peers\r\n                // the manager is env agnostic, the bridge will augment the configuration with whatever's required\r\n                // NB: also, since peers are requested in two ways (single peer with just its configuration,\r\n                // or peer created as part of new activity, where the factory receives the aggregate config of\r\n                // all peers, combined from ADD ACTIVITY TYPE and CREATE ACTIVITY), the peer factories need to\r\n                // be able to handle both configuration structures intelligently.\r\n                configuration.gateway_token = configuration.gateway_token || msg.gateway_token;\r\n                configuration.peer_factory = configuration.peer_factory || msg.peer_factory;\r\n                var promise = factory.create({\r\n                    activityId: msg.activity.id,\r\n                    type: msg.activity.type,\r\n                    gwToken: configuration.gateway_token,\r\n                    configuration: configuration,\r\n                });\r\n                if (promise && promise.then && promise.catch) {\r\n                    promise.catch(function (err) { return _this._gw3Session.send({\r\n                        type: gwMmessageError,\r\n                        request_id: msg.request_id,\r\n                        reason: err && (err.message || JSON.stringify(err))\r\n                    }); });\r\n                }\r\n            }\r\n            catch (err) {\r\n                _this._gw3Session.send({\r\n                    type: gwMmessageError,\r\n                    request_id: msg.request_id,\r\n                    reason: err && (err.message || JSON.stringify(err))\r\n                });\r\n            }\r\n        });\r\n    };\r\n    GW3Bridge.prototype.forwardActivityWindowMessagesToEventHandlers = function () {\r\n        var _this = this;\r\n        var _loop_1 = function (joinedMessage) {\r\n            this_1.subscribe(joinedMessage, function (msg) {\r\n                var joinedId = (joinedMessage === gwMessageActivityJoined) ? msg.joined_id : msg.peer_id;\r\n                var joinedType = (joinedMessage === gwMessageActivityJoined) ? msg.joined_type : msg.peer_type;\r\n                var joinedName = (joinedMessage === gwMessageActivityJoined) ? msg.joined_name : msg.peer_name;\r\n                var entity = new activityWindow_1.default(joinedId, joinedName, joinedType /* for ACTIVITY JOINED */, msg.activity_id, undefined, undefined, _this.generateWindowGetter(joinedId), undefined);\r\n                // TODO review - what if it's our activity, do we\r\n                // even need to subscribe\r\n                if (!_this._contextSubscriptions[msg.activity_id]) {\r\n                    _this.subscribeToContext(msg).then(function () {\r\n                        if (joinedMessage === gwMessageJoinedActivity) {\r\n                            _this._activityJoinedPromiseResolve({});\r\n                        }\r\n                    });\r\n                }\r\n                else if (joinedMessage === gwMessageJoinedActivity) {\r\n                    _this._activityJoinedPromiseResolve({});\r\n                }\r\n                // TODO review: we might have the context data here already\r\n                // why not update it here instead of waiting for subscribeToContext\r\n                _this.invokeCallbacks(_this._activityWindowChangeCallbacks, new entityEvent_1.EntityEvent(entity, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowJoinedActivity)), joinedMessage);\r\n            });\r\n        };\r\n        var this_1 = this;\r\n        for (var _i = 0, _a = [gwMessageActivityJoined, gwMessageJoinedActivity]; _i < _a.length; _i++) {\r\n            var joinedMessage = _a[_i];\r\n            _loop_1(joinedMessage);\r\n        }\r\n        this.subscribe(gwMessageActivityLeft, function (msg) {\r\n            var entity = new activityWindow_1.default(msg.left_id, undefined, undefined, null, undefined, undefined, _this.generateWindowGetter(msg.left_id), undefined);\r\n            _this.invokeCallbacks(_this._activityWindowChangeCallbacks, new entityEvent_1.EntityEvent(entity, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowLeftActivity)), gwMessageActivityLeft);\r\n        });\r\n        this.forwardAddedAndRemovedMessagesToEventHandler(gwMessagePeerCreated, undefined, function (msg) { return [\r\n            new activityWindow_1.default(msg.created_id, undefined /* #deleteme TODO: review - we should know the name if any */, undefined /* #deleteme TODO: review - we should know the type */, undefined, undefined, undefined, _this.generateWindowGetter(msg.created_id), undefined)\r\n        ]; }, this._activityWindowChangeCallbacks);\r\n    };\r\n    GW3Bridge.prototype.generateWindowGetter = function (peerId) {\r\n        var _this = this;\r\n        return function () {\r\n            var server = _this._config.agm.servers().filter(function (s) { return s.peerId === peerId; })[0];\r\n            if (!server) {\r\n                return;\r\n            }\r\n            var windowId = server.windowId;\r\n            return _this._config.windows.list().filter(function (w) { return w.id === windowId; })[0];\r\n        };\r\n    };\r\n    GW3Bridge.prototype.isOverrideTypeDefinition = function (value) {\r\n        if (typeof value === \"undefined\") {\r\n            return false;\r\n        }\r\n        if (value.owner) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return GW3Bridge;\r\n}());\r\nexports.default = GW3Bridge;\r\n//# sourceMappingURL=gw3Bridge.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/bridges/gw3Bridge.js\n// module id = 54\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar entityEvent_1 = require(\"../contracts/entityEvent\");\r\nvar activityType_1 = require(\"../entities/activityType\");\r\nvar promiseExtensions_1 = require(\"../helpers/promiseExtensions\");\r\nvar readyMarker_1 = require(\"../helpers/readyMarker\");\r\nvar entityObservableCollection_1 = require(\"../helpers/entityObservableCollection\");\r\nvar logger_1 = require(\"../helpers/logger\");\r\nvar util = require(\"../helpers/util\");\r\nvar localWindowFactory_1 = require(\"./localWindowFactory\");\r\nvar entityEvent_2 = require(\"../contracts/entityEvent\");\r\nvar hcBridge_1 = require(\"../bridges/hcBridge\");\r\nvar ActivityManager = /** @class */ (function () {\r\n    function ActivityManager(bridge, autoAnnounce, windows) {\r\n        var _this = this;\r\n        this._logger = logger_1.Logger.Get(\"activityManager\");\r\n        this._announcedWindows = [];\r\n        this._attachedCallbacks = [];\r\n        this._detachedCallbacks = [];\r\n        this._frameColorChangesCallbacks = [];\r\n        this._bridge = bridge;\r\n        this._activityTypes = new entityObservableCollection_1.EntityObservableCollection(function (e) { return _this._grabEntity(e); });\r\n        this._windowTypes = new entityObservableCollection_1.EntityObservableCollection(function (e) { return _this._grabEntity(e); });\r\n        this._activities = new entityObservableCollection_1.EntityObservableCollection(function (e) { return _this._grabEntity(e); });\r\n        this._windows = new entityObservableCollection_1.EntityObservableCollection(function (e) { return _this._grabEntity(e); });\r\n        // signals to wait for - get AT, get WT, get Activities and get Windows\r\n        this._dataReadyMarker = new readyMarker_1.ReadyMarker(\"Activity Manager Data\", [\"GetActivityTypes\", \"GetWindowTypes\", \"GetActivities\", \"GetWindows\"].length);\r\n        this._descriptorsMarker = new readyMarker_1.ReadyMarker(\"Attached Activities Descriptors\", [\"GetDescriptors\"].length);\r\n        // waiting for activity data first\r\n        // NB: in the GW3 case, we don't have the ability to request data at will\r\n        // but need wait for delta messages\r\n        // So GW3Bridge returns empty arrays from the get() calls\r\n        // We're relying on the fact that the GW3 bridge will wait\r\n        // until resolving its .ready()\r\n        if (autoAnnounce) {\r\n            // if auto announce replace the ready marker, so:\r\n            // 1) wait for data\r\n            // 2) get descriptors\r\n            // 3) announce the current window\r\n            this._readyMarker = new readyMarker_1.ReadyMarker(\"Activity Manager Announce\", [\"Announcement\"].length);\r\n            this._dataReadyMarker.setCallback(function (dataErr) {\r\n                if (dataErr) {\r\n                    _this._readyMarker.error(dataErr);\r\n                }\r\n                _this._descriptorsMarker.setCallback(function (err) {\r\n                    if (err) {\r\n                        _this._readyMarker.error(err);\r\n                    }\r\n                    _this._logger.debug(\"Auto announcing window\");\r\n                    // signal no matter if it failed or not\r\n                    _this.announceWindow()\r\n                        .then(function (w) {\r\n                        // NB: this creates glue.activities.my.window\r\n                        _this._announcedWindows.push(w);\r\n                        _this._readyMarker.signal(\"Successfully announced window with id '\" + w.id + \"'\");\r\n                    })\r\n                        .catch(function (errCatch) {\r\n                        _this._logger.debug(\"Will not announce window - \" + errCatch);\r\n                        _this._readyMarker.signal();\r\n                    });\r\n                });\r\n                _this.refreshDescriptors();\r\n            });\r\n        }\r\n        else {\r\n            // TODO: not sure if this still works\r\n            this._readyMarker = this._dataReadyMarker;\r\n        }\r\n        this._bridge.onActivitiesAttached(function (e) {\r\n            _this._handleActivitiesAttached(e);\r\n        });\r\n        this._bridge.onActivitiesDetached(function (e) {\r\n            _this._handleActivitiesDetached(e);\r\n        });\r\n        this._bridge.onActivityAttachedDescriptorsRefreshed(function (e) {\r\n            _this._handleActivityDescriptorsRefreshed(e);\r\n        });\r\n        if (windows) {\r\n            windows.onWindowFrameColorChanged(this._handleWindowFrameColorChanged.bind(this));\r\n        }\r\n        // initialize the bridge\r\n        this._bridge.init();\r\n        // NB: there is no race condition here.\r\n        // Since browser/Node JS is a single-threaded environment, assuming no events on _bridge\r\n        // fire inside .init(), this subscribe will catch anything that comes between it and the init() call\r\n        this._subscribeForData();\r\n        // NB: in GW3 case, the initial state messages after a JOIN come in before the JOIN's SUCCESS\r\n        // message (see https://confluence.tick42.com:8443/display/TD/Global+Gateway+Domain#GlobalGatewayDomain-JOIN)\r\n        // so the .initReady().then() callback will only get invoked after we've received the initial domain\r\n        // state. We need to be ready to handle events before that, hence the _subscribeForData() above.\r\n        // what's more, our own JOINED ACTIVITY will come only after we've sent our READY, hence waiting\r\n        // for bridge.ready() in the manager's ready()\r\n        // wait for it to become ready and then start getting/subscribing for data\r\n        this._bridge\r\n            .initReady()\r\n            .then(function (aw) {\r\n            _this._getInitialData();\r\n        })\r\n            .catch(function (error) {\r\n            // tslint:disable-next-line\r\n            console.log(error);\r\n        });\r\n    }\r\n    Object.defineProperty(ActivityManager.prototype, \"usingHc\", {\r\n        get: function () {\r\n            return this._bridge.bridgeType === \"HC\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ActivityManager.prototype, \"announcedWindows\", {\r\n        get: function () {\r\n            return this._announcedWindows;\r\n        },\r\n        set: function (v) {\r\n            throw new Error(\"not allowed\");\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ActivityManager.prototype.ready = function (callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            _this._readyMarker.setCallback(function (err) {\r\n                if (!err) {\r\n                    resolve(_this);\r\n                }\r\n                else {\r\n                    reject(_this._readyMarker.getError());\r\n                }\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(Promise.all([this._bridge.ready(), promise]).then(function () { return _this; }), callback);\r\n    };\r\n    /**\r\n     * @returns All known activity types\r\n     */\r\n    ActivityManager.prototype.getActivityTypes = function () {\r\n        return this._activityTypes.get();\r\n    };\r\n    /**\r\n     * Gets ActivityType by name\r\n     * @param name  Name to search for\r\n     * @returns     If found the @type ActivityType; otherwise undefined\r\n     */\r\n    ActivityManager.prototype.getActivityType = function (name) {\r\n        return this._activityTypes.getByName(name);\r\n    };\r\n    /**\r\n     * Registers a new activity type\r\n     * @param activityTypeName      The name of the activity type to be created\r\n     * @param ownerWindowType       The type of the owner window or a WindowDefinition for the owner window\r\n     * @param helperWindowTypes     Types of helper windows (or WindowDefinitions for helper windows) for that activity type\r\n     * @param config                (HC only, deprecated) Layout config\r\n     * @param description           (HC only, deprecated) Description for the new activity type\r\n     * @param callback              (Optional) Callback for results - if not specified the method will return a promise\r\n     */\r\n    ActivityManager.prototype.registerActivityType = function (activityTypeName, ownerWindowType, helperWindowTypes, config, description, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            // activityTypeName checks\r\n            if (util.isUndefinedOrNull(activityTypeName)) {\r\n                reject(\"activityTypeName argument can not be undefined\");\r\n                return;\r\n            }\r\n            if (!util.isString(activityTypeName)) {\r\n                reject(\"activityTypeName should be string\");\r\n                return;\r\n            }\r\n            // check if type is already defined\r\n            var actType = _this.getActivityType(activityTypeName);\r\n            if (!util.isUndefinedOrNull(actType)) {\r\n                reject(\"Activity type '\" + activityTypeName + \"' already exists\");\r\n                return;\r\n            }\r\n            // ownerWindowType checks\r\n            var ownerDefinition;\r\n            if (util.isUndefined(ownerWindowType)) {\r\n                reject(\"Owner window type can not be undefined\");\r\n                return;\r\n            }\r\n            if (util.isString(ownerWindowType)) {\r\n                ownerDefinition = { type: ownerWindowType, name: \"\", isIndependent: false, arguments: {} };\r\n            }\r\n            else {\r\n                ownerDefinition = ownerWindowType;\r\n            }\r\n            // helperWindowTypes checks\r\n            var helperDefinitions = [];\r\n            if (!util.isUndefined(helperWindowTypes) && util.isArray(helperWindowTypes)) {\r\n                // tslint:disable-next-line\r\n                for (var index in helperWindowTypes) {\r\n                    var item = helperWindowTypes[index];\r\n                    if (util.isString(item)) {\r\n                        var definition = {\r\n                            type: item,\r\n                            name: \"\",\r\n                            isIndependent: false,\r\n                            arguments: {},\r\n                            relativeTo: \"\",\r\n                            relativeDirection: \"\",\r\n                            windowStyleAttributes: {}\r\n                        };\r\n                        helperDefinitions.push(definition);\r\n                    }\r\n                    else {\r\n                        helperDefinitions.push(item);\r\n                    }\r\n                }\r\n            }\r\n            // redirect to bridge\r\n            _this._bridge\r\n                .registerActivityType(activityTypeName, ownerDefinition, helperDefinitions, config, description)\r\n                .then(function (activityType) {\r\n                // add to from collections\r\n                _this._grabEntity(activityType);\r\n                resolve(activityType);\r\n            })\r\n                .catch(function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Unregister existing activity type\r\n     * @param type The name of the activity type to be removed\r\n     */\r\n    ActivityManager.prototype.unregisterActivityType = function (type, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            // check if type is defined\r\n            var actType = _this.getActivityType(type);\r\n            if (util.isUndefined(actType)) {\r\n                reject(\"Activity type '\" + type + \"' does not exists\");\r\n                return;\r\n            }\r\n            _this._bridge.unregisterActivityType(type).then(function () { return resolve(actType); }, reject);\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Initiates a new activity from the given type.\r\n     * @param activityType  The ActivityType to initiate\r\n     * @param context       The initial context of the activity\r\n     * @param callback      Callback for result\r\n     * @param configuration Optional configuration passed to window/peer factories for the new activity's participants\r\n     * @returns             Promise for activity\r\n     */\r\n    ActivityManager.prototype.initiate = function (activityType, context, callback, configuration) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            // check if type is defined\r\n            var actType = _this.getActivityType(activityType);\r\n            if (util.isUndefined(actType)) {\r\n                reject(\"Activity type '\" + activityType + \"' does not exists\");\r\n                return;\r\n            }\r\n            _this._bridge\r\n                .initiateActivity(activityType, context, configuration)\r\n                .then(function (actId) {\r\n                _this._activities\r\n                    .getOrWait(actId)\r\n                    .then(function (act) {\r\n                    resolve(act);\r\n                })\r\n                    .catch(function (err) { return reject(err); });\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    ActivityManager.prototype.subscribeActivityTypeEvents = function (handler) {\r\n        this._activityTypes.subscribe(function (at, context) {\r\n            handler(at, context.type);\r\n        });\r\n    };\r\n    /**\r\n     * @returns All known WindowTypes\r\n     */\r\n    ActivityManager.prototype.getWindowTypes = function () {\r\n        return this._windowTypes.get();\r\n    };\r\n    /**\r\n     * Gets WindowType by name\r\n     * @param name  The name of the type @type WindowType\r\n     * @returns     WindowType if found; undefined otherwise\r\n     */\r\n    ActivityManager.prototype.getWindowType = function (name) {\r\n        return this._windowTypes.getByName(name);\r\n    };\r\n    /**\r\n     * Registers a factory for a given WindowType. The factory will be called once window of that type is requested\r\n     * @param windowType   Window type that will be constructed from the factory. Can be a string (name of the window type)\r\n     * or object that has name, description properties\r\n     * @param factoryMethod      The factory that will construct Windows of that type\r\n     * @param description\r\n     * @param callback\r\n     * @param configuration\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.registerWindowFactory = function (windowType, factoryMethod, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(windowType)) {\r\n                reject(\"no windowType specified\");\r\n                return;\r\n            }\r\n            if (util.isObject(windowType)) {\r\n                windowType = windowType.getName();\r\n            }\r\n            else if (!util.isString(windowType)) {\r\n                reject(\"windowType should be string or object that has getName method\");\r\n                return;\r\n            }\r\n            var factory = new localWindowFactory_1.LocalWindowFactory(factoryMethod);\r\n            _this._bridge\r\n                .registerWindowFactory(windowType, factory)\r\n                .then(function (v) {\r\n                resolve(v);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Unregisters all factories for a given WindowType.\r\n     * @param windowType   Window type that is constructed from the factory.\r\n     * @param callback\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.unregisterWindowFactory = function (windowType, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(windowType)) {\r\n                reject(\"no windowType specified\");\r\n                return;\r\n            }\r\n            if (!util.isString(windowType)) {\r\n                reject(\"windowType should be a string\");\r\n                return;\r\n            }\r\n            _this._bridge\r\n                .unregisterWindowFactory(windowType)\r\n                .then(function (v) {\r\n                resolve(v);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * @returns All started activities\r\n     * @param activityType Can be a string or @type ActivityType. If string a new activityType will be created using the string for name.\r\n     * @returns Array of Activity objects\r\n     */\r\n    ActivityManager.prototype.getActivities = function (activityType) {\r\n        var act = this._activities.get();\r\n        if (!activityType) {\r\n            return act;\r\n        }\r\n        var types = activityType;\r\n        if (util.isString(activityType)) {\r\n            types = [activityType];\r\n        }\r\n        else if (activityType instanceof activityType_1.default) {\r\n            types = [activityType.name];\r\n        }\r\n        else if (activityType instanceof Array) {\r\n            // TODO check if string array or array of ActivityTypes\r\n        }\r\n        else {\r\n            throw new Error(\"Invalid input argument 'activityType' = \" + activityType);\r\n        }\r\n        return act.filter(function (at) {\r\n            var type = at.type;\r\n            return util.some(types, function (t) {\r\n                return type.id === t.id;\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Returns Activity by ID\r\n     */\r\n    ActivityManager.prototype.getActivityById = function (id) {\r\n        return this._activities.getByName(id);\r\n    };\r\n    /**\r\n     * Initialises activity for the current window - by doing this the window is announced as activity aware to the other participants\r\n     * @param windowType            Type of window\r\n     * @param activityWindowId      The id of the window that was created\r\n     * @returns {}                  Promise for an activity window (joined to an activity, if the activity creation fails the promise will be rejected)\r\n     */\r\n    ActivityManager.prototype.announceWindow = function (activityWindowId, windowType) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            // get the announcement info from the bridge (e.g. the context in HC) - this will be used if no arguments passed\r\n            var announcementInfo = _this._bridge.getAnnouncementInfo();\r\n            if (util.isUndefined(activityWindowId)) {\r\n                activityWindowId = announcementInfo.activityWindowId;\r\n            }\r\n            if (util.isUndefined(windowType)) {\r\n                windowType = announcementInfo.activityWindowType;\r\n            }\r\n            if (util.isUndefinedOrNull(windowType)) {\r\n                throw new Error(\"Can not announce - unknown windowType\");\r\n            }\r\n            var activityId = announcementInfo && announcementInfo.activityId;\r\n            // We cover two cases here:\r\n            // * no activityWindowId supplied (neither in arguments or announcement info) - in that case we register new window by type. Most of the time this is the case when an independent window is created outside activity\r\n            // * activityWindowId supplied - window created as part of activity creation\r\n            // NB: in GW3, windows are created standalone, and receive 'JOINED' after they send a 'READY'\r\n            // so we always go in 'if' case, not 'else'\r\n            if (util.isUndefinedOrNull(activityWindowId)) {\r\n                _this._logger.debug(\"Registering window with type:'\" + windowType + \"', name:'\" + announcementInfo.activityWindowName + \"', ind.:'\" + announcementInfo.activityWindowIndependent + \"'\");\r\n                // register new window created outside activity\r\n                _this._bridge.registerWindow(windowType, announcementInfo.activityWindowName, announcementInfo.activityWindowIndependent)\r\n                    .then(_this._windows.getOrWait.bind(_this._windows))\r\n                    .then(function (w) {\r\n                    if (activityId) {\r\n                        return _this._activities.getOrWait(activityId).then(function (_) { return w; });\r\n                    }\r\n                    else {\r\n                        return w;\r\n                    }\r\n                })\r\n                    .then(function (w) {\r\n                    resolve(w);\r\n                })\r\n                    .catch(function (err) {\r\n                    _this._logger.error(err);\r\n                });\r\n            }\r\n            else {\r\n                // announce new window created in an activity creation process\r\n                _this._logger.debug(\"Announcing window with id '\" + activityWindowId + \"' and type '\" + windowType + \"'\");\r\n                // check if the window is already created -\r\n                var currentWindow = _this._windows.getByName(activityWindowId);\r\n                if (!util.isUndefinedOrNull(currentWindow)) {\r\n                    _this._logger.debug(\"Window with id '\" + activityWindowId + \"' already announced - reusing the window\");\r\n                    resolve(currentWindow);\r\n                    return;\r\n                }\r\n                // window events handler\r\n                var windowEventHandler_1 = function (a, w, e) {\r\n                    if (activityWindowId === w.id) {\r\n                        if (typeof htmlContainer !== \"undefined\") {\r\n                            _this._logger.trace(\"Got HC event for id '\" + activityWindowId + \"'\");\r\n                            resolve(w);\r\n                            _this.unsubscribeWindowEvents(windowEventHandler_1);\r\n                        }\r\n                        else if (e === entityEvent_1.EntityEventType.ActivityWindowJoinedActivity) {\r\n                            var activity = w.activity;\r\n                            if (util.isUndefined(activity)) {\r\n                                reject(\"UNDEFINED ACTIVITY\");\r\n                            }\r\n                            _this._logger.trace(\"Got joined event for id '\" + activityWindowId + \"'\");\r\n                            resolve(w);\r\n                            _this.unsubscribeWindowEvents(windowEventHandler_1);\r\n                        }\r\n                    }\r\n                };\r\n                _this.subscribeWindowEvents(windowEventHandler_1);\r\n                _this._logger.trace(\"Waiting for joined event for id '\" + activityWindowId + \"'\");\r\n                _this._bridge.announceWindow(windowType, activityWindowId);\r\n            }\r\n        });\r\n        return promise;\r\n    };\r\n    /**\r\n     * Allows you to subscribe for windows events, e.g. window type registered\r\n     * @param handler   The handler to receive notifications\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.subscribeWindowTypeEvents = function (handler) {\r\n        this._windowTypes.subscribe(function (wt, context) {\r\n            handler(wt, context.type);\r\n        });\r\n    };\r\n    /**\r\n     * Subscribe for activity status events\r\n     * @param handler Handler function that will receive status notifications\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.subscribeActivityEvents = function (handler) {\r\n        var _this = this;\r\n        return this._activities.subscribe(function (act, context) {\r\n            if (context.type === entityEvent_1.EntityEventType.StatusChange) {\r\n                var p = context;\r\n                handler(act, p.newStatus, p.oldStatus);\r\n            }\r\n            // implicitly leave the activity on destroy\r\n            if (context.type === entityEvent_1.EntityEventType.Removed ||\r\n                (context.type === entityEvent_1.EntityEventType.StatusChange &&\r\n                    context.newStatus.getState() === entityEvent_2.ActivityState.Destroyed)) {\r\n                for (var _i = 0, _a = _this._windows.get(); _i < _a.length; _i++) {\r\n                    var window_1 = _a[_i];\r\n                    if (window_1.activity && window_1.activity.id === act.id) {\r\n                        _this._windows.process(new entityEvent_1.EntityEvent(window_1, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.ActivityWindowLeftActivity)));\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Allows you to subscribe for windows events, e.g. window joining to activity\r\n     * @param handler   The handler to receive notifications\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.subscribeWindowEvents = function (handler) {\r\n        return this._windows.subscribe(function (window, context) {\r\n            var eventType = context.type;\r\n            if (eventType === entityEvent_1.EntityEventType.Added) {\r\n                // rename added to opened (because added is misleading - semantically it's the opposite of remove);\r\n                eventType = \"opened\";\r\n            }\r\n            handler(window.activity, window, eventType);\r\n        });\r\n    };\r\n    ActivityManager.prototype.unsubscribeWindowEvents = function (handler) {\r\n        // this._windows.unsubscribe(handler);\r\n    };\r\n    /**\r\n     * Creates a new window from a given type and joins it to an activity\r\n     *\r\n     * @param activity      Activity to join the window to\r\n     * @param windowType    The window type to join (string or window definition)\r\n     * @param callback      (Optional) Result callback\r\n     * @returns             Promise for ActivityWindow\r\n     */\r\n    ActivityManager.prototype.createWindow = function (activity, windowTypeOrConfiguration, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(windowTypeOrConfiguration)) {\r\n                reject(\"windowType is undefined\");\r\n            }\r\n            var windowDefinition;\r\n            if (util.isString(windowTypeOrConfiguration)) {\r\n                windowDefinition = { type: windowTypeOrConfiguration, name: \"\", isIndependent: false, arguments: {} };\r\n            }\r\n            else {\r\n                windowDefinition = windowTypeOrConfiguration;\r\n            }\r\n            var relativeToWindow;\r\n            if (!util.isUndefinedOrNull(windowDefinition.relativeTo)) {\r\n                relativeToWindow = windowDefinition.relativeTo;\r\n                if (typeof relativeToWindow === \"string\") {\r\n                    var windows = _this.getWindows({ type: relativeToWindow });\r\n                    if (!util.isUndefinedOrNull(windows) && windows.length > 0) {\r\n                        windowDefinition.relativeTo = windows[0].id;\r\n                    }\r\n                }\r\n                else if (!util.isUndefinedOrNull(relativeToWindow.type)) {\r\n                    var windows = _this.getWindows({ type: relativeToWindow.type });\r\n                    if (!util.isUndefinedOrNull(windows) && windows.length > 0) {\r\n                        windowDefinition.relativeTo = windows[0].id;\r\n                    }\r\n                }\r\n                else if (!util.isUndefinedOrNull(relativeToWindow.windowId)) {\r\n                    windowDefinition.relativeTo = relativeToWindow.windowId;\r\n                }\r\n            }\r\n            _this._bridge.createWindow(activity && activity.id, windowDefinition)\r\n                .then(function (wid) {\r\n                _this._logger.debug(\"Window created, waiting for window entity with id \" + wid);\r\n                var handler = function (window, context) {\r\n                    // wait until the window has activity property (this means it was joined)\r\n                    if (window.id === wid && (!activity || window.activity)) {\r\n                        _this._logger.debug(\"Got entity window with id \" + wid);\r\n                        resolve(window);\r\n                        _this._windows.unsubscribe(handler);\r\n                    }\r\n                };\r\n                // if we can not get the window right away, wait for event\r\n                _this._windows.subscribe(handler);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Creates relative windows from a given types and joins them to an activity\r\n     *\r\n     * @param activity               Activity to join relative windows to\r\n     * @param relativeWindowTypes    Relative window types to join (string or window definitions array)\r\n     * @param callback               (Optional) Result callback\r\n     * @returns                      Promise for ActivityWindow\r\n     */\r\n    ActivityManager.prototype.createStackedWindows = function (activity, relativeWindowTypes, timeout, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(activity)) {\r\n                reject(\"activity is undefined\");\r\n            }\r\n            if (util.isUndefinedOrNull(relativeWindowTypes)) {\r\n                reject(\"relativeWindowTypes is undefined\");\r\n            }\r\n            if (!Array.isArray(relativeWindowTypes)) {\r\n                reject(\"relativeWindowTypes has to be array\");\r\n            }\r\n            if (util.isUndefinedOrNull(timeout)) {\r\n                timeout = 20000; // default timeout: 20 seconds\r\n            }\r\n            var relativeWindows = [];\r\n            relativeWindowTypes.forEach(function (element) {\r\n                var windowDefinition;\r\n                if (util.isString(element)) {\r\n                    windowDefinition = { type: element, name: \"\", isIndependent: false, arguments: {} };\r\n                }\r\n                else {\r\n                    windowDefinition = element;\r\n                }\r\n                var relativeToWindow;\r\n                if (!util.isUndefinedOrNull(windowDefinition.relativeTo)) {\r\n                    // this can not be string, converted in the prev. layer\r\n                    relativeToWindow = windowDefinition.relativeTo;\r\n                    if (!util.isUndefinedOrNull(relativeToWindow.type)) {\r\n                        windowDefinition.relativeTo = relativeToWindow.type;\r\n                    }\r\n                    else if (!util.isUndefinedOrNull(relativeToWindow.windowId)) {\r\n                        var windows = _this.getWindows({ id: relativeToWindow.windowId });\r\n                        if (!util.isUndefinedOrNull(windows) && windows.length > 0) {\r\n                            windowDefinition.relativeTo = windows[0].type.name;\r\n                            windowDefinition.useExisting = true;\r\n                        }\r\n                    }\r\n                }\r\n                relativeWindows.push(windowDefinition);\r\n            });\r\n            _this._bridge.createStackedWindows(activity.id, relativeWindows, timeout)\r\n                .then(function (wid) {\r\n                var activityWindows = [];\r\n                var alreadyCreated = [];\r\n                var handler = function (window, context) {\r\n                    // wait until the window has activity property (this means it was joined)\r\n                    if (wid.indexOf(window.id) >= 0 && alreadyCreated.indexOf(window.id) < 0 && window.activity) {\r\n                        this._logger.debug(\"Got entity window with id \" + wid);\r\n                        activityWindows.push(window);\r\n                        alreadyCreated.push(window.id);\r\n                        if (activityWindows.length === wid.length) {\r\n                            resolve(activityWindows);\r\n                            this._windows.unsubscribe(handler);\r\n                        }\r\n                    }\r\n                }.bind(_this);\r\n                // if we can not get the window right away, wait for event\r\n                _this._windows.subscribe(handler);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Joins a new window from a given type to the activity\r\n     *\r\n     * @param activity      Activity to join the window to\r\n     * @param window        The window to join\r\n     * @param callback      (Optional) Result callback\r\n     * @returns             Promise for ActivityWindow\r\n     */\r\n    ActivityManager.prototype.addWindowToActivity = function (activity, window, callback) {\r\n        var toReturn = this._bridge.joinActivity(activity.id, window.id)\r\n            .then(function () { return window; });\r\n        promiseExtensions_1.nodeify(toReturn, callback);\r\n        return toReturn;\r\n    };\r\n    /**\r\n     * Removes a window from the activity\r\n     *\r\n     * @param activity  Activity to remove the window from\r\n     * @param           The window to remove\r\n     * @param           (Optional) Result callback\r\n     * @returns         Promise for ActivityWindow\r\n     */\r\n    ActivityManager.prototype.leaveWindowFromActivity = function (activity, window, callback) {\r\n        var toReturn = this._bridge.leaveActivity(activity.id, window.id)\r\n            .then(function () { return window; });\r\n        promiseExtensions_1.nodeify(toReturn, callback);\r\n        return toReturn;\r\n    };\r\n    /**\r\n     * Replaces the activity context\r\n     * @param activity  Activity\r\n     * @param context   The new context\r\n     * @param callback  (Optional) Result callback\r\n     * @returns         Promise for Activity\r\n     */\r\n    ActivityManager.prototype.setActivityContext = function (activity, context, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(activity)) {\r\n                reject(\"activity can not be null\");\r\n            }\r\n            // TODO: duplication with updateActivityContext\r\n            // DONE: verify is the change visible here when 'updateActivityContext' resolves?\r\n            _this._bridge\r\n                .updateActivityContext(activity, context, true)\r\n                .then(function (_) {\r\n                resolve(activity);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Updates activity context using the properties from  context argument.\r\n     * If old context is {a:1, b:2, c:3} and invoking updateContext({b:3, c:null}) will result a context\r\n     * be {a:1, b:3}\r\n     *\r\n     * @param activity\r\n     * @param context\r\n     * @param callback\r\n     */\r\n    ActivityManager.prototype.updateActivityContext = function (activity, context, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (util.isUndefinedOrNull(activity)) {\r\n                reject(\"activity can not be null\");\r\n            }\r\n            var removedKeys = [];\r\n            for (var key in context) {\r\n                if (context.hasOwnProperty(key) && context[key] === null) {\r\n                    removedKeys.push(key);\r\n                }\r\n            }\r\n            for (var _i = 0, removedKeys_1 = removedKeys; _i < removedKeys_1.length; _i++) {\r\n                var removedKey = removedKeys_1[_i];\r\n                delete context[removedKey];\r\n            }\r\n            _this._bridge\r\n                .updateActivityContext(activity, context, false, removedKeys)\r\n                .then(function (_) {\r\n                // DONE: verify is the change already visible here when 'updateActivityContext' resolves?\r\n                resolve(activity);\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Subscribe for activity context update events\r\n     *\r\n     * @param activity  Activity\r\n     * @param handler   Handler function that will receive context related events\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.subscribeActivityContextChanged = function (handler) {\r\n        this._activities.subscribe(function (act, context) {\r\n            if (context.type === entityEvent_1.EntityEventType.ActivityContextChange) {\r\n                var updateContext = context;\r\n                handler(act, act.context);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Stops an activity\r\n     * @returns {}\r\n     */\r\n    ActivityManager.prototype.stopActivity = function (activity, callback) {\r\n        var promise = this._bridge.stopActivity(activity);\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    /**\r\n     * Returns activity windows based on some filter. If no filter supplied all activity windows are returned.\r\n     * @param filter  Filter that\r\n     * @returns Array of ActivityWindows that match the filter object\r\n     */\r\n    ActivityManager.prototype.getWindows = function (filter) {\r\n        if (util.isUndefined(filter)) {\r\n            return this._windows.get();\r\n        }\r\n        if (!util.isUndefined(filter.id)) {\r\n            return [this._windows.getByName(filter.id)];\r\n        }\r\n        var allWindows = this._windows.get();\r\n        return allWindows.filter(function (w) {\r\n            if (!util.isUndefined(filter.type) && w.type.id !== filter.type) {\r\n                return false;\r\n            }\r\n            if (!util.isUndefined(filter.name) && w.name !== filter.name) {\r\n                return false;\r\n            }\r\n            if (!util.isUndefined(filter.activityId)) {\r\n                if (util.isUndefinedOrNull(w.activity)) {\r\n                    return false;\r\n                }\r\n                if (w.activity.id !== filter.activityId) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n    };\r\n    ActivityManager.prototype.getWindowBounds = function (id) {\r\n        return this._bridge.getWindowBounds(id);\r\n    };\r\n    ActivityManager.prototype.setWindowBounds = function (id, bounds, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            _this._bridge.setWindowBounds(id, bounds)\r\n                .then(function () { return resolve(); })\r\n                .catch(function (err) { return reject(err); });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    ActivityManager.prototype.closeWindow = function (id) {\r\n        return this._bridge.closeWindow(id);\r\n    };\r\n    ActivityManager.prototype.activateWindow = function (id, focus) {\r\n        return this._bridge.activateWindow(id, focus);\r\n    };\r\n    ActivityManager.prototype.setWindowVisibility = function (id, visible) {\r\n        return this._bridge.setWindowVisibility(id, visible);\r\n    };\r\n    ActivityManager.prototype.clone = function (activity, cloneOptions, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (!activity) {\r\n                reject(\"activity can not be null\");\r\n            }\r\n            _this._bridge.cloneActivity(activity.id, cloneOptions)\r\n                .then(function (activityId) {\r\n                _this._activities\r\n                    .getOrWait(activityId)\r\n                    .then(function (act) {\r\n                    resolve(act);\r\n                })\r\n                    .catch(function (err) { return reject(err); });\r\n            })\r\n                .catch(function (err) { return reject(err); });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    ActivityManager.prototype.attachActivities = function (from, to, tag, callback) {\r\n        var _this = this;\r\n        tag = tag || {};\r\n        var promise = new Promise(function (resolve, reject) {\r\n            var fromActivity = _this._activities.getByName(from);\r\n            if (!fromActivity) {\r\n                reject(\"can not find activity with id \" + from);\r\n                return;\r\n            }\r\n            var toActivity = _this._activities.getByName(to);\r\n            if (!toActivity) {\r\n                reject(\"can not find activity with id \" + to);\r\n                return;\r\n            }\r\n            return _this._bridge.attachActivities(from, to, tag)\r\n                .then(function (data) {\r\n                var newActId = data.to;\r\n                var state = data.descriptor;\r\n                var allStates = data.descriptors;\r\n                _this._activities.getOrWait(newActId).then(function (act) {\r\n                    act._updateDescriptors(allStates);\r\n                    var stateWrapped = act.attached.filter(function (u) { return u.ownerId === state.ownerId; })[0];\r\n                    resolve(stateWrapped);\r\n                });\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    ActivityManager.prototype.detachActivities = function (activityId, descriptor, callback) {\r\n        var _this = this;\r\n        var promise = new Promise(function (resolve, reject) {\r\n            return _this._bridge.detachActivities(activityId, descriptor)\r\n                .then(/*(params)*/ function () {\r\n                // #deleteme TODO: deal with this\r\n                var oldActId = undefined; // params.oldActivityId;\r\n                var newActId = undefined; // params.newActivityId;\r\n                var descriptors = undefined; // params.descriptors;\r\n                _this._activities\r\n                    .getOrWait(oldActId)\r\n                    .then(function (oldAct) {\r\n                    oldAct._updateDescriptors(descriptors);\r\n                    _this._activities\r\n                        .getOrWait(newActId)\r\n                        .then(function (newAct) {\r\n                        resolve(newAct);\r\n                    });\r\n                })\r\n                    .catch(function (err) { return reject(err); });\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n        return promiseExtensions_1.nodeify(promise, callback);\r\n    };\r\n    ActivityManager.prototype.subscribeActivitiesAttached = function (callback) {\r\n        this._attachedCallbacks.push(callback);\r\n    };\r\n    ActivityManager.prototype.subscribeActivitiesDetached = function (callback) {\r\n        this._detachedCallbacks.push(callback);\r\n    };\r\n    ActivityManager.prototype.subscribeActivityFrameColorChanged = function (callback) {\r\n        this._frameColorChangesCallbacks.push(callback);\r\n    };\r\n    /** Assigns a manager to a given ActivityEntity */\r\n    ActivityManager.prototype._grabEntity = function (entity) {\r\n        entity._manager = this;\r\n    };\r\n    ActivityManager.prototype._getInitialData = function () {\r\n        var _this = this;\r\n        this._logger.debug(\"Request initial data...\");\r\n        // NB: there's no possibility for duplicate entities from events that have come\r\n        // in between _bridge.init() and _bridge.ready()'s resolve, since the ObservableCollections\r\n        // coalesce items by id.\r\n        this._bridge.getActivityTypes()\r\n            .then(function (at) {\r\n            _this._activityTypes.add(at);\r\n            _this._dataReadyMarker.signal(\"Got act types\");\r\n        })\r\n            .catch(function (error) {\r\n            _this._logger.error(error);\r\n            _this._dataReadyMarker.error(\"Can not initialize ActivityManager - error getting activity types -\" + error);\r\n        });\r\n        this._bridge.getWindowTypes()\r\n            .then(function (wt) {\r\n            _this._windowTypes.add(wt);\r\n            _this._dataReadyMarker.signal(\"Got window types\");\r\n        })\r\n            .catch(function (error) {\r\n            _this._logger.error(error);\r\n            _this._dataReadyMarker.error(\"Can not initialize ActivityManager - error getting window types  \" + error);\r\n        });\r\n        this._bridge.getActivities()\r\n            .then(function (ac) {\r\n            _this._activities.add(ac);\r\n            _this._dataReadyMarker.signal(\"Got activities\");\r\n        })\r\n            .catch(function (error) {\r\n            _this._logger.error(error);\r\n            _this._dataReadyMarker.error(\"Can not initialize ActivityManager - error getting activity instances -\" + error);\r\n        });\r\n        this._bridge.getActivityWindows()\r\n            .then(function (aw) {\r\n            _this._windows.add(aw);\r\n            _this._dataReadyMarker.signal(\"Got windows\");\r\n        })\r\n            .catch(function (error) {\r\n            _this._logger.error(error);\r\n            _this._dataReadyMarker.error(\"Can not initialize ActivityManager - error getting activity windows -\" + error);\r\n        });\r\n    };\r\n    ActivityManager.prototype._subscribeForData = function () {\r\n        var _this = this;\r\n        this._logger.debug(\"Subscribe for data...\");\r\n        // NB: there's no possibility for duplicate entities from events that have come\r\n        // in between _bridge.init() and _bridge.ready()'s resolve, since the ObservableCollections\r\n        // coalesce items by id.\r\n        this._bridge.onActivityTypeStatusChange(function (event) {\r\n            _this._activityTypes.process(event);\r\n        });\r\n        this._bridge.onWindowTypeStatusChange(function (event) {\r\n            _this._windowTypes.process(event);\r\n        });\r\n        this._bridge.onActivityStatusChange(function (event) {\r\n            var activity = _this._activities.process(event);\r\n            if (event.context.type === entityEvent_1.EntityEventType.ActivityWindowJoinedActivity &&\r\n                activity &&\r\n                activity.context &&\r\n                _this._bridge instanceof hcBridge_1.default) {\r\n                // for parity with older code which explicitly sent a context update to subscribers\r\n                // upon joining an activity\r\n                _this._activities.process(new entityEvent_1.EntityEvent(activity, new entityEvent_1.ActivityContextChangedEventContext(activity.context)));\r\n            }\r\n        });\r\n        this._bridge.onActivityWindowChange(function (event) {\r\n            _this._windows.process(event);\r\n        });\r\n    };\r\n    ActivityManager.prototype._handleActivitiesAttached = function (data) {\r\n        var _this = this;\r\n        var newActId = data.to;\r\n        var descriptor = data.descriptor;\r\n        var descriptors = data.descriptors;\r\n        this._activities.getOrWait(newActId).then(function (act) {\r\n            act._updateDescriptors(descriptors);\r\n            var descriptorAsObjectFromAPI = act.attached.filter(function (u) { return u.ownerId === descriptor.ownerId; })[0];\r\n            _this._attachedCallbacks.forEach(function (callback) {\r\n                try {\r\n                    callback(act, descriptorAsObjectFromAPI);\r\n                }\r\n                catch (err) {\r\n                    return;\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ActivityManager.prototype._handleActivitiesDetached = function (data) {\r\n        var _this = this;\r\n        var oldActId = data.oldActivityId;\r\n        var newActId = data.newActivityId;\r\n        var descriptors = data.descriptors;\r\n        var descriptor = data.descriptor;\r\n        this._activities.getOrWait(oldActId).then(function (oldAct) {\r\n            oldAct._updateDescriptors(descriptors);\r\n            _this._activities.getOrWait(newActId).then(function (newAct) {\r\n                _this._detachedCallbacks.forEach(function (callback) {\r\n                    try {\r\n                        callback(newAct, oldAct, descriptor);\r\n                    }\r\n                    catch (err) {\r\n                        return;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    };\r\n    ActivityManager.prototype._handleActivityDescriptorsRefreshed = function (data) {\r\n        var id = data.id;\r\n        var descriptors = data.descriptors;\r\n        var act = this._activities.getByName(id);\r\n        if (act) {\r\n            act._updateDescriptors(descriptors);\r\n        }\r\n    };\r\n    ActivityManager.prototype.refreshDescriptors = function () {\r\n        var _this = this;\r\n        this._bridge.getAttachedDescriptors()\r\n            .then(function (map) {\r\n            // populate descriptors\r\n            if (map) {\r\n                Object.keys(map).forEach(function (key) {\r\n                    var actId = key;\r\n                    var descriptors = map[key];\r\n                    var act = _this._activities.getByName(actId);\r\n                    if (act) {\r\n                        act._updateDescriptors(descriptors);\r\n                    }\r\n                });\r\n            }\r\n            _this._descriptorsMarker.signal(\"Successfully got descriptors\");\r\n        })\r\n            .catch(function (err) {\r\n            _this._descriptorsMarker.error(\"failed to get descriptors - \" + err);\r\n        });\r\n    };\r\n    ActivityManager.prototype._handleWindowFrameColorChanged = function (win) {\r\n        if (!win.activityId) {\r\n            return;\r\n        }\r\n        var act = this._activities.getByName(win.activityId);\r\n        if (!act) {\r\n            return;\r\n        }\r\n        // notify for the owner only\r\n        if (!act.owner) {\r\n            return;\r\n        }\r\n        if (act.owner.underlyingWindow.id !== win.id) {\r\n            return;\r\n        }\r\n        this._frameColorChangesCallbacks.forEach(function (callback) {\r\n            try {\r\n                callback(act, win.frameColor);\r\n            }\r\n            catch (e) {\r\n                return;\r\n            }\r\n        });\r\n    };\r\n    return ActivityManager;\r\n}());\r\nexports.default = ActivityManager;\r\n//# sourceMappingURL=activityManager.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/core/activityManager.js\n// module id = 55\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LocalWindowFactory = /** @class */ (function () {\r\n    function LocalWindowFactory(createFunction) {\r\n        this.createFunction = createFunction;\r\n        this.createFunction = createFunction;\r\n    }\r\n    LocalWindowFactory.prototype.create = function (activityInfo) {\r\n        return this.createFunction(activityInfo);\r\n    };\r\n    return LocalWindowFactory;\r\n}());\r\nexports.LocalWindowFactory = LocalWindowFactory;\r\n//# sourceMappingURL=localWindowFactory.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/core/localWindowFactory.js\n// module id = 56\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AttachedActivityDescriptor = /** @class */ (function () {\r\n    function AttachedActivityDescriptor(manager, ownerActivityId, state) {\r\n        this._manager = manager;\r\n        this._ownerActivityId = ownerActivityId;\r\n        this._state = state;\r\n    }\r\n    Object.defineProperty(AttachedActivityDescriptor.prototype, \"ownerId\", {\r\n        get: function () {\r\n            return this._state.ownerId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AttachedActivityDescriptor.prototype, \"windowIds\", {\r\n        get: function () {\r\n            return this._state.windowIds;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AttachedActivityDescriptor.prototype, \"frameColor\", {\r\n        get: function () {\r\n            return this._state.frameColor;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AttachedActivityDescriptor.prototype, \"context\", {\r\n        get: function () {\r\n            return this._state.context;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AttachedActivityDescriptor.prototype, \"tag\", {\r\n        get: function () {\r\n            return this._state.tag;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    AttachedActivityDescriptor.prototype.detach = function (descriptor) {\r\n        var _this = this;\r\n        descriptor = descriptor || {};\r\n        var merged = {};\r\n        Object.keys(this._state).forEach(function (prop) {\r\n            merged[prop] = _this._state[prop];\r\n        });\r\n        merged.context = descriptor.context || merged.context;\r\n        merged.frameColor = descriptor.frameColor || merged.frameColor;\r\n        return this._manager.detachActivities(this._ownerActivityId, merged);\r\n    };\r\n    return AttachedActivityDescriptor;\r\n}());\r\nexports.AttachedActivityDescriptor = AttachedActivityDescriptor;\r\n//# sourceMappingURL=attachedActivityDescriptor.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/entities/attachedActivityDescriptor.js\n// module id = 57\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar entityEvent_1 = require(\"../contracts/entityEvent\");\r\nvar entityEvent_2 = require(\"..//contracts/entityEvent\");\r\n/**\r\n * Collection of ActivityEntities that provides change notifications\r\n * @module entityCollection\r\n * @private\r\n */\r\nvar EntityObservableCollection = /** @class */ (function () {\r\n    function EntityObservableCollection(processNew) {\r\n        this._items = {};\r\n        this._listeners = [];\r\n        this._processNew = processNew;\r\n    }\r\n    /**\r\n     * Adds one item to the collection\r\n     */\r\n    EntityObservableCollection.prototype.addOne = function (item) {\r\n        this.add([item]);\r\n    };\r\n    /**\r\n     * Adds an array of items to the collection\r\n     */\r\n    EntityObservableCollection.prototype.add = function (items) {\r\n        var _this = this;\r\n        items.forEach(function (element) {\r\n            _this.process(new entityEvent_1.EntityEvent(element, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added)));\r\n        });\r\n    };\r\n    /**\r\n     * Process existing EntityEvent\r\n     */\r\n    EntityObservableCollection.prototype.process = function (event) {\r\n        var context = event.context;\r\n        var type = context.type;\r\n        var entity = event.entity;\r\n        // here we're populating some data which particular implementations (e.g.\r\n        // GW3) can't provide\r\n        // TODO: extract these cases into external filters\r\n        // activity status change without old status?\r\n        // grab it from the existing entity\r\n        if (type === entityEvent_1.EntityEventType.StatusChange &&\r\n            !context.oldStatus) {\r\n            var act = this._items[entity.id];\r\n            if (act) {\r\n                context.oldStatus = act.status;\r\n            }\r\n        }\r\n        // the GW3 bridge notifies us of possible status changes (it's mostly stateless so\r\n        // it can't/doesn't distinguish between JOINED ACTIVITY for an activity we already\r\n        // know about vs a brand new activity. for this reason, we just coalesce status\r\n        // updates which indicate the same state.\r\n        if (type === entityEvent_1.EntityEventType.StatusChange &&\r\n            context.oldStatus &&\r\n            context.newStatus &&\r\n            context.oldStatus.state ===\r\n                context.newStatus.state) {\r\n            context.type = entityEvent_1.EntityEventType.Updated;\r\n        }\r\n        // coalesce multiple joined/left events\r\n        //\r\n        if (type === entityEvent_1.EntityEventType.ActivityWindowJoinedActivity &&\r\n            this._items[entity.id] &&\r\n            this._items[entity.id].activity) {\r\n            context.type = entityEvent_1.EntityEventType.Updated;\r\n        }\r\n        if (type === entityEvent_1.EntityEventType.ActivityWindowLeftActivity &&\r\n            this._items[entity.id] &&\r\n            !this._items[entity.id].activity) {\r\n            context.type = entityEvent_1.EntityEventType.Updated;\r\n        }\r\n        // update internal collections (adding the entity or updating existing entity). From that\r\n        // point start using the internalEntity\r\n        // NB: undefined properties are coalesced, null properties represent removals\r\n        var internalEntity = this._updateInternalCollections(entity, type, context);\r\n        this._notifyListeners(internalEntity, context);\r\n        return internalEntity;\r\n    };\r\n    /**\r\n     * Gets all items from the collection.\r\n     */\r\n    EntityObservableCollection.prototype.get = function () {\r\n        var result = [];\r\n        for (var key in this._items) {\r\n            if (this._items.hasOwnProperty(key)) {\r\n                var element = this._items[key];\r\n                result.push(element);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    /**\r\n     * Gets item by name/id\r\n     * @param name  Name/id of the item to get\r\n     * @returns     Item if found; undefined if not\r\n     */\r\n    EntityObservableCollection.prototype.getByName = function (name) {\r\n        // this does not work for some reason\r\n        // return this._items[name];\r\n        for (var key in this._items) {\r\n            if (key === name) {\r\n                return this._items[key];\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    /**\r\n     * Gets a item if in the collection or waits for it to appear\r\n     * @param name\r\n     * @returns {Promise<T>}\r\n     */\r\n    EntityObservableCollection.prototype.getOrWait = function (name) {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            var entityAddedHandler = function (entity) {\r\n                if (entity.id !== name) {\r\n                    return;\r\n                }\r\n                resolve(entity);\r\n                _this.unsubscribe(entityAddedHandler);\r\n            };\r\n            _this.subscribe(entityAddedHandler);\r\n            // try to get right away - if not here wait for it to appear\r\n            var window = _this.getByName(name);\r\n            if (window) {\r\n                _this.unsubscribe(entityAddedHandler);\r\n                resolve(window);\r\n                return;\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Subscribes a listener for changes\r\n     * @param handler Callback for changes\r\n     */\r\n    EntityObservableCollection.prototype.subscribe = function (handler) {\r\n        var _this = this;\r\n        this._listeners.push(handler);\r\n        // replay existing items for new subscribers\r\n        Object.keys(this._items).forEach(function (key) {\r\n            var element = _this._items[key];\r\n            handler(element, new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added.toString()));\r\n        });\r\n        return function () {\r\n            _this.unsubscribe(handler);\r\n        };\r\n    };\r\n    /**\r\n     *  Unsubscribes a listener\r\n     */\r\n    EntityObservableCollection.prototype.unsubscribe = function (handler) {\r\n        var index = this._listeners.indexOf(handler);\r\n        if (index !== -1) {\r\n            this._listeners.splice(index, 1);\r\n        }\r\n    };\r\n    /**\r\n     * Notify all listeners for some event\r\n     */\r\n    EntityObservableCollection.prototype._notifyListeners = function (entity, context) {\r\n        this._listeners.forEach(function (listener) {\r\n            try {\r\n                listener(entity, context);\r\n            }\r\n            catch (e) {\r\n                return;\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * Update internal collections (usually after some kind of modification event has arrived)\r\n     */\r\n    EntityObservableCollection.prototype._updateInternalCollections = function (entity, type, context) {\r\n        var entityAsAny = entity;\r\n        // #deleteme TODO: refactor - currently we apply some rules for each type\r\n        var isActivityDestroy = (type === entityEvent_1.EntityEventType.StatusChange &&\r\n            entityAsAny.status &&\r\n            entityAsAny.status.state === entityEvent_2.ActivityState.Destroyed) ||\r\n            (type === entityEvent_1.EntityEventType.StatusChange &&\r\n                context &&\r\n                context.newStatus &&\r\n                context.newStatus.state === entityEvent_2.ActivityState.Destroyed);\r\n        // #deleteme TODO: verify this stuff\r\n        // windows have two states - removed from activity and closed (TODO: this only works in GD 2.1 and later)\r\n        var isWindowClose = type === entityEvent_1.EntityEventType.Closed;\r\n        var isTypeRemove = type === entityEvent_1.EntityEventType.Removed && typeof entityAsAny.isIndependent === \"undefined\";\r\n        if (isTypeRemove || isWindowClose || isActivityDestroy) {\r\n            var oldEntity = this._items[entity.id];\r\n            delete this._items[entity.id];\r\n            // on remove return the input entity\r\n            this._processNew(entity);\r\n            if (oldEntity) {\r\n                entity._beforeDelete(oldEntity);\r\n            }\r\n            return entity;\r\n        }\r\n        else {\r\n            var key = entity.id;\r\n            // if new object add, otherwise clone object properties\r\n            if (!this._items.hasOwnProperty(key)) {\r\n                this._processNew(entity);\r\n                this._items[entity.id] = entity;\r\n            }\r\n            else {\r\n                this._items[entity.id]._update(entity);\r\n            }\r\n        }\r\n        return this._items[entity.id];\r\n    };\r\n    return EntityObservableCollection;\r\n}());\r\nexports.EntityObservableCollection = EntityObservableCollection;\r\n//# sourceMappingURL=entityObservableCollection.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/helpers/entityObservableCollection.js\n// module id = 58\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar activityModule_1 = require(\"./activityModule\");\r\nexports.ActivityModule = activityModule_1.ActivityModule;\r\n//# sourceMappingURL=main.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/activity/main.js\n// module id = 59\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar application_1 = require(\"./application\");\r\nvar callback_registry_1 = require(\"callback-registry\");\r\nvar instance_1 = require(\"./instance\");\r\nvar AppManagerImpl = /** @class */ (function () {\r\n    function AppManagerImpl(_agm, _activities, _windows, _logger, _gdMajorVersion) {\r\n        var _this = this;\r\n        this._agm = _agm;\r\n        this._activities = _activities;\r\n        this._windows = _windows;\r\n        this._logger = _logger;\r\n        this._gdMajorVersion = _gdMajorVersion;\r\n        this._apps = {};\r\n        this._instances = [];\r\n        this._registry = callback_registry_1.default();\r\n        this.application = function (name) {\r\n            return _this._apps[name];\r\n        };\r\n        this.applications = function () {\r\n            return Object.keys(_this._apps).map(function (k) { return _this._apps[k]; });\r\n        };\r\n        this.instances = function () {\r\n            return _this._instances;\r\n        };\r\n        this.getMyInstance = function () {\r\n            if (_this._gdMajorVersion >= 3) {\r\n                // GD3 check\r\n                var instanceId_1 = window.glue42gd.appInstanceId;\r\n                return _this._instances.filter(function (i) { return i.id === instanceId_1; })[0];\r\n            }\r\n            if (_this._gdMajorVersion === 2) {\r\n                var myWindowId_1 = window.htmlContainer.windowId;\r\n                var matchingInstances = _this._instances.filter(function (i) { return i.id === myWindowId_1; });\r\n                if (matchingInstances.length < 2) {\r\n                    return matchingInstances[0];\r\n                }\r\n                // If we have two matches - this can happen only when asking for the window\r\n                // of activity owner - so return the instance that is not activity instance\r\n                return matchingInstances.filter(function (i) { return !i.isActivityInstance; })[0];\r\n            }\r\n            return undefined;\r\n        };\r\n        this.handleAppAdded = function (props) {\r\n            var id = _this._getAppId(props);\r\n            _this._logger.trace(\"adding app \" + id);\r\n            _this._apps[id] = new application_1.default(_this, id, _this._agm);\r\n            var app = _this._updateAppFromProps(props);\r\n            _this._registry.execute(\"appAdded\", app);\r\n        };\r\n        this.handleAppUpdated = function (props) {\r\n            // TODO: check side effects, is this._apps updated?\r\n            var app = _this._updateAppFromProps(props);\r\n            _this._registry.execute(\"appChanged\", app);\r\n        };\r\n        this.handleAppRemoved = function (props) {\r\n            var id = _this._getAppId(props);\r\n            _this._logger.trace(\"removing app \" + id);\r\n            var app = _this.application(id);\r\n            // remove all instances related to the app\r\n            _this._instances = _this._instances.filter(function (i) { return i.application.name !== app.name; });\r\n            delete _this._apps[id];\r\n            _this._registry.execute(\"appRemoved\", app);\r\n        };\r\n        this.handleAppReady = function (props) {\r\n            var id = _this._getAppId(props);\r\n            var app = _this._getAppOrThrow(id);\r\n            app.updateFromProps(props);\r\n            if (app.available) {\r\n                _this._registry.execute(\"appAvailable\", app);\r\n            }\r\n            else {\r\n                _this._registry.execute(\"appUnavailable\", app);\r\n            }\r\n        };\r\n        this.handleInstanceStarted = function (props) {\r\n            _this._logger.trace(\"started app \" + props.Name + \" \" + props.Id);\r\n            var id = _this._getInstanceId(props);\r\n            var app = _this.application(_this._getInstanceAppName(props));\r\n            var instance = new instance_1.default(id, app, _this, _this._agm, _this._activities, _this._windows);\r\n            _this._updateInstanceFromProps(instance, props);\r\n            _this._instances.push(instance);\r\n            _this._registry.execute(\"instanceStarted\", instance);\r\n        };\r\n        this.handleInstanceStopped = function (props) {\r\n            _this._logger.trace(\"failed to start app \" + props.Name + \" \" + props.Id);\r\n            var id = _this._getInstanceId(props);\r\n            var appName = _this._getInstanceAppName(props);\r\n            var instance = _this._getInstanceOrThrow(id, appName);\r\n            _this._instances = _this._instances.filter(function (i) { return !_this._matchInstance(i, id, appName); });\r\n            _this._registry.execute(\"instanceStopped\", instance);\r\n            instance.done();\r\n        };\r\n        this.handleInstanceAgmServerReady = function (props) {\r\n            var id = _this._getInstanceId(props);\r\n            var appName = _this._getInstanceAppName(props);\r\n            var instance = _this._getInstanceOrThrow(id, appName);\r\n            instance.updateAgmInstanceFromProps(props);\r\n            _this._registry.execute(\"instanceAgmServerReady\", instance);\r\n        };\r\n        this.handleInstanceStartFailed = function (props) {\r\n            var id = _this._getInstanceId(props);\r\n            var app = _this.application(_this._getInstanceAppName(props));\r\n            var startFailed = true;\r\n            var instance = new instance_1.default(id, app, undefined, undefined, undefined, undefined, startFailed);\r\n            _this._updateInstanceFromProps(instance, props);\r\n            _this._registry.execute(\"instanceStartFailed\", instance);\r\n        };\r\n        this.handleInstanceUpdated = function (props) {\r\n            var id = _this._getInstanceId(props);\r\n            var app = _this._getInstanceAppName(props);\r\n            var instance = _this._getInstanceOrThrow(id, app);\r\n            _this._updateInstanceFromProps(instance, props);\r\n        };\r\n        /** Event subscription methods */\r\n        this.onInstanceStarted = function (callback) {\r\n            _this._replay(_this._instances, callback);\r\n            return _this._registry.add(\"instanceStarted\", callback);\r\n        };\r\n        this.onInstanceStartFailed = function (callback) {\r\n            return _this._registry.add(\"instanceStartFailed\", callback);\r\n        };\r\n        this.onInstanceStopped = function (callback) {\r\n            return _this._registry.add(\"instanceStopped\", callback);\r\n        };\r\n        this.onInstanceUpdated = function (callback) {\r\n            return _this._registry.add(\"instanceChanged\", callback);\r\n        };\r\n        this.onInstanceAgmServerReady = function (callback) {\r\n            return _this._registry.add(\"instanceAgmServerReady\", callback);\r\n        };\r\n        this.onAppAdded = function (callback) {\r\n            _this._replay(_this._apps, callback);\r\n            return _this._registry.add(\"appAdded\", callback);\r\n        };\r\n        this.onAppRemoved = function (callback) {\r\n            return _this._registry.add(\"appRemoved\", callback);\r\n        };\r\n        this.onAppAvailable = function (callback) {\r\n            return _this._registry.add(\"appAvailable\", callback);\r\n        };\r\n        this.onAppUnavailable = function (callback) {\r\n            return _this._registry.add(\"appUnavailable\", callback);\r\n        };\r\n        this.onAppChanged = function (callback) {\r\n            return _this._registry.add(\"appChanged\", callback);\r\n        };\r\n        //\r\n    }\r\n    AppManagerImpl.prototype._getAppOrThrow = function (id) {\r\n        var result = this.application(id);\r\n        if (!result) {\r\n            throw Error(\"app with id \" + id + \" not found\");\r\n        }\r\n        return result;\r\n    };\r\n    AppManagerImpl.prototype._getAppId = function (props) {\r\n        return props.Name;\r\n    };\r\n    AppManagerImpl.prototype._matchInstance = function (instance, id, appName) {\r\n        return instance.id === id && instance.application.name === appName;\r\n    };\r\n    AppManagerImpl.prototype._getInstanceByIdAndName = function (id, appName) {\r\n        var _this = this;\r\n        return this._instances.filter(function (i) { return _this._matchInstance(i, id, appName); })[0];\r\n    };\r\n    AppManagerImpl.prototype._getInstanceOrThrow = function (id, appName) {\r\n        var result = this._getInstanceByIdAndName(id, appName);\r\n        if (!result) {\r\n            throw Error(\"instance with id \" + id + \" not found\");\r\n        }\r\n        return result;\r\n    };\r\n    AppManagerImpl.prototype._getInstanceId = function (props) {\r\n        return props.Id;\r\n    };\r\n    AppManagerImpl.prototype._getInstanceAppName = function (props) {\r\n        return props.Name;\r\n    };\r\n    AppManagerImpl.prototype._updateAppFromProps = function (props) {\r\n        var id = this._getAppId(props);\r\n        this._logger.trace(\"updating app with  + \" + id + \", \" + props);\r\n        var app = this._getAppOrThrow(id);\r\n        app.updateFromProps(props);\r\n        return app;\r\n    };\r\n    AppManagerImpl.prototype._updateInstanceFromProps = function (instance, props) {\r\n        this._logger.trace(\"updating instance with \" + this._getInstanceId(props) + \" for app \" + this._getInstanceAppName(props));\r\n        instance.updateFromProps(props);\r\n    };\r\n    AppManagerImpl.prototype._replay = function (itemsToReplay, callback) {\r\n        if (itemsToReplay) {\r\n            // if not array transform to array using Object.values\r\n            if (Array.isArray(itemsToReplay)) {\r\n                itemsToReplay.forEach(function (item) { return callback(item); });\r\n            }\r\n            else {\r\n                var itemsToReplayArr = Object.keys(itemsToReplay).map(function (key) { return itemsToReplay[key]; });\r\n                itemsToReplayArr.forEach(function (item) { return callback(item); });\r\n            }\r\n        }\r\n    };\r\n    return AppManagerImpl;\r\n}());\r\nexports.default = AppManagerImpl;\r\n//# sourceMappingURL=app-manager.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/app-manager/app-manager.js\n// module id = 60\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AgmNames = require(\"./const/agm-names\");\r\nvar callback_registry_1 = require(\"callback-registry\");\r\nvar helper_1 = require(\"./helper\");\r\nvar ApplicationImpl = /** @class */ (function () {\r\n    function ApplicationImpl(_appManager, _name, _agm) {\r\n        // TODO: Replace string events with constants. The string declaration of the registry event name should only ever appear once. Ever. Period.\r\n        var _this = this;\r\n        this._appManager = _appManager;\r\n        this._name = _name;\r\n        this._agm = _agm;\r\n        this._registry = callback_registry_1.default();\r\n        // subscribe for events from app-manager\r\n        _appManager.onInstanceStarted(function (instance) {\r\n            if (instance.application.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"instanceStarted\", instance);\r\n        });\r\n        _appManager.onInstanceStopped(function (instance) {\r\n            if (instance.application.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"instanceStopped\", instance);\r\n        });\r\n        _appManager.onAppRemoved(function (app) {\r\n            if (app.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"appRemoved\", app);\r\n        });\r\n        _appManager.onAppChanged(function (app) {\r\n            if (app.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"appChanged\", app);\r\n        });\r\n        _appManager.onAppAvailable(function (app) {\r\n            if (app.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"appAvailable\", app);\r\n        });\r\n        _appManager.onAppUnavailable(function (app) {\r\n            if (app.name !== _this._name) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"appUnavailable\", app);\r\n        });\r\n    }\r\n    Object.defineProperty(ApplicationImpl.prototype, \"name\", {\r\n        get: function () { return this._name; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"title\", {\r\n        get: function () { return this._props.Title; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"version\", {\r\n        get: function () { return this._props.Version; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"autoStart\", {\r\n        get: function () { return this._props.AutoStart; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"isShell\", {\r\n        get: function () { return this._props.IsShell; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"caption\", {\r\n        get: function () { return this._props.Caption; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"hidden\", {\r\n        get: function () { return this._props.IsHidden; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"container\", {\r\n        get: function () { return this._props.ApplicationName; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"activityType\", {\r\n        get: function () { return this._props.ActivityType; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"activityWindowType\", {\r\n        get: function () { return this._props.ActivityWindowType; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"windowSettings\", {\r\n        get: function () {\r\n            if (!this._props.Arguments) {\r\n                return {};\r\n            }\r\n            return helper_1.objectClone(this._props.Arguments);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"allowMultiple\", {\r\n        get: function () { return this._props.AllowMultiple; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"available\", {\r\n        get: function () { return this._props.IsReady || false; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"icon\", {\r\n        get: function () { return this._props.Icon; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"iconURL\", {\r\n        get: function () { return this._props.IconUrl; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"sortOrder\", {\r\n        get: function () { return this._props.SortOrder; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"userProperties\", {\r\n        get: function () {\r\n            if (!this._props.UserProperties) {\r\n                return {};\r\n            }\r\n            return helper_1.objectClone(this._props.UserProperties);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"isActivity\", {\r\n        get: function () {\r\n            return this._props.ActivityType !== undefined && this._props.ActivityType !== \"\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"configuration\", {\r\n        get: function () {\r\n            return {\r\n                autoStart: this._props.AutoStart,\r\n                caption: this._props.Caption,\r\n                hidden: this._props.IsHidden,\r\n                container: this._props.ApplicationName,\r\n                activityType: this._props.ActivityType,\r\n                allowMultiple: this._props.AllowMultiple\r\n            };\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"instances\", {\r\n        get: function () {\r\n            var _this = this;\r\n            return this._appManager.instances().filter(function (instance) { return instance.application.name === _this._name; });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"type\", {\r\n        get: function () {\r\n            return this._props.Type;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ApplicationImpl.prototype, \"mode\", {\r\n        get: function () {\r\n            if (!this._props) {\r\n                // no info about the app\r\n                return \"unknown\";\r\n            }\r\n            // GD3 - we always have Mode from the stream object\r\n            if (this._props.Mode && typeof this._props.Mode === \"string\") {\r\n                return this._props.Mode.toLowerCase();\r\n            }\r\n            // GD2\r\n            // return unknown for activity applications\r\n            if (this.isActivity) {\r\n                return \"unknown\";\r\n            }\r\n            // check definition -> hc.args.mode\r\n            if (this._props.Arguments && this._props.Arguments.mode && typeof this._props.Arguments.mode === \"string\") {\r\n                return this._props.Arguments.mode.toLowerCase();\r\n            }\r\n            // if no hc.args.mode, check hc.WindowStyleAttributes\r\n            var styleAttributes = this._props.WindowStyleAttributes;\r\n            if (styleAttributes) {\r\n                // WindowStyleAttributes is not a valid JSON, we will need to find mode in the string\r\n                styleAttributes = styleAttributes.split(\" \").join(\"\");\r\n                var searchFor = \"mode:\\\"\";\r\n                var modeIndex = styleAttributes.indexOf(searchFor);\r\n                if (modeIndex !== -1) {\r\n                    var startModeIndex = modeIndex + searchFor.length;\r\n                    var stopModeIndex = styleAttributes.indexOf(\"\\\"\", startModeIndex);\r\n                    var style = styleAttributes.substr(startModeIndex, stopModeIndex - startModeIndex);\r\n                    if (style && typeof style === \"string\") {\r\n                        return style.toLowerCase();\r\n                    }\r\n                }\r\n            }\r\n            // default mode for GD2\r\n            return \"flat\";\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ApplicationImpl.prototype.updateFromProps = function (props) {\r\n        var _this = this;\r\n        if (!this._props) {\r\n            this._props = { Name: props.Name };\r\n        }\r\n        Object.keys(props).forEach(function (key) {\r\n            _this._props[key] = props[key];\r\n        });\r\n    };\r\n    ApplicationImpl.prototype.start = function (context, options) {\r\n        var _this = this;\r\n        var name = this._name;\r\n        var startTimeout = 10000;\r\n        return new Promise(function (resolve, reject) {\r\n            options = options || {};\r\n            context = context || {};\r\n            context._t42 = { createWindowArgs: options };\r\n            if (typeof options.waitForAGMReady === \"undefined\") {\r\n                options.waitForAGMReady = true;\r\n            }\r\n            var waitForAGMInstance = options.waitForAGMReady;\r\n            var waitForInstance = !options.waitForAGMReady;\r\n            var waitForApplicationInstance = function (id) {\r\n                // fetch from the current list in app-manager\r\n                var check = function () {\r\n                    var filtered = _this._appManager.instances().filter(function (i) { return i.id === id; });\r\n                    var result;\r\n                    if (filtered.length === 2) {\r\n                        result = filtered[0].isActivityInstance ? filtered[0] : filtered[1];\r\n                    }\r\n                    result = filtered[0];\r\n                    if (result && waitForAGMInstance) {\r\n                        if (result.agm) {\r\n                            return result;\r\n                        }\r\n                        else {\r\n                            return undefined;\r\n                        }\r\n                    }\r\n                    return result;\r\n                };\r\n                var unsub;\r\n                // reject after some timeout\r\n                setTimeout(function () {\r\n                    if (unsub) {\r\n                        unsub();\r\n                        reject(\"timeout\");\r\n                    }\r\n                }, startTimeout);\r\n                var waitFunc = function (i) {\r\n                    if (i.id !== id) {\r\n                        return;\r\n                    }\r\n                    if (unsub) {\r\n                        unsub();\r\n                        unsub = undefined;\r\n                    }\r\n                    // schedule - we need this because there might be more than one\r\n                    // instance with the same id (activity case) - so this handler\r\n                    // will kick for the very first\r\n                    setTimeout(function () {\r\n                        resolve(check());\r\n                    }, 1);\r\n                };\r\n                if (waitForAGMInstance) {\r\n                    unsub = _this._appManager.onInstanceAgmServerReady(waitFunc);\r\n                }\r\n                else {\r\n                    // if not there subscribe for instance events\r\n                    unsub = _this._appManager.onInstanceStarted(waitFunc);\r\n                }\r\n                // try to find it in the current list\r\n                var instances = check();\r\n                if (instances) {\r\n                    unsub = undefined;\r\n                    resolve(instances);\r\n                }\r\n            };\r\n            _this._agm.invoke(AgmNames.StartApplicationMethodName, {\r\n                Name: name,\r\n                Context: context,\r\n                WaitForAgmInstance: waitForAGMInstance,\r\n                WaitForInstance: waitForInstance\r\n            }, \"best\", {\r\n                methodResponseTimeoutMs: startTimeout\r\n            }, function (result) {\r\n                var acsResult = result.returned.Instance_0 || result.returned;\r\n                if (acsResult && acsResult.Id) {\r\n                    // we received instance from ACS, let's wait until it appears on the stream\r\n                    waitForApplicationInstance(acsResult.Id);\r\n                }\r\n                else {\r\n                    // we haven't received instance from ACS - this might happen if the app does not\r\n                    // support tracking instances (e.g. we start internet explorer with some url)\r\n                    resolve(undefined);\r\n                }\r\n            }, function (err) {\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n    ApplicationImpl.prototype.onInstanceStarted = function (callback) {\r\n        this._registry.add(\"instanceStarted\", callback);\r\n    };\r\n    ApplicationImpl.prototype.onInstanceStopped = function (callback) {\r\n        this._registry.add(\"instanceStopped\", callback);\r\n    };\r\n    ApplicationImpl.prototype.onAvailable = function (callback) {\r\n        this._registry.add(\"appAvailable\", callback);\r\n    };\r\n    ApplicationImpl.prototype.onUnavailable = function (callback) {\r\n        this._registry.add(\"appUnavailable\", callback);\r\n    };\r\n    ApplicationImpl.prototype.onChanged = function (callback) {\r\n        this._registry.add(\"appChanged\", callback);\r\n    };\r\n    ApplicationImpl.prototype.onRemoved = function (callback) {\r\n        this._registry.add(\"appRemoved\", callback);\r\n    };\r\n    return ApplicationImpl;\r\n}());\r\nexports.default = ApplicationImpl;\r\n//# sourceMappingURL=application.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/app-manager/application.js\n// module id = 61\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.OnNotificationEvent = \"OnNotification\";\r\nexports.OnBranchChangedEvent = \"OnBranchChanged\";\r\nexports.OnBranchesModifiedEvent = \"OnBranchesModified\";\r\nexports.OnApplicationAddedEvent = \"OnApplicationAdded\";\r\nexports.OnApplicationRemovedEvent = \"OnApplicationRemoved\";\r\nexports.OnApplicationChangedEvent = \"OnApplicationChanged\";\r\nexports.OnApplicationReadyEvent = \"OnApplicationReady\";\r\nexports.OnApplicationStartedEvent = \"OnApplicationStarted\";\r\nexports.OnApplicationRegisteredEvent = \"OnApplicationRegistered\";\r\nexports.OnApplicationAgmServerReadyEvent = \"OnApplicationAgmServerReady\";\r\nexports.OnApplicationUpdatedEvent = \"OnApplicationUpdated\";\r\nexports.OnApplicationStoppedEvent = \"OnApplicationStopped\";\r\nexports.OnApplicationStartFailedEvent = \"OnApplicationStartFailed\";\r\n//# sourceMappingURL=event-names.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/app-manager/const/event-names.js\n// module id = 62\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AgmNames = require(\"./const/agm-names\");\r\nvar EventNames = require(\"./const/event-names\");\r\nvar helper_1 = require(\"./helper\");\r\n/** Subscribe for the AGM stream published by ACS and distributes events to applications and instances components */\r\nfunction createDataSubscription(agm, applications, entitlements, skipIcons) {\r\n    var subscription;\r\n    var start = function () {\r\n        var resolveFunc;\r\n        var rejectFunc;\r\n        var resultPromise = new Promise(function (resolve, reject) {\r\n            resolveFunc = resolve;\r\n            rejectFunc = reject;\r\n        });\r\n        agm.subscribe(AgmNames.OnEventMethodName, { arguments: { skipIcon: skipIcons }, waitTimeoutMs: 10000 })\r\n            .then(function (s) {\r\n            subscription = s;\r\n            subscription.onData(function (streamData) {\r\n                var events = streamData.data;\r\n                helper_1.objectValues(events[EventNames.OnApplicationAddedEvent])\r\n                    .map(function (item) { return applications.handleAppAdded(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationChangedEvent])\r\n                    .map(function (item) { return applications.handleAppUpdated(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationRemovedEvent])\r\n                    .map(function (item) { return applications.handleAppRemoved(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationReadyEvent])\r\n                    .map(function (item) { return applications.handleAppReady(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationStartedEvent])\r\n                    .map(function (item) { return applications.handleInstanceStarted(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationStartFailedEvent])\r\n                    .map(function (item) { return applications.handleInstanceStartFailed(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationStoppedEvent])\r\n                    .map(function (item) { return applications.handleInstanceStopped(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationUpdatedEvent])\r\n                    .map(function (item) { return applications.handleInstanceUpdated(item); });\r\n                helper_1.objectValues(events[EventNames.OnApplicationAgmServerReadyEvent])\r\n                    .map(function (item) { return applications.handleInstanceAgmServerReady(item); });\r\n                helper_1.objectValues(events[EventNames.OnBranchChangedEvent])\r\n                    .map(function (item) { return entitlements.handleBranchModified(item); });\r\n                helper_1.objectValues(events[EventNames.OnBranchesModifiedEvent])\r\n                    .map(function (item) { return entitlements.handleBranchesModified(item); });\r\n                resolveFunc();\r\n            });\r\n            subscription.onFailed(function (err) { return rejectFunc(err); });\r\n        })\r\n            .catch(function (err) { return rejectFunc(\"Error subscribing for \" + AgmNames.OnEventMethodName + \" stream. Err: \" + err); });\r\n        return resultPromise;\r\n    };\r\n    var stop = function () {\r\n        if (subscription) {\r\n            subscription.close();\r\n        }\r\n    };\r\n    return {\r\n        start: start,\r\n        stop: stop\r\n    };\r\n}\r\nexports.default = createDataSubscription;\r\n//# sourceMappingURL=data-subscription.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/app-manager/data-subscription.js\n// module id = 63\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AgmNames = require(\"./const/agm-names\");\r\nvar callback_registry_1 = require(\"callback-registry\");\r\nvar promisify = require(\"tick42-promisify\");\r\nvar EntitlementsImpl = /** @class */ (function () {\r\n    function EntitlementsImpl(_agm) {\r\n        var _this = this;\r\n        this._agm = _agm;\r\n        this._registry = callback_registry_1.default();\r\n        this.handleBranchModified = function (branch) {\r\n            _this._registry.execute(\"branchChanged\", branch);\r\n        };\r\n        this.handleBranchesModified = function (branches) {\r\n            _this._registry.execute(\"branchesChanged\", branches);\r\n        };\r\n        this.getRegion = function (success, error) {\r\n            return promisify(_this._agmInvoke(AgmNames.GetConfigurationRegionMethodName, function (e) { return e.returned.Region; }), success, error);\r\n        };\r\n        this.getBranches = function (success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.GetBranchesMethodName, function (e) {\r\n                var obj = e.returned.Branches;\r\n                return Object.keys(obj).map(function (key) { return obj[key]; });\r\n            });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.getCurrentBranch = function (success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.GetCurrentBranchMethodName, function (e) { return e.returned.Branch; }, undefined);\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.setRegion = function (region, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.SetConfigurationRegionMethodName, function (e) { return e.returned.ResultMessage; }, { Region: region });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.setCurrentBranch = function (branch, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.SetCurrentBranchMethodName, function (e) { return e.returned.ResultMessage; }, { Branch: branch });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.currentUser = function (success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.GetUserMethodName);\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.getFunctionalEntitlement = function (funct, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.GetFunctionalEntitlementMethodName, function (e) { return e.returned.Entitlement; }, { Function: funct });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.getFunctionalEntitlementBranch = function (funct, branch, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.GetFunctionalEntitlementMethodName, function (e) { return e.returned.Entitlement; }, { Function: funct, Branch: branch });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.canI = function (func, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.CanIMethodName, function (e) { return e.returned.Result; }, { Function: func });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.canIBranch = function (func, branch, success, error) {\r\n            var promise = _this._agmInvoke(AgmNames.CanIMethodName, function (e) { return e.returned.Result; }, { Function: func, Branch: branch });\r\n            return promisify(promise, success, error);\r\n        };\r\n        this.onBranchesChanged = function (callback) {\r\n            _this._registry.add(\"branchesChanged\", callback);\r\n        };\r\n        this.onBranchChanged = function (callback) {\r\n            _this._registry.add(\"branchChanged\", callback);\r\n        };\r\n        this.exit = function (options) {\r\n            return _this._agmInvoke(AgmNames.ShutdownMethodName, null, options);\r\n        };\r\n        this._agmInvoke = function (method, transformFunction, args) {\r\n            args = args || {};\r\n            return new Promise(function (resolve, reject) {\r\n                var errHandler = function (error) { return reject(error); };\r\n                _this._agm.invoke(method, args)\r\n                    .then(function (result) {\r\n                    if (!transformFunction) {\r\n                        transformFunction = function (d) { return d.returned; };\r\n                    }\r\n                    resolve(transformFunction(result));\r\n                })\r\n                    .catch(errHandler);\r\n            });\r\n        };\r\n        //\r\n    }\r\n    return EntitlementsImpl;\r\n}());\r\nexports.default = EntitlementsImpl;\r\n//# sourceMappingURL=entitlements.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/app-manager/entitlements.js\n// module id = 64\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AgmNames = require(\"./const/agm-names\");\r\nvar callback_registry_1 = require(\"callback-registry\");\r\nvar InstanceImpl = /** @class */ (function () {\r\n    function InstanceImpl(_id, _app, _appManager, _agm, _activities, _windows, startFailed) {\r\n        var _this = this;\r\n        this._id = _id;\r\n        this._app = _app;\r\n        this._appManager = _appManager;\r\n        this._agm = _agm;\r\n        this._activities = _activities;\r\n        this._windows = _windows;\r\n        this.onAgmReady = this._addToRegistry(\"agmReady\");\r\n        this.onStopped = this._addToRegistry(\"stopped\");\r\n        this._registry = callback_registry_1.default();\r\n        if (startFailed) {\r\n            return;\r\n        }\r\n        this._unsubscribeInstanceStopped = this._appManager.onInstanceStopped(function (instance) {\r\n            if (instance.id !== _this._id) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"stopped\", instance);\r\n        });\r\n        this._unsubscribeInstanceAgmServerReady = this._appManager.onInstanceAgmServerReady(function (instance) {\r\n            if (instance.id !== _this._id) {\r\n                return;\r\n            }\r\n            _this._registry.execute(\"agmReady\", instance);\r\n        });\r\n    }\r\n    Object.defineProperty(InstanceImpl.prototype, \"id\", {\r\n        get: function () { return this._id; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"application\", {\r\n        get: function () { return this._app; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"activity\", {\r\n        get: function () {\r\n            var _this = this;\r\n            if (!this._activities) {\r\n                throw new Error(\"This method requires glue.activities library to be enabled.\");\r\n            }\r\n            return this._activities.all.instances.get()\r\n                .filter(function (activityInstance) { return activityInstance.id === _this._activityId; })[0];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"activityInstances\", {\r\n        get: function () {\r\n            var _this = this;\r\n            return this._appManager.instances()\r\n                .filter(function (i) { return i.context && (i.context.activityId === _this._activityId); });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"activityOwnerInstance\", {\r\n        get: function () {\r\n            return this._appManager.instances()\r\n                .filter(function (instance) {\r\n                if (instance.window && instance.window.context) {\r\n                    var instWinCntx = instance.window.context;\r\n                    if (instWinCntx._t42 && instWinCntx._t42.activityIsOwner) {\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            })[0];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"window\", {\r\n        get: function () {\r\n            var _this = this;\r\n            if (!this._windows) {\r\n                throw new Error(\"This method requires glue.windows library to be enabled.\");\r\n            }\r\n            var win = this._windows.list().filter(function (w) { return w.id === _this._id; })[0];\r\n            if (!win && this.activity && this.activityOwnerInstance) {\r\n                // This is covering GD3 activity instance\r\n                win = this.activityOwnerInstance.window;\r\n            }\r\n            return win;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"context\", {\r\n        get: function () { return this._startUpContext; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"title\", {\r\n        get: function () { return this._title; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"isActivityInstance\", {\r\n        get: function () { return this._isActivityInstance; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"activityId\", {\r\n        get: function () { return this._activityId; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"inActivity\", {\r\n        get: function () { return this._inActivity; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"isSingleWindowApp\", {\r\n        get: function () { return !this._inActivity; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(InstanceImpl.prototype, \"agm\", {\r\n        get: function () {\r\n            return this._agmInstance;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    InstanceImpl.prototype.updateFromProps = function (props) {\r\n        this._startUpContext = props.Context;\r\n        this._title = props.Title;\r\n        this._isActivityInstance = false;\r\n        if (props.ActivityId && props.ActivityId !== \"\") {\r\n            this._activityId = props.ActivityId;\r\n            this._isActivityInstance = true;\r\n        }\r\n        if (!this._activityId && this._startUpContext && this._startUpContext.activityId) {\r\n            this._activityId = this._startUpContext.activityId;\r\n        }\r\n        this._inActivity = Boolean(this._activityId);\r\n        this.updateAgmInstanceFromProps(props);\r\n    };\r\n    InstanceImpl.prototype.updateAgmInstanceFromProps = function (props) {\r\n        if (!props.AgmServers) {\r\n            return;\r\n        }\r\n        if (props.GD3) {\r\n            var agmInstances = props.AgmServers;\r\n            if (agmInstances) {\r\n                this._agmInstance = agmInstances[0];\r\n            }\r\n        }\r\n        else {\r\n            var gdAgmServers = props.AgmServers;\r\n            var propsAgmServer = Object.keys(gdAgmServers)[0];\r\n            if (!propsAgmServer) {\r\n                return;\r\n            }\r\n            var propsAgm = gdAgmServers[propsAgmServer];\r\n            this._agmInstance = {\r\n                machine: propsAgm.machineName,\r\n                user: propsAgm.userName,\r\n                environment: propsAgm.environment,\r\n                application: propsAgm.applicationName,\r\n            };\r\n        }\r\n    };\r\n    InstanceImpl.prototype.stop = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var unsubscribe = _this._appManager.onInstanceStopped(function (instance) {\r\n                if (instance.id === _this._id) {\r\n                    unsubscribe();\r\n                    resolve();\r\n                }\r\n            });\r\n            _this._agm.invoke(AgmNames.StopApplicationMethodName, {\r\n                Name: _this._app.name,\r\n                Id: _this._id\r\n            })\r\n                .catch(function (err) { return reject(err); });\r\n        });\r\n    };\r\n    InstanceImpl.prototype.activate = function () {\r\n        return this._agm.invoke(AgmNames.ActivateApplicationMethodName, { Name: this._app.name, Id: this._id });\r\n    };\r\n    InstanceImpl.prototype.done = function () {\r\n        // remove all handlers\r\n        this._registry.clear();\r\n        // remove subscriptions\r\n        this._unsubscribeInstanceAgmServerReady();\r\n        this._unsubscribeInstanceStopped();\r\n    };\r\n    InstanceImpl.prototype._addToRegistry = function (key) {\r\n        var _this = this;\r\n        return function (callback) {\r\n            _this._registry.add(key, callback);\r\n        };\r\n    };\r\n    return InstanceImpl;\r\n}());\r\nexports.default = InstanceImpl;\r\n//# sourceMappingURL=instance.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/app-manager/instance.js\n// module id = 65\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar app_manager_1 = require(\"./app-manager\");\r\nvar entitlements_1 = require(\"./entitlements\");\r\nvar snapshot_1 = require(\"./snapshot\");\r\nvar data_subscription_1 = require(\"./data-subscription\");\r\nexports.default = (function (config) {\r\n    if (!config) {\r\n        throw Error(\"config not set\");\r\n    }\r\n    if (!config.agm) {\r\n        throw Error(\"config.agm is missing\");\r\n    }\r\n    var START_ONLY = \"startOnly\";\r\n    var SKIP_ICONS = \"skipIcons\";\r\n    var FULL = \"full\";\r\n    var mode = config.mode || START_ONLY;\r\n    if (mode !== START_ONLY && mode !== SKIP_ICONS && mode !== FULL) {\r\n        throw new Error(\"Invalid mode for appManager lib - \" + mode + \" is not supported\");\r\n    }\r\n    var activities = config.activities;\r\n    var agm = config.agm;\r\n    var logger = config.logger;\r\n    var windows = config.windows;\r\n    var appManager = new app_manager_1.default(agm, activities, windows, logger.subLogger(\"applications\"), config.gdMajorVersion);\r\n    var entitlements = new entitlements_1.default(agm);\r\n    var readyPromise;\r\n    if (mode === START_ONLY) {\r\n        readyPromise = snapshot_1.default(agm, appManager);\r\n    }\r\n    else {\r\n        var subscription = data_subscription_1.default(agm, appManager, entitlements, mode === SKIP_ICONS);\r\n        readyPromise = subscription.start();\r\n    }\r\n    var api = {\r\n        ready: function () { return readyPromise; },\r\n        applications: appManager.applications,\r\n        application: appManager.application,\r\n        onAppAdded: appManager.onAppAdded,\r\n        onAppRemoved: appManager.onAppRemoved,\r\n        onAppChanged: appManager.onAppChanged,\r\n        onAppAvailable: appManager.onAppAvailable,\r\n        onAppUnavailable: appManager.onAppUnavailable,\r\n        instances: appManager.instances,\r\n        get myInstance() {\r\n            return appManager.getMyInstance();\r\n        },\r\n        onInstanceStarted: appManager.onInstanceStarted,\r\n        onInstanceStopped: appManager.onInstanceStopped,\r\n        onInstanceUpdated: appManager.onInstanceUpdated,\r\n        onInstanceStartFailed: appManager.onInstanceStartFailed,\r\n        getRegion: entitlements.getRegion,\r\n        getBranches: entitlements.getBranches,\r\n        getCurrentBranch: entitlements.getCurrentBranch,\r\n        getFunctionalEntitlement: entitlements.getFunctionalEntitlement,\r\n        getFunctionalEntitlementBranch: entitlements.getFunctionalEntitlementBranch,\r\n        setCurrentBranch: entitlements.setCurrentBranch,\r\n        setRegion: entitlements.setRegion,\r\n        currentUser: entitlements.currentUser,\r\n        canI: entitlements.canI,\r\n        canIBranch: entitlements.canIBranch,\r\n        onBranchesChanged: entitlements.onBranchesChanged,\r\n        exit: entitlements.exit\r\n    };\r\n    return api;\r\n});\r\n//# sourceMappingURL=main.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/app-manager/main.js\n// module id = 66\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AgmNames = require(\"./const/agm-names\");\r\nvar helper_1 = require(\"./helper\");\r\n/** Retrieves application snapshot from ACS */\r\nfunction snapshot(agm, appManager) {\r\n    return new Promise(function (resolve, reject) {\r\n        agm.invoke(AgmNames.GetApplicationsMethodName, { skipIcon: true })\r\n            .then(function (response) {\r\n            var data = response.returned;\r\n            if (!data) {\r\n                resolve();\r\n            }\r\n            var applications = data.applications;\r\n            if (!applications) {\r\n                resolve();\r\n            }\r\n            helper_1.objectValues(applications).map(function (item) { return appManager.handleAppAdded(item); });\r\n            resolve();\r\n        })\r\n            .catch(function (err) { return reject(\"Error getting application snapshot: \" + err.message); });\r\n    });\r\n}\r\nexports.default = snapshot;\r\n//# sourceMappingURL=snapshot.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/app-manager/snapshot.js\n// module id = 67\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.default = (function (options) {\r\n    // Possible options per lib (this is InputLibConfig type)\r\n    // * false - library is disabled (e.g. config.appManager = false)\r\n    // * true - library is enabled in running in default mode (e.g config.appManager = true).\r\n    //          Exception is if default mode is false - in that case it runs default true mode.\r\n    // * string - start in some mode (e.g. config.appManager = \"full\")\r\n    // * object - allows further customization (e.g config.appManager = {mode: \"full\", someSetting: 42})\r\n    //\r\n    // Some libs support different running modes, some do not.\r\n    //\r\n    // Currently defaults are:\r\n    // appManager: disabled\r\n    // layouts: enabled in 'slim' mode\r\n    // activities: enabled in 'trackMyTypeAndInitiatedFromMe' mode\r\n    // windows: enabled (does not support modes)\r\n    //\r\n    // InputLibConfig is transformed to LibConfigObject\r\n    /**\r\n     * Transforms InputLibConfig (the config as specified from the user)\r\n     * to LibConfigObject(internal library configuration)\r\n     */\r\n    function getLibConfig(value, defaultMode, trueMode) {\r\n        // if value is false return undefined\r\n        if (typeof value === \"boolean\" && !value) {\r\n            return undefined;\r\n        }\r\n        // find the mode of the library\r\n        var mode = getModeAsString(value, defaultMode, trueMode);\r\n        // if object we will replace the mode because appManager = {mode: true, setting: 42}\r\n        // should be turned into appManager = {mode: 'slim', setting: 42}\r\n        if (typeof value === \"object\") {\r\n            value.mode = mode;\r\n            return value;\r\n        }\r\n        return {\r\n            mode: mode,\r\n        };\r\n    }\r\n    /**\r\n     * Finds the mode based for a given library\r\n     * 1. If object we call recursively using object.mode for value\r\n     * 1. If the user hasn't specified anything we use the hard coded defaults\r\n     * 3. If the value is false or it got defaulted to false, we return undefined\r\n     * 4. If the value is true we return trueMode or defaultMode (if trueMode is undefined)\r\n     */\r\n    function getModeAsString(value, defaultMode, trueMode) {\r\n        if (typeof value === \"object\") {\r\n            // 1. if object\r\n            return getModeAsString(value.mode, defaultMode, trueMode) + \"\";\r\n        }\r\n        else if (typeof value === \"undefined\") {\r\n            // 2. if the user does not pass anything\r\n            if (typeof defaultMode === \"boolean\" && !defaultMode) {\r\n                // 3. if gets defaulted to false, the library should be off\r\n                return undefined;\r\n            }\r\n            else {\r\n                return defaultMode + \"\";\r\n            }\r\n        }\r\n        else if (typeof value === \"boolean\") {\r\n            // 4. if the user passes true, use trueMode or defaultMode\r\n            if (value) {\r\n                // if the user passes true, use trueMode or defaultMode\r\n                return ((trueMode === undefined) ? defaultMode : trueMode) + \"\";\r\n            }\r\n            else {\r\n                // 3. if the user passes false, the library should be off\r\n                return undefined;\r\n            }\r\n        }\r\n        return value + \"\";\r\n    }\r\n    var appDefaultMode = false;\r\n    var appDefaultTrueMode = \"startOnly\";\r\n    var activitiesDefaultMode = \"trackMyTypeAndInitiatedFromMe\";\r\n    var layoutsDefaultMode = \"slim\";\r\n    return {\r\n        layouts: getLibConfig(options.layouts, layoutsDefaultMode),\r\n        activities: getLibConfig(options.activities, activitiesDefaultMode),\r\n        appManager: getLibConfig(options.appManager, appDefaultMode, appDefaultTrueMode),\r\n        windows: getLibConfig(options.windows, true)\r\n    };\r\n});\r\n//# sourceMappingURL=config.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/config.js\n// module id = 68\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar SaveContextMethodName = \"T42.HC.GetSaveContext\";\r\n/**\r\n * Logic for apps that want to provide custom context on save\r\n */\r\nvar ContextProvider = /** @class */ (function () {\r\n    function ContextProvider(agm, activitiesGetter, callbacks) {\r\n        this.agm = agm;\r\n        this.activitiesGetter = activitiesGetter;\r\n        this.callbacks = callbacks;\r\n        this.registeredRequestsMethods = false;\r\n    }\r\n    ContextProvider.prototype.onSaveRequested = function (callback) {\r\n        if (!this.registeredRequestsMethods) {\r\n            this.registerRequestMethods();\r\n            this.registeredRequestsMethods = true;\r\n        }\r\n        return this.callbacks.add(\"saveRequested\", callback);\r\n    };\r\n    ContextProvider.prototype.isActivityOwner = function () {\r\n        // fallback for GD2 - remove once the bellow code is tested\r\n        if (typeof htmlContainer !== \"undefined\") {\r\n            var context = htmlContainer.getContext();\r\n            return context && context._t42 && context._t42.activityIsOwner;\r\n        }\r\n        // check if we're the activity owners\r\n        var activities = this.activitiesGetter();\r\n        if (!activities) {\r\n            return false;\r\n        }\r\n        if (!activities.inActivity) {\r\n            return false;\r\n        }\r\n        var myWindow = activities.my.window;\r\n        var myActivity = activities.my.activity;\r\n        if (!myActivity && !myWindow) {\r\n            return false;\r\n        }\r\n        // TODO - fix activities typings\r\n        return myActivity.owner.id === myWindow.id;\r\n    };\r\n    ContextProvider.prototype.registerRequestMethods = function () {\r\n        var _this = this;\r\n        this.agm.register(SaveContextMethodName, function (args) {\r\n            var requestResult = _this.callbacks.execute(\"saveRequested\", args)[0];\r\n            if (!requestResult) {\r\n                return {};\r\n            }\r\n            requestResult.activityContext = requestResult.activityContext || {};\r\n            requestResult.windowContext = requestResult.windowContext || {};\r\n            // always include the window context\r\n            var result = { windowContext: requestResult.windowContext, activityContext: undefined };\r\n            // if we're the activity owner put the context too\r\n            if (_this.isActivityOwner()) {\r\n                result.activityContext = requestResult.activityContext;\r\n            }\r\n            return result;\r\n        });\r\n    };\r\n    return ContextProvider;\r\n}());\r\nexports.default = ContextProvider;\r\n//# sourceMappingURL=contextProvider.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/layouts/contextProvider.js\n// module id = 69\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar store_1 = require(\"./store\");\r\nvar shortid_1 = require(\"shortid\");\r\nvar contextProvider_1 = require(\"./contextProvider\");\r\nvar transform_1 = require(\"./transform\");\r\nvar layout_1 = require(\"./layout\");\r\nvar LayoutsAPIImpl = /** @class */ (function () {\r\n    function LayoutsAPIImpl(config, stream, callbacks) {\r\n        this.config = config;\r\n        this.stream = stream;\r\n        this.callbacks = callbacks;\r\n        this.appManager = config.appManager;\r\n        this.onEvent = stream.onEvent;\r\n        this.provider = new contextProvider_1.default(config.agm, config.activityGetter, callbacks);\r\n        stream.subscribe();\r\n    }\r\n    LayoutsAPIImpl.prototype.ready = function () {\r\n        if (this.config.mode === \"fullWaitSnapshot\") {\r\n            return this.stream.gotSnapshot;\r\n        }\r\n        return this.stream.ready;\r\n    };\r\n    LayoutsAPIImpl.prototype.save = function (layout) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.verifyNotSlimMode();\r\n            if (!layout.name) {\r\n                throw Error(\"layout.name argument is required\");\r\n            }\r\n            if (!layout.type) {\r\n                layout.type = \"Global\";\r\n            }\r\n            if (layout.activityId) {\r\n                layout.type = \"Activity\";\r\n            }\r\n            if (typeof layout.ignoreHidden === \"undefined\") {\r\n                layout.ignoreHidden = true; // default to true\r\n            }\r\n            var layoutObject = {\r\n                name: layout.name,\r\n                actIds: [],\r\n                appIds: [],\r\n                type: layout.type,\r\n                context: layout.context,\r\n                options: { ignoreLayoutRestrictions: false },\r\n            };\r\n            if (layout.type === \"Activity\") {\r\n                var actId = layout.activityId;\r\n                if (!actId) {\r\n                    if (!_this.appManager.myInstance.inActivity) {\r\n                        throw new Error(\"Current application is not in activity. Can not save activity layout for it\");\r\n                    }\r\n                    actId = _this.appManager.myInstance.activityId;\r\n                }\r\n                layoutObject.actIds.push(actId);\r\n                layoutObject.options = { ignoreLayoutRestrictions: true };\r\n            }\r\n            else if (layout.type === \"Global\") {\r\n                var instances = _this.appManager.instances();\r\n                if (layout.ignoreHidden) {\r\n                    instances = instances.filter(function (i) { return _this.isVisibleWindow(i); });\r\n                }\r\n                if (layout.ignoreMyInstance && _this.appManager.myInstance) {\r\n                    instances = instances.filter(function (i) { return i.id !== _this.appManager.myInstance.id; });\r\n                }\r\n                instances.reduce(function (prev, current) {\r\n                    if (!current.id) {\r\n                        return prev;\r\n                    }\r\n                    if (current.inActivity) {\r\n                        var actId = current.activityId;\r\n                        if (prev.actIds.indexOf(actId) === -1) {\r\n                            prev.actIds.push(actId);\r\n                        }\r\n                    }\r\n                    else {\r\n                        prev.appIds.push(current.id);\r\n                    }\r\n                    return prev;\r\n                }, layoutObject);\r\n            }\r\n            else {\r\n                throw new Error(\"layout type \" + layout.type + \" not supported\");\r\n            }\r\n            _this.invokeMethodAndTrack(\"T42.ACS.SaveLayout\", layoutObject, resolve, reject);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.restore = function (options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.verifyNotSlimMode();\r\n            if (typeof options === \"undefined\") {\r\n                throw Error(\"options argument is required\");\r\n            }\r\n            if (!options.name) {\r\n                throw Error(\"options.name argument is required\");\r\n            }\r\n            if (!options.type) {\r\n                options.type = \"Global\";\r\n            }\r\n            if (options.activityIdToJoin) {\r\n                options.type = \"Activity\";\r\n            }\r\n            if (typeof options.restoreActivityOwner === \"undefined\") {\r\n                options.restoreActivityOwner = false;\r\n            }\r\n            if (typeof options.ignoreActivityWindowTypes === \"undefined\") {\r\n                options.ignoreActivityWindowTypes = [];\r\n            }\r\n            if (typeof options.setActivityContext === \"undefined\") {\r\n                options.setActivityContext = true;\r\n            }\r\n            // if no closeOwnRunning we set closeRunningInstance to true; if\r\n            if (typeof options.closeRunningInstance === \"undefined\") {\r\n                if (options.type === \"Global\") {\r\n                    options.closeRunningInstance = true;\r\n                }\r\n                else if (options.type === \"Activity\") {\r\n                    // we don't close anything in case of activity layout type\r\n                    options.closeRunningInstance = false;\r\n                }\r\n            }\r\n            if (typeof options.reuseWindows === \"undefined\") {\r\n                options.reuseWindows = true;\r\n            }\r\n            options.context = options.context || {};\r\n            var t42 = {\r\n                restoreOptions: {\r\n                    activityToJoin: options.activityIdToJoin,\r\n                    setActivityContext: options.setActivityContext,\r\n                    ignoreActivityWindowTypes: options.ignoreActivityWindowTypes,\r\n                    restoreActivityOwner: options.restoreActivityOwner,\r\n                    closeOldWindows: true,\r\n                    reuseExistingWindows: options.reuseWindows\r\n                }\r\n            };\r\n            var arg = {\r\n                type: options.type,\r\n                name: options.name,\r\n                context: options.context,\r\n                toClose: [],\r\n                splash: options.splash\r\n            };\r\n            if (options.closeRunningInstance) {\r\n                arg.toClose = _this.getInstancesToClose(options);\r\n            }\r\n            if (options.timeout) {\r\n                arg.timeout = options.timeout;\r\n            }\r\n            arg.context._t42 = t42;\r\n            _this.invokeMethodAndTrack(\"T42.ACS.RestoreLayout\", arg, resolve, reject, true);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.remove = function (type, name) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.verifyNotSlimMode();\r\n            if (!name) {\r\n                throw Error(\"name argument is required\");\r\n            }\r\n            if (!type) {\r\n                throw Error(\"type argument is required\");\r\n            }\r\n            var msg = {\r\n                type: type,\r\n                name: name,\r\n            };\r\n            _this.invokeMethodAndTrack(\"T42.ACS.RemoveLayout\", msg, resolve, reject);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.list = function () {\r\n        this.verifyNotSlimMode();\r\n        return store_1.default.all;\r\n    };\r\n    LayoutsAPIImpl.prototype.import = function (layouts, mode) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.verifyNotSlimMode();\r\n            var msg = {\r\n                mode: mode || \"replace\",\r\n                layouts: layouts\r\n            };\r\n            _this.invokeMethodAndTrack(\"T42.ACS.ImportLayouts\", msg, resolve, reject);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.export = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var handleResult = function (result) {\r\n                var layouts = _this.getObjectValues(result.Layouts).map(function (t) { return new layout_1.default(transform_1.default(t)); });\r\n                resolve(layouts);\r\n            };\r\n            _this.invokeMethodAndTrack(\"T42.ACS.ExportLayouts\", {}, handleResult, reject, true);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.rename = function (layout, newName) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.verifyNotSlimMode();\r\n            if (!layout) {\r\n                throw Error(\"layout argument is required\");\r\n            }\r\n            if (!layout.name) {\r\n                throw Error(\"name argument is required\");\r\n            }\r\n            if (!layout.type) {\r\n                throw Error(\"type argument is required\");\r\n            }\r\n            var msg = { type: layout.type, oldName: layout.name, newName: newName };\r\n            _this.invokeMethodAndTrack(\"T42.ACS.RenameLayout\", msg, resolve, reject);\r\n        });\r\n    };\r\n    LayoutsAPIImpl.prototype.onAdded = function (callback) {\r\n        var result = this.callbacks.add(\"added\", callback);\r\n        if (store_1.default.all.length > 0) {\r\n            store_1.default.all.forEach(function (layout) {\r\n                try {\r\n                    callback(layout);\r\n                }\r\n                catch (err) { /** */ }\r\n            });\r\n        }\r\n        return result;\r\n    };\r\n    LayoutsAPIImpl.prototype.onRemoved = function (callback) {\r\n        return this.callbacks.add(\"removed\", callback);\r\n    };\r\n    LayoutsAPIImpl.prototype.onChanged = function (callback) {\r\n        return this.callbacks.add(\"changed\", callback);\r\n    };\r\n    LayoutsAPIImpl.prototype.onRenamed = function (callback) {\r\n        return this.callbacks.add(\"renamed\", callback);\r\n    };\r\n    LayoutsAPIImpl.prototype.onEvent = function (callback) {\r\n        return this.stream.onEvent(callback);\r\n    };\r\n    LayoutsAPIImpl.prototype.onSaveRequested = function (callback) {\r\n        return this.provider.onSaveRequested(callback);\r\n    };\r\n    LayoutsAPIImpl.prototype.verifyNotSlimMode = function () {\r\n        if (this.config.mode === \"slim\") {\r\n            throw Error(\"Operation not allowed in slim mode. Run in full mode.\");\r\n        }\r\n    };\r\n    LayoutsAPIImpl.prototype.isVisibleWindow = function (instance) {\r\n        // GD3\r\n        // allow exes to participate in layouts (TODO - check if the app is layouts aware (has the layouts methods) - if not treat it as not visible window)\r\n        if (instance.application.type === \"exe\" || instance.application.type === \"node\") {\r\n            return true;\r\n        }\r\n        // allow activities to participate in layouts\r\n        if (instance.application.type === \"activity\") {\r\n            return true;\r\n        }\r\n        if (!instance || !instance.window) {\r\n            return false;\r\n        }\r\n        return instance.window.isVisible;\r\n    };\r\n    LayoutsAPIImpl.prototype.invokeMethodAndTrack = function (methodName, args, resolve, reject, skipStreamEvent) {\r\n        var streamEventReceived = skipStreamEvent;\r\n        var agmResult;\r\n        var token = shortid_1.generate();\r\n        args.token = token;\r\n        var handleResult = function () {\r\n            if (streamEventReceived && agmResult) {\r\n                resolve(agmResult);\r\n            }\r\n        };\r\n        if (!skipStreamEvent) {\r\n            this.stream.waitFor(token)\r\n                .then(function () {\r\n                streamEventReceived = true;\r\n                handleResult();\r\n            })\r\n                .catch(function (err) {\r\n                reject(err);\r\n            });\r\n        }\r\n        var responseHandler = function (result) {\r\n            if (!result.returned) {\r\n                reject(\"No result from method \" + methodName);\r\n            }\r\n            if (result.returned.status && (result.returned.status !== \"Success\" && result.returned.status !== \"PartialSuccess\")) {\r\n                reject(result.returned);\r\n            }\r\n            agmResult = result.returned;\r\n            handleResult();\r\n        };\r\n        this.config.agm.invoke(methodName, args, \"best\", { methodResponseTimeoutMs: 120 * 1000 })\r\n            .then(responseHandler)\r\n            .catch(function (err) { return reject(err); });\r\n    };\r\n    LayoutsAPIImpl.prototype.getInstancesToClose = function (options) {\r\n        var _this = this;\r\n        var instances = [];\r\n        var shellApp = this.appManager.applications().filter(function (a) { return a.isShell; })[0];\r\n        var shellApplicationName = shellApp ? shellApp.name : \"AppManager\";\r\n        this.appManager.instances().forEach(function (i) {\r\n            // ignore my instance\r\n            if (_this.appManager.myInstance && i.id === _this.appManager.myInstance.id) {\r\n                return;\r\n            }\r\n            // ignore shell app\r\n            if (i.application.name === shellApplicationName) {\r\n                return;\r\n            }\r\n            // ignore hidden windows\r\n            if (!_this.isVisibleWindow(i)) {\r\n                return;\r\n            }\r\n            // if activity layout stop only the instances\r\n            // running in the same activity\r\n            if (options.type === \"Activity\") {\r\n                if (i.activityId !== options.activityIdToJoin) {\r\n                    return;\r\n                }\r\n            }\r\n            instances.push({ application: i.application.name, instance: i.id });\r\n        });\r\n        return instances;\r\n    };\r\n    LayoutsAPIImpl.prototype.getObjectValues = function (obj) {\r\n        if (!obj) {\r\n            return [];\r\n        }\r\n        return Object.keys(obj).map(function (k) { return obj[k]; });\r\n    };\r\n    return LayoutsAPIImpl;\r\n}());\r\nexports.default = LayoutsAPIImpl;\r\n//# sourceMappingURL=layouts.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/layouts/layouts.js\n// module id = 70\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar layouts_1 = require(\"./layouts\");\r\nvar acsStream_1 = require(\"./stream/acsStream\");\r\nvar nullStream_1 = require(\"./stream/nullStream\");\r\nvar callback_registry_1 = require(\"callback-registry\");\r\nfunction default_1(config) {\r\n    if (!config.agm) {\r\n        throw Error(\"config.agm is required\");\r\n    }\r\n    if (!config.logger) {\r\n        throw Error(\"config.logger is required\");\r\n    }\r\n    // default mode to slim\r\n    config.mode = config.mode || \"slim\";\r\n    var logger = config.logger;\r\n    var callbacks = callback_registry_1.default();\r\n    var acsStream;\r\n    if (config.mode === \"full\" || \"fullWaitSnapshot\") {\r\n        acsStream = new acsStream_1.default(config.agm, callbacks);\r\n    }\r\n    else {\r\n        acsStream = nullStream_1.default();\r\n    }\r\n    return new layouts_1.default(config, acsStream, callbacks);\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=main.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/layouts/main.js\n// module id = 71\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar store_1 = require(\"../store\");\r\nvar layout_1 = require(\"../layout\");\r\nvar transform_1 = require(\"../transform\");\r\n/**\r\n * ACS event stream related to layouts\r\n */\r\nvar ACSStream = /** @class */ (function () {\r\n    function ACSStream(agm, callbacks) {\r\n        var _this = this;\r\n        this.agm = agm;\r\n        this.callbacks = callbacks;\r\n        this.ready = new Promise(function (resolve, reject) {\r\n            _this.resolveReady = resolve;\r\n            _this.rejectReady = reject;\r\n        });\r\n        this.gotSnapshot = new Promise(function (resolve, reject) {\r\n            _this.resolveGotSnapshot = resolve;\r\n            _this.rejectGotSnapshot = reject;\r\n        });\r\n    }\r\n    ACSStream.prototype.subscribe = function (noRetry) {\r\n        var _this = this;\r\n        var transform = function (obj) {\r\n            return _this.getObjectValues(obj).map(function (t) { return transform_1.default(t); });\r\n        };\r\n        // if we don't have OnLayoutEvent stream  we're running pre 2.1 GD version or outside GD,\r\n        if (!this.checkForLayoutEventMethod()) {\r\n            // if no retry resolve right away\r\n            if (noRetry) {\r\n                this.resolveReady();\r\n            }\r\n            // if we should retry, schedule  one more time\r\n            setTimeout(function () {\r\n                _this.subscribe(true);\r\n            }, 500);\r\n        }\r\n        else {\r\n            this.agm.subscribe(\"T42.ACS.OnLayoutEvent\", { waitTimeoutMs: 10000 })\r\n                .then(function (subs) {\r\n                subs.onData(function (args) {\r\n                    var data = args.data;\r\n                    if (data.IsSnapshot) {\r\n                        _this.resolveGotSnapshot();\r\n                    }\r\n                    _this.addLayouts(transform(data.OnLayoutAdded));\r\n                    _this.removeLayouts(transform(data.OnLayoutRemoved));\r\n                    _this.changeLayouts(transform(data.OnLayoutChanged));\r\n                    _this.renameLayouts(transform(data.OnLayoutRenamed));\r\n                    _this.callbacks.execute(\"streamEvent\", data);\r\n                });\r\n                subs.onFailed(function (err) {\r\n                    var msg = \"can not subscribe to T42.ACS.OnLayoutEvent \" + err;\r\n                    _this.rejectReady(msg);\r\n                    _this.rejectGotSnapshot(msg);\r\n                });\r\n                _this.resolveReady();\r\n            })\r\n                .catch(function (err) {\r\n                var msg = \"Error subscribing for T42.ACS.OnLayoutEvent stream. Err: \" + err;\r\n                _this.rejectReady(msg);\r\n                _this.rejectGotSnapshot(msg);\r\n            });\r\n        }\r\n    };\r\n    ACSStream.prototype.onEvent = function (callback) {\r\n        return this.callbacks.add(\"streamEvent\", callback);\r\n    };\r\n    ACSStream.prototype.waitFor = function (token, timeout) {\r\n        var _this = this;\r\n        if (!timeout) {\r\n            timeout = 10000; // default timeout is 10 seconds\r\n        }\r\n        return new Promise(function (resolve, reject) {\r\n            var done = false;\r\n            var unsubscribe = _this.onEvent(function (streamEvent) {\r\n                if (streamEvent.Token === token) {\r\n                    done = true;\r\n                    unsubscribe();\r\n                    resolve();\r\n                }\r\n            });\r\n            setTimeout(function () {\r\n                if (!done) {\r\n                    reject(\"timed out\");\r\n                }\r\n            }, timeout);\r\n        });\r\n    };\r\n    ACSStream.prototype.checkForLayoutEventMethod = function () {\r\n        try {\r\n            return this.agm\r\n                .methods()\r\n                .map(function (m) { return m.name; })\r\n                .indexOf(\"T42.ACS.OnLayoutEvent\") !== -1;\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    };\r\n    ACSStream.prototype.addLayouts = function (layoutsData) {\r\n        var _this = this;\r\n        if (!layoutsData) {\r\n            return;\r\n        }\r\n        layoutsData.forEach(function (layoutData) {\r\n            var layout = new layout_1.default(layoutData);\r\n            store_1.default.add(layout);\r\n            _this.callbacks.execute(\"added\", layout);\r\n        });\r\n    };\r\n    ACSStream.prototype.removeLayouts = function (removedLayouts) {\r\n        var _this = this;\r\n        if (!removedLayouts) {\r\n            return;\r\n        }\r\n        removedLayouts.forEach(function (removedLayout) {\r\n            store_1.default.removeWhere(function (existingLayout) { return !_this.compareLayouts(existingLayout, removedLayout); });\r\n            _this.callbacks.execute(\"removed\", removedLayout);\r\n        });\r\n    };\r\n    ACSStream.prototype.changeLayouts = function (changedLayouts) {\r\n        var _this = this;\r\n        if (!changedLayouts) {\r\n            return;\r\n        }\r\n        changedLayouts.forEach(function (changedLayout) {\r\n            // removed the changed layout and push it again\r\n            store_1.default.removeWhere(function (existingLayout) { return !_this.compareLayouts(existingLayout, changedLayout); });\r\n            store_1.default.add(new layout_1.default(changedLayout));\r\n            // execute callback\r\n            _this.callbacks.execute(\"changed\", changedLayout);\r\n        });\r\n    };\r\n    ACSStream.prototype.renameLayouts = function (renamedLayouts) {\r\n        var _this = this;\r\n        if (!renamedLayouts) {\r\n            return;\r\n        }\r\n        renamedLayouts.forEach(function (renamedLayout) {\r\n            var existingLayout = store_1.default.first(function (current) { return _this.compareLayouts(current, { type: renamedLayout.type, name: renamedLayout.oldName }); });\r\n            if (!existingLayout) {\r\n                throw Error(\"received rename event for unknown layout with type \" + renamedLayout.type + \" and name \" + renamedLayout.oldName);\r\n            }\r\n            existingLayout.name = renamedLayout.newName;\r\n            _this.callbacks.execute(\"renamed\", existingLayout);\r\n        });\r\n    };\r\n    ACSStream.prototype.compareLayouts = function (layout1, layout2) {\r\n        return layout1.name === layout2.name && layout1.type === layout2.type;\r\n    };\r\n    ACSStream.prototype.getObjectValues = function (obj) {\r\n        if (!obj) {\r\n            return [];\r\n        }\r\n        return Object.keys(obj).map(function (k) { return obj[k]; });\r\n    };\r\n    return ACSStream;\r\n}());\r\nexports.default = ACSStream;\r\n//# sourceMappingURL=acsStream.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/layouts/stream/acsStream.js\n// module id = 72\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction default_1() {\r\n    return {\r\n        ready: Promise.resolve(undefined),\r\n        subscribe: function () { },\r\n        onEvent: function (callback) { return function () { }; },\r\n        waitFor: function (token, timeout) { return Promise.resolve(undefined); },\r\n        gotSnapshot: Promise.resolve(undefined),\r\n    };\r\n}\r\nexports.default = default_1;\r\n//# sourceMappingURL=nullStream.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/layouts/stream/nullStream.js\n// module id = 73\n// module chunks = 0","\"use strict\";\r\nvar glue_1 = require(\"./glue\");\r\nif (typeof window !== \"undefined\") {\r\n    window.Glue = glue_1.default;\r\n}\r\n// add default library for ES6 modules\r\nglue_1.default.default = glue_1.default;\r\nmodule.exports = glue_1.default;\r\n//# sourceMappingURL=main.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/main.js\n// module id = 74\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Utils = /** @class */ (function () {\r\n    function Utils() {\r\n    }\r\n    Utils.getGDMajorVersion = function () {\r\n        if (typeof window === \"undefined\") {\r\n            return -1;\r\n        }\r\n        if (!window.glueDesktop) {\r\n            return -1;\r\n        }\r\n        if (!window.glueDesktop.version) {\r\n            return -1;\r\n        }\r\n        var ver = Number(window.glueDesktop.version.substr(0, 1));\r\n        return isNaN(ver) ? -1 : ver;\r\n    };\r\n    Utils.isNode = function () {\r\n        // Only Node.JS has a process variable that is of [[Class]] process\r\n        try {\r\n            return Object.prototype.toString.call(global.process) === \"[object process]\";\r\n        }\r\n        catch (e) {\r\n            return false;\r\n        }\r\n    };\r\n    return Utils;\r\n}());\r\nexports.default = Utils;\r\n//# sourceMappingURL=utils.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/utils.js\n// module id = 75\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar gd_1 = require(\"./gd/gd\");\r\nvar hc_1 = require(\"./hc/hc\");\r\nexports.default = (function (agm, logger, appManagerGetter, gdMajorVersion) {\r\n    var _logger = logger;\r\n    return new Promise(function (resolve, reject) {\r\n        if (gdMajorVersion === 2) {\r\n            // We are running in HC\r\n            _logger.trace(\"running in HC\");\r\n            hc_1.default(agm, _logger, appManagerGetter, window.htmlContainer.containerName, window.htmlContainer.windowId)\r\n                .then(resolve)\r\n                .catch(reject);\r\n        }\r\n        else if (gdMajorVersion >= 3) {\r\n            // We are running in GD 3\r\n            // TODO expose instance in glu42gd\r\n            _logger.trace(\"running in GD\");\r\n            var gd = new gd_1.default(agm, _logger, appManagerGetter, undefined, window.glue42gd.windowId);\r\n            gd.init()\r\n                .then(resolve)\r\n                .catch(reject);\r\n        }\r\n        else {\r\n            // We are running in Browser or Node, we should check which stream is available\r\n            // But we need to pass the container as dependency\r\n            var hcPromise = hc_1.default(agm, _logger, appManagerGetter);\r\n            var gdPromise = new gd_1.default(agm, _logger, appManagerGetter).init();\r\n            var wait = function (ms) { return new Promise(function (res, rej) { return setTimeout(function () { rej(\"timeout waiting for streams\"); }, ms); }); };\r\n            Promise.race([hcPromise, gdPromise, wait(10000)])\r\n                .then(resolve)\r\n                .catch(reject);\r\n        }\r\n    });\r\n});\r\n//# sourceMappingURL=detector.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/windows/environment/detector.js\n// module id = 76\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar objectAssign = require(\"object-assign\");\r\nvar GDExecutor = /** @class */ (function () {\r\n    function GDExecutor() {\r\n    }\r\n    Object.defineProperty(GDExecutor.prototype, \"hostInstance\", {\r\n        get: function () {\r\n            return this.agmTarget;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    GDExecutor.prototype.init = function (agm, instance) {\r\n        this.agm = agm;\r\n        this.agmTarget = instance;\r\n    };\r\n    GDExecutor.prototype.close = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"close\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.navigate = function (resultWindow, newUrl) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"navigate\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    url: newUrl\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.setStyle = function (resultWindow, style) {\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            Promise.resolve();\r\n        });\r\n    };\r\n    GDExecutor.prototype.setTitle = function (resultWindow, newTitle) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var options = {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    title: newTitle\r\n                }\r\n            };\r\n            _this.execute(\"setTitle\", options)\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n            Promise.resolve();\r\n        });\r\n    };\r\n    GDExecutor.prototype.moveResize = function (resultWindow, dimensions) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"moveResize\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    bounds: dimensions\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.addFrameButton = function (resultWindow, buttonInfo) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"addButton\", {\r\n                windowId: resultWindow.id,\r\n                options: buttonInfo\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.removeFrameButton = function (resultWindow, buttonId) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"removeButton\", {\r\n                windowId: resultWindow.id,\r\n                options: buttonId\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.activate = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"activate\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.focus = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"focus\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.maximizeRestore = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            _this.execute(\"maximizeRestore\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.maximize = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"maximize\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.restore = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"restore\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.minimize = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"minimize\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.collapse = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"collapse\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.expand = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"expand\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.toggleCollapse = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"toggleCollapse\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.snap = function (resultWindow, target, direction) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var sourceWindowId = resultWindow.id;\r\n            var targetWindowId;\r\n            var errorMessage = \"Invalid target parameter - should be an object with property id or a string. Invoked for source window id:\" +\r\n                resultWindow.id;\r\n            if (!target) {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            if (typeof target === \"string\") {\r\n                targetWindowId = target;\r\n            }\r\n            else if (typeof target.id !== \"undefined\") {\r\n                targetWindowId = target.id;\r\n            }\r\n            else {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            var args = {\r\n                targetWindowId: targetWindowId\r\n            };\r\n            if (direction) {\r\n                args.snappingEdge = direction;\r\n            }\r\n            _this.execute(\"snap\", {\r\n                windowId: resultWindow.id,\r\n                options: args\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.attachTab = function (resultWindow, options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"attachTab\", {\r\n                windowId: resultWindow.id,\r\n                options: options\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.detachTab = function (resultWindow, options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            _this.execute(\"detachTab\", {\r\n                windowId: resultWindow.id,\r\n                options: options\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.setVisible = function (resultWindow, toBeVisible) {\r\n        var _this = this;\r\n        if (toBeVisible === void 0) { toBeVisible = true; }\r\n        return new Promise(function (resolve, reject) {\r\n            var command;\r\n            if (toBeVisible) {\r\n                command = \"show\";\r\n            }\r\n            else {\r\n                command = \"hide\";\r\n            }\r\n            _this.execute(command, { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.showLoader = function (resultWindow, loader) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"showLoadingAnimation\", { windowId: resultWindow.id, options: loader })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.hideLoader = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"hideLoadingAnimation\", { windowId: resultWindow.id })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.updateContext = function (resultWindow, context) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"updateContext\", {\r\n                windowId: resultWindow.id,\r\n                context: context,\r\n                replace: Object.keys(resultWindow.context).length > 0 ? false : true\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.lock = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"lockUnlock\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    isLocked: true\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.unlock = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"lockUnlock\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    isLocked: false\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.getIcon = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"getIcon\", {\r\n                windowId: resultWindow.id,\r\n                options: {}\r\n            })\r\n                .then(function (result) {\r\n                resolve(result.icon);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.setIcon = function (resultWindow, base64Image) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.execute(\"setIcon\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    dataURL: base64Image\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.setFrameColor = function (resultWindow, frameColor) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            _this.execute(\"setFrameColor\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    frameColor: frameColor\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.setTabHeaderVisible = function (resultWindow, toBeTabHeaderVisible) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            _this.execute(\"setTabHeaderVisible\", {\r\n                windowId: resultWindow.id,\r\n                options: {\r\n                    toShow: toBeTabHeaderVisible\r\n                }\r\n            })\r\n                .then(function () {\r\n                resolve(resultWindow);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    };\r\n    GDExecutor.prototype.execute = function (command, options) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var args = {};\r\n            objectAssign(args, options);\r\n            args.command = command;\r\n            _this.agm\r\n                .invoke(\"T42.Wnd.Execute\", args, _this.agmTarget)\r\n                .then(function (i) {\r\n                if (i.returned && i.returned.errorMsg) {\r\n                    reject(i);\r\n                }\r\n                else {\r\n                    resolve(i.returned);\r\n                }\r\n            })\r\n                .catch(function (i) {\r\n                reject(i);\r\n            });\r\n        });\r\n    };\r\n    /** Groups */\r\n    GDExecutor.prototype.setGroupHeaderVisible = function (windowId, toShow) {\r\n        return this.execute(\"setGroupHeaderVisibility\", {\r\n            windowId: windowId,\r\n            options: {\r\n                toShow: toShow\r\n            }\r\n        });\r\n    };\r\n    return GDExecutor;\r\n}());\r\nexports.GDExecutor = GDExecutor;\r\nexports.default = new GDExecutor();\r\n//# sourceMappingURL=executor.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/windows/environment/gd/executor.js\n// module id = 77\n// module chunks = 0","\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = require(\"callback-registry\");\r\nvar store_1 = require(\"../../store\");\r\nvar window_1 = require(\"../../window\");\r\nvar executor_1 = require(\"./executor\");\r\nvar helpers_1 = require(\"../helpers\");\r\nvar GDEnvironment = /** @class */ (function () {\r\n    function GDEnvironment(agm, logger, appManagerGetter, instance, wndId) {\r\n        this._registry = CallbackFactory();\r\n        this._waitTimeout = 10000;\r\n        this._agm = agm;\r\n        this._logger = logger.subLogger(\"gd-env\");\r\n        this._agmInstance = this.normalizeInstance(instance);\r\n        this._windowId = wndId;\r\n        this._appManagerGetter = appManagerGetter;\r\n    }\r\n    GDEnvironment.prototype.init = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // if we don't have an Instance, thats means that we are running outside from any Tick42 Containers\r\n            // so our target is best\r\n            if (typeof _this._agmInstance === \"undefined\") {\r\n                _this._agmInstance = \"best\";\r\n            }\r\n            var streamPromise = new Promise(function (streamResolve, streamReject) {\r\n                _this._agm.subscribe(\"T42.Wnd.OnEvent\", {\r\n                    waitTimeoutMs: _this._waitTimeout,\r\n                    target: _this._agmInstance,\r\n                })\r\n                    .then(function (stream) {\r\n                    stream.onData(function (streamData) {\r\n                        _this.updateWindow(streamData.data);\r\n                    });\r\n                    stream.onFailed(function (err) {\r\n                        reject(err);\r\n                    });\r\n                    _this._agmInstance = _this.normalizeInstance(stream.serverInstance);\r\n                    // Init the executor\r\n                    executor_1.default.init(_this._agm, _this._agmInstance);\r\n                    resolve(_this);\r\n                })\r\n                    .catch(function (err) {\r\n                    reject(\"Can not subscribe for stream T42.Wnd.OnEvent. Err: \" + err);\r\n                });\r\n            });\r\n        });\r\n    };\r\n    Object.defineProperty(GDEnvironment.prototype, \"executor\", {\r\n        get: function () {\r\n            return executor_1.default;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    GDEnvironment.prototype.open = function (name, url, options, success, error) {\r\n        options = options || {};\r\n        var copyOptions = Object.assign({}, options);\r\n        // relativeTo fix\r\n        if (typeof name === \"undefined\") {\r\n            if (error) {\r\n                error({ message: \"The name is undefined\" });\r\n            }\r\n            return;\r\n        }\r\n        if (typeof copyOptions.relativeTo !== \"undefined\" && typeof copyOptions.relativeTo !== \"string\") {\r\n            copyOptions.relativeTo = copyOptions.relativeTo.id || \"\";\r\n        }\r\n        copyOptions.name = name;\r\n        copyOptions.url = url;\r\n        // This is for compatability between gd2 and gd3\r\n        copyOptions.windowState = options.windowState || options.state;\r\n        // Otherwise glue desktop throws an error for extra properties\r\n        delete copyOptions.state;\r\n        this._agm.invoke(\"T42.Wnd.Create\", copyOptions, this._agmInstance)\r\n            .then(function (message) {\r\n            if (message.returned !== undefined) {\r\n                var id = message.returned.id;\r\n                success(id);\r\n            }\r\n            else {\r\n                error({ message: \"failed to execute T42.Wnd.Create - unknown reason\" });\r\n            }\r\n        }).catch(function (e) {\r\n            if (typeof error === \"function\") {\r\n                error(e);\r\n            }\r\n        });\r\n    };\r\n    GDEnvironment.prototype.tabAttached = function (callback) {\r\n        return this._registry.add(\"tab-attached\", callback);\r\n    };\r\n    GDEnvironment.prototype.tabDetached = function (callback) {\r\n        return this._registry.add(\"tab-detached\", callback);\r\n    };\r\n    GDEnvironment.prototype.onWindowFrameColorChanged = function (callback) {\r\n        return this._registry.add(\"frame-color-changed\", callback);\r\n    };\r\n    GDEnvironment.prototype.onEvent = function (callback) {\r\n        return this._registry.add(\"window-event\", callback);\r\n    };\r\n    GDEnvironment.prototype.my = function () {\r\n        return this._windowId;\r\n    };\r\n    GDEnvironment.prototype.execute = function (command, options) {\r\n        return this._agm.invoke(\"T42.Wnd.Execute\", {\r\n            command: command,\r\n            options: options,\r\n        });\r\n    };\r\n    /** Groups */\r\n    GDEnvironment.prototype.setGroupHeaderVisible = function (windowId, toShow) {\r\n        return this._agm.invoke(\"T42.Wnd.SetGroupHeaderVisible\", {\r\n            windowId: windowId,\r\n            toShow: toShow,\r\n        }, this._agmInstance);\r\n    };\r\n    GDEnvironment.prototype.onCompositionChanged = function (callback) {\r\n        return this._registry.add(\"composition-changed\", callback);\r\n    };\r\n    GDEnvironment.prototype.onGroupHeaderVisibilityChanged = function (callback) {\r\n        return this._registry.add(\"group-header-changed\", callback);\r\n    };\r\n    GDEnvironment.prototype.onWindowGotFocus = function (callback) {\r\n        return this._registry.add(\"got-focus\", callback);\r\n    };\r\n    GDEnvironment.prototype.onWindowLostFocus = function (callback) {\r\n        return this._registry.add(\"lost-focus\", callback);\r\n    };\r\n    GDEnvironment.prototype.normalizeInstance = function (instance) {\r\n        if (!instance) {\r\n            return undefined;\r\n        }\r\n        return {\r\n            application: instance.application,\r\n            machine: instance.machine,\r\n            user: instance.user,\r\n        };\r\n    };\r\n    GDEnvironment.prototype.updateWindow = function (windowInfo) {\r\n        var _this = this;\r\n        var extendedStreamEvent = this.getExtendedStreamEvent(windowInfo);\r\n        // this is the snapshot of all windows\r\n        if (windowInfo.type === \"Snapshot\") {\r\n            var windowInfoFullInfoEvent = windowInfo;\r\n            windowInfoFullInfoEvent.windows.forEach(function (w) {\r\n                var win = _this.createWindow(w.id, w);\r\n                store_1.default.markReadyToShow(win.API.id);\r\n                _this._registry.execute(\"window-event\", extendedStreamEvent);\r\n            });\r\n            return;\r\n        }\r\n        // if new window handle it separately\r\n        if (windowInfo.type === \"Created\") {\r\n            var windowInfoCreatedEvent = windowInfo;\r\n            var win = this.createWindow(windowInfoCreatedEvent.windowId, windowInfoCreatedEvent.data || {});\r\n            store_1.default.setReadyState(win.API.id);\r\n            this._registry.execute(\"window-event\", extendedStreamEvent);\r\n            return;\r\n        }\r\n        // otherwise check if the window is in our internal collections and update its state\r\n        var windowObjectAndEvents = store_1.default.get(windowInfo.windowId);\r\n        if (!windowObjectAndEvents) {\r\n            this._logger.error(\"received update for unknown window. Stream:', \" + JSON.stringify(windowInfo, null, 4));\r\n            return;\r\n        }\r\n        var theWindow = windowObjectAndEvents.API;\r\n        var theWindowEvents = windowObjectAndEvents.Events;\r\n        // handle bounds changed\r\n        if (windowInfo.type === \"BoundsChanged\") {\r\n            var windowInfoBoundsChangedEvent = windowInfo;\r\n            theWindowEvents.handleBoundsChanged(windowInfoBoundsChangedEvent.data);\r\n        }\r\n        // handle url changed\r\n        if (windowInfo.type === \"UrlChanged\") {\r\n            var windowInfoUrlChangedEvent = windowInfo;\r\n            store_1.default.setUrlChangedState(windowInfoUrlChangedEvent.windowId);\r\n            theWindowEvents.handleUrlChanged(windowInfoUrlChangedEvent.data);\r\n        }\r\n        // handle title changed\r\n        if (windowInfo.type === \"TitleChanged\") {\r\n            var windowInfoTitleChanged = windowInfo;\r\n            theWindowEvents.handleTitleChanged(windowInfoTitleChanged.data);\r\n        }\r\n        // handle visibility changed\r\n        if (windowInfo.type === \"VisibilityChanged\") {\r\n            theWindowEvents.handleVisibilityChanged(windowInfo.data);\r\n        }\r\n        // handle context changed\r\n        if (windowInfo.type === \"ContextChanged\") {\r\n            theWindowEvents.handleContextUpdated(windowInfo.data);\r\n        }\r\n        // handle window state changed\r\n        if (windowInfo.type === \"StateChanged\") {\r\n            theWindowEvents.handleWindowChangeState(windowInfo.data);\r\n        }\r\n        // handle frame color changed\r\n        if (windowInfo.type === \"FrameColorChanged\") {\r\n            theWindowEvents.handleFrameColorChanged(windowInfo.data);\r\n            this._registry.execute(\"frame-color-changed\", theWindow);\r\n        }\r\n        // handle composition changed - groups API\r\n        if (windowInfo.type === \"CompositionChanged\") {\r\n            var windowInfoCompositionChanged = windowInfo;\r\n            theWindowEvents.handleCompositionChanged(windowInfoCompositionChanged.data.neighbors, windowInfoCompositionChanged.data.groupId);\r\n            this._registry.execute(\"composition-changed\", windowInfoCompositionChanged.data);\r\n        }\r\n        if (windowInfo.type === \"GroupHeaderVisibilityChanged\") {\r\n            var info = windowInfo;\r\n            theWindowEvents.handleGroupHeaderVisibilityChanged(info.data.groupHeaderVisible);\r\n            this._registry.execute(\"group-header-changed\", info.data);\r\n        }\r\n        // handle focus changed\r\n        if (windowInfo.type === \"FocusChanged\") {\r\n            var windowInfoFocusChanged = windowInfo;\r\n            this.focusChanged(theWindowEvents, theWindow, windowInfoFocusChanged.data);\r\n        }\r\n        if (windowInfo.type === \"WindowFrameChanged\") {\r\n            theWindowEvents.handleFrameAttached(windowInfo.data.frameId, windowInfo.data.isTabHeaderVisible);\r\n            this._registry.execute(\"frame-changed\");\r\n        }\r\n        if (windowInfo.type === \"WindowFrameAdded\") {\r\n            theWindowEvents.handleAttached(windowInfo.data.frameId, windowInfo.data.isTabHeaderVisible);\r\n            var winsToBeNotified_1 = helpers_1.getWindowsByTabGroupId(theWindow.id, windowInfo.data.frameId);\r\n            // Getting all windows, except current, with same tabGroupId\r\n            Object.keys(winsToBeNotified_1).forEach(function (id) {\r\n                var win = winsToBeNotified_1[id];\r\n                // Executing event windowAttached to all windows\r\n                win.Events.handleWindowAttached(theWindow);\r\n            });\r\n            this._registry.execute(\"tab-attached\", theWindow, windowInfo.data.frameId, windowInfo.data.isTabHeaderVisible);\r\n        }\r\n        if (windowInfo.type === \"WindowFrameRemoved\") {\r\n            // In the event, tabGroupId is empty, will be update on the next event FrameAttached\r\n            var oldTabGroupId = theWindow.tabGroupId;\r\n            theWindowEvents.handleDetached(windowInfo.data.frameId);\r\n            var winsToBeNotified_2 = helpers_1.getWindowsByTabGroupId(theWindow.id, oldTabGroupId);\r\n            Object.keys(winsToBeNotified_2).forEach(function (id) {\r\n                var win = winsToBeNotified_2[id];\r\n                win.Events.handleWindowDetached(theWindow);\r\n            });\r\n            var un_1 = this._registry.add(\"frame-changed\", function () {\r\n                un_1();\r\n                _this._registry.execute(\"tab-detached\", theWindow, windowInfo.data.frameId, theWindow.tabGroupId);\r\n            });\r\n        }\r\n        if (windowInfo.type === \"TabHeaderVisibilityChanged\") {\r\n            theWindowEvents.handleTabHeaderVisibilityChanged(windowInfo.data.isTabHeaderVisible);\r\n        }\r\n        if (windowInfo.type === \"FrameSelectionChanged\") {\r\n            theWindowEvents.handleFrameSelectionChanged(windowInfo.data.newWindowId, windowInfo.data.prevWindowId);\r\n        }\r\n        if (windowInfo.type === \"ButtonClicked\") {\r\n            theWindowEvents.handleFrameButtonClicked(windowInfo.data);\r\n        }\r\n        if (windowInfo.type === \"ButtonAdded\") {\r\n            theWindowEvents.handleFrameButtonAdded(windowInfo.data);\r\n        }\r\n        if (windowInfo.type === \"ButtonRemoved\") {\r\n            theWindowEvents.handleFrameButtonRemoved(windowInfo.data);\r\n        }\r\n        // Clear the window on close event\r\n        if (windowInfo.type === \"Closed\") {\r\n            store_1.default.remove(windowObjectAndEvents);\r\n            theWindowEvents.handleWindowClose();\r\n        }\r\n        // expose to external listeners\r\n        this._registry.execute(\"window-event\", extendedStreamEvent);\r\n    };\r\n    GDEnvironment.prototype.createWindow = function (windowId, options) {\r\n        var windowObjAndEvents = window_1.default(windowId, this.mapToWindowConstructorOptions(options), executor_1.default, this._logger, this._appManagerGetter);\r\n        store_1.default.add(windowObjAndEvents);\r\n        return windowObjAndEvents;\r\n    };\r\n    GDEnvironment.prototype.focusChanged = function (theWindowEvents, theWindow, focus) {\r\n        theWindowEvents.handleFocusChanged(focus);\r\n        if (focus) {\r\n            this._registry.execute(\"got-focus\", theWindow);\r\n        }\r\n        else {\r\n            this._registry.execute(\"lost-focus\", theWindow);\r\n        }\r\n    };\r\n    GDEnvironment.prototype.mapToWindowConstructorOptions = function (args) {\r\n        // TODO\r\n        return {\r\n            name: args.name,\r\n            context: args.context,\r\n            bounds: args.bounds,\r\n            url: args.url,\r\n            title: args.title,\r\n            isVisible: args.isVisible,\r\n            focus: args.isFocused,\r\n            state: args.state,\r\n            frameColor: args.frameColor,\r\n            groupId: args.groupId,\r\n            neighbours: args.neighbors,\r\n            isFocused: args.isFocused,\r\n            isGroupHeaderVisible: args.groupHeaderVisible,\r\n            isCollapsed: args.isCollapsed,\r\n            tabGroupId: args.frameId,\r\n            mode: args.mode,\r\n            isTabHeaderVisible: args.isTabHeaderVisible,\r\n            isTabSelected: args.isActiveTab,\r\n            settings: args.settings,\r\n            windowType: args.windowType,\r\n        };\r\n    };\r\n    GDEnvironment.prototype.getExtendedStreamEvent = function (streamEvent) {\r\n        try {\r\n            var result = __assign({ state: streamEvent.type, windowName: store_1.default.get(streamEvent.windowId).API.name }, streamEvent);\r\n            if (result.state === \"WindowFrameAdded\") {\r\n                result.state = \"TabAttached\";\r\n            }\r\n            if (result.state === \"StateChanged\") {\r\n                result.state = result.data.charAt(0).toUpperCase() + result.data.slice(1);\r\n            }\r\n            if (result.state === \"ButtonAdded\") {\r\n                result.state = \"FrameButtonAdded\";\r\n            }\r\n            if (result.state === \"ButtonRemoved\") {\r\n                result.state = \"FrameButtonRemoved\";\r\n            }\r\n            return result;\r\n        }\r\n        catch (error) {\r\n            return streamEvent;\r\n        }\r\n    };\r\n    return GDEnvironment;\r\n}());\r\nexports.default = GDEnvironment;\r\n//# sourceMappingURL=gd.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/windows/environment/gd/gd.js\n// module id = 78\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar HcExecutor = /** @class */ (function () {\r\n    function HcExecutor() {\r\n    }\r\n    Object.defineProperty(HcExecutor.prototype, \"hostInstance\", {\r\n        get: function () {\r\n            return this.agmTarget;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    HcExecutor.prototype.init = function (agm, instance) {\r\n        this.agm = agm;\r\n        this.agmTarget = instance;\r\n    };\r\n    HcExecutor.prototype.close = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.url === undefined;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Close\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onClose);\r\n        });\r\n    };\r\n    HcExecutor.prototype.navigate = function (resultWindow, newUrl) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.url === newUrl;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Html.OpenUrl\", successHandler, errorHandler, { url: newUrl }, conditionFunc, resultWindow.onUrlChanged, true);\r\n        });\r\n    };\r\n    HcExecutor.prototype.setStyle = function (resultWindow, style) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetWindowStyle\", successHandler, errorHandler, { windowStyleAttributes: JSON.stringify(style) });\r\n        });\r\n    };\r\n    HcExecutor.prototype.setTitle = function (resultWindow, newTitle) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.title === newTitle;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetWindowTitle\", successHandler, errorHandler, { title: newTitle }, conditionFunc, resultWindow.onTitleChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.moveResize = function (resultWindow, dimensions) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                var b = resultWindow.bounds;\r\n                var isSame = true;\r\n                Object.keys(dimensions).forEach(function (key) {\r\n                    if (dimensions[key] !== b[key]) {\r\n                        isSame = false;\r\n                        return;\r\n                    }\r\n                });\r\n                return isSame;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.ResizeAndMove\", successHandler, errorHandler, dimensions, conditionFunc, resultWindow.onBoundsChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.addFrameButton = function (resultWindow, buttonInfo) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.AddFrameButton\", successHandler, errorHandler, { buttonInfo: buttonInfo }, conditionFunc, resultWindow.onFrameButtonAdded);\r\n        });\r\n    };\r\n    HcExecutor.prototype.removeFrameButton = function (resultWindow, buttonId) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.RemoveFrameButton\", successHandler, errorHandler, { buttonId: buttonId }, conditionFunc, resultWindow.onFrameButtonRemoved);\r\n        });\r\n    };\r\n    HcExecutor.prototype.activate = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.isFocused;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Activate\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onFocusChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.focus = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Activate\", successHandler, errorHandler, { focus: true }, conditionFunc, resultWindow.onFocusChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.maximizeRestore = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.MaximizeOrRestoreDown\", successHandler, errorHandler);\r\n        });\r\n    };\r\n    HcExecutor.prototype.maximize = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.state === \"maximized\";\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Maximize\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onMaximized);\r\n        });\r\n    };\r\n    HcExecutor.prototype.restore = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.state === \"normal\";\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Restore\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onNormal);\r\n        });\r\n    };\r\n    HcExecutor.prototype.minimize = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.state === \"minimized\";\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Minimize\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onMinimized);\r\n        });\r\n    };\r\n    HcExecutor.prototype.collapse = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return resultWindow.isCollapsed;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetCollapsed\", successHandler, errorHandler, { collapsed: true }, conditionFunc, resultWindow.onCollapsed);\r\n        });\r\n    };\r\n    HcExecutor.prototype.expand = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return !resultWindow.isCollapsed;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetCollapsed\", successHandler, errorHandler, { collapsed: false }, conditionFunc, resultWindow.onExpanded);\r\n        });\r\n    };\r\n    HcExecutor.prototype.toggleCollapse = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            var subscribeFunc = resultWindow.isCollapsed ? resultWindow.onExpanded : resultWindow.onCollapsed;\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetCollapsed\", successHandler, errorHandler, { title: \"\" }, conditionFunc, subscribeFunc);\r\n        });\r\n    };\r\n    HcExecutor.prototype.snap = function (resultWindow, target, direction) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var sourceWindowId = resultWindow.id;\r\n            var targetWindowId;\r\n            var errorMessage = \"Invalid target parameter - should be an object with property id or a string. Invoked for source window id:\" + resultWindow.id;\r\n            if (!target) {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            if (typeof target === \"string\") {\r\n                targetWindowId = target;\r\n            }\r\n            else if (typeof target.id !== \"undefined\") {\r\n                targetWindowId = target.id;\r\n            }\r\n            else {\r\n                reject(errorMessage);\r\n                return;\r\n            }\r\n            var args = {\r\n                sourceWindowId: sourceWindowId,\r\n                targetWindowId: targetWindowId,\r\n            };\r\n            if (direction) {\r\n                args.snappingEdge = direction;\r\n            }\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Snap\", successHandler, errorHandler, args);\r\n        });\r\n    };\r\n    HcExecutor.prototype.attachTab = function (resultWindow, args) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.AttachTab\", successHandler, errorHandler, args);\r\n        });\r\n    };\r\n    HcExecutor.prototype.detachTab = function (resultWindow, args) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var _options = args || {};\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.DettachTab\", successHandler, errorHandler, args);\r\n        });\r\n    };\r\n    HcExecutor.prototype.setVisible = function (resultWindow, toBeVisible) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (typeof toBeVisible === \"undefined\") {\r\n                toBeVisible = true;\r\n            }\r\n            var conditionFunc = function () {\r\n                return resultWindow.isVisible === toBeVisible;\r\n            };\r\n            var styles = { Hidden: !toBeVisible };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetWindowStyle\", successHandler, errorHandler, { windowStyleAttributes: JSON.stringify(styles) }, conditionFunc, resultWindow.onVisibilityChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.showLoader = function (resultWindow, loader) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var opt = loader || {};\r\n            opt.enabled = true;\r\n            opt.timeout = opt.timeout || -1; // by default show the loader forever\r\n            var argsForSend = { loader: opt };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.UpdateLoader\", successHandler, errorHandler, argsForSend);\r\n        });\r\n    };\r\n    HcExecutor.prototype.hideLoader = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.UpdateLoader\", successHandler, errorHandler, { loader: { enabled: false } });\r\n        });\r\n    };\r\n    HcExecutor.prototype.updateContext = function (resultWindow, context) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!context) {\r\n                reject(\"Invalid context parameter - should be an object. Invoked for source window id:\" + resultWindow.id);\r\n                return;\r\n            }\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.UpdateContext\", successHandler, errorHandler, { context: context }, conditionFunc, resultWindow.onContextUpdated);\r\n        });\r\n    };\r\n    HcExecutor.prototype.lock = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Lock\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onLockingChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.unlock = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.Unlock\", successHandler, errorHandler, {}, conditionFunc, resultWindow.onLockingChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.getIcon = function (resultWindow) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            // TODO check it in HC\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.GetIcon\", successHandler, errorHandler);\r\n        });\r\n    };\r\n    HcExecutor.prototype.setIcon = function (resultWindow, base64Image) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!base64Image) {\r\n                reject(\"Invalid base64Image parameter. Invoked for source window id:\" + resultWindow.id);\r\n                return;\r\n            }\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetIcon\", successHandler, errorHandler, { base64ImageSource: base64Image });\r\n        });\r\n    };\r\n    HcExecutor.prototype.setFrameColor = function (resultWindow, frameColor) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!frameColor) {\r\n                reject(\"Invalid frameColor parameter. Invoked for source window id:\" + resultWindow.id);\r\n                return;\r\n            }\r\n            var conditionFunc = function () {\r\n                return false;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetWindowStyle\", successHandler, errorHandler, { windowStyleAttributes: JSON.stringify({ stickyFrameColor: frameColor }) }, conditionFunc, resultWindow.onFrameColorChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.setTabHeaderVisible = function (resultWindow, toBeTabHeaderVisible) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (typeof toBeTabHeaderVisible === \"undefined\") {\r\n                toBeTabHeaderVisible = true;\r\n            }\r\n            var conditionFunc = function () {\r\n                return resultWindow.isTabHeaderVisible === toBeTabHeaderVisible;\r\n            };\r\n            function successHandler(w) {\r\n                resolve(w);\r\n            }\r\n            function errorHandler(e) {\r\n                reject(e);\r\n            }\r\n            return _this.agmAction(resultWindow, \"T42.Wnd.SetTabHeaderVisible\", successHandler, errorHandler, { toShow: toBeTabHeaderVisible }, conditionFunc, resultWindow.onTabHeaderVisibilityChanged);\r\n        });\r\n    };\r\n    HcExecutor.prototype.execute = function (command, options) {\r\n        return this.agm.invoke(\"T42.Wnd.Execute\", {\r\n            command: command,\r\n            options: options,\r\n        });\r\n    };\r\n    /** Groups */\r\n    HcExecutor.prototype.setGroupHeaderVisible = function (windowId, toShow) {\r\n        return this.agm.invoke(\"T42.Wnd.SetGroupHeaderVisible\", {\r\n            windowId: windowId,\r\n            toShow: toShow,\r\n        }, this.agmTarget);\r\n    };\r\n    HcExecutor.prototype.agmAction = function (resultWindow, action, success, error, args, conditionFunc, subscribeFunc, ignoreTimeout) {\r\n        // Stop if the window is closed\r\n        ignoreTimeout = ignoreTimeout || false;\r\n        if (resultWindow.url === undefined) {\r\n            if (typeof error === \"function\") {\r\n                error(\"Cannot execute a command on a closed window.\");\r\n            }\r\n            return;\r\n        }\r\n        if (typeof conditionFunc === \"undefined\" || conditionFunc()) {\r\n            this.agmInvoke(resultWindow, action, args, success, error);\r\n        }\r\n        else {\r\n            var removeCallback_1 = function () {\r\n                return;\r\n            };\r\n            var isResolved_1 = false;\r\n            var successHandler = function () {\r\n                isResolved_1 = true;\r\n                removeCallback_1();\r\n                if (typeof success === \"function\") {\r\n                    success(resultWindow);\r\n                }\r\n            };\r\n            removeCallback_1 = subscribeFunc(successHandler);\r\n            if (!ignoreTimeout) {\r\n                setTimeout(function () {\r\n                    if (!isResolved_1) {\r\n                        if (typeof error === \"function\") {\r\n                            error(\"Agm invoke timeout! action: \" + action);\r\n                        }\r\n                    }\r\n                }, 2000);\r\n            }\r\n            this.agmInvoke(resultWindow, action, args, function () {\r\n                return;\r\n            }, error);\r\n        }\r\n    };\r\n    HcExecutor.prototype.agmInvoke = function (resultWindow, action, args, success, error) {\r\n        // Add the window ID to the arguments\r\n        args = args || {};\r\n        args.windowId = resultWindow.id;\r\n        // Invoke the AGM method\r\n        this.agm.invoke(action, args, this.agmTarget, {}, successHandler, errorHandler);\r\n        function successHandler() {\r\n            if (typeof success === \"function\") {\r\n                success(resultWindow);\r\n            }\r\n        }\r\n        function errorHandler(err) {\r\n            if (typeof error === \"function\") {\r\n                if (err.all_return_values && err.all_return_values.length > 0) {\r\n                    error(err.all_return_values[0].message);\r\n                }\r\n                else {\r\n                    error(err);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return HcExecutor;\r\n}());\r\nexports.HcExecutor = HcExecutor;\r\nexports.default = new HcExecutor();\r\n//# sourceMappingURL=executor.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/windows/environment/hc/executor.js\n// module id = 79\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = require(\"callback-registry\");\r\nvar store_1 = require(\"../../store\");\r\nvar window_1 = require(\"../../window\");\r\nvar executor_1 = require(\"./executor\");\r\nvar helpers_1 = require(\"../helpers\");\r\nexports.default = (function (agm, logger, appManagerGetter, cntName, wndId) {\r\n    return new Promise(function (resolve, reject) {\r\n        var _registry = CallbackFactory();\r\n        var _logger = logger.subLogger(\"hc-env\");\r\n        var waitTimeout = 10000;\r\n        var _windowId = wndId;\r\n        var hcEnv;\r\n        var instance;\r\n        // We have two cases here:\r\n        // 1. when we are in HC\r\n        // 2. when we are in Browser/Node, but we have also started  HC/GD\r\n        if (typeof cntName !== \"undefined\") {\r\n            instance = { application: \"HtmlContainer.\" + cntName };\r\n        }\r\n        else {\r\n            instance = \"best\";\r\n        }\r\n        var streamPromise = new Promise(function (streamResolve, streamReject) {\r\n            agm.subscribe(\"T42.Wnd.WindowStateChanged\", {\r\n                waitTimeoutMs: waitTimeout,\r\n                target: instance,\r\n            })\r\n                .then(function (stream) {\r\n                stream.onData(function (streamData) {\r\n                    instance = streamData.server;\r\n                    updateWindow(streamData.data.state, streamData.data);\r\n                });\r\n                stream.onFailed(function (err) {\r\n                    streamReject(err);\r\n                });\r\n                streamResolve();\r\n            })\r\n                .catch(function (err) {\r\n                streamReject(\"Can not subscribe for stream T42.Wnd.WindowStateChanged. Err: \" + err);\r\n            });\r\n        });\r\n        var listWindowsPromise = new Promise(function (listWndResolve, listWndReject) {\r\n            agm.invoke(\"T42.Wnd.ListWindows\", {}, instance, { waitTimeoutMs: waitTimeout })\r\n                .then(function (result) {\r\n                // add the server object\r\n                instance = result.executed_by;\r\n                // populate windows\r\n                Object.keys(result.returned).forEach(function (existingWindow) {\r\n                    var windowInfo = result.returned[existingWindow];\r\n                    var windowObjAndEvents = createWindow(windowInfo.windowId, windowInfo);\r\n                    // Added to store, showing to world\r\n                    store_1.default.markReadyToShow(windowObjAndEvents.API.id);\r\n                });\r\n                listWndResolve();\r\n            })\r\n                .catch(function (e) {\r\n                listWndReject(\"Can not invoke T42.Wnd.ListWindows method. Err: \" + e);\r\n            });\r\n        });\r\n        Promise.all([streamPromise, listWindowsPromise])\r\n            .then(function () {\r\n            // Init the executor, if we have container name - use it, if not get the first one from the collection\r\n            executor_1.default.init(agm, instance);\r\n            resolve(hcEnv);\r\n        })\r\n            .catch(function (e) {\r\n            reject(\"can not subscribe for stream T42.Wnd.WindowStateChanged or can not invoke T42.Wnd.ListWindows \");\r\n        });\r\n        function updateWindow(eventType, windowInfo) {\r\n            // if new window handle it separately\r\n            if (eventType === \"Created\") {\r\n                var win = createWindow(windowInfo.windowId, windowInfo);\r\n                _registry.execute(\"window-event\", windowInfo);\r\n                // if the window has focus, trigger got focus event\r\n                if (windowInfo.focus) {\r\n                    focusChanged(win.Events, win.API, true);\r\n                }\r\n                return;\r\n            }\r\n            // otherwise check if the window is in our internal collections and update its state\r\n            var windowObjectAndEvents = store_1.default.get(windowInfo.windowId);\r\n            if (!windowObjectAndEvents) {\r\n                _logger.error(\"received update for unknown window. Stream:', \" + JSON.stringify(windowInfo, null, 4));\r\n                return;\r\n            }\r\n            var theWindow = windowObjectAndEvents.API;\r\n            var theWindowEvents = windowObjectAndEvents.Events;\r\n            var oldFrameColor = theWindow.frameColor;\r\n            // const property: string = \"handle\" + eventType;\r\n            // // Try the generic handlers\r\n            // if (theWindowEvents.hasOwnProperty(property)) {\r\n            //     theWindowEvents[property](windowInfo);\r\n            // }\r\n            if (eventType === \"Ready\") {\r\n                store_1.default.setReadyState(windowObjectAndEvents.API.id);\r\n            }\r\n            if (eventType === \"TitleChanged\") {\r\n                theWindowEvents.handleTitleChanged(windowInfo.windowTitle);\r\n            }\r\n            if (eventType === \"UrlChanged\") {\r\n                store_1.default.setUrlChangedState(windowObjectAndEvents.API.id);\r\n                theWindowEvents.handleUrlChanged(windowInfo.url);\r\n            }\r\n            if (eventType === \"WindowStyleChanged\") {\r\n                var parsedWsa = parseWindowStyleAttributes(windowInfo.windowStyleAttributes);\r\n                theWindowEvents.handleWindowSettingsChanged(parsedWsa);\r\n                theWindowEvents.handleVisibilityChanged(!parsedWsa.hidden);\r\n            }\r\n            if (eventType === \"Normal\" ||\r\n                eventType === \"Maximized\" ||\r\n                eventType === \"Minimized\" ||\r\n                eventType === \"Collapsed\" ||\r\n                eventType === \"Expanded\") {\r\n                var state = eventType.toLowerCase();\r\n                theWindowEvents.handleWindowChangeState(state);\r\n            }\r\n            if (eventType === \"ContextUpdated\") {\r\n                theWindowEvents.handleContextUpdated(windowInfo.context);\r\n            }\r\n            if (eventType === \"FrameButtonAdded\") {\r\n                theWindowEvents.handleFrameButtonAdded(windowInfo);\r\n            }\r\n            if (eventType === \"FrameButtonRemoved\") {\r\n                theWindowEvents.handleFrameButtonRemoved(windowInfo);\r\n            }\r\n            if (eventType === \"FrameButtonClicked\") {\r\n                theWindowEvents.handleFrameButtonClicked(windowInfo);\r\n            }\r\n            if (eventType === \"FrameSelectionChanged\") {\r\n                theWindowEvents.handleFrameSelectionChanged(windowInfo.newWindow, windowInfo.prevWindow);\r\n            }\r\n            if (eventType === \"FrameIsLockedChanged\") {\r\n                theWindowEvents.handleFrameIsLockedChanged(windowInfo.isLocked);\r\n            }\r\n            if (eventType === \"TabHeaderVisibilityChanged\") {\r\n                theWindowEvents.handleTabHeaderVisibilityChanged(windowInfo.tabHeaderVisible);\r\n            }\r\n            if (eventType === \"BoundsChanged\") {\r\n                var bounds = {\r\n                    height: windowInfo.height,\r\n                    left: windowInfo.left,\r\n                    top: windowInfo.top,\r\n                    width: windowInfo.width,\r\n                };\r\n                theWindowEvents.handleBoundsChanged(bounds);\r\n            }\r\n            if (eventType === \"FocusChanged\") {\r\n                focusChanged(theWindowEvents, theWindow, windowInfo.focus);\r\n            }\r\n            if (eventType === \"FrameColorChanged\") {\r\n                if (oldFrameColor !== windowInfo.frameColor) {\r\n                    theWindowEvents.handleFrameColorChanged(windowInfo.frameColor);\r\n                    _registry.execute(\"frame-color-changed\", theWindow);\r\n                }\r\n            }\r\n            if (eventType === \"FrameAttached\") {\r\n                theWindowEvents.handleFrameAttached(windowInfo.tabGroupId, windowInfo.tabHeaderVisible);\r\n            }\r\n            if (eventType === \"TabAttached\") {\r\n                theWindowEvents.handleAttached(windowInfo.tabGroupId, windowInfo.tabHeaderVisible);\r\n                var winsToBeNotified_1 = helpers_1.getWindowsByTabGroupId(theWindow.id, windowInfo.tabGroupId);\r\n                // Getting all windows, except current, with same tabGroupId\r\n                Object.keys(winsToBeNotified_1).forEach(function (id) {\r\n                    var win = winsToBeNotified_1[id];\r\n                    // Executing event windowAttached to all windows\r\n                    win.Events.handleWindowAttached(theWindow);\r\n                });\r\n                _registry.execute(\"tab-attached\", theWindow, windowInfo.tabGroupId, windowInfo.tabHeaderVisible);\r\n            }\r\n            if (eventType === \"TabDettached\") {\r\n                // In the event, tabGroupId is empty, will be update on the next event FrameAttached\r\n                var oldTabGroupId = theWindow.tabGroupId;\r\n                theWindowEvents.handleDetached(windowInfo.tabGroupId);\r\n                var winsToBeNotified_2 = helpers_1.getWindowsByTabGroupId(theWindow.id, oldTabGroupId);\r\n                Object.keys(winsToBeNotified_2).forEach(function (id) {\r\n                    var win = winsToBeNotified_2[id];\r\n                    win.Events.handleWindowDetached(theWindow);\r\n                });\r\n                _registry.execute(\"tab-detached\", theWindow, windowInfo.tabGroupId, theWindow.tabGroupId);\r\n            }\r\n            if (eventType === \"CompositionChanged\") {\r\n                theWindowEvents.handleCompositionChanged(windowInfo.neighbours, windowInfo.groupId);\r\n                _registry.execute(\"composition-changed\", windowInfo);\r\n            }\r\n            if (eventType === \"GroupHeaderVisibilityChanged\") {\r\n                theWindowEvents.handleGroupHeaderVisibilityChanged(windowInfo.groupHeaderVisible);\r\n                _registry.execute(\"group-header-changed\", windowInfo);\r\n            }\r\n            // Clear the window on close event\r\n            if (eventType === \"Closed\") {\r\n                if (windowInfo.focus) {\r\n                    // raise lost focus event\r\n                    focusChanged(theWindowEvents, theWindow, false);\r\n                }\r\n                store_1.default.remove(windowObjectAndEvents);\r\n                theWindowEvents.handleWindowClose();\r\n            }\r\n            // expose to external listeners\r\n            _registry.execute(\"window-event\", windowInfo);\r\n        }\r\n        function focusChanged(theWindowEvents, theWindow, focus) {\r\n            theWindowEvents.handleFocusChanged(focus);\r\n            if (focus) {\r\n                _registry.execute(\"got-focus\", theWindow);\r\n            }\r\n            else {\r\n                _registry.execute(\"lost-focus\", theWindow);\r\n            }\r\n        }\r\n        function createWindow(windowId, args) {\r\n            var windowObjAndEvents = window_1.default(windowId, mapToWindowConstructorOptions(args), executor_1.default, _logger, appManagerGetter);\r\n            store_1.default.add(windowObjAndEvents);\r\n            return windowObjAndEvents;\r\n        }\r\n        function open(name, url, options, success, error) {\r\n            options = options || {};\r\n            // relativeTo fix\r\n            if (typeof options.relativeTo !== \"undefined\" && typeof options.relativeTo !== \"string\") {\r\n                options.relativeTo = options.relativeTo.id || \"\";\r\n            }\r\n            options.windowName = name;\r\n            options.url = url;\r\n            agm.invoke(\"T42.Html.CreateWindow\", options)\r\n                .then(function (message) {\r\n                if (message.returned !== undefined) {\r\n                    var id = message.returned.id;\r\n                    success(id);\r\n                }\r\n                else {\r\n                    error(\"failed to execute T42.Html.CreateWindow - unknown reason\");\r\n                }\r\n            }).catch(function (e) {\r\n                if (typeof error === \"function\") {\r\n                    error(e);\r\n                }\r\n            });\r\n        }\r\n        function tabAttached(callback) {\r\n            return _registry.add(\"tab-attached\", callback);\r\n        }\r\n        function tabDetached(callback) {\r\n            return _registry.add(\"tab-detached\", callback);\r\n        }\r\n        function onWindowFrameColorChanged(callback) {\r\n            return _registry.add(\"frame-color-changed\", callback);\r\n        }\r\n        function onWindowGotFocus(callback) {\r\n            return _registry.add(\"got-focus\", callback);\r\n        }\r\n        function onWindowLostFocus(callback) {\r\n            return _registry.add(\"lost-focus\", callback);\r\n        }\r\n        function onEvent(callback) {\r\n            return _registry.add(\"window-event\", callback);\r\n        }\r\n        function my() {\r\n            return _windowId;\r\n        }\r\n        function onCompositionChanged(callback) {\r\n            return _registry.add(\"composition-changed\", callback);\r\n        }\r\n        function onGroupHeaderVisibilityChanged(callback) {\r\n            return _registry.add(\"group-header-changed\", callback);\r\n        }\r\n        function mapToWindowConstructorOptions(args) {\r\n            var _state = typeof args.WindowState !== \"undefined\" ? args.WindowState.toLowerCase() : \"normal\";\r\n            var windowStyleAttributes = parseWindowStyleAttributes(args.windowStyleAttributes);\r\n            return {\r\n                name: args.windowName,\r\n                url: args.url,\r\n                title: args.windowTitle,\r\n                context: args.context,\r\n                bounds: {\r\n                    height: args.height,\r\n                    left: args.left,\r\n                    top: args.top,\r\n                    width: args.width,\r\n                },\r\n                focus: args.focus,\r\n                frameColor: args.frameColor,\r\n                groupId: args.groupId,\r\n                isCollapsed: args.isCollapsed,\r\n                isGroupHeaderVisible: args.isGroupHeaderVisible,\r\n                isLocked: args.isLocked,\r\n                isTabHeaderVisible: args.isTabHeaderVisible,\r\n                isTabSelected: args.isTabSelected,\r\n                isVisible: !windowStyleAttributes.hidden,\r\n                isFocused: windowStyleAttributes.focus,\r\n                mode: windowStyleAttributes.mode,\r\n                settings: windowStyleAttributes,\r\n                state: _state,\r\n                tabGroupId: args.tabGroupId,\r\n                neighbours: args.neighbours,\r\n            };\r\n        }\r\n        function parseWindowStyleAttributes(windowStyles) {\r\n            if (windowStyles === undefined) {\r\n                return {};\r\n            }\r\n            if (typeof windowStyles !== \"object\") {\r\n                return JSON.parse(windowStyles);\r\n            }\r\n            return windowStyles;\r\n        }\r\n        hcEnv = {\r\n            my: my,\r\n            onEvent: onEvent,\r\n            open: open,\r\n            tabAttached: tabAttached,\r\n            tabDetached: tabDetached,\r\n            onWindowFrameColorChanged: onWindowFrameColorChanged,\r\n            executor: executor_1.default,\r\n            onCompositionChanged: onCompositionChanged,\r\n            onGroupHeaderVisibilityChanged: onGroupHeaderVisibilityChanged,\r\n            onWindowGotFocus: onWindowGotFocus,\r\n            onWindowLostFocus: onWindowLostFocus,\r\n        };\r\n    });\r\n});\r\n//# sourceMappingURL=hc.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/windows/environment/hc/hc.js\n// module id = 80\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = require(\"callback-registry\");\r\nvar store_1 = require(\"./store\");\r\nexports.default = (function (id, executor) {\r\n    var _registry = CallbackFactory();\r\n    var _windowsId = [];\r\n    var isGroupHeaderVisibleCalled;\r\n    //#region \"API functions\"\r\n    function addWindow(winId) {\r\n        if (_windowsId.indexOf(winId) === -1) {\r\n            _windowsId.push(winId);\r\n            var window_1 = store_1.default.get(winId);\r\n            window_1.Events.handleGroupAssociation(groupObject);\r\n            _registry.execute(\"window-added\", groupObject, window_1.API);\r\n        }\r\n    }\r\n    function removeWindow(winId) {\r\n        var index = _windowsId.indexOf(winId);\r\n        if (index !== -1) {\r\n            _windowsId.splice(index, 1);\r\n            var window_2 = _mapToWindowObject(winId);\r\n            _registry.execute(\"window-removed\", groupObject, window_2);\r\n        }\r\n    }\r\n    function find(window, success) {\r\n        var winId;\r\n        if (typeof window === \"string\") {\r\n            winId = window;\r\n        }\r\n        else {\r\n            winId = window.id;\r\n        }\r\n        var index = _windowsId.indexOf(winId);\r\n        if (index !== -1) {\r\n            var mappedWindow = _mapToWindowObject(_windowsId[index]);\r\n            if (typeof success === \"function\") {\r\n                success(mappedWindow);\r\n            }\r\n            return mappedWindow;\r\n        }\r\n    }\r\n    function windows(success) {\r\n        var mappedWindows = _mapToWindowObjects();\r\n        if (typeof success === \"function\") {\r\n            success(mappedWindows);\r\n        }\r\n        return mappedWindows;\r\n    }\r\n    function showHeader(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setGroupHeaderVisible(_windowsId[0], true)\r\n                .then(function (w) {\r\n                if (typeof success === \"function\") {\r\n                    success(groupObject);\r\n                }\r\n                resolve(groupObject);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    function hideHeader(success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.setGroupHeaderVisible(_windowsId[0], false)\r\n                .then(function (w) {\r\n                if (typeof success === \"function\") {\r\n                    success(groupObject);\r\n                }\r\n                resolve(groupObject);\r\n            })\r\n                .catch(function (e) {\r\n                return;\r\n            });\r\n        });\r\n    }\r\n    function execute(command, options, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            executor.execute(command, options)\r\n                .then(function (w) {\r\n                if (typeof success === \"function\") {\r\n                    success(groupObject);\r\n                }\r\n                resolve(groupObject);\r\n            })\r\n                .catch(function (e) {\r\n                reject(e);\r\n            });\r\n        });\r\n    }\r\n    //#endregion \"API functions\"\r\n    //#region \"Stream function\"\r\n    function handleGroupHeaderVisibilityChanged(windowInfo) {\r\n        if (isGroupHeaderVisibleCalled !== windowInfo.groupHeaderVisible) {\r\n            isGroupHeaderVisibleCalled = windowInfo.groupHeaderVisible;\r\n            _registry.execute(\"header-visibility-changed\", groupObject);\r\n        }\r\n    }\r\n    //#endregion \"Stream function\"\r\n    //#region \"Internal function\"\r\n    function _mapToWindowObjects() {\r\n        var winObjects = [];\r\n        _windowsId.forEach(function (winId) {\r\n            var windowObject = _mapToWindowObject(winId);\r\n            if (typeof windowObject !== \"undefined\") {\r\n                winObjects.push(windowObject);\r\n            }\r\n        });\r\n        return winObjects;\r\n    }\r\n    function _mapToWindowObject(windowId) {\r\n        return store_1.default.get(windowId) ? store_1.default.get(windowId).API : undefined;\r\n    }\r\n    function _getGroupHeaderVisibility() {\r\n        // if one of the windows has a flag hideGroupHeader the group header should be off.\r\n        var _isGroupHeaderVisible;\r\n        var result = _mapToWindowObjects().filter(function (w) {\r\n            return !w.isGroupHeaderVisible;\r\n        });\r\n        _isGroupHeaderVisible = result.length === 0;\r\n        return _isGroupHeaderVisible;\r\n    }\r\n    //#endregion \"Internal function\"\r\n    //#region \"Events\"\r\n    function onHeaderVisibilityChanged(callback) {\r\n        return _registry.add(\"header-visibility-changed\", callback);\r\n    }\r\n    function onWindowAdded(callback) {\r\n        return _registry.add(\"window-added\", callback);\r\n    }\r\n    function onWindowRemoved(callback) {\r\n        return _registry.add(\"window-removed\", callback);\r\n    }\r\n    //#endregion \"Events\"\r\n    //#region \"API\"\r\n    var groupObject = {\r\n        id: id,\r\n        get windows() {\r\n            return windows();\r\n        },\r\n        find: find,\r\n        get isHeaderVisible() {\r\n            return _getGroupHeaderVisibility();\r\n        },\r\n        showHeader: showHeader,\r\n        hideHeader: hideHeader,\r\n        maximize: function (success, error) {\r\n            return execute(\"maximize\", { groupId: id }, success, error);\r\n        },\r\n        restore: function (success, error) {\r\n            return execute(\"restore\", { groupId: id }, success, error);\r\n        },\r\n        onHeaderVisibilityChanged: onHeaderVisibilityChanged,\r\n        onWindowAdded: onWindowAdded,\r\n        onWindowRemoved: onWindowRemoved,\r\n    };\r\n    var internal = {\r\n        addWindow: addWindow,\r\n        removeWindow: removeWindow,\r\n        handleGroupHeaderVisibilityChanged: handleGroupHeaderVisibilityChanged,\r\n    };\r\n    return {\r\n        groupAPI: groupObject,\r\n        groupInternal: internal,\r\n    };\r\n    //#endregion \"API\"\r\n});\r\n//# sourceMappingURL=group.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/windows/group.js\n// module id = 81\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = require(\"callback-registry\");\r\nvar group_1 = require(\"./group\");\r\nvar store_1 = require(\"./store\");\r\nexports.default = (function (environment, logger) {\r\n    var _logger = logger.subLogger(\"groups\");\r\n    var _registry = CallbackFactory();\r\n    var _groups = {};\r\n    // Getting already existing windows and create Group API for each window\r\n    var windows = store_1.default.list;\r\n    Object.keys(windows).forEach(function (k) {\r\n        addNewWindow(windows[k]);\r\n    });\r\n    environment.onCompositionChanged(function (windowInfo) {\r\n        handleCompositionChanged(windowInfo);\r\n    });\r\n    environment.onGroupHeaderVisibilityChanged(function (windowInfo) {\r\n        var windowId = windowInfo.windowId;\r\n        var group = findGroupByWindow(windowId);\r\n        if (typeof group !== \"undefined\") {\r\n            var groupEvents = _groups[group.id];\r\n            groupEvents.groupInternal.handleGroupHeaderVisibilityChanged(windowInfo);\r\n        }\r\n    });\r\n    store_1.default.onAdded(function (win) {\r\n        addNewWindow(win);\r\n    });\r\n    store_1.default.onRemoved(function (win) {\r\n        removeWindow(win);\r\n    });\r\n    // Methods\r\n    function my() {\r\n        return findGroupByWindow(environment.my());\r\n    }\r\n    function list(success) {\r\n        var result = Object.keys(_groups).map(function (groupId) {\r\n            if (_groups[groupId]) {\r\n                return _groups[groupId].groupAPI;\r\n            }\r\n        });\r\n        if (typeof success === \"function\") {\r\n            success(result);\r\n        }\r\n        return result;\r\n    }\r\n    function findGroupByWindow(winId, success) {\r\n        var windowId;\r\n        if (typeof winId === \"undefined\") {\r\n            logger.debug(\"trying to find a group by a window, but winId is undefined\");\r\n            return;\r\n        }\r\n        if (typeof winId === \"string\") {\r\n            windowId = winId;\r\n        }\r\n        else {\r\n            windowId = winId.id;\r\n        }\r\n        var groupFound;\r\n        Object.keys(_groups).forEach(function (groupId) {\r\n            var group = _groups[groupId].groupAPI;\r\n            if (group.find(windowId) !== undefined) {\r\n                groupFound = group;\r\n                return;\r\n            }\r\n        });\r\n        if (typeof success === \"function\") {\r\n            success(groupFound);\r\n        }\r\n        return groupFound;\r\n    }\r\n    // Events\r\n    function onWindowMoved(callback) {\r\n        return _registry.add(\"window-moved\", callback);\r\n    }\r\n    // Private\r\n    function createOrGetGroup(groupId) {\r\n        if (!_groups.hasOwnProperty(groupId)) {\r\n            var createdGroup = group_1.default(groupId, environment.executor);\r\n            _groups[groupId] = createdGroup;\r\n            return createdGroup;\r\n        }\r\n        else {\r\n            return _groups[groupId];\r\n        }\r\n    }\r\n    function deleteGroup(groupId) {\r\n        if (_groups.hasOwnProperty(groupId) && typeof _groups[groupId] !== \"undefined\") {\r\n            if (_groups[groupId].groupAPI.windows.length === 0) {\r\n                delete _groups[groupId];\r\n            }\r\n        }\r\n    }\r\n    function addNewWindow(win) {\r\n        _logger.trace(\"Adding new window \" + win.API.id + \" to win.API.groupId \" + win.API.groupId);\r\n        var group = addWindow(win);\r\n        if (group) {\r\n            _logger.trace(\"handleGroupAssociation \" + win.API.id + \" to group.groupAPI.id \" + group.groupAPI.id);\r\n            win.Events.handleGroupAssociation(group.groupAPI);\r\n        }\r\n    }\r\n    function addWindow(win, groupId) {\r\n        var windowGroupId = groupId || win.API.groupId;\r\n        var windowId = win.API.id;\r\n        if (typeof windowGroupId === \"undefined\" || typeof windowId === \"undefined\") {\r\n            _logger.debug(\"trying to add a window without group - winId: \" + windowId);\r\n            return;\r\n        }\r\n        var group = createOrGetGroup(windowGroupId);\r\n        group.groupInternal.addWindow(windowId);\r\n        return group;\r\n    }\r\n    function removeWindow(win, groupId) {\r\n        var windowId = win.API.id;\r\n        var windowGroupId = groupId || win.API.groupId;\r\n        if (typeof windowGroupId !== \"undefined\") {\r\n            var group = _groups[windowGroupId];\r\n            group.groupInternal.removeWindow(windowId);\r\n            win.Events.handleGroupAssociation(undefined);\r\n            deleteGroup(windowGroupId);\r\n        }\r\n    }\r\n    function handleCompositionChanged(windowInfo) {\r\n        var newGroupId = windowInfo.groupId;\r\n        var windowId = windowInfo.windowId;\r\n        var oldGroup = findGroupByWindow(windowId);\r\n        var oldGroupId = oldGroup ? oldGroup.id : undefined;\r\n        _logger.trace(\"handleCompositionChanged newGroupId: \" + newGroupId + \" windowId: \" + windowId + \" oldGroup: \" + oldGroupId);\r\n        if (oldGroupId === newGroupId) {\r\n            _logger.trace(\"handleCompositionChanged newGroupId: \" + newGroupId + \" windowId: \" + windowId + \" oldGroup: \" + oldGroupId + \" are the same - returning...\");\r\n            return;\r\n        }\r\n        var win = store_1.default.get(windowId) || store_1.default.get(windowId);\r\n        var newGroup = addWindow(win, newGroupId);\r\n        if (oldGroup) {\r\n            removeWindow(win, oldGroupId);\r\n            _registry.execute(\"window-moved\", windowId, oldGroup, newGroupId);\r\n        }\r\n        win.Events.handleGroupChanged(newGroup.groupAPI, oldGroup);\r\n    }\r\n    //#region \"API\"\r\n    var groups = {\r\n        get my() {\r\n            return my();\r\n        },\r\n        list: list,\r\n        findGroupByWindow: findGroupByWindow,\r\n    };\r\n    //#endregion \"API\r\n    var events = { onWindowMoved: onWindowMoved };\r\n    return {\r\n        groupsAPI: groups,\r\n        groupsEvents: events,\r\n    };\r\n});\r\n//# sourceMappingURL=groups.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/windows/groups.js\n// module id = 82\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar CallbackFactory = require(\"callback-registry\");\r\nvar detector_1 = require(\"./environment/detector\");\r\nvar groups_1 = require(\"./groups\");\r\nvar store_1 = require(\"./store\");\r\nexports.default = (function (agm, logger, appManagerGetter, gdMajorVersion) {\r\n    var _registry = CallbackFactory();\r\n    var _logger = logger;\r\n    var groups;\r\n    var environment;\r\n    store_1.default.init(_logger);\r\n    var isReady = new Promise(function (resolve, reject) {\r\n        detector_1.default(agm, _logger, appManagerGetter, gdMajorVersion)\r\n            .then(function (env) {\r\n            environment = env;\r\n            groups = groups_1.default(env, _logger);\r\n            resolve();\r\n        })\r\n            .catch(function (e) {\r\n            var err = \"Environment detector fails with: \" + e;\r\n            _logger.error(err);\r\n            reject(err);\r\n        });\r\n    });\r\n    function ready() {\r\n        return isReady;\r\n    }\r\n    function my() {\r\n        var myWindow = store_1.default.getIfReady(environment.my());\r\n        return myWindow ? myWindow.API : undefined;\r\n    }\r\n    function open(name, url, options, success, error) {\r\n        return new Promise(function (resolve, reject) {\r\n            var errorHandler = function (errorResponse) {\r\n                if (typeof error === \"function\") {\r\n                    error(errorResponse);\r\n                }\r\n                reject(errorResponse);\r\n            };\r\n            var successHandler = function (id) {\r\n                store_1.default.waitFor(id)\r\n                    .then(function (win) {\r\n                    if (typeof success === \"function\") {\r\n                        success(win);\r\n                    }\r\n                    resolve(win);\r\n                })\r\n                    .catch(errorHandler);\r\n            };\r\n            environment.open(name, url, options, successHandler, errorHandler);\r\n        });\r\n    }\r\n    function find(name, success, error) {\r\n        var windows = store_1.default.list;\r\n        var windowsForListing = Object.keys(windows).reduce(function (memo, winId) {\r\n            var window = windows[winId];\r\n            if (window && window.API.name === name) {\r\n                memo.push(window.API);\r\n            }\r\n            return memo;\r\n        }, []);\r\n        if (typeof success !== \"function\") {\r\n            return windowsForListing[0];\r\n        }\r\n        if (windowsForListing.length > 0) {\r\n            success(windowsForListing[0]);\r\n        }\r\n        else {\r\n            if (typeof error === \"function\") {\r\n                error(\"There is no window with name:\" + name);\r\n            }\r\n        }\r\n    }\r\n    function findById(id, success, error) {\r\n        var windows = store_1.default.list;\r\n        var windowsForListing = Object.keys(windows).reduce(function (memo, winId) {\r\n            var window = windows[winId];\r\n            if (typeof window !== \"undefined\" && window.API.id === id) {\r\n                memo.push(window.API);\r\n            }\r\n            return memo;\r\n        }, []);\r\n        if (typeof success !== \"function\") {\r\n            return windowsForListing[0];\r\n        }\r\n        if (windowsForListing.length > 0) {\r\n            success(windowsForListing[0]);\r\n        }\r\n        else {\r\n            if (typeof error === \"function\") {\r\n                error(\"There is no window with such id:\" + id);\r\n            }\r\n        }\r\n    }\r\n    function list(success) {\r\n        var windows = store_1.default.list;\r\n        var windowsForListing = Object.keys(windows)\r\n            .map(function (k) {\r\n            return windows[k].API;\r\n        });\r\n        if (typeof success !== \"function\") {\r\n            return windowsForListing;\r\n        }\r\n        success(windowsForListing);\r\n    }\r\n    function windowAdded(callback) {\r\n        return _registry.add(\"window-added\", callback);\r\n    }\r\n    function windowRemoved(callback) {\r\n        return _registry.add(\"window-removed\", callback);\r\n    }\r\n    function tabAttached(callback) {\r\n        return isReady.then(function () {\r\n            environment.tabAttached(callback);\r\n        });\r\n    }\r\n    function tabDetached(callback) {\r\n        return isReady.then(function () {\r\n            environment.tabDetached(callback);\r\n        });\r\n    }\r\n    function onWindowFrameColorChanged(callback) {\r\n        return isReady.then(function () {\r\n            return environment.onWindowFrameColorChanged(callback);\r\n        });\r\n    }\r\n    function onWindowGotFocus(callback) {\r\n        var unsubscribe;\r\n        isReady.then(function () {\r\n            unsubscribe = environment.onWindowGotFocus(callback);\r\n        });\r\n        return function () {\r\n            if (unsubscribe) {\r\n                unsubscribe();\r\n            }\r\n        };\r\n    }\r\n    function onWindowLostFocus(callback) {\r\n        var unsubscribe;\r\n        isReady.then(function () {\r\n            unsubscribe = environment.onWindowLostFocus(callback);\r\n        });\r\n        return function () {\r\n            if (unsubscribe) {\r\n                unsubscribe();\r\n            }\r\n        };\r\n    }\r\n    function onEvent(callback) {\r\n        var unsubFunc;\r\n        var unsubscribed = false;\r\n        isReady.then(function () {\r\n            if (unsubscribed) {\r\n                return;\r\n            }\r\n            unsubFunc = environment.onEvent(callback);\r\n        });\r\n        return function () {\r\n            unsubscribed = true;\r\n            if (unsubFunc) {\r\n                unsubFunc();\r\n            }\r\n        };\r\n    }\r\n    function handleWindowAdded(w) {\r\n        _registry.execute(\"window-added\", w.API);\r\n    }\r\n    function handleWindowRemoved(w) {\r\n        _registry.execute(\"window-removed\", w.API);\r\n    }\r\n    store_1.default.onReadyWindow(handleWindowAdded);\r\n    store_1.default.onRemoved(handleWindowRemoved);\r\n    // The API itself\r\n    return {\r\n        my: my,\r\n        open: open,\r\n        find: find,\r\n        findById: findById,\r\n        list: list,\r\n        ready: ready,\r\n        onWindowAdded: windowAdded,\r\n        windowAdded: windowAdded,\r\n        onWindowRemoved: windowRemoved,\r\n        windowRemoved: windowRemoved,\r\n        onTabAttached: tabAttached,\r\n        onTabDetached: tabDetached,\r\n        onWindowFrameColorChanged: onWindowFrameColorChanged,\r\n        get groups() {\r\n            return groups.groupsAPI;\r\n        },\r\n        onWindowGotFocus: onWindowGotFocus,\r\n        onWindowLostFocus: onWindowLostFocus,\r\n        onEvent: onEvent,\r\n    };\r\n});\r\n//# sourceMappingURL=main.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src_js/windows/main.js\n// module id = 83\n// module chunks = 0"],"sourceRoot":""}