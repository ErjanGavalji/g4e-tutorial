(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
!function(){"function"!=typeof[].forEach&&(require("es5-shim"),require("es5-shim/es5-sham"));var i=require("tick42-metrics"),e=require("tick42-agm"),n=require("tick42-gateway-connection"),t=require("tick42-logger"),o=require("tick42-appconfig/src/js/appconfig"),r=require("tick42-windows"),a=require("tick42-app-manager"),c=require("tick42-activity");if(window.glue_auto_initialize!==!1){var s={};s.version="2.3.0";var w={identity:{system:"Tick42"}},l={identity:{system:"Tick42"}},d={instance:{},server:{presence_interval:3e3}};s.connection=void 0;var g;if(void 0!==window.htmlContainer)g=window.agm_application||window.htmlContainer.containerName+"."+window.htmlContainer.browserWindowName,d.instance.application=g,w.identity.system="HtmlContainer."+window.htmlContainer.containerName,w.identity.service="JS."+window.htmlContainer.browserWindowName,w.identity.instance="~"+window.htmlContainer.machineName,void 0!==window.htmlContainer.appConfigFacade&&void 0!==window.htmlContainer.appConfigFacade.config&&(s.appconfig=o(),s.appconfig.init(function(){function i(i){return i.replace(/\{([^{}]*)\}/g,function(i,e){var n=this;return e.split(".").forEach(function(i){n&&(n=n[i])}),"string"==typeof n||"number"==typeof n?n:i})}var e=window.htmlContainer.appConfigFacade.config,n={};return Object.keys(e.identity).forEach(function(t){var o=i(e.identity[t]);n[t]=o}),e.identity=n,e}())),s.connection=n();else{var m,p={};if("function"!=typeof window.WebSocket){m="HTTP";var u="http:"===window.location.protocol?"http://localhost:22037":"https://localhost:22037";p.http_url=window.glue_http_url||u}else{m="WS";var v="http:"===window.location.protocol?"ws://localhost:22037":"wss://localhost:22037";p.websocket_url=window.glue_ws_url||v}var y=m+Math.floor(1e10*Math.random());g=window.agm_application||document.title+y,d.instance.application=g,w.identity.system="Browser",w.identity.service=document.title||"unknown",w.identity.instance="~"+y,s.connection=n(p)}w.connection=s.connection,l.connection=s.connection,d.connection=s.connection,w.identity.system=window.glue_metric_system||w.identity.system,w.identity.service=window.glue_metric_service||w.identity.service,w.identity.instance=window.glue_metric_instance||w.identity.instance,s.logger=t(w),l.identity=w.identity,l.logger=s.logger.subLogger("metrics"),s.metrics=i(l).subSystem("App"),s.logger.metricsLevel("warn",s.metrics.parent.subSystem("LogEvents")),d.instance.application=window.glue_agm_application||d.instance.application,d.metrics=s.metrics.subSystem("AGM"),s.agm=e(d);var f=window.htmlContainer?window.htmlContainer.activityFacade:void 0;if("undefined"!=typeof f){var h=s.logger.subLogger("activity");h.publishLevel("debug"),h.consoleLevel("info"),h.metricsLevel("off"),s.activities=c({agm:s.agm,logger:h})}s.windows=r(s.agm),s.appManager=a(s.agm,s.windows),s.info={glueVersion:"2.3.0",activities:s.activities?s.activities.version:"unknown",metrics:s.metrics.repo.version,agm:s.agm.version,windows:s.windows.version,logger:s.logger.version,appManager:s.appManager.version,connection:s.connection.version};var _=window.glue;s.noConflict=function(){return window.glue=_,s},window.glue=s,module.exports=s}}();

},{"es5-shim":5,"es5-shim/es5-sham":4,"tick42-activity":12,"tick42-agm":30,"tick42-app-manager":39,"tick42-appconfig/src/js/appconfig":44,"tick42-gateway-connection":50,"tick42-logger":57,"tick42-metrics":72,"tick42-windows":73}],2:[function(require,module,exports){
(function(){"use strict";function t(t,e){this.options=e||{},this.reset(t)}var e=Array.prototype.slice,i=Object.prototype.toString;t.VERSION="0.0.8",t.LEFT=0,t.CENTER=1,t.RIGHT=2,t.factory=function(e,i){return new t(e,i)},t.align=function(e,i,r,n){return e===t.LEFT?t.alignLeft(i,r,n):e===t.RIGHT?t.alignRight(i,r,n):e===t.CENTER?t.alignCenter(i,r,n):t.alignAuto(i,r,n)},t.alignLeft=function(t,e,i){if(!e||0>e)return"";(void 0===t||null===t)&&(t=""),"undefined"==typeof i&&(i=" "),"string"!=typeof t&&(t=t.toString());var r=e+1-t.length;return 0>=r?t:t+Array(e+1-t.length).join(i)},t.alignCenter=function(e,i,r){if(!i||0>i)return"";(void 0===e||null===e)&&(e=""),"undefined"==typeof r&&(r=" "),"string"!=typeof e&&(e=e.toString());var n=e.length,o=Math.floor(i/2-n/2),s=Math.abs(n%2-i%2),i=e.length;return t.alignRight("",o,r)+e+t.alignLeft("",o+s,r)},t.alignRight=function(t,e,i){if(!e||0>e)return"";(void 0===t||null===t)&&(t=""),"undefined"==typeof i&&(i=" "),"string"!=typeof t&&(t=t.toString());var r=e+1-t.length;return 0>=r?t:Array(e+1-t.length).join(i)+t},t.alignAuto=function(e,r,n){(void 0===e||null===e)&&(e="");var o=i.call(e);if(n||(n=" "),r=+r,"[object String]"!==o&&(e=e.toString()),e.length<r)switch(o){case"[object Number]":return t.alignRight(e,r,n);default:return t.alignLeft(e,r,n)}return e},t.arrayFill=function(t,e){for(var i=new Array(t),r=0;r!==t;r++)i[r]=e;return i},t.prototype.reset=t.prototype.clear=function(e){return this.__name="",this.__nameAlign=t.CENTER,this.__rows=[],this.__maxCells=0,this.__aligns=[],this.__colMaxes=[],this.__spacing=1,this.__heading=null,this.__headingAlign=t.CENTER,this.setBorder(),"[object String]"===i.call(e)?this.__name=e:"[object Object]"===i.call(e)&&this.fromJSON(e),this},t.prototype.setBorder=function(t,e,i,r){return this.__border=!0,1===arguments.length&&(e=i=r=t),this.__edge=t||"|",this.__fill=e||"-",this.__top=i||".",this.__bottom=r||"'",this},t.prototype.removeBorder=function(){return this.__border=!1,this.__edge=" ",this.__fill=" ",this},t.prototype.setAlign=function(t,e){return this.__aligns[t]=e,this},t.prototype.setTitle=function(t){return this.__name=t,this},t.prototype.getTitle=function(){return this.__name},t.prototype.setTitleAlign=function(t){return this.__nameAlign=t,this},t.prototype.sort=function(t){return this.__rows.sort(t),this},t.prototype.sortColumn=function(t,e){return this.__rows.sort(function(i,r){return e(i[t],r[t])}),this},t.prototype.setHeading=function(t){return(arguments.length>1||"[object Array]"!==i.call(t))&&(t=e.call(arguments)),this.__heading=t,this},t.prototype.getHeading=function(){return this.__heading.slice()},t.prototype.setHeadingAlign=function(t){return this.__headingAlign=t,this},t.prototype.addRow=function(t){return(arguments.length>1||"[object Array]"!==i.call(t))&&(t=e.call(arguments)),this.__maxCells=Math.max(this.__maxCells,t.length),this.__rows.push(t),this},t.prototype.getRows=function(){return this.__rows.slice().map(function(t){return t.slice()})},t.prototype.addRowMatrix=function(t){for(var e=0;e<t.length;e++)this.addRow(t[e]);return this},t.prototype.addData=function(t,e,r){if("[object Array]"!==i.call(t))return this;for(var n=0,o=t.length;o>n;n++){var s=e(t[n]);r?this.addRowMatrix(s):this.addRow(s)}return this},t.prototype.clearRows=function(){return this.__rows=[],this.__maxCells=0,this.__colMaxes=[],this},t.prototype.setJustify=function(t){return 0===arguments.length&&(t=!0),this.__justify=!!t,this},t.prototype.toJSON=function(){return{title:this.getTitle(),heading:this.getHeading(),rows:this.getRows()}},t.prototype.parse=t.prototype.fromJSON=function(t){return this.clear().setTitle(t.title).setHeading(t.heading).addRowMatrix(t.rows)},t.prototype.render=t.prototype.valueOf=t.prototype.toString=function(){for(var e,i=this,r=[],n=this.__maxCells,o=t.arrayFill(n,0),s=3*n,h=this.__rows,a=this.__border,l=this.__heading?[this.__heading].concat(h):h,_=0;_<l.length;_++)for(var u=l[_],g=0;n>g;g++){var p=u[g];o[g]=Math.max(o[g],p?p.toString().length:0)}this.__colMaxes=o,e=this.__justify?Math.max.apply(null,o):0,o.forEach(function(t){s+=e?e:t+i.__spacing}),e&&(s+=o.length),s-=this.__spacing,a&&r.push(this._seperator(s-n+1,this.__top)),this.__name&&(r.push(this._renderTitle(s-n+1)),a&&r.push(this._seperator(s-n+1))),this.__heading&&(r.push(this._renderRow(this.__heading," ",this.__headingAlign)),r.push(this._rowSeperator(n,this.__fill)));for(var _=0;_<this.__rows.length;_++)r.push(this._renderRow(this.__rows[_]," "));a&&r.push(this._seperator(s-n+1,this.__bottom));var f=this.options.prefix||"";return f+r.join("\n"+f)},t.prototype._seperator=function(e,i){return i||(i=this.__edge),i+t.alignRight(i,e,this.__fill)},t.prototype._rowSeperator=function(){var e=t.arrayFill(this.__maxCells,this.__fill);return this._renderRow(e,this.__fill)},t.prototype._renderTitle=function(e){var i=" "+this.__name+" ",r=t.align(this.__nameAlign,i,e-1," ");return this.__edge+r+this.__edge},t.prototype._renderRow=function(e,i,r){for(var n=[""],o=this.__colMaxes,s=0;s<this.__maxCells;s++){var h=e[s],a=this.__justify?Math.max.apply(null,o):o[s],l=a,_=this.__aligns[s],u=r,g="alignAuto";"undefined"==typeof r&&(u=_),u===t.LEFT&&(g="alignLeft"),u===t.CENTER&&(g="alignCenter"),u===t.RIGHT&&(g="alignRight"),n.push(t[g](h,l,i))}var p=n.join(i+this.__edge+i);return p=p.substr(1,p.length),p+i+this.__edge},["Left","Right","Center"].forEach(function(i){var r=t[i.toUpperCase()];["setAlign","setTitleAlign","setHeadingAlign"].forEach(function(n){t.prototype[n+i]=function(){var t=e.call(arguments).concat(r);return this[n].apply(this,t)}})}),"undefined"!=typeof exports?module.exports=t:this.AsciiTable=t}).call(this);

},{}],3:[function(require,module,exports){
module.exports=require("./ascii-table");

},{"./ascii-table":2}],4:[function(require,module,exports){
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.returnExports=t()}(this,function(){var e,t,n,r,o=Function.call,c=Object.prototype,i=o.bind(c.hasOwnProperty),f=o.bind(c.propertyIsEnumerable),u=o.bind(c.toString),l=i(c,"__defineGetter__");l&&(e=o.bind(c.__defineGetter__),t=o.bind(c.__defineSetter__),n=o.bind(c.__lookupGetter__),r=o.bind(c.__lookupSetter__)),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){var t=e.__proto__;return t||null===t?t:"[object Function]"===u(e.constructor)?e.constructor.prototype:e instanceof Object?c:null});var b=function(e){try{return e.sentinel=0,0===Object.getOwnPropertyDescriptor(e,"sentinel").value}catch(t){return!1}};if(Object.defineProperty){var p=b({}),a="undefined"==typeof document||b(document.createElement("div"));if(!a||!p)var O=Object.getOwnPropertyDescriptor}if(!Object.getOwnPropertyDescriptor||O){var j="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(e,t){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError(j+e);if(O)try{return O.call(Object,e,t)}catch(o){}var u;if(!i(e,t))return u;if(u={enumerable:f(e,t),configurable:!0},l){var b=e.__proto__,p=e!==c;p&&(e.__proto__=c);var a=n(e,t),s=r(e,t);if(p&&(e.__proto__=b),a||s)return a&&(u.get=a),s&&(u.set=s),u}return u.value=e[t],u.writable=!0,u}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),!Object.create){var s,d=!({__proto__:null}instanceof Object),y=function(){if(!document.domain)return!1;try{return!!new ActiveXObject("htmlfile")}catch(e){return!1}},_=function(){var e,t;return t=new ActiveXObject("htmlfile"),t.write("<script></script>"),t.close(),e=t.parentWindow.Object.prototype,t=null,e},w=function(){var e,t=document.createElement("iframe"),n=document.body||document.documentElement;return t.style.display="none",n.appendChild(t),t.src="javascript:",e=t.contentWindow.Object.prototype,n.removeChild(t),t=null,e};s=d||"undefined"==typeof document?function(){return{__proto__:null}}:function(){var e=y()?_():w();delete e.constructor,delete e.hasOwnProperty,delete e.propertyIsEnumerable,delete e.isPrototypeOf,delete e.toLocaleString,delete e.toString,delete e.valueOf;var t=function(){};return t.prototype=e,s=function(){return new t},new t},Object.create=function(e,t){var n,r=function(){};if(null===e)n=s();else{if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object or null");r.prototype=e,n=new r,n.__proto__=e}return void 0!==t&&Object.defineProperties(n,t),n}}var v=function(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(t){return!1}};if(Object.defineProperty){var m=v({}),h="undefined"==typeof document||v(document.createElement("div"));if(!m||!h)var E=Object.defineProperty,P=Object.defineProperties}if(!Object.defineProperty||E){var g="Property description must be an object: ",T="Object.defineProperty called on non-object: ",x="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(o,i,f){if("object"!=typeof o&&"function"!=typeof o||null===o)throw new TypeError(T+o);if("object"!=typeof f&&"function"!=typeof f||null===f)throw new TypeError(g+f);if(E)try{return E.call(Object,o,i,f)}catch(u){}if("value"in f)if(l&&(n(o,i)||r(o,i))){var b=o.__proto__;o.__proto__=c,delete o[i],o[i]=f.value,o.__proto__=b}else o[i]=f.value;else{if(!l&&("get"in f||"set"in f))throw new TypeError(x);"get"in f&&e(o,i,f.get),"set"in f&&t(o,i,f.set)}return o}}(!Object.defineProperties||P)&&(Object.defineProperties=function(e,t){if(P)try{return P.call(Object,e,t)}catch(n){}return Object.keys(t).forEach(function(n){"__proto__"!==n&&Object.defineProperty(e,n,t[n])}),e}),Object.seal||(Object.seal=function(e){if(Object(e)!==e)throw new TypeError("Object.seal can only be called on Objects.");return e}),Object.freeze||(Object.freeze=function(e){if(Object(e)!==e)throw new TypeError("Object.freeze can only be called on Objects.");return e});try{Object.freeze(function(){})}catch(z){Object.freeze=function(e){return function(t){return"function"==typeof t?t:e(t)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(e){if(Object(e)!==e)throw new TypeError("Object.preventExtensions can only be called on Objects.");return e}),Object.isSealed||(Object.isSealed=function(e){if(Object(e)!==e)throw new TypeError("Object.isSealed can only be called on Objects.");return!1}),Object.isFrozen||(Object.isFrozen=function(e){if(Object(e)!==e)throw new TypeError("Object.isFrozen can only be called on Objects.");return!1}),Object.isExtensible||(Object.isExtensible=function(e){if(Object(e)!==e)throw new TypeError("Object.isExtensible can only be called on Objects.");for(var t="";i(e,t);)t+="?";e[t]=!0;var n=i(e,t);return delete e[t],n})});

},{}],5:[function(require,module,exports){
!function(t,e){"use strict";"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.returnExports=e()}(this,function(){var t,e=Array,r=e.prototype,n=Object,o=n.prototype,i=Function,a=i.prototype,u=String,s=u.prototype,f=Number,l=f.prototype,c=r.slice,h=r.splice,p=r.push,g=r.unshift,y=r.concat,d=r.join,v=a.call,b=a.apply,m=Math.max,w=Math.min,T=o.toString,D="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,x=Function.prototype.toString,S=function(t){try{return x.call(t),!0}catch(e){return!1}},O="[object Function]",E="[object GeneratorFunction]";t=function(t){if("function"!=typeof t)return!1;if(D)return S(t);var e=T.call(t);return e===O||e===E};var j,M=RegExp.prototype.exec,I=function(t){try{return M.call(t),!0}catch(e){return!1}},U="[object RegExp]";j=function(t){return"object"!=typeof t?!1:D?I(t):T.call(t)===U};var N,F=String.prototype.valueOf,k=function(t){try{return F.call(t),!0}catch(e){return!1}},C="[object String]";N=function(t){return"string"==typeof t?!0:"object"!=typeof t?!1:D?k(t):T.call(t)===C};var R=n.defineProperty&&function(){try{var t={};n.defineProperty(t,"x",{enumerable:!1,value:t});for(var e in t)return!1;return t.x===t}catch(r){return!1}}(),A=function(t){var e;return e=R?function(t,e,r,o){!o&&e in t||n.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:!0,value:r})}:function(t,e,r,n){!n&&e in t||(t[e]=r)},function(r,n,o){for(var i in n)t.call(n,i)&&e(r,i,n[i],o)}}(o.hasOwnProperty),$=function(t){var e=typeof t;return null===t||"object"!==e&&"function"!==e},P=f.isNaN||function(t){return t!==t},J={ToInteger:function(t){var e=+t;return P(e)?e=0:0!==e&&e!==1/0&&e!==-(1/0)&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e},ToPrimitive:function(e){var r,n,o;if($(e))return e;if(n=e.valueOf,t(n)&&(r=n.call(e),$(r)))return r;if(o=e.toString,t(o)&&(r=o.call(e),$(r)))return r;throw new TypeError},ToObject:function(t){if(null==t)throw new TypeError("can't convert "+t+" to object");return n(t)},ToUint32:function(t){return t>>>0}},Z=function(){};A(a,{bind:function(e){var r=this;if(!t(r))throw new TypeError("Function.prototype.bind called on incompatible "+r);for(var o,a=c.call(arguments,1),u=function(){if(this instanceof o){var t=b.call(r,this,y.call(a,c.call(arguments)));return n(t)===t?t:this}return b.call(r,e,y.call(a,c.call(arguments)))},s=m(0,r.length-a.length),f=[],l=0;s>l;l++)p.call(f,"$"+l);return o=i("binder","return function ("+d.call(f,",")+"){ return binder.apply(this, arguments); }")(u),r.prototype&&(Z.prototype=r.prototype,o.prototype=new Z,Z.prototype=null),o}});var z=v.bind(o.hasOwnProperty),G=v.bind(o.toString),Y=v.bind(c),B=b.bind(c),H=v.bind(s.slice),W=v.bind(s.split),L=v.bind(s.indexOf),X=v.bind(p),q=v.bind(o.propertyIsEnumerable),K=v.bind(r.sort),Q=e.isArray||function(t){return"[object Array]"===G(t)},V=1!==[].unshift(0);A(r,{unshift:function(){return g.apply(this,arguments),this.length}},V),A(e,{isArray:Q});var _=n("a"),tt="a"!==_[0]||!(0 in _),et=function(t){var e=!0,r=!0,n=!1;if(t)try{t.call("foo",function(t,r,n){"object"!=typeof n&&(e=!1)}),t.call([1],function(){"use strict";r="string"==typeof this},"x")}catch(o){n=!0}return!!t&&!n&&e&&r};A(r,{forEach:function(e){var r,n=J.ToObject(this),o=tt&&N(this)?W(this,""):n,i=-1,a=J.ToUint32(o.length);if(arguments.length>1&&(r=arguments[1]),!t(e))throw new TypeError("Array.prototype.forEach callback must be a function");for(;++i<a;)i in o&&("undefined"==typeof r?e(o[i],i,n):e.call(r,o[i],i,n))}},!et(r.forEach)),A(r,{map:function(r){var n,o=J.ToObject(this),i=tt&&N(this)?W(this,""):o,a=J.ToUint32(i.length),u=e(a);if(arguments.length>1&&(n=arguments[1]),!t(r))throw new TypeError("Array.prototype.map callback must be a function");for(var s=0;a>s;s++)s in i&&("undefined"==typeof n?u[s]=r(i[s],s,o):u[s]=r.call(n,i[s],s,o));return u}},!et(r.map)),A(r,{filter:function(e){var r,n,o=J.ToObject(this),i=tt&&N(this)?W(this,""):o,a=J.ToUint32(i.length),u=[];if(arguments.length>1&&(n=arguments[1]),!t(e))throw new TypeError("Array.prototype.filter callback must be a function");for(var s=0;a>s;s++)s in i&&(r=i[s],("undefined"==typeof n?e(r,s,o):e.call(n,r,s,o))&&X(u,r));return u}},!et(r.filter)),A(r,{every:function(e){var r,n=J.ToObject(this),o=tt&&N(this)?W(this,""):n,i=J.ToUint32(o.length);if(arguments.length>1&&(r=arguments[1]),!t(e))throw new TypeError("Array.prototype.every callback must be a function");for(var a=0;i>a;a++)if(a in o&&!("undefined"==typeof r?e(o[a],a,n):e.call(r,o[a],a,n)))return!1;return!0}},!et(r.every)),A(r,{some:function(e){var r,n=J.ToObject(this),o=tt&&N(this)?W(this,""):n,i=J.ToUint32(o.length);if(arguments.length>1&&(r=arguments[1]),!t(e))throw new TypeError("Array.prototype.some callback must be a function");for(var a=0;i>a;a++)if(a in o&&("undefined"==typeof r?e(o[a],a,n):e.call(r,o[a],a,n)))return!0;return!1}},!et(r.some));var rt=!1;r.reduce&&(rt="object"==typeof r.reduce.call("es5",function(t,e,r,n){return n})),A(r,{reduce:function(e){var r=J.ToObject(this),n=tt&&N(this)?W(this,""):r,o=J.ToUint32(n.length);if(!t(e))throw new TypeError("Array.prototype.reduce callback must be a function");if(0===o&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var i,a=0;if(arguments.length>=2)i=arguments[1];else for(;;){if(a in n){i=n[a++];break}if(++a>=o)throw new TypeError("reduce of empty array with no initial value")}for(;o>a;a++)a in n&&(i=e(i,n[a],a,r));return i}},!rt);var nt=!1;r.reduceRight&&(nt="object"==typeof r.reduceRight.call("es5",function(t,e,r,n){return n})),A(r,{reduceRight:function(e){var r=J.ToObject(this),n=tt&&N(this)?W(this,""):r,o=J.ToUint32(n.length);if(!t(e))throw new TypeError("Array.prototype.reduceRight callback must be a function");if(0===o&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var i,a=o-1;if(arguments.length>=2)i=arguments[1];else for(;;){if(a in n){i=n[a--];break}if(--a<0)throw new TypeError("reduceRight of empty array with no initial value")}if(0>a)return i;do a in n&&(i=e(i,n[a],a,r));while(a--);return i}},!nt);var ot=r.indexOf&&-1!==[0,1].indexOf(1,2);A(r,{indexOf:function(t){var e=tt&&N(this)?W(this,""):J.ToObject(this),r=J.ToUint32(e.length);if(0===r)return-1;var n=0;for(arguments.length>1&&(n=J.ToInteger(arguments[1])),n=n>=0?n:m(0,r+n);r>n;n++)if(n in e&&e[n]===t)return n;return-1}},ot);var it=r.lastIndexOf&&-1!==[0,1].lastIndexOf(0,-3);A(r,{lastIndexOf:function(t){var e=tt&&N(this)?W(this,""):J.ToObject(this),r=J.ToUint32(e.length);if(0===r)return-1;var n=r-1;for(arguments.length>1&&(n=w(n,J.ToInteger(arguments[1]))),n=n>=0?n:r-Math.abs(n);n>=0;n--)if(n in e&&t===e[n])return n;return-1}},it);var at=function(){var t=[1,2],e=t.splice();return 2===t.length&&Q(e)&&0===e.length}();A(r,{splice:function(t,e){return 0===arguments.length?[]:h.apply(this,arguments)}},!at);var ut=function(){var t={};return r.splice.call(t,0,0,1),1===t.length}();A(r,{splice:function(t,e){if(0===arguments.length)return[];var r=arguments;return this.length=m(J.ToInteger(this.length),0),arguments.length>0&&"number"!=typeof e&&(r=Y(arguments),r.length<2?X(r,this.length-t):r[1]=J.ToInteger(e)),h.apply(this,r)}},!ut);var st=function(){var t=new e(1e5);return t[8]="x",t.splice(1,1),7===t.indexOf("x")}(),ft=function(){var t=256,e=[];return e[t]="a",e.splice(t+1,0,"b"),"a"===e[t]}();A(r,{splice:function(t,e){for(var r,n=J.ToObject(this),o=[],i=J.ToUint32(n.length),a=J.ToInteger(t),s=0>a?m(i+a,0):w(a,i),f=w(m(J.ToInteger(e),0),i-s),l=0;f>l;)r=u(s+l),z(n,r)&&(o[l]=n[r]),l+=1;var c,h=Y(arguments,2),p=h.length;if(f>p){l=s;for(var g=i-f;g>l;)r=u(l+f),c=u(l+p),z(n,r)?n[c]=n[r]:delete n[c],l+=1;l=i;for(var y=i-f+p;l>y;)delete n[l-1],l-=1}else if(p>f)for(l=i-f;l>s;)r=u(l+f-1),c=u(l+p-1),z(n,r)?n[c]=n[r]:delete n[c],l-=1;l=s;for(var d=0;d<h.length;++d)n[l]=h[d],l+=1;return n.length=i-f+p,o}},!st||!ft);var lt,ct=r.join;try{lt="1,2,3"!==Array.prototype.join.call("123",",")}catch(ht){lt=!0}lt&&A(r,{join:function(t){var e="undefined"==typeof t?",":t;return ct.call(N(this)?W(this,""):this,e)}},lt);var pt="1,2"!==[1,2].join(void 0);pt&&A(r,{join:function(t){var e="undefined"==typeof t?",":t;return ct.call(this,e)}},pt);var gt=function(t){for(var e=J.ToObject(this),r=J.ToUint32(e.length),n=0;n<arguments.length;)e[r+n]=arguments[n],n+=1;return e.length=r+n,r+n},yt=function(){var t={},e=Array.prototype.push.call(t,void 0);return 1!==e||1!==t.length||"undefined"!=typeof t[0]||!z(t,0)}();A(r,{push:function(t){return Q(this)?p.apply(this,arguments):gt.apply(this,arguments)}},yt);var dt=function(){var t=[],e=t.push(void 0);return 1!==e||1!==t.length||"undefined"!=typeof t[0]||!z(t,0)}();A(r,{push:gt},dt),A(r,{slice:function(t,e){var r=N(this)?W(this,""):this;return B(r,arguments)}},tt);var vt=function(){try{return[1,2].sort(null),[1,2].sort({}),!0}catch(t){}return!1}(),bt=function(){try{return[1,2].sort(/a/),!1}catch(t){}return!0}(),mt=function(){try{return[1,2].sort(void 0),!0}catch(t){}return!1}();A(r,{sort:function(e){if("undefined"==typeof e)return K(this);if(!t(e))throw new TypeError("Array.prototype.sort callback must be a function");return K(this,e)}},vt||!mt||!bt);var wt=!{toString:null}.propertyIsEnumerable("toString"),Tt=function(){}.propertyIsEnumerable("prototype"),Dt=!z("x","0"),xt=function(t){var e=t.constructor;return e&&e.prototype===t},St={$window:!0,$console:!0,$parent:!0,$self:!0,$frame:!0,$frames:!0,$frameElement:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$external:!0},Ot=function(){if("undefined"==typeof window)return!1;for(var t in window)try{!St["$"+t]&&z(window,t)&&null!==window[t]&&"object"==typeof window[t]&&xt(window[t])}catch(e){return!0}return!1}(),Et=function(t){if("undefined"==typeof window||!Ot)return xt(t);try{return xt(t)}catch(e){return!1}},jt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Mt=jt.length,It=function(t){return"[object Arguments]"===G(t)},Ut=function(e){return null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&!Q(e)&&t(e.callee)},Nt=It(arguments)?It:Ut;A(n,{keys:function(e){var r=t(e),n=Nt(e),o=null!==e&&"object"==typeof e,i=o&&N(e);if(!o&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var a=[],s=Tt&&r;if(i&&Dt||n)for(var f=0;f<e.length;++f)X(a,u(f));if(!n)for(var l in e)s&&"prototype"===l||!z(e,l)||X(a,u(l));if(wt)for(var c=Et(e),h=0;Mt>h;h++){var p=jt[h];c&&"constructor"===p||!z(e,p)||X(a,p)}return a}});var Ft=n.keys&&function(){return 2===n.keys(arguments).length}(1,2),kt=n.keys&&function(){var t=n.keys(arguments);return 1!==arguments.length||1!==t.length||1!==t[0]}(1),Ct=n.keys;A(n,{keys:function(t){return Ct(Nt(t)?Y(t):t)}},!Ft||kt);var Rt,At,$t=0!==new Date(-0xc782b5b342b24).getUTCMonth(),Pt=new Date(-0x55d318d56a724),Jt=new Date(14496624e5),Zt="Mon, 01 Jan -45875 11:59:59 GMT"!==Pt.toUTCString(),zt=Pt.getTimezoneOffset();-720>zt?(Rt="Tue Jan 02 -45875"!==Pt.toDateString(),At=!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-\+]\d\d\d\d(?: |$)/.test(Jt.toString())):(Rt="Mon Jan 01 -45875"!==Pt.toDateString(),At=!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-\+]\d\d\d\d(?: |$)/.test(Jt.toString()));var Gt=v.bind(Date.prototype.getFullYear),Yt=v.bind(Date.prototype.getMonth),Bt=v.bind(Date.prototype.getDate),Ht=v.bind(Date.prototype.getUTCFullYear),Wt=v.bind(Date.prototype.getUTCMonth),Lt=v.bind(Date.prototype.getUTCDate),Xt=v.bind(Date.prototype.getUTCDay),qt=v.bind(Date.prototype.getUTCHours),Kt=v.bind(Date.prototype.getUTCMinutes),Qt=v.bind(Date.prototype.getUTCSeconds),Vt=v.bind(Date.prototype.getUTCMilliseconds),_t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],te=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ee=function(t,e){return Bt(new Date(e,t,0))};A(Date.prototype,{getFullYear:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Gt(this);return 0>t&&Yt(this)>11?t+1:t},getMonth:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Gt(this),e=Yt(this);return 0>t&&e>11?0:e},getDate:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Gt(this),e=Yt(this),r=Bt(this);if(0>t&&e>11){if(12===e)return r;var n=ee(0,t+1);return n-r+1}return r},getUTCFullYear:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Ht(this);return 0>t&&Wt(this)>11?t+1:t},getUTCMonth:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Ht(this),e=Wt(this);return 0>t&&e>11?0:e},getUTCDate:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Ht(this),e=Wt(this),r=Lt(this);if(0>t&&e>11){if(12===e)return r;var n=ee(0,t+1);return n-r+1}return r}},$t),A(Date.prototype,{toUTCString:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=Xt(this),e=Lt(this),r=Wt(this),n=Ht(this),o=qt(this),i=Kt(this),a=Qt(this);return _t[t]+", "+(10>e?"0"+e:e)+" "+te[r]+" "+n+" "+(10>o?"0"+o:o)+":"+(10>i?"0"+i:i)+":"+(10>a?"0"+a:a)+" GMT"}},$t||Zt),A(Date.prototype,{toDateString:function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=this.getDay(),e=this.getDate(),r=this.getMonth(),n=this.getFullYear();return _t[t]+" "+te[r]+" "+(10>e?"0"+e:e)+" "+n}},$t||Rt),($t||At)&&(Date.prototype.toString=function(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var t=this.getDay(),e=this.getDate(),r=this.getMonth(),n=this.getFullYear(),o=this.getHours(),i=this.getMinutes(),a=this.getSeconds(),u=this.getTimezoneOffset(),s=Math.floor(Math.abs(u)/60),f=Math.floor(Math.abs(u)%60);return _t[t]+" "+te[r]+" "+(10>e?"0"+e:e)+" "+n+" "+(10>o?"0"+o:o)+":"+(10>i?"0"+i:i)+":"+(10>a?"0"+a:a)+" GMT"+(u>0?"-":"+")+(10>s?"0"+s:s)+(10>f?"0"+f:f)},R&&n.defineProperty(Date.prototype,"toString",{configurable:!0,enumerable:!1,writable:!0}));var re=-621987552e5,ne="-000001",oe=Date.prototype.toISOString&&-1===new Date(re).toISOString().indexOf(ne),ie=Date.prototype.toISOString&&"1969-12-31T23:59:59.999Z"!==new Date(-1).toISOString();A(Date.prototype,{toISOString:function(){if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");var t=Ht(this),e=Wt(this);t+=Math.floor(e/12),e=(e%12+12)%12;var r=[e+1,Lt(this),qt(this),Kt(this),Qt(this)];t=(0>t?"-":t>9999?"+":"")+H("00000"+Math.abs(t),t>=0&&9999>=t?-4:-6);for(var n=0;n<r.length;++n)r[n]=H("00"+r[n],-2);return t+"-"+Y(r,0,2).join("-")+"T"+Y(r,2).join(":")+"."+H("000"+Vt(this),-3)+"Z"}},oe||ie);var ae=function(){try{return Date.prototype.toJSON&&null===new Date(NaN).toJSON()&&-1!==new Date(re).toJSON().indexOf(ne)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(t){return!1}}();ae||(Date.prototype.toJSON=function(e){var r=n(this),o=J.ToPrimitive(r);if("number"==typeof o&&!isFinite(o))return null;var i=r.toISOString;if(!t(i))throw new TypeError("toISOString property is not callable");return i.call(r)});var ue=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),se=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z")),fe=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(fe||se||!ue){var le=Math.pow(2,31)-1,ce=P(new Date(1970,0,1,0,0,0,le+1).getTime());Date=function(t){var e=function(r,n,o,i,a,s,f){var l,c=arguments.length;if(this instanceof t){var h=s,p=f;if(ce&&c>=7&&f>le){var g=Math.floor(f/le)*le,y=Math.floor(g/1e3);h+=y,p-=1e3*y}l=1===c&&u(r)===r?new t(e.parse(r)):c>=7?new t(r,n,o,i,a,h,p):c>=6?new t(r,n,o,i,a,h):c>=5?new t(r,n,o,i,a):c>=4?new t(r,n,o,i):c>=3?new t(r,n,o):c>=2?new t(r,n):c>=1?new t(r):new t}else l=t.apply(this,arguments);return $(l)||A(l,{constructor:e},!0),l},r=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),n=[0,31,59,90,120,151,181,212,243,273,304,334,365],o=function(t,e){var r=e>1?1:0;return n[e]+Math.floor((t-1969+r)/4)-Math.floor((t-1901+r)/100)+Math.floor((t-1601+r)/400)+365*(t-1970)},i=function(e){var r=0,n=e;if(ce&&n>le){var o=Math.floor(n/le)*le,i=Math.floor(o/1e3);r+=i,n-=1e3*i}return f(new t(1970,0,1,0,0,r,n))};for(var a in t)z(t,a)&&(e[a]=t[a]);A(e,{now:t.now,UTC:t.UTC},!0),e.prototype=t.prototype,A(e.prototype,{constructor:e},!0);var s=function(e){var n=r.exec(e);if(n){var a,u=f(n[1]),s=f(n[2]||1)-1,l=f(n[3]||1)-1,c=f(n[4]||0),h=f(n[5]||0),p=f(n[6]||0),g=Math.floor(1e3*f(n[7]||0)),y=Boolean(n[4]&&!n[8]),d="-"===n[9]?1:-1,v=f(n[10]||0),b=f(n[11]||0),m=h>0||p>0||g>0;return(m?24:25)>c&&60>h&&60>p&&1e3>g&&s>-1&&12>s&&24>v&&60>b&&l>-1&&l<o(u,s+1)-o(u,s)&&(a=60*(24*(o(u,s)+l)+c+v*d),a=1e3*(60*(a+h+b*d)+p)+g,y&&(a=i(a)),a>=-864e13&&864e13>=a)?a:NaN}return t.parse.apply(this,arguments)};return A(e,{parse:s}),e}(Date)}Date.now||(Date.now=function(){return(new Date).getTime()});var he=l.toFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==0xde0b6b3a7640080.toFixed(0)),pe={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function(t,e){for(var r=-1,n=e;++r<pe.size;)n+=t*pe.data[r],pe.data[r]=n%pe.base,n=Math.floor(n/pe.base)},divide:function(t){for(var e=pe.size,r=0;--e>=0;)r+=pe.data[e],pe.data[e]=Math.floor(r/t),r=r%t*pe.base},numToString:function(){for(var t=pe.size,e="";--t>=0;)if(""!==e||0===t||0!==pe.data[t]){var r=u(pe.data[t]);""===e?e=r:e+=H("0000000",0,7-r.length)+r}return e},pow:function ke(t,e,r){return 0===e?r:e%2===1?ke(t,e-1,r*t):ke(t*t,e/2,r)},log:function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}},ge=function(t){var e,r,n,o,i,a,s,l;if(e=f(t),e=P(e)?0:Math.floor(e),0>e||e>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(r=f(this),P(r))return"NaN";if(-1e21>=r||r>=1e21)return u(r);if(n="",0>r&&(n="-",r=-r),o="0",r>1e-21)if(i=pe.log(r*pe.pow(2,69,1))-69,a=0>i?r*pe.pow(2,-i,1):r/pe.pow(2,i,1),a*=4503599627370496,i=52-i,i>0){for(pe.multiply(0,a),s=e;s>=7;)pe.multiply(1e7,0),s-=7;for(pe.multiply(pe.pow(10,s,1),0),s=i-1;s>=23;)pe.divide(1<<23),s-=23;pe.divide(1<<s),pe.multiply(1,1),pe.divide(2),o=pe.numToString()}else pe.multiply(0,a),pe.multiply(1<<-i,0),o=pe.numToString()+H("0.00000000000000000000",2,2+e);return e>0?(l=o.length,o=e>=l?n+H("0.0000000000000000000",0,e-l+2)+o:n+H(o,0,l-e)+"."+H(o,l-e)):o=n+o,o};A(l,{toFixed:ge},he);var ye=function(){try{return"1"===1..toPrecision(void 0)}catch(t){return!0}}(),de=l.toPrecision;A(l,{toPrecision:function(t){return"undefined"==typeof t?de.call(this):de.call(this,t)}},ye),2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var t="undefined"==typeof/()??/.exec("")[1],e=Math.pow(2,32)-1;s.split=function(r,n){var o=String(this);if("undefined"==typeof r&&0===n)return[];if(!j(r))return W(this,r,n);var i,a,u,s,f=[],l=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(r.sticky?"y":""),c=0,h=new RegExp(r.source,l+"g");t||(i=new RegExp("^"+h.source+"$(?!\\s)",l));var g="undefined"==typeof n?e:J.ToUint32(n);for(a=h.exec(o);a&&(u=a.index+a[0].length,!(u>c&&(X(f,H(o,c,a.index)),!t&&a.length>1&&a[0].replace(i,function(){for(var t=1;t<arguments.length-2;t++)"undefined"==typeof arguments[t]&&(a[t]=void 0)}),a.length>1&&a.index<o.length&&p.apply(f,Y(a,1)),s=a[0].length,c=u,f.length>=g)));)h.lastIndex===a.index&&h.lastIndex++,a=h.exec(o);return c===o.length?(s||!h.test(""))&&X(f,""):X(f,H(o,c)),f.length>g?Y(f,0,g):f}}():"0".split(void 0,0).length&&(s.split=function(t,e){return"undefined"==typeof t&&0===e?[]:W(this,t,e)});var ve=s.replace,be=function(){var t=[];return"x".replace(/x(.)?/g,function(e,r){X(t,r)}),1===t.length&&"undefined"==typeof t[0]}();be||(s.replace=function(e,r){var n=t(r),o=j(e)&&/\)[*?]/.test(e.source);if(n&&o){var i=function(t){var n=arguments.length,o=e.lastIndex;e.lastIndex=0;var i=e.exec(t)||[];return e.lastIndex=o,X(i,arguments[n-2],arguments[n-1]),r.apply(this,i)};return ve.call(this,e,i)}return ve.call(this,e,r)});var me=s.substr,we="".substr&&"b"!=="0b".substr(-1);A(s,{substr:function(t,e){var r=t;return 0>t&&(r=m(this.length+t,0)),me.call(this,r,e)}},we);var Te="	\n\f\r   ᠎             　\u2028\u2029\ufeff",De="​",xe="["+Te+"]",Se=new RegExp("^"+xe+xe+"*"),Oe=new RegExp(xe+xe+"*$"),Ee=s.trim&&(Te.trim()||!De.trim());A(s,{trim:function(){if("undefined"==typeof this||null===this)throw new TypeError("can't convert "+this+" to object");return u(this).replace(Se,"").replace(Oe,"")}},Ee);var je=v.bind(String.prototype.trim),Me=s.lastIndexOf&&-1!=="abcあい".lastIndexOf("あい",2);A(s,{lastIndexOf:function(t){if("undefined"==typeof this||null===this)throw new TypeError("can't convert "+this+" to object");for(var e=u(this),r=u(t),n=arguments.length>1?f(arguments[1]):NaN,o=P(n)?1/0:J.ToInteger(n),i=w(m(o,0),e.length),a=r.length,s=i+a;s>0;){s=m(0,s-a);var l=L(H(e,s,i+a),r);if(-1!==l)return s+l}return-1}},Me);var Ie=s.lastIndexOf;if(A(s,{lastIndexOf:function(t){return Ie.apply(this,arguments)}},1!==s.lastIndexOf.length),(8!==parseInt(Te+"08")||22!==parseInt(Te+"0x16"))&&(parseInt=function(t){var e=/^[\-+]?0[xX]/;return function(r,n){var o=je(r),i=f(n)||(e.test(o)?16:10);return t(o,i)}}(parseInt)),1/parseFloat("-0")!==-(1/0)&&(parseFloat=function(t){return function(e){var r=je(e),n=t(r);return 0===n&&"-"===H(r,0,1)?-0:n}}(parseFloat)),"RangeError: test"!==String(new RangeError("test"))){var Ue=function(){if("undefined"==typeof this||null===this)throw new TypeError("can't convert "+this+" to object");var t=this.name;"undefined"==typeof t?t="Error":"string"!=typeof t&&(t=u(t));var e=this.message;return"undefined"==typeof e?e="":"string"!=typeof e&&(e=u(e)),t?e?t+": "+e:t:e};Error.prototype.toString=Ue}if(R){var Ne=function(t,e){if(q(t,e)){var r=Object.getOwnPropertyDescriptor(t,e);r.enumerable=!1,Object.defineProperty(t,e,r)}};Ne(Error.prototype,"message"),""!==Error.prototype.message&&(Error.prototype.message=""),Ne(Error.prototype,"name")}if("/a/gim"!==String(/a/gim)){var Fe=function(){var t="/"+this.source+"/";return this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),t};RegExp.prototype.toString=Fe}});

},{}],6:[function(require,module,exports){
(function (process,global){
(function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function n(t){return"function"==typeof t}function e(t){return"object"==typeof t&&null!==t}function r(t){U=t}function o(t){G=t}function i(){return function(){process.nextTick(f)}}function u(){return function(){N(f)}}function s(){var t=0,n=new Q(f),e=document.createTextNode("");return n.observe(e,{characterData:!0}),function(){e.data=t=++t%2}}function c(){var t=new MessageChannel;return t.port1.onmessage=f,function(){t.port2.postMessage(0)}}function a(){return function(){setTimeout(f,1)}}function f(){for(var t=0;B>t;t+=2){var n=X[t],e=X[t+1];n(e),X[t]=void 0,X[t+1]=void 0}B=0}function l(){try{var t=require,n=t("vertx");return N=n.runOnLoop||n.runOnContext,u()}catch(e){return a()}}function p(){}function _(){return new TypeError("You cannot resolve a promise with itself")}function h(){return new TypeError("A promises callback cannot return that same promise.")}function v(t){try{return t.then}catch(n){return nt.error=n,nt}}function d(t,n,e,r){try{t.call(n,e,r)}catch(o){return o}}function y(t,n,e){G(function(t){var r=!1,o=d(e,n,function(e){r||(r=!0,n!==e?g(t,e):A(t,e))},function(n){r||(r=!0,E(t,n))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,E(t,o))},t)}function m(t,n){n._state===$?A(t,n._result):n._state===tt?E(t,n._result):j(n,void 0,function(n){g(t,n)},function(n){E(t,n)})}function b(t,e){if(e.constructor===t.constructor)m(t,e);else{var r=v(e);r===nt?E(t,nt.error):void 0===r?A(t,e):n(r)?y(t,e,r):A(t,e)}}function g(n,e){n===e?E(n,_()):t(e)?b(n,e):A(n,e)}function w(t){t._onerror&&t._onerror(t._result),S(t)}function A(t,n){t._state===Z&&(t._result=n,t._state=$,0!==t._subscribers.length&&G(S,t))}function E(t,n){t._state===Z&&(t._state=tt,t._result=n,G(w,t))}function j(t,n,e,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=n,o[i+$]=e,o[i+tt]=r,0===i&&t._state&&G(S,t)}function S(t){var n=t._subscribers,e=t._state;if(0!==n.length){for(var r,o,i=t._result,u=0;u<n.length;u+=3)r=n[u],o=n[u+e],r?x(e,r,o,i):o(i);t._subscribers.length=0}}function T(){this.error=null}function P(t,n){try{return t(n)}catch(e){return et.error=e,et}}function x(t,e,r,o){var i,u,s,c,a=n(r);if(a){if(i=P(r,o),i===et?(c=!0,u=i.error,i=null):s=!0,e===i)return void E(e,h())}else i=o,s=!0;e._state!==Z||(a&&s?g(e,i):c?E(e,u):t===$?A(e,i):t===tt&&E(e,i))}function C(t,n){try{n(function(n){g(t,n)},function(n){E(t,n)})}catch(e){E(t,e)}}function M(t,n){var e=this;e._instanceConstructor=t,e.promise=new t(p),e._validateInput(n)?(e._input=n,e.length=n.length,e._remaining=n.length,e._init(),0===e.length?A(e.promise,e._result):(e.length=e.length||0,e._enumerate(),0===e._remaining&&A(e.promise,e._result))):E(e.promise,e._validationError())}function O(t){return new rt(this,t).promise}function k(t){function n(t){g(o,t)}function e(t){E(o,t)}var r=this,o=new r(p);if(!z(t))return E(o,new TypeError("You must pass an array to race.")),o;for(var i=t.length,u=0;o._state===Z&&i>u;u++)j(r.resolve(t[u]),void 0,n,e);return o}function Y(t){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var e=new n(p);return g(e,t),e}function q(t){var n=this,e=new n(p);return E(e,t),e}function F(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function I(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function D(t){this._id=ct++,this._state=void 0,this._result=void 0,this._subscribers=[],p!==t&&(n(t)||F(),this instanceof D||I(),C(this,t))}function K(){var t;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(n){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;(!e||"[object Promise]"!==Object.prototype.toString.call(e.resolve())||e.cast)&&(t.Promise=at)}var L;L=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var N,U,W,z=L,B=0,G=({}.toString,function(t,n){X[B]=t,X[B+1]=n,B+=2,2===B&&(U?U(f):W())}),H="undefined"!=typeof window?window:void 0,J=H||{},Q=J.MutationObserver||J.WebKitMutationObserver,R="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),V="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,X=new Array(1e3);W=R?i():Q?s():V?c():void 0===H&&"function"==typeof require?l():a();var Z=void 0,$=1,tt=2,nt=new T,et=new T;M.prototype._validateInput=function(t){return z(t)},M.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},M.prototype._init=function(){this._result=new Array(this.length)};var rt=M;M.prototype._enumerate=function(){for(var t=this,n=t.length,e=t.promise,r=t._input,o=0;e._state===Z&&n>o;o++)t._eachEntry(r[o],o)},M.prototype._eachEntry=function(t,n){var r=this,o=r._instanceConstructor;e(t)?t.constructor===o&&t._state!==Z?(t._onerror=null,r._settledAt(t._state,n,t._result)):r._willSettleAt(o.resolve(t),n):(r._remaining--,r._result[n]=t)},M.prototype._settledAt=function(t,n,e){var r=this,o=r.promise;o._state===Z&&(r._remaining--,t===tt?E(o,e):r._result[n]=e),0===r._remaining&&A(o,r._result)},M.prototype._willSettleAt=function(t,n){var e=this;j(t,void 0,function(t){e._settledAt($,n,t)},function(t){e._settledAt(tt,n,t)})};var ot=O,it=k,ut=Y,st=q,ct=0,at=D;D.all=ot,D.race=it,D.resolve=ut,D.reject=st,D._setScheduler=r,D._setAsap=o,D._asap=G,D.prototype={constructor:D,then:function(t,n){var e=this,r=e._state;if(r===$&&!t||r===tt&&!n)return this;var o=new this.constructor(p),i=e._result;if(r){var u=arguments[r-1];G(function(){x(r,o,u,i)})}else j(e,o,t,n);return o},"catch":function(t){return this.then(null,t)}};var ft=K,lt={Promise:at,polyfill:ft};"function"==typeof define&&define.amd?define(function(){return lt}):"undefined"!=typeof module&&module.exports?module.exports=lt:"undefined"!=typeof this&&(this.ES6Promise=lt),ft()}).call(this);

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"_process":7}],7:[function(require,module,exports){
function cleanUpNextTick(){draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue()}function drainQueue(){if(!draining){var e=setTimeout(cleanUpNextTick);draining=!0;for(var n=queue.length;n;){for(currentQueue=queue,queue=[];++queueIndex<n;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,n=queue.length}currentQueue=null,draining=!1,clearTimeout(e)}}function Item(e,n){this.fun=e,this.array=n}function noop(){}var process=module.exports={},queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];queue.push(new Item(e,n)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],8:[function(require,module,exports){
var promiseExtensions_1=require("./../helpers/promiseExtensions"),activityManagementAPI_1=require("./activityManagementAPI"),activityAGM_1=require("../core/activityAGM"),ActivityAPI=function(){function t(t,e){this.version="__VERSION__",this._manager=t,this._my=e,this.all=new activityManagementAPI_1.ActivityManagementAPI(t,e)}return t.prototype.ready=function(t){var e=this,i=new Promise(function(t,i){e._manager.ready().then(function(){t(e)})["catch"](function(t){i(t)})});return promiseExtensions_1.nodeify(i,t)},Object.defineProperty(t.prototype,"my",{get:function(){return this._my},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aware",{get:function(){return void 0!==this._my.window},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inActivity",{get:function(){return this.aware&&void 0!==this._my.activity},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"agm",{get:function(){return this.aware?this.inActivity?this._my.activity.agm:new activityAGM_1.ActivityAGM(null):void 0},enumerable:!0,configurable:!0}),t}();exports.ActivityAPI=ActivityAPI;

},{"../core/activityAGM":16,"./../helpers/promiseExtensions":27,"./activityManagementAPI":9}],9:[function(require,module,exports){
var util=require("./../helpers/util"),ActivityManagementAPI=function(){function i(i,e){this._manager=i,this._my=e,this.activityTypes={get:this._getActivityTypesWrapper.bind(this),register:this._manager.registerActivityType.bind(this._manager),unregister:this._manager.unregisterActivityType.bind(this._manager),subscribe:this._manager.subscribeActivityTypeEvents.bind(this._manager),unsubscribe:void 0,initiate:this._manager.initiate.bind(this._manager)},this.windowTypes={get:this._getWindowTypesWrapper.bind(this),registerFactory:this._manager.registerWindowFactory.bind(this._manager),unregisterFactory:this._manager.unregisterWindowFactory.bind(this._manager),subscribe:this._manager.subscribeWindowTypeEvents.bind(this._manager),unsubscribe:void 0},this.windows={get:this._manager.getWindows.bind(this._manager),subscribe:this._manager.subscribeWindowEvents.bind(this._manager),announce:this._manager.announceWindow.bind(this._manager),unsubscribe:void 0,create:this._manager.createWindow.bind(this._manager)},this.instances={get:this._manager.getActivities.bind(this._manager),subscribe:this._manager.subscribeActivityEvents.bind(this._manager),unsubscribe:void 0}}return i.prototype._getActivityTypesWrapper=function(i){return util.isUndefined(i)?this._manager.getActivityTypes():this._manager.getActivityType(i)},i.prototype._getWindowTypesWrapper=function(i){return util.isUndefined(i)?this._manager.getWindowTypes():this._manager.getWindowType(i)},i}();exports.ActivityManagementAPI=ActivityManagementAPI;

},{"./../helpers/util":29}],10:[function(require,module,exports){
var logger_1=require("./../helpers/logger"),util=require("./../helpers/util"),ActivityMy=function(){function t(t){var i=this;this._myActivityJoinedCallbacks=[],this._myActivityRemovedCallbacks=[],this._myContextUpdateCallbacks=[],this._logger=logger_1.Logger.Get(this),this._manager=t,t.ready().then(function(t){t.subscribeActivityContextChanged(i._subscribeMyContextChanged.bind(i)),t.subscribeWindowEvents(i._subscribeMyWindowEvent.bind(i))})}return Object.defineProperty(t.prototype,"window",{get:function(){if(util.isUndefinedOrNull(this._window)){var t=this._manager.announcedWindows;t.length>0&&(this._window=t[0])}return this._window},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activity",{get:function(){var t=this.window;return util.isUndefinedOrNull(t)?void 0:t.activity},enumerable:!0,configurable:!0}),t.prototype.createWindow=function(t){return this._manager.createWindow(this.activity,t)},Object.defineProperty(t.prototype,"context",{get:function(){var t=this.activity;return util.isUndefined(t)?{}:t.context},enumerable:!0,configurable:!0}),t.prototype.onActivityJoined=function(t){this._myActivityJoinedCallbacks.push(t);var i=this.window;util.isUndefinedOrNull(i)||util.isUndefinedOrNull(i.activity)||t(i.activity)},t.prototype.onActivityLeft=function(t){this._myActivityRemovedCallbacks.push(t)},t.prototype.onContextChanged=function(t){this._myContextUpdateCallbacks.push(t);var i=this.window;if(!util.isUndefinedOrNull(i)){var e=i.activity;util.isUndefinedOrNull(e)||t(e.context,e.context,[],e)}},t.prototype._subscribeMyContextChanged=function(t,i,e,n){var o=this.window;if(!util.isUndefinedOrNull(o)){var r=o.activity;util.isUndefinedOrNull(r)||t.id===r.id&&this._notifyMyContextChanged(t,i,e,n)}},t.prototype._subscribeMyWindowEvent=function(t,i,e){util.isUndefinedOrNull(this.window)||this.window.id===i.id&&("joined"===e?this._notifyOnJoined(t):this._notifyMyWindowEvent(t,this._myActivityRemovedCallbacks))},t.prototype._notifyMyWindowEvent=function(t,i){for(var e=0;e<i.length;e++){var n=i[e];n(t,event)}},t.prototype._notifyMyContextChanged=function(t,i,e,n){e=e||{},n=n||[];for(var o=0;o<this._myContextUpdateCallbacks.length;o++){var r=this._myContextUpdateCallbacks[o];r(i,e,n,t)}},t.prototype._notifyOnJoined=function(t){this._notifyMyWindowEvent(t,this._myActivityJoinedCallbacks),this._notifyMyContextChanged(t,t.context)},t}();Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=ActivityMy;

},{"./../helpers/logger":26,"./../helpers/util":29}],11:[function(require,module,exports){
var ActivityConfig=function(){function i(){}return i}();exports.ActivityConfig=ActivityConfig;

},{}],12:[function(require,module,exports){
require("es6-promise");var hcBridge_1=require("./bridges/hcBridge"),activityManager_1=require("./core/activityManager"),activityMyAPI_1=require("./API/activityMyAPI"),logger_1=require("./helpers/logger"),util=require("./helpers/util"),activityConfig_1=require("./activityConfig"),activityAPI_1=require("./API/activityAPI"),activityAGM_1=require("./core/activityAGM");activity=function(i){i=i||new activityConfig_1.ActivityConfig,util.isUndefined(i.logLevel)||(logger_1.Logger.Level=i.logLevel),util.isUndefinedOrNull(i.logger)||(logger_1.Logger.GlueLogger=i.logger);var e;if(util.isUndefined(window.htmlContainer))throw new Error("Activity not supported in in browser");if(e=new hcBridge_1["default"],!e)throw new Error("A bridge to native activity is needed to create activity lib.");activityAGM_1.ActivityAGM.AGM=i.agm;var t=new activityManager_1["default"](e,!i.disableAutoAnnounce),r=new activityMyAPI_1["default"](t);return new activityAPI_1.ActivityAPI(t,r)},module.exports=activity;

},{"./API/activityAPI":8,"./API/activityMyAPI":10,"./activityConfig":11,"./bridges/hcBridge":13,"./core/activityAGM":16,"./core/activityManager":17,"./helpers/logger":26,"./helpers/util":29,"es6-promise":6}],13:[function(require,module,exports){
var entityEvent_1=require("../contracts/entityEvent"),activityStatus_1=require("../contracts/activityStatus"),activityType_1=require("../entities/activityType"),windowType_1=require("../entities/windowType"),activity_1=require("../entities/activity"),activityWindow_1=require("../entities/activityWindow"),proxyWindowFactory_1=require("../core/proxyWindowFactory"),logger_1=require("../helpers/logger"),entityEvent_2=require("../contracts/entityEvent"),readyMarker_1=require("../helpers/readyMarker"),util=require("../helpers/util"),entityEvent_3=require("../contracts/entityEvent"),HCBridge=function(){function t(t){this._activityTypeEntityName="activityType",this._windowTypeEntityName="windowType",this._activityEntityName="activity",this._windowEntityName="activityWindow",this._logger=logger_1.Logger.Get(this),this._lastSeq=0,this._eventQueue=[],this._activityTypeCallbacks=[],this._windowTypeCallbacks=[],this._activityCallbacks=[],this._windowCallbacks=[],this._agm=t}return t.prototype.init=function(){var t=this;this._readyMarker=new readyMarker_1.ReadyMarker("HC Bridge",1),this._htmlContainer=window.htmlContainer.activityFacade,this._htmlContainer.init(this._agm?this._agm.instance:void 0,this._hcEventHandler.bind(this),function(){t._readyMarker.signal("Init done from HC")},function(i){t._readyMarker.error(i)})},t.prototype.ready=function(){var t=this;return new Promise(function(i,e){t._readyMarker.setCallback(function(n){n?(t._logger.error("Error initializing HC bridge - "+n),e(t._readyMarker.getError())):i(t)})})},t.prototype._hcEventHandler=function(t){this._logger.trace(t);var i=JSON.parse(t);this._processEventBySeq(i)},t.prototype._processEventBySeq=function(t){var i=t.sequence;if(i===this._lastSeq+1){this._processEvent(t),this._lastSeq++;var e=this._eventQueue[i+1];util.isUndefined(e)||(this._logger.debug("replaying message number "+i),this._processEventBySeq(e),delete this._eventQueue[i+1])}else this._eventQueue[i]=t,this._logger.debug("Got out of order event with number "+i+". Will wait for previous event(s) before replaying.")},t.prototype._processEvent=function(i){var e,n=i.entityType,o=this._convertContext(i.context);switch(n){case this._activityTypeEntityName:e=t._hcToJsActivityType(i.entity),this._publishActivityTypeStatusChange(e,o);break;case this._windowTypeEntityName:e=this._hcToJsWindowType(i.entity),this._publishWindowTypeStatusChange(e,o);break;case this._activityEntityName:e=this._hcToJsActivity(i.entity),this._publishActivityStatusChange(e,o);break;case this._windowEntityName:e=t._hcToJsWindow(i.entity),this._publishActivityWindowEvent(e,o)}},t.prototype._convertContext=function(t){if(t.type===entityEvent_1.EntityEventType.StatusChange){var i=new activityStatus_1.ActivityStatus(t.oldStatus.state,t.oldStatus.statusMessage,t.oldStatus.statusTime),e=new activityStatus_1.ActivityStatus(t.newStatus.state,t.newStatus.statusMessage,t.newStatus.statusTime);return new entityEvent_1.EntityStatusChangeEventContext(e,i)}if(t.type===entityEvent_1.EntityEventType.ActivityWindowEvent){var n=this._hcToJsActivity(t.activity);return new entityEvent_1.EntityActivityWindowEventContext(n,t.event)}return t.type===entityEvent_1.EntityEventType.ActivityContextChange?new entityEvent_3.ActivityContextChangedContext(t.newContext,t.updated,t.removed):new entityEvent_1.EntityEventContext(t.type)},t._hcToJsWindow=function(t){return new activityWindow_1["default"](t.id,t.name,t.type,t.activityId,t.instance,t.isIndependent)},t.prototype._hcToJsActivity=function(i){var e=i.owner?t._hcToJsWindow(i.owner):null,n=new activityStatus_1.ActivityStatus(i.status.state,i.status.statusMessage,i.status.statusTime),o=i.windows?i.windows.map(function(i){return t._hcToJsWindow(i)}):[],r=JSON.parse(i.context);return new activity_1["default"](i.id,i.type.name,n,r,e,o)},t._hcToJsActivityType=function(t){return new activityType_1["default"](t.name,t.ownerWindowType,t.helperWindowTypes,t.description)},t.prototype._hcToJsWindowType=function(i){util.isUndefined(i.factories)&&(i.factories=[]);var e=i.factories.map(function(i){return t._hcToJsWindowTypeFactory(i)});return new windowType_1["default"](i.name,e)},t._hcToJsWindowTypeFactory=function(t){return new proxyWindowFactory_1.ProxyWindowFactory(t.description)},t._getURLParameter=function(t){return decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null},t.prototype.getActivityTypes=function(){var i=this;return new Promise(function(e,n){i._htmlContainer.getActivityTypes(function(i){for(var n=[],o=0;o<i.length;o++){var r=i[o],a=t._hcToJsActivityType(r);n.push(a)}e(n)},function(t){n(t)})})},t.prototype.registerActivityType=function(i,e,n,o,r){var a=this;return new Promise(function(s,c){void 0===n&&(n=[]);var u={name:i,ownerWindowType:e,helperWindowTypes:n,description:r,layoutConfig:JSON.stringify(o)};a._htmlContainer.registerActivityType(JSON.stringify(u),function(i){var e=t._hcToJsActivityType(i);s(e)},function(t){c(t)})})},t.prototype.unregisterActivityType=function(t){var i=this;return new Promise(function(e,n){i._htmlContainer.unregisterActivityType(t,function(t){e(!0)},function(t){n(t)})})},t.prototype.getWindowTypes=function(){var t=this;return new Promise(function(i,e){t._htmlContainer.getWindowTypes(function(e){for(var n=[],o=0;o<e.length;o++){var r=e[o],a=t._hcToJsWindowType(r);n.push(a)}i(n)},function(t){e(t)})})},t.prototype.registerWindowFactory=function(t,i){var e=this;return new Promise(function(n,o){return util.isUndefinedOrNull(t)?void o("windowTypeName should be provided"):void e._htmlContainer.registerWindowFactory(t,i.create.bind(i),function(t){n(!0)},function(t){o(t)})})},t.prototype.initiateActivity=function(t,i,e){var n=this;return new Promise(function(e,o){return util.isUndefinedOrNull(t)?void o("windowTypeName should be provided"):(util.isUndefinedOrNull(i)&&(i={}),void n._htmlContainer.initiate(t,JSON.stringify(i),function(t){e(t)},function(t){o(t)}))})},t.prototype.getAnnouncementInfo=function(){var i=window.htmlContainer,e=i.getContext(),n={activityWindowId:"",activityWindowType:"",activityWindowIndependent:!1,activityWindowName:""};return n.activityWindowType=e.activityWindowType,util.isUndefined(n.activityWindowType)&&(n.activityWindowType=t._getURLParameter("activityWindowType")),n.activityWindowId=e.activityWindowId,util.isUndefined(n.activityWindowId)&&(n.activityWindowId=t._getURLParameter("activityWindowId")),n.activityWindowIndependent=e.activityWindowIndependent,util.isUndefined(n.activityWindowIndependent),n.activityWindowName=e.activityWindowName,util.isUndefined(n.activityWindowName)&&(n.activityWindowName=t._getURLParameter("activityWindowName")),n},t.prototype.announceWindow=function(t,i){var e=this;if(util.isUndefined(t))throw new Error("can not determine window type");if(util.isUndefined(t))throw new Error("can not determine window activityWindowId");this._htmlContainer.announceWindow(t,i,function(t){e._logger.error("Error announcing activity window with id '"+i+"'. "+t)})},t.prototype.getActivities=function(){var t=this;return new Promise(function(i,e){t._logger.trace("Executing getActivities()"),t._htmlContainer.getActivities(function(e){t._logger.trace("Got getActivities() :"+e);var n=JSON.parse(e),o=n.map(function(i){return t._hcToJsActivity(i)});i(o)},function(i){t._logger.trace("Error in getActivities() :"+i),e(i)})})},t.prototype.updateActivityContext=function(t,i,e,n){var o=this;return new Promise(function(r,a){util.isUndefined(n)&&(n=[]);var s={fullReplace:e,removedKeys:n};o._htmlContainer.setActivityContext(t.id,JSON.stringify(i),JSON.stringify(s),function(t){var i=JSON.parse(t);r(i)},function(t){return a(t)})})},t.prototype.getActivityWindows=function(){var i=this;return new Promise(function(e,n){i._htmlContainer.getWindows(function(i){var n=i.map(function(i){return t._hcToJsWindow(i)});e(n)},function(t){n(t)})})},t.prototype.stopActivity=function(t){var i=this;return new Promise(function(e,n){i._htmlContainer.stopActivity(t.id,function(t){e(t)},function(t){n(t)})})},t.prototype.unregisterWindowFactory=function(t){var i=this;return new Promise(function(e,n){i._htmlContainer.registerWindowFactory(t,function(t){e(!0)},function(t){n(t)})})},t.prototype.createWindow=function(t,i){var e=this;return new Promise(function(n,o){e._htmlContainer.createWindow(t,JSON.stringify(i),function(t){n(t)},function(t){o(t)})})},t.prototype.onActivityTypeStatusChange=function(t){this._activityTypeCallbacks.push(t)},t.prototype.onWindowTypeStatusChange=function(t){this._windowTypeCallbacks.push(t)},t.prototype.onActivityStatusChange=function(t){this._activityCallbacks.push(t)},t.prototype.onActivityWindowChange=function(t){this._windowCallbacks.push(t)},t.prototype.getWindowBounds=function(t){var i=this;return new Promise(function(e,n){i._htmlContainer.getWindowBounds(t,function(t){e(t)},function(t){n(t)})})},t.prototype.setWindowBounds=function(t,i){var e=this;return new Promise(function(n,o){e._htmlContainer.setWindowBounds(t,JSON.stringify(i),function(){n()},function(t){o(t)})})},t.prototype.registerWindow=function(t,i,e){var n=this;return new Promise(function(o,r){n._htmlContainer.registerWindow(t,i,e,function(t){o(t)},function(t){r(t)})})},t.prototype.closeWindow=function(t){var i=this;return new Promise(function(e,n){i._htmlContainer.closeWindow(t,function(){e()},function(t){n(t)})})},t.prototype._publishStatusChange=function(t,i,e){var n=new entityEvent_2.EntityEvent(t,i);e.forEach(function(t){t(n)})},t.prototype._publishActivityTypeStatusChange=function(t,i){this._publishStatusChange(t,i,this._activityTypeCallbacks)},t.prototype._publishWindowTypeStatusChange=function(t,i){this._publishStatusChange(t,i,this._windowTypeCallbacks)},t.prototype._publishActivityStatusChange=function(t,i){this._publishStatusChange(t,i,this._activityCallbacks)},t.prototype._publishActivityWindowEvent=function(t,i){this._publishStatusChange(t,i,this._windowCallbacks)},t}();Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=HCBridge;

},{"../contracts/activityStatus":14,"../contracts/entityEvent":15,"../core/proxyWindowFactory":19,"../entities/activity":20,"../entities/activityType":22,"../entities/activityWindow":23,"../entities/windowType":24,"../helpers/logger":26,"../helpers/readyMarker":28,"../helpers/util":29}],14:[function(require,module,exports){
var ActivityStatus=function(){function t(t,e,i){this.state=t,this.message=e,this.time=i}return t.prototype.getState=function(){return this.state},t.prototype.getMessage=function(){return this.message},t.prototype.getTime=function(){return this.time},t}();exports.ActivityStatus=ActivityStatus;

},{}],15:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,n){function e(){this.constructor=t}for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i]);t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)},EntityEvent=function(){function t(t,n){this.entity=t,this.context=n}return t}();exports.EntityEvent=EntityEvent;var EntityEventContext=function(){function t(t){this.type=t}return t}();exports.EntityEventContext=EntityEventContext;var EntityStatusChangeEventContext=function(t){function n(n,e){t.call(this,EntityEventType.StatusChange),this.newStatus=n,this.oldStatus=e}return __extends(n,t),n}(EntityEventContext);exports.EntityStatusChangeEventContext=EntityStatusChangeEventContext;var EntityActivityWindowEventContext=function(t){function n(n,e){t.call(this,EntityEventType.ActivityWindowEvent),this.activity=n,this.event=e}return __extends(n,t),n}(EntityEventContext);exports.EntityActivityWindowEventContext=EntityActivityWindowEventContext;var ActivityContextChangedContext=function(t){function n(n,e,i){t.call(this,EntityEventType.ActivityContextChange),this.updated=e,this.removed=i,this.context=JSON.parse(n)}return __extends(n,t),n}(EntityEventContext);exports.ActivityContextChangedContext=ActivityContextChangedContext;var EntityEventType=function(){function t(){}return t.Added="added",t.Removed="removed",t.Updated="updated",t.FactoryRegistered="factoryRegistered",t.FactoryUnregistered="factoryUnregistered",t.StatusChange="statusChange",t.ActivityContextChange="activityContextUpdate",t.ActivityWindowEvent="activityWindowEvent",t}();exports.EntityEventType=EntityEventType;

},{}],16:[function(require,module,exports){
var util=require("../helpers/util"),ActivityAGM=function(){function t(t){this._activity=t}return t.prototype.register=function(i,e){this._ensureHasAgm(),t.AGM.register(i,e)},t.prototype.servers=function(){return this._ensureHasAgm(),util.isUndefinedOrNull(this._activity)?[]:this._activity.windows.map(function(t){return t.instance})},t.prototype.methods=function(){if(this._ensureHasAgm(),util.isUndefinedOrNull(this._activity))return[];for(var t=this._activity.windows,i=[],e=[],n=0;n<t.length;n++)for(var r=t[n],s=this.methodsForWindow(r),o=0;o<s.length;o++){var u=s[o];-1===i.indexOf(u.name)&&(i.push(u.name),e.push(u))}return e},t.prototype.methodsForWindow=function(i){return this._ensureHasAgm(),i.instance?t.AGM.methodsForInstance(i.instance):[]},t.prototype.invoke=function(i,e,n,r,s,o){this._ensureHasAgm();var u=this.servers(),a=[];if(util.isUndefinedOrNull(n)&&(n="activity.all"),util.isString(n))if("activity.all"===n)a=u;else{if("activity.best"!==n){if("all"===n||"best"===n)return t.AGM.invoke(i,e,n,r,s,o);throw new Error("Invalid invoke target "+n)}var c=u.filter(function(e){var n=t.AGM.methodsForInstance(e);return n.filter(function(t){return t.name===i}).length>0});c.length>0&&(a=[c[0]])}else if(util.isArray(n)){if(n.length>=0){var f=n[0];if(this._isAgmInstance(f))a=n.map(function(t){return t});else{if(!this._isActivityWindow(f))throw new Error("Unknown target object");a=n.map(function(t){return t.instance})}}}else if(this._isAgmInstance(n))a=[n];else{if(!this._isActivityWindow(n))throw new Error("Unknown target object");a=[n.instance]}return t.AGM.invoke(i,e,a,r,s,o)},t.prototype.unregister=function(i){return this._ensureHasAgm(),t.AGM.unregister(i)},t.prototype.createStream=function(i,e,n){this._ensureHasAgm(),t.AGM.createStream(i,e,n)},t.prototype.subscribe=function(i,e,n){this._ensureHasAgm();var r=this.servers();return t.AGM.subscribe(i,e,r)},t.prototype._ensureHasAgm=function(){if(util.isUndefinedOrNull(t.AGM))throw new Error("Agm should be configured to be used in activity")},t.prototype._isAgmInstance=function(t){return void 0!=t.application},t.prototype._isActivityWindow=function(t){return void 0!==t.instance},t}();exports.ActivityAGM=ActivityAGM;

},{"../helpers/util":29}],17:[function(require,module,exports){
var entityEvent_1=require("../contracts/entityEvent"),activityType_1=require("../entities/activityType"),promiseExtensions_1=require("../helpers/promiseExtensions"),readyMarker_1=require("../helpers/readyMarker"),entityObservableCollection_1=require("../helpers/entityObservableCollection"),logger_1=require("../helpers/logger"),util=require("../helpers/util"),localWindowFactory_1=require("./localWindowFactory"),ActivityManager=function(){function t(t,i){var e=this;if(this._logger=logger_1.Logger.Get(this),this._announcedWindows=[],this._bridge=t,this._activityTypes=new entityObservableCollection_1.EntityObservableCollection(function(t){return e._grabEntity(t)}),this._windowTypes=new entityObservableCollection_1.EntityObservableCollection(function(t){return e._grabEntity(t)}),this._activities=new entityObservableCollection_1.EntityObservableCollection(function(t){return e._grabEntity(t)}),this._windows=new entityObservableCollection_1.EntityObservableCollection(function(t){return e._grabEntity(t)}),this._dataReadyMarker=new readyMarker_1.ReadyMarker("Activity Manager Data",["GetActivityTypes","GetWindowTypes","GetActivities","GetWindows"].length),i){var n=new readyMarker_1.ReadyMarker("Activity Manager Announce",["Announcement"].length);this._readyMarker=n,this._dataReadyMarker.setCallback(function(t){t&&e._readyMarker.error(t),e._logger.debug("Auto announcing window"),e.announceWindow().then(function(t){e._announcedWindows.push(t),e._readyMarker.signal("Successfully announced window with id '"+t.id+"'")})["catch"](function(t){e._logger.debug("Will not announce window - "+t),e._readyMarker.signal()})})}else this._readyMarker=this._dataReadyMarker;this._bridge.init(),this._bridge.ready().then(function(t){e._subscribeForData()})["catch"](function(t){console.log(t)})}return Object.defineProperty(t.prototype,"announcedWindows",{get:function(){return this._announcedWindows},set:function(t){throw new Error("not allowed")},enumerable:!0,configurable:!0}),t.prototype.ready=function(t){var i=this,e=new Promise(function(t,e){i._readyMarker.setCallback(function(n){n?e(i._readyMarker.getError()):t(i)})});return promiseExtensions_1.nodeify(e,t)},t.prototype.getActivityTypes=function(){return this._activityTypes.get()},t.prototype.getActivityType=function(t){return this._activityTypes.getByName(t)},t.prototype.registerActivityType=function(t,i,e,n,r,o){var s=this,a=new Promise(function(o,a){util.isUndefinedOrNull(t)&&a("activityTypeName argument can not be undefined"),util.isString(t)||a("activityTypeName should be string");var d=s.getActivityType(t);util.isUndefinedOrNull(d)||a("Activity type '"+t+"' already exists");var u;util.isUndefined(i)&&a("Owner window type can not be undefined"),u=util.isString(i)?{type:i,name:"",isIndependent:!1,arguments:{}}:i;var c=[];if(!util.isUndefined(e)&&util.isArray(e))for(var y in e){var l=e[y];if(util.isString(l)){var f={type:l,name:"",isIndependent:!1,arguments:{},relativeTo:"",relativeDirection:"",windowStyleAttributes:{}};c.push(f)}else c.push(l)}s._bridge.registerActivityType(t,u,c,n,r).then(function(t){s._grabEntity(t),o(t)})["catch"](function(t){a(t)})});return promiseExtensions_1.nodeify(a,o)},t.prototype.unregisterActivityType=function(t,i){var e=this,n=new Promise(function(i,n){var r=e.getActivityType(t);return util.isUndefined(r)&&n("Activity type '"+t+"' does not exists"),e._bridge.unregisterActivityType(t)});return promiseExtensions_1.nodeify(n,i)},t.prototype.initiate=function(t,i,e){var n=this,r=new Promise(function(e,r){var o=n.getActivityType(t);util.isUndefined(o)&&r("Activity type '"+t+"' does not exists"),n._bridge.initiateActivity(t,i).then(function(t){n._activities.getOrWait(t).then(function(t){e(t)})["catch"](function(t){return r(t)})})["catch"](function(t){r(t)})});return promiseExtensions_1.nodeify(r,e)},t.prototype.subscribeActivityTypeEvents=function(t){this._activityTypes.subscribe(function(i,e){t(i,e.type)})},t.prototype.getWindowTypes=function(){return this._windowTypes.get()},t.prototype.getWindowType=function(t){return this._windowTypes.getByName(t)},t.prototype.registerWindowFactory=function(t,i,e,n){var r=this,o=new Promise(function(n,o){if(util.isUndefinedOrNull(t))return void o("no windowType specified");if(util.isObject(t))t=t.getName();else if(!util.isString(t))return void o("windowType should be string or object that has getName method");var s=new localWindowFactory_1.LocalWindowFactory(i,e);r._bridge.registerWindowFactory(t,s).then(function(t){n(t)})["catch"](function(t){o(t)})});return promiseExtensions_1.nodeify(o,n)},t.prototype.unregisterWindowFactory=function(t,i){var e=this,n=new Promise(function(i,n){return util.isUndefinedOrNull(t)?void n("no windowType specified"):util.isString(t)?void e._bridge.unregisterWindowFactory(t).then(function(t){i(t)})["catch"](function(t){n(t)}):void n("windowType should be a string")});return promiseExtensions_1.nodeify(n,i)},t.prototype.getActivities=function(t){var i=this._activities.get();if(!t)return i;var e=t;if(util.isString(t))e=[t];else if(t instanceof activityType_1["default"])e=[t.name];else if(!(t instanceof Array))throw new Error("Invalid input argument 'activityType' = "+t);return i.filter(function(t){var i=t.type;return util.some(e,function(t){return i.id==t.id})})},t.prototype.getActivityById=function(t){return this._activities.getByName(t)},t.prototype.announceWindow=function(t,i){var e=this,n=new Promise(function(n,r){var o=e._bridge.getAnnouncementInfo();if(util.isUndefined(t)&&(t=o.activityWindowId),util.isUndefined(i)&&(i=o.activityWindowType),util.isUndefinedOrNull(i))throw new Error("Can not announce - unknown windowType");if(util.isUndefinedOrNull(t))e._logger.debug("Registering window with type:'"+i+"', name:'"+o.activityWindowName+"', ind.:'"+o.activityWindowIndependent+"'"),e._bridge.registerWindow(i,o.activityWindowName,o.activityWindowIndependent).then(e._windows.getOrWait.bind(e._windows)).then(function(t){n(t)})["catch"](function(t){e._logger.error(t)});else{e._logger.debug("Announcing window with id '"+t+"' and type '"+i+"'");var s=e._windows.getByName(t);if(!util.isUndefinedOrNull(s))return e._logger.debug("Window with id '"+t+"' already announced - reusing the window"),void n(s);var a=function(i,o,s){if(t===o.id&&"joined"===s){var d=o.activity;util.isUndefined(d)&&r("UNDEFINED ACTIVITY"),e._logger.trace("Got joined event for id '"+t+"'"),n(o),e.unsubscribeWindowEvents(a)}};e.subscribeWindowEvents(a),e._logger.trace("Waiting for joined event for id '"+t+"'"),e._bridge.announceWindow(i,t)}});return n},t.prototype.subscribeWindowTypeEvents=function(t){this._windowTypes.subscribe(function(i,e){t(i,e.type)})},t.prototype.subscribeActivityEvents=function(t){this._activities.subscribe(function(i,e){if(e.type===entityEvent_1.EntityEventType.StatusChange){var n=e;t(i,n.newStatus,n.oldStatus)}})},t.prototype.subscribeWindowEvents=function(t){this._windows.subscribe(function(i,e){if(e.type===entityEvent_1.EntityEventType.ActivityWindowEvent){var n=e;t(i.activity,i,n.event)}})},t.prototype.unsubscribeWindowEvents=function(t){},t.prototype.createWindow=function(t,i,e){var n=this,r=new Promise(function(e,r){util.isUndefinedOrNull(t)&&r("activity is undefined"),util.isUndefinedOrNull(i)&&r("windowType is undefined");var o;o=util.isString(i)?{type:i,name:"",isIndependent:!1,arguments:{}}:i;var s;if(!util.isUndefinedOrNull(o.relativeTo))if(s=o.relativeTo,util.isString(s)){var a=n.getWindows({type:s});!util.isUndefinedOrNull(a)&&a.length>0&&(o.relativeTo=a[0].id)}else if(util.isUndefinedOrNull(s.type))util.isUndefinedOrNull(s.windowId)||(o.relativeTo=s.windowId);else{var a=n.getWindows({type:s.type});!util.isUndefinedOrNull(a)&&a.length>0&&(o.relativeTo=a[0].id)}n._bridge.createWindow(t.id,o).then(function(t){var i=n._windows.getByName(t);util.isUndefined(i)||e(i),n._logger.debug("Window created, waiting for window entity with id "+t);var r=function(i,n){i.id===t&&(this._logger.debug("Got entity window with id "+t),e(i),this._windows.unsubscribe(r))}.bind(n);n._windows.subscribe(r)})["catch"](function(t){r(t)})});return promiseExtensions_1.nodeify(r,e)},t.prototype.joinWindowToActivity=function(t,i,e){return void 0},t.prototype.leaveWindowFromActivity=function(t,i,e){return void 0},t.prototype.setActivityContext=function(t,i,e){var n=this,r=new Promise(function(e,r){util.isUndefinedOrNull(t)&&r("activity can not be null"),n._bridge.updateActivityContext(t,i,!0).then(function(t){e(t)})["catch"](function(t){r(t)})});return promiseExtensions_1.nodeify(r,e)},t.prototype.updateActivityContext=function(t,i,e){var n=this,r=new Promise(function(e,r){util.isUndefinedOrNull(t)&&r("activity can not be null");var o=[];for(var s in i)i.hasOwnProperty(s)&&null===i[s]&&o.push(s);n._bridge.updateActivityContext(t,i,!1,o).then(function(t){e(t)})["catch"](function(t){r(t)})});return promiseExtensions_1.nodeify(r,e)},t.prototype.subscribeActivityContextChanged=function(t){this._activities.subscribe(function(i,e){if(e.type===entityEvent_1.EntityEventType.ActivityContextChange){var n=e;t(i,n.context,n.updated,n.removed)}})},t.prototype.stopActivity=function(t,i){var e=this._bridge.stopActivity(t);return promiseExtensions_1.nodeify(e,i)},t.prototype.getWindows=function(t){if(util.isUndefined(t))return this._windows.get();if(!util.isUndefined(t.id))return[this._windows.getByName(t.id)];var i=this._windows.get();return i.filter(function(i){if(!util.isUndefined(t.type)&&i.type.id!==t.type)return!1;if(!util.isUndefined(t.name)&&i.name!==t.name)return!1;if(!util.isUndefined(t.activityId)){if(util.isUndefinedOrNull(i.activity))return!1;if(i.activity.id!==t.activityId)return!1}return!0})},t.prototype._grabEntity=function(t){t.manager=this},t.prototype._subscribeForData=function(){var t=this;this._logger.debug("Start getting initial data..."),this._bridge.onActivityTypeStatusChange(function(i){t._activityTypes.process(i)}),this._bridge.getActivityTypes().then(function(i){t._activityTypes.add(i),t._dataReadyMarker.signal("Got act types")})["catch"](function(i){t._logger.error(i),t._dataReadyMarker.error("Can not initialize ActivityManager - error getting activity types -"+i)}),this._bridge.onWindowTypeStatusChange(function(i){t._windowTypes.process(i)}),this._bridge.getWindowTypes().then(function(i){t._windowTypes.add(i),t._dataReadyMarker.signal("Got window types")})["catch"](function(i){t._logger.error(i),t._dataReadyMarker.error("Can not initialize ActivityManager - error getting window types  "+i)}),this._bridge.onActivityStatusChange(function(i){t._activities.process(i)}),this._bridge.getActivities().then(function(i){t._activities.add(i),t._dataReadyMarker.signal("Got activities")})["catch"](function(i){t._logger.error(i),t._dataReadyMarker.error("Can not initialize ActivityManager - error getting activity instances -"+i)}),this._bridge.onActivityWindowChange(function(i){t._windows.process(i)}),this._bridge.getActivityWindows().then(function(i){t._windows.add(i),t._dataReadyMarker.signal("Got windows")})["catch"](function(i){t._logger.error(i),t._dataReadyMarker.error("Can not initialize ActivityManager - error getting activity windows -"+i)})},t.prototype.getWindowBounds=function(t){return this._bridge.getWindowBounds(t)},t.prototype.setWindowBounds=function(t,i,e){var n=this,r=new Promise(function(e,r){n._bridge.setWindowBounds(t,i).then(function(){return e()})["catch"](function(t){return r(t)})});return promiseExtensions_1.nodeify(r,e)},t.prototype.closeWindow=function(t){return this._bridge.closeWindow(t)},t}();Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=ActivityManager;

},{"../contracts/entityEvent":15,"../entities/activityType":22,"../helpers/entityObservableCollection":25,"../helpers/logger":26,"../helpers/promiseExtensions":27,"../helpers/readyMarker":28,"../helpers/util":29,"./localWindowFactory":18}],18:[function(require,module,exports){
var LocalWindowFactory=function(){function t(t,o){this._createFunction=t,this._description=o}return t.prototype.create=function(t,o,n){return this._createFunction(t,o,n)},t.prototype.description=function(){return this._description},t}();exports.LocalWindowFactory=LocalWindowFactory;

},{}],19:[function(require,module,exports){
var ProxyWindowFactory=function(){function o(o){this._description=o}return o.prototype.create=function(o,t){return void 0},o.prototype.description=function(){return this._description},o}();exports.ProxyWindowFactory=ProxyWindowFactory;

},{}],20:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},activityEntity_1=require("./activityEntity"),activityAGM_1=require("../core/activityAGM"),Activity=function(t){function e(e,i,n,o,r,s){t.call(this,e),this._id=e,this._actType=i,this._status=n,this._context=o,this._owner=r,this._helperWindows=s,this._agm=new activityAGM_1.ActivityAGM(this)}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.manager?this.manager.getActivityType(this._actType):void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"windows",{get:function(){return this.manager.getWindows({activityId:this._id})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"agm",{get:function(){return this._agm},enumerable:!0,configurable:!0}),e.prototype.join=function(t,e){return this.manager.joinWindowToActivity(this,t,e)},e.prototype.createWindow=function(t,e){return this.manager.createWindow(this,t,e)},e.prototype.leave=function(t,e){return this.manager.leaveWindowFromActivity(this,t,e)},e.prototype.getWindowsByType=function(t){var e={activityId:this._id,type:t};return this.manager.getWindows(e)},e.prototype.setContext=function(t,e){return this.manager.setActivityContext(this,t,e)},e.prototype.updateContext=function(t,e){return this.manager.updateActivityContext(this,t,e)},e.prototype.onStatusChange=function(t){var e=this;this.manager.subscribeActivityEvents(function(i,n,o){i.id===e.id&&t(i,n,o)})},e.prototype.onWindowEvent=function(t){var e=this;this.manager.subscribeWindowEvents(function(i,n,o){i.id===e.id&&t(i,n,o)})},e.prototype.onContextChanged=function(t){var e=this;this.manager.subscribeActivityContextChanged(function(i,n,o,r){i.id===e.id&&t(n,o,r,i)}),t(this.context,this.context,[],this)},e.prototype.stop=function(){this.manager.stopActivity(this)},e.prototype.updateCore=function(e){t.prototype.updateCore.call(this,e),this._actType=e._actType,this._context=e._context,this._status=e._status,this._helperWindows=e._helperWindows,this._owner=e._owner},e}(activityEntity_1["default"]);Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=Activity;

},{"../core/activityAGM":16,"./activityEntity":21}],21:[function(require,module,exports){
var ActivityEntity=function(){function t(t){this.listeners=[],this._id=t}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.onUpdated=function(t){this.listeners.push(t)},t.prototype.update=function(t){if(t._id!=this._id)throw Error("Can not update from entity with different id.");this.updateCore(t),this.notify()},t.prototype.updateCore=function(t){},t.prototype.notify=function(){for(var t=0;t<this.listeners.length;t++){var e=this.listeners[t];e(this)}},t}();Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=ActivityEntity;

},{}],22:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},activityEntity_1=require("./activityEntity"),ActivityType=function(t){function e(e,i,n,r){t.call(this,e),this._name=e,this._description=r,this._ownerWindow=i,this._helperWindows=n||[]}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"helperWindows",{get:function(){return this._helperWindows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ownerWindow",{get:function(){return this._ownerWindow},enumerable:!0,configurable:!0}),e.prototype.subscribeActivityStatusChange=function(t){return void 0},e.prototype.initiate=function(t,e){return this.manager.initiate(this._name,t,e)},e.prototype.updateCore=function(e){t.prototype.updateCore.call(this,e),this._description=e._description,this._ownerWindow=e._ownerWindow,this._helperWindows=e._helperWindows},e}(activityEntity_1["default"]);Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=ActivityType;

},{"./activityEntity":21}],23:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},activityEntity_1=require("./activityEntity"),logger_1=require("../helpers/logger"),util=require("../helpers/util"),ActivityWindow=function(t){function e(e,i,n,o,r,s){t.call(this,e),this._logger=logger_1.Logger.Get(this),this._type=n,this._activityId=o,this._name=i,this._instance=r,this._isIndependent=s}return __extends(e,t),e.prototype.getBounds=function(){return this.manager.getWindowBounds(this.id)},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isIndependent",{get:function(){return this._isIndependent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.manager?this.manager.getWindowType(this._type):void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activity",{get:function(){return util.isUndefined(this._activityId)?void 0:this.manager.getActivityById(this._activityId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOwner",{get:function(){var t=this.activity;return util.isUndefined(t)?!1:t.owner.id===this.id},enumerable:!0,configurable:!0}),e.prototype.setVisible=function(t,e){return void 0},e.prototype.setTitle=function(t,e){return void 0},e.prototype.setBounds=function(t,e){return this.manager.setWindowBounds(this.id,t,e)},e.prototype.setState=function(t,e){return void 0},e.prototype.close=function(){return this.manager.closeWindow(this.id)},Object.defineProperty(e.prototype,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),e.prototype.onActivityJoined=function(t){this._subscribeForActivityWindowEvent("joined",t)},e.prototype.onActivityRemoved=function(t){this._subscribeForActivityWindowEvent("removed",t)},e.prototype.updateCore=function(t){this._activityId=t._activityId,this._isIndependent=t._isIndependent,util.isUndefinedOrNull(t._instance)||(this._instance=t._instance)},e.prototype._subscribeForActivityWindowEvent=function(t,e){var i=this;this.manager.subscribeWindowEvents(function(n,o,r){o.id===i.id&&r===t&&e(n)})},e}(activityEntity_1["default"]);Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=ActivityWindow;

},{"../helpers/logger":26,"../helpers/util":29,"./activityEntity":21}],24:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},activityEntity_1=require("./activityEntity"),WindowType=function(t){function e(e,r){t.call(this,e),this._name=e,this._factories=r}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"factories",{get:function(){return this._factories},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"windows",{get:function(){return this.manager.getWindows({type:this._name})},enumerable:!0,configurable:!0}),e.prototype.registerFactory=function(t,e,r,n){return this.manager.registerWindowFactory(this,e,r)},e}(activityEntity_1["default"]);Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=WindowType;

},{"./activityEntity":21}],25:[function(require,module,exports){
var entityEvent_1=require("../contracts/entityEvent"),EntityObservableCollection=function(){function t(t){this._items={},this._listeners=[],this._processNew=t}return t.prototype.addOne=function(t){this.add([t])},t.prototype.add=function(t){for(var e=0;e<t.length;e++){var i=t[e];this.process(new entityEvent_1.EntityEvent(i,new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added)))}},t.prototype.process=function(t){var e=t.context,i=e.type,n=t.entity,s=this._updateInternalCollections(n,i);this._notifyListeners(s,e)},t.prototype.get=function(){var t=[];for(var e in this._items)if(this._items.hasOwnProperty(e)){var i=this._items[e];t.push(i)}return t},t.prototype.getByName=function(t){for(var e in this._items)if(e===t)return this._items[e];return void 0},t.prototype.getOrWait=function(t){var e=this;return new Promise(function(i){var n=function(s){s.id===t&&(i(s),e.unsubscribe(n))};e.subscribe(n);var s=e.getByName(t);return s?void i(s):void 0})},t.prototype.subscribe=function(t){this._listeners.push(t);for(var e in this._items){var i=this._items[e];t(i,new entityEvent_1.EntityEventContext(entityEvent_1.EntityEventType.Added.toString()))}},t.prototype.unsubscribe=function(t){var e=this._listeners.indexOf(t);-1!=e&&this._listeners.splice(e,1)},t.prototype._notifyListeners=function(t,e){for(var i=0;i<this._listeners.length;i++){var n=this._listeners[i];n(t,e)}},t.prototype._updateInternalCollections=function(t,e){if(e===entityEvent_1.EntityEventType.Removed)return delete this._items[t.id],t;var i=t.id;return this._items.hasOwnProperty(i)?this._items[t.id].update(t):(this._processNew(t),this._items[t.id]=t),this._items[t.id]},t}();exports.EntityObservableCollection=EntityObservableCollection;

},{"../contracts/entityEvent":15}],26:[function(require,module,exports){
var util=require("./util"),LogLevel=function(){function e(){}return e.Trace="trace",e.Debug="debug",e.Info="info",e.Warn="warn",e.Error="error",e}();exports.LogLevel=LogLevel;var Logger=function(){function e(o){this._name=o,util.isUndefinedOrNull(e.GlueLogger)||(this._glueLogger=e.GlueLogger.subLogger(o))}return e.GetNamed=function(o){return new e(o)},e.Get=function(o){return new e(e.GetTypeName(o))},e.prototype.trace=function(o){util.isUndefinedOrNull(this._glueLogger)?e.Level===LogLevel.Trace&&console.info(this._getMessage(o,LogLevel.Trace)):this._glueLogger.trace(o)},e.prototype.debug=function(o){util.isUndefinedOrNull(this._glueLogger)?(e.Level===LogLevel.Debug||e.Level===LogLevel.Trace)&&console.info(this._getMessage(o,LogLevel.Debug)):this._glueLogger.debug(o)},e.prototype.info=function(o){util.isUndefinedOrNull(this._glueLogger)?(e.Level===LogLevel.Debug||e.Level===LogLevel.Trace||e.Level===LogLevel.Info)&&console.info(this._getMessage(o,LogLevel.Info)):this._glueLogger.info(o)},e.prototype.warn=function(o){util.isUndefinedOrNull(this._glueLogger)?(e.Level===LogLevel.Debug||e.Level===LogLevel.Trace||e.Level===LogLevel.Info||e.Level===LogLevel.Warn)&&console.info(this._getMessage(o,LogLevel.Info)):this._glueLogger.warn(o)},e.prototype.error=function(e){util.isUndefinedOrNull(this._glueLogger)?(console.error(this._getMessage(e,LogLevel.Error)),console.trace()):this._glueLogger.error(e)},e.prototype._getMessage=function(e,o){return"["+o+"] "+this._name+" - "+e},e.GetTypeName=function(e){var o=/function (.{1,})\(/,g=o.exec(e.constructor.toString());return g&&g.length>1?g[1]:""},e.Level=LogLevel.Info,e}();exports.Logger=Logger;

},{"./util":29}],27:[function(require,module,exports){
function nodeify(n,i){return util.isFunction(i)?void n.then(function(n){nextTick(function(){i(null,n)})},function(n){nextTick(function(){i(n,null)})}):n}var util=require("../helpers/util"),nextTick=function(n){setTimeout(n,0)};exports.nodeify=nodeify;

},{"../helpers/util":29}],28:[function(require,module,exports){
var logger_1=require("./logger"),util=require("../helpers/util"),ReadyMarker=function(){function r(r,i){if(this._logger=logger_1.Logger.GetNamed("ReadyMarker ["+r+"]"),this._logger.debug("Initializing ready marker for '"+r+"' with "+i+" signals to wait"),0>=i)throw new Error("Invalid signal number. Should be > 0");this._signals=i,this._callbacks=[],this._name=r}return r.prototype.setCallback=function(r){return this.isSet()?void r(void 0):this.isError()?void r(this._error):void this._callbacks.push(r)},r.prototype.signal=function(r){if(this._logger.debug("Signaled - "+r+" - signals left "+(this._signals-1)),this._signals--,this._signals<0)throw new Error("Error in ready marker '"+this._name+" - signals are "+this._signals);this.isSet()&&this._callbacks.forEach(function(r){r(void 0)})},r.prototype.error=function(r){this._error=r,this._callbacks.forEach(function(i){i(r)})},r.prototype.isSet=function(){return this.isError()?!1:0===this._signals},r.prototype.isError=function(){return!util.isUndefined(this._error)},r.prototype.getError=function(){return this._error},r}();exports.ReadyMarker=ReadyMarker;

},{"../helpers/util":29,"./logger":26}],29:[function(require,module,exports){
function isNumber(r){return"number"==typeof r}function isString(r){return"string"==typeof r}function isObject(r){return"object"==typeof r&&null!==r}function isArray(r){return Array.isArray?Array.isArray(r):"[object Array]"===toString.call(r)}function isUndefined(r){return"undefined"==typeof r}function isUndefinedOrNull(r){return!r||"undefined"==typeof r}function isEmpty(r){for(var n in r)if(r.hasOwnProperty(n))return!1;return!0}function isFunction(r){return!!(r&&r.constructor&&r.call&&r.apply)}function some(r,n){for(var t=0;t<r.length;t++)if(n(r[t],t))return!0;return!1}function first(r,n){for(var t=0;t<r.length;t++)if(n(r[t],t))return r[t];return void 0}exports.isNumber=isNumber,exports.isString=isString,exports.isObject=isObject,exports.isArray=isArray,exports.isUndefined=isUndefined,exports.isUndefinedOrNull=isUndefinedOrNull,exports.isEmpty=isEmpty,exports.isFunction=isFunction,exports.some=some,exports.first=first;

},{}],30:[function(require,module,exports){
(function (global){
var connection=require("tick42-gateway-connection"),client=require("./agm_client"),server=require("./agm_server"),instance=require("./agm_instance"),native_agm=require("./agm_native");agm=function(e){"use strict";var t={};t.version="__VERSION__","object"!=typeof e&&(e={});var r=["connection","client","server"];r.forEach(function(t){"object"!=typeof e[t]&&(e[t]={}),e.debug&&(e[t].debug=!0)});var n=e.connection;t.connection="object"==typeof n&&"function"==typeof n.send&&"function"==typeof n.on?n:connection(e.connection);var o="agm",d={send:function(e,r){t.connection.send(o,e,r)},on:function(e,r){t.connection.on(o,e,r)}},i=e.metrics;return void 0!==i&&(e.client.metrics=i.subSystem("Client"),e.server.metrics=i.subSystem("Server")),t.instance=instance(e.instance,d),t.client=client(d,t.instance,e.client),t.server=server(d,t.instance,e.server),t.invoke=t.client.invoke,t.register=t.server.register,t.unregister=t.server.unregister,t.servers=t.client.servers,t.methods=t.client.methods,t.methods_for_instance=t.client.methods_for_instance,t.methodsForInstance=t.client.methods_for_instance,t.method=t.client.method,t.method_added=t.client.method_added,t.methodAdded=t.client.method_added,t.method_removed=t.client.method_removed,t.methodRemoved=t.client.method_removed,t.server_method_added=t.client.server_method_added,t.serverMethodAdded=t.client.server_method_added,t.server_method_removed=t.client.server_method_removed,t.serverMethodRemoved=t.client.server_method_removed,t.server_added=t.client.server_added,t.serverAdded=t.client.server_added,t.server_removed=t.client.server_removed,t.serverRemoved=t.client.server_removed,t.start=t.server.start,t.stop=t.server.stop,void 0!==global.console&&t.debug===!0&&console.log("AGM started."),t},agm=void 0!==global.htmlContainer?native_agm:agm,void 0===global.tick42&&(global.tick42={}),global.tick42.agm=agm,module.exports=agm;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./agm_client":31,"./agm_instance":36,"./agm_native":37,"./agm_server":38,"tick42-gateway-connection":50}],31:[function(require,module,exports){
(function (global){
function filter_by_target(e,t){if("string"==typeof e)"all"===e?e=t:"best"===e&&(e=void 0!==t[0]?[t[0]]:[]);else{"Array"!==e.constructor.name&&(e=[e]);e=e.reduce(function(e,n){var r=t.filter(function(e){return instance_match(n,e)});return e.concat(r)},[])}return e}function instance_match(e,t){return contains_props(e,t)}function method_match(e,t){return["accepts","returns"].forEach(function(t){void 0!==e[t]&&(e[t]=helpers.signature_normalize(e[t]))}),contains_props(e,t)}function contains_props(e,t){return Object.keys(e).reduce(function(n,r){return e[r].constructor===RegExp?e[r].test(t[r])?n:!1:String(e[r]).toLowerCase()!==String(t[r]).toLowerCase()?!1:n},!0)}function takeWhile(e,t){for(var n=e.length,r=0;n>r&&t(e[r])!==!0;r++);return e[r]}function apply_on(e,t){return e().map(t)}var client_serverstate=require("./agm_client_serverstate"),client_invocationsstate=require("./agm_client_invocationsstate"),helpers=require("./agm_helpers");module.exports=function(e,t,n){function r(e){if("string"==typeof e&&(e={name:e}),void 0!==e){var t=l.get_method(e);return void 0!==t?t:takeWhile(l.get_methods(),function(t){return method_match(e,t)})}}function o(e){return void 0===e?l.get_methods():("string"==typeof e&&(e={name:e}),l.get_methods().filter(function(t){return method_match(e,t)}))}function i(e){var t=l.get_methods(e);if(0!==t.length)return t;var n=s().filter(function(t){return instance_match(e,t)}).reduce(function(e,t){return l.get_method_ids(t).forEach(function(t){e[t]=!0}),e},{});return Object.keys(n).map(function(e){return l.get_method(e)})}function s(e){if(void 0===e)return l.get_servers();var t=r(e);return void 0===t?[]:l.get_servers(t)}function a(e){return e.reduce(function(e,t){return e.concat(l.get_servers(t,!0))},[]).sort(l.compare_servers)}function d(e,t){var n=o(e);return filter_by_target(t,a(n))}function u(e,t,r,o,i,s){var a=new Promise(function(i,s){var a,u;a=function(e){i(e)},u=function(e){s(e)},void 0===t&&(t={}),void 0===r&&(r="best"),"string"==typeof r&&"all"!==r&&"best"!==r&&s({message:'"'+r+'" is not a valid target. Valid targets are "all" and "best".'}),void 0===o&&(o={}),void 0===o.method_response_timeout&&(o.method_response_timeout=n.method_response_timeout),void 0===o.wait_for_method_timeout&&(o.wait_for_method_timeout=n.wait_for_method_timeout),"object"!=typeof t&&s({message:"The method arguments must be an object."}),"string"==typeof e&&(e={name:e});var l=d(e,r);0===l.length?_(e,t,r,o,a,u):1===l.length?(void 0!==global.console&&n.debug===!0&&console.log('>>> Invoking "'+e.name+'" on 1 server'),m.invoke(e,t,l[0],o,a,u)):(void 0!==global.console&&n.debug===!0&&console.log('>>> Invoking "'+e.name+'" on '+l.length+" servers"),c(e,t,l,o,a,u))});return helpers.promisify(a,i,s)}function _(e,t,r,i,s,a){function u(){if(!c){var n=d(e,r)[0];void 0!==n&&(c=!0,m.invoke(e,t,n,i,s,a))}}function _(){return 0!==o(e).length?void a({method:e,called_with:t,message:"I could not find servers with these properties: "+JSON.stringify(r)}):void a({method:e,called_with:t,message:"I could not find a method with those properties: "+JSON.stringify(e)})}var c=!1;0===i.wait_for_method_timeout?_():(setTimeout(function(){n.server_method_added=n.server_method_added.filter(function(e){return e!==u}),c||_()},i.wait_for_method_timeout),h("server_method_added",g,u))}function c(e,t,n,r,o,i){function s(){if(!(a.length+d.length<n.length))if(0!==a.length){var e=a.reduce(function(e,t){return e.method=t.method,e.called_with=t.called_with,e.returned=t.returned,e.all_return_values.push({executed_by:t.executed_by,returned:t.returned}),e.executed_by=t.executed_by,e},{all_return_values:[]});0!==d.length&&(e.all_errors=[],d.forEach(function(t){e.all_errors.push({name:t.method.name,message:t.message})})),o(e)}else 0!==d.length&&i(d.reduce(function(e,t){return e.method=t.method,e.called_with=t.called_with,e.message=t.message,e.all_errors.push({executed_by:t.executed_by,message:t.message}),e},{all_errors:[]}))}var a=[],d=[],u=function(e){a.push(e),s(a,d)},_=function(e){d.push(e),s(a,d)};n.forEach(function(n){m.invoke(e,t,n,r,u,_)})}"object"!=typeof n&&(n={},void 0!==global.console&&n.debug===!0&&console.log("Creating an AGM client with default configuration.")),"number"!=typeof n.remove_server_on_n_missing_heartbeats&&(n.remove_server_on_n_missing_heartbeats=3),"number"!=typeof n.method_response_timeout&&(n.method_response_timeout=3e3),"number"!=typeof n.wait_for_method_timeout&&(n.wait_for_method_timeout=3e3);var l=client_serverstate(n,t);e.on("ServerPresenceMessage",function(e){l.process_presence(e,!0)}),e.on("ServerHeartbeatMessage",function(e){l.process_presence(e,!1)});var m=client_invocationsstate(n,t,function(t){e.send("MethodInvocationRequestMessage",t)});e.on("MethodInvocationResultMessage",m.process_method_response);var h=helpers.save_callback_in.bind(this,n),f=apply_on.bind(null,l.get_servers),v=apply_on.bind(null,l.get_methods),g=function(e){return e};return{invoke:u,method:r,servers:s,methods:o,methods_for_instance:i,method_added:h.bind(null,"method_added",v),method_removed:h.bind(null,"method_removed",g),server_added:h.bind(null,"server_added",f),server_removed:h.bind(null,"server_removed",g),server_method_added:h.bind(null,"server_method_added",g),server_method_removed:h.bind(null,"server_method_removed",g),parse_signature:helpers.signature_parse_friendly}};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./agm_client_invocationsstate":32,"./agm_client_serverstate":34,"./agm_helpers":35}],32:[function(require,module,exports){
(function (global){
var helpers=require("./agm_helpers");module.exports=function(e,o,s){"use strict";function t(t,n,l,c,a,i){var d=Math.floor(1e10*Math.random());r(d,{method:t,called_with:n},a,i,c.method_response_timeout),o.response_subject(t,function(r){var a={MethodRequestSubject:l.request_subject,MethodResponseSubject:r,Client:o.info(),Context:{Arguments:helpers.parameters_stringify(n),InvocationId:d,ObjectType:c.object_type,DisplayContext:c.display_context,MethodName:t.name,ExecutionServer:l,Timeout:c.method_response_timeout}};s(a),void 0!==global.console&&e.debug===!0&&(console.debug("%c>>> sending MethodInvocationRequestMessage","background-color:hsla(198, 51%, 79%, 0.5)"),console.debug("%c"+JSON.stringify(a),"background-color:hsla(198, 51%, 79%, 0.5)"))})}function r(e,o,s,t,r){l[e]={response:o,success:s,error:t},setTimeout(function(){void 0!==l[e]&&(t({method:o.method,called_with:o.argument_obj,message:"Timeout reached"}),delete l[e])},r)}function n(o){var s=l[o.InvocationId];if(void 0!==s){if(void 0!==global.console&&e.debug===!0&&(console.debug("%c<<< receiving MethodInvocationResultMessage","background-color:hsla(118, 51%, 79%, 0.5)"),console.debug("%c"+JSON.stringify(o),"background-color:hsla(118, 51%, 79%, 0.5)")),0===o.Status&&"function"==typeof s.success){var t=helpers.parameters_parse(o.ResultContext).arguments;0===Object.keys(t).length&&(t=void 0),void 0!==global.console&&e.debug===!0&&console.log('<<<  "'+s.response.method.name+'" was executed by '+JSON.stringify(helpers.preprocess_server(o.Server))),s.success({method:s.response.method,called_with:s.response.called_with,executed_by:helpers.preprocess_server(o.Server),returned:t,message:o.ResultMessage,log_details:o.ResultLogDetails})}else"function"==typeof s.error&&(void 0!==global.console&&e.debug===!0&&console.log('<<<  "'+s.response.method.name+'" was executed with error by '+JSON.stringify(helpers.preprocess_server(o.Server))),s.error({method:s.response.method,called_with:s.response.called_with,message:o.ResultMessage,log_details:o.ResultLogDetails,status:o.status}));delete l[o.InvocationId]}}var l={};return{process_method_response:n,invoke:t}};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./agm_helpers":35}],33:[function(require,module,exports){
(function (global){
var helpers=require("./agm_helpers");module.exports=function(e){function o(o,r,l){var d=s(o),v=o.request_subject;delete o.request_subject;var _=helpers.clone_object(o),h=helpers.clone_object(l),u=c[d];void 0===u?(u=c[d]={info:o,servers:{}},u=t(u,r,v),helpers.execute_all_with(e.method_added,_),void 0!==global.console&&void 0!==console.table&&e.debug===!0&&(console.log(">>>>>> New method detected: "+JSON.stringify(_)),console.table(n())),i("Methods total count",Object.keys(c).length)):u=t(u,r,v),helpers.execute_all_with(e.server_method_added,{method:_,server:h})}function t(e,o,t){return e.servers[o]=t,e}function r(o,t,r){var s=d(o),l=helpers.clone_object(r),v=c[o].servers;if(delete v[t],0===Object.keys(v).length){e.on_method_removed;helpers.execute_all_with(e.method_removed,s),delete c[o],void 0!==global.console&&void 0!==console.table&&e.debug===!0&&(console.log("<<<<<< Method stopped being available: "+JSON.stringify(s)),console.table(n())),i("Methods total count",Object.keys(c).length)}helpers.execute_all_with(e.server_method_removed,{method:s,server:l})}function s(e){var o=void 0!==e.accepts?e.accepts:"",t=void 0!==e.returns?e.returns:"",r=void 0!==e.version?e.version:0;return(e.name+o+t+r).toLowerCase()}function n(){return Object.keys(c).map(function(e){return helpers.clone_object(c[e].info)})}function l(e){var o=c[s(e)];return void 0!==o?o.servers:{}}function d(e){return"object"==typeof e&&(e=s(e)),void 0!==c[e]?helpers.clone_object(c[e].info):void 0}var c={},i=void 0!==e.metrics?e.metrics.numberMetric.bind(e.metrics):function(){};return{get_methods:n,get_method:d,get_method_id:s,add_server_to_method:o,remove_server_from_method:r,get_servers_for_method:l}};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./agm_helpers":35}],34:[function(require,module,exports){
(function (global){
var helpers=require("./agm_helpers"),get_server_id=helpers.get_server_id,client_methodstate=require("./agm_client_methodstate");module.exports=function(e,r){"use strict";function t(e,r){var t=helpers.preprocess_server(e.Instance);s(t)||n(t),r&&0===e.PublishingInterval||o(t,e.PublishingInterval),void 0!==e.MethodDefinitions&&_(t,e.MethodDefinitions)}function o(r,t){if(-1!==t){var o=get_server_id(r),s=u[o];void 0!==s.bomb&&clearTimeout(s.bomb),s.bomb=setTimeout(function(){i(r)},t*e.remove_server_on_n_missing_heartbeats+1)}}function s(e){var r=get_server_id(e);return void 0!==u[r]}function n(r){var t=get_server_id(r);return u[t]={info:r,methods:[],bomb:void 0},void 0!==global.console&&void 0!==console.table&&e.debug===!0&&(console.log(">>>>>> New server detected: "+JSON.stringify(r)),console.table(d())),helpers.execute_all_with(e.server_added,r),t}function i(r){var t=get_server_id(r);u[t].methods.forEach(function(e){l.remove_server_from_method(e,t,r)}),delete u[t],void 0!==global.console&&void 0!==console.table&&e.debug===!0&&(console.log("<<<<<< Server stopped being available:"+JSON.stringify(r)),console.table(d())),helpers.execute_all_with(e.server_removed,r)}function _(e,r){var t=get_server_id(e),o=u[t].methods;r=r.map(helpers.preprocess_method).reduce(function(e,r){return e[l.get_method_id(r)]=r,e},{}),o.forEach(function(o){void 0===r[o]?l.remove_server_from_method(o,t,e):r[o]=void 0});var s=Object.keys(r);s.forEach(function(o){void 0!==r[o]&&l.add_server_to_method(r[o],t,e)}),u[t].methods=s}function d(e,r){var t;if(void 0===e)t=Object.keys(u);else{var o=l.get_servers_for_method(e);t=Object.keys(o)}return t.map(function(e){var t=helpers.clone_object(u[e].info);return r&&(t.request_subject=o[e]),t}).sort(c)}function c(e,t){var o=0,s=0;return e.machine===r.machine&&(o+=2),t.machine===r.machine&&(s+=2),e.user===r.user&&(o+=1),t.user===r.user&&(s+=1),s-o}function v(e){return u[get_server_id(e)].methods}function a(e){return void 0===e?l.get_methods():s(e)?v(e).map(function(e){return l.get_method(e)}):[]}var u={},l=client_methodstate(e);return{process_presence:t,get_methods:a,get_method_ids:v,get_servers:d,get_method:l.get_method,exists:s,compare_servers:c}};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./agm_client_methodstate":33,"./agm_helpers":35}],35:[function(require,module,exports){
(function (global){
function parameters_stringify(e,r){function t(e,r){var t,a=!1;if(void 0===r){var n;e instanceof Array?(a=!0,n=e[0]):n=e,"string"==typeof n||n instanceof String?t=4:n instanceof Date?t=5:"boolean"==typeof n?t=0:isNaN(n)||(t=2)}else if(isNaN(r)){r=r.split("[]"),2===r.length&&(a=!0),r=r[0];var i={Boolean:0,Integer:1,Double:2,Long:3,String:4,Date:5};if(t=i[r],"DateTime"===r)if(e instanceof Array)for(var o=0;o<e.length;o++)e[o]=e[o].getTime();else e=e.getTime()}return{value:e,type:t,isArray:a}}var a=[];void 0===r&&(r={});for(var n in e){if(void 0===e[n])break;e[n].constructor!==Object?a.push({Name:n,composite:!1,CompositeValue:null,Value:t(e[n],r[n])}):a.push({Name:n,composite:!0,CompositeValue:parameters_stringify(e[n],r[n])})}return a}function parameters_parse(e){function r(e){function r(e,r){return 5===r?new Date(e):e}if(e.isArray){var t=e.type,a=e.value;for(var n in a)a[n]=r(a[n],t);return a}return r(e.value,e.type)}function t(e){var r={0:"Bool",1:"Int",2:"Double",3:"Long",4:"String",5:"DateTime"},t=r[e.type+""];return e.isArray&&(t+="[]"),t}for(var a={},n={},i=0;i<e.length;i++){var o=e[i];o.composite||null!==o.CompositeValue&&void 0!==o.CompositeValue?(a[o.Name]=parameters_parse(o.CompositeValue).arguments,n[o.Name]=parameters_parse(o.CompositeValue).signature):(a[o.Name]=r(o.Value),n[o.Name]=t(o.Value))}return{arguments:a,signature:n}}function signature_stringify(e){if(void 0===e||""===e)return"";try{return e.sort(function(e,r){return e.Name>r.Name?1:e.Name<r.Name?-1:0}).map(function(e){var r="?";e.IsRequired&&(r="");var t="";e.isArray&&(t="[]");var a=datatypes[parseInt(e.Type)];if(void 0===a)throw"Invalid datatype "+e.Type;return a+r+t+" "+e.Name}).join(", ")}catch(r){return""}}function signature_parse(e){return void 0===e||""===e?void 0:e.split(",").map(function(e){var r={},t=e.trim().split(" ");if(2!==t.length)throw"Invalid argument: "+e+".";r.Name=t[1];var a=t[0];r.isArray=!1,-1!==a.indexOf("[]")&&(a=a.replace("[]",""),r.isArray=!0),r.IsRequired=!0,-1!==a.indexOf("?")&&(a=a.replace("?",""),r.IsRequired=!1);var n=datatypes.indexOf(a);if(-1===n)throw"Invalid datatype: "+a+". The accepted datatypes are Int, Double, Long, DateTime, Bool and String";return r.Type=n+"",r})}function signature_parse_friendly(e){return signature_parse(e).reduce(function(e,r){return e[r.Name]={type:datatypes[parseInt(r.Type)],is_array:r.isArray,is_required:r.IsRequired},e},{})}function signature_normalize(e){return signature_stringify(signature_parse(e))}function preprocess_server(e){return{machine:e.MachineName,pid:e.ProcessId,started:e.ProcessStartTime,user:e.UserName,application:e.ApplicationName,environment:e.Environment,region:e.Region,service_name:e.ServiceName,metrics_repository_id:e.MetricsRepositoryId,state:e.State}}function clone_object(e){var r={};for(var t in e)void 0!==e[t]&&""!==e[t]&&0!==e[t]&&(r[t]=e[t]);return r}function preprocess_method(e){var r=e.Method;return{name:r.Name,accepts:r.InputSignature,returns:r.ResultSignature,request_subject:e.MethodRequestSubject,description:r.Description,display_name:r.DisplayName,version:r.Version,object_types:r.ObjectTypeRestrictions}}function save_callback_in(e,r,t,a){if("function"!=typeof a)throw'"'+r+'" must be called with a function as an argument';e[r]=e[r]||[],e[r].push(a),t(a)}function execute_all_with(e,r){"object"==typeof e&&e.forEach(function(e){e(r)})}function get_server_id(e){return void 0===e?void 0:(e.application+e.user).toLowerCase()}function promisify(e,r,t){return"function"!=typeof r&&"function"!=typeof t?e:("function"!=typeof r?r=function(e){void 0!==global.console&&agm.debug===!0&&console.log("Success!")}:"function"!=typeof t&&(t=function(e){void 0!==global.console&&agm.debug===!0&&console.log("An error occurred.")}),void e.then(r,t))}var datatypes=["Bool","Int","Double","Long","String","DateTime"];module.exports={get_server_id:get_server_id,execute_all_with:execute_all_with,save_callback_in:save_callback_in,parameters_stringify:parameters_stringify,parameters_parse:parameters_parse,signature_stringify:signature_stringify,signature_parse:signature_parse,signature_parse_friendly:signature_parse_friendly,signature_normalize:signature_normalize,preprocess_server:preprocess_server,preprocess_method:preprocess_method,clone_object:clone_object,promisify:promisify};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],36:[function(require,module,exports){
(function (global){
var document=global.document||global.process;module.exports=function(e,o){function i(e){return r[e]}function n(e,o){o("req"+s++ +r.ProcessId)}function t(e,o){o("resp"+m++ +r.ProcessId)}function a(){return r}var r={};r.ApplicationName=document.title+Math.floor(1e9*Math.random()),r.ProcessId=Math.floor(1e9*Math.random()),r.ProcessStartTime=(new Date).getTime(),"object"==typeof e&&(void 0!==e.application&&(r.ApplicationName=e.application),r.MachineName=e.machine,r.UserName=e.user,r.Environment=e.environment,r.Region=e.region,r.ServiceName=e.service_name,r.MetricsRepositoryId=e.metrics_repository_id,r.State=1);var c=!1;o.on("Instance",function(e){c||(void 0===r.MachineName&&(r.MachineName=e.MachineName),void 0===r.UserName&&(r.UserName=e.UserName),void 0===r.Environment&&(r.Environment=e.Environment),void 0===r.Region&&(r.Region=e.Region),void 0===r.ServiceName&&(r.ServiceName=e.ServiceName),void 0===r.MetricsRepositoryId&&(r.MetricsRepositoryId=e.MetricsRepositoryId),void 0===r.State&&(r.State=e.State),void 0!==global.console&&void 0!==global.console.table&&agm.debug===!0&&console.log("Received instance with info from Gateway."),c=!0)});var s=0,m=0;return{request_subject:n,response_subject:t,info:a,application:i("ApplicationName"),pid:i("ProcessId"),user:i("UserName"),machine:i("MachineName")}};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],37:[function(require,module,exports){
(function (global){
var Promise=require("es6-promise").Promise,h=require("./agm_helpers");module.exports=function(e){function r(e,r,t){var n={};return"string"==typeof e?(n[r]=e,JSON.stringify(n)):void 0===t?JSON.stringify(e):(n[t]=e,JSON.stringify(n))}function t(e){return JSON.parse(e,function(e,r){if("string"!=typeof r)return r;if(r[0]!==d[0])return r;if(0!==r.indexOf(d))return r;var t=r.substr(m);return new Date(parseFloat(t))})}function n(e){if(e=e||"best","string"==typeof e){if("all"!==e&&"best"!==e)throw new Error('"'+e+'" is not a valid target. Valid targets are "all" and "best".');return{target:e}}return"Array"!==e.constructor.name&&(e=[e]),e=e.map(function(e){return i(e)}),{serverFilter:e}}function i(e){var r={};return Object.keys(e).forEach(function(t){var n=e[t];r[t]=n,"undefined"!=typeof n&&null!==n&&("string"==typeof n?r[t]="^"+e[t]+"$":e[t].constructor===RegExp?r[t]=e[t].source:r[t]=e[t])}),r}var s={register:function(e,t){this.agmFacade.register(r(e,"name"),function(e){var r=t(JSON.parse(e));return JSON.stringify(r)})},unregister:function(e){this.agmFacade.unregister(r(e,"name"))},invoke:function(e,t,i,s,a,o){var d=new Promise(function(i,a){var o,d;o=function(e){var r=JSON.parse(e);i(r)},d=function(e){var r=JSON.parse(e);a(r)},void 0===t&&(t={}),"object"!=typeof t&&a({message:"The method arguments must be an object."}),void 0===s&&(s={});var m=n(m);this.agmFacade.invoke(r(e,"name"),JSON.stringify(t),JSON.stringify(m),JSON.stringify(s),o,d)}.bind(this));return h.promisify(d,a,o)},methodAdded:function(e){this.agmFacade.methodAdded(e)},methodRemoved:function(e){this.agmFacade.methodRemoved(e)},serverAdded:function(e){this.agmFacade.serverAdded(e)},serverRemoved:function(e){this.agmFacade.serverRemoved(e)},serverMethodAdded:function(e){this.agmFacade.serverMethodAdded(e)},serverMethodRemoved:function(e){this.agmFacade.serverMethodRemoved(e)},servers:function(e){var r=this.agmFacade.servers(JSON.stringify(e));return t(r)},methods:function(e){var r=this.agmFacade.methods(JSON.stringify(e));return t(r)},methodsForInstance:function(e){var r=this.agmFacade.methodsForInstance(JSON.stringify(e));return t(r)},subscribe:function(e,r,t,i){var s=new Promise(function(t,i){void 0===r&&(r={}),r.args=JSON.stringify(r.arguments||{}),r.target=n(r.target),this.agmFacade.subscribe2(e,JSON.stringify(r),function(e){t(e)},function(e){i(e)})}.bind(this));return h.promisify(s,t,i)},createStream:function(e,r,t,n){var i=new Promise(function(t,n){"string"==typeof e&&(e={name:e}),r||(r={}),this.agmFacade.createStream2(JSON.stringify(e),r.subscriptionRequestHandler,r.subscriptionAddedHandler,r.subscriptionRemovedHandler,function(e){t(e)},function(e){n(e)})}.bind(this));return h.promisify(i,t,n)}};if(s.version="__VERSION__",void 0!==e&&void 0!==e.metrics){e.metrics.metricsIdentity=e.metrics.identity;var a={metricsIdentity:e.metrics.metricsIdentity,path:e.metrics.path};e.metrics=a}var o=global.htmlContainer.jsAgmFacade;s.instance=o.init(JSON.stringify(e)),s.agmFacade=o;var d=s.agmFacade.jsonValueDatePrefix,m=d.length;return s.create_stream=s.createStream,s.methods_for_instance=s.methodsForInstance,s.method_added=s.methodAdded,s.method_removed=s.methodRemoved,s.server_added=s.serverAdded,s.server_removed=s.serverRemoved,s.server_method_added=s.serverMethodAdded,s.server_method_removed=s.serverMethodRemoved,s};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./agm_helpers":35,"es6-promise":6}],38:[function(require,module,exports){
(function (global){
var helpers=require("./agm_helpers");module.exports=function(e,t,n){function o(e,o){"string"==typeof e&&(e={name:e}),t.request_subject(e,function(t){var r=l(e);r.MethodRequestSubject=t,b.push({method:r,definition:e,the_function:o}),c(),void 0===f&&(f=setInterval(c,n.presence_interval)),v("Registered methods",b.length)})}function r(){return{PublishingInterval:n.hearbeat_interval,Instance:t.info()}}function s(){var e={PublishingInterval:n.presence_interval,Instance:t.info()};return e.MethodDefinitions=b.map(function(e){return e.method}),e}function i(){m=!0}function a(){m=!1}function c(){m&&e.send("ServerPresenceMessage",s())}function u(){m&&e.send("ServerHeartbeatMessage",r())}function l(e){return"string"==typeof e&&(e={name:e}),"number"!=typeof e.version&&(e.version=0),{Method:{Name:e.name,InputSignature:e.accepts,ResultSignature:e.returns,Description:e.description,DisplayName:e.display_name,Version:e.version,ObjectTypeRestrictions:e.object_types}}}function d(e,t){var n=!0;return Object.keys(e).forEach(function(o){e[o]!==t[o]&&(n=!1)}),n}function g(e){"string"==typeof e&&(e={name:e}),b=b.filter(function(t){return!d(e,t.definition)}),v("Registered methods",b.length)}"object"!=typeof n&&(n={},void 0!==global.console&&n.debug===!0&&console.log("Creating an AGM server with default configuration.")),"number"!=typeof n.hearbeat_interval&&(n.hearbeat_interval=5e3),"number"!=typeof n.presence_interval&&(n.presence_interval=1e4);var f,h,v=void 0!==n.metrics?n.metrics.numberMetric.bind(n.metrics):function(){},b=[];void 0===h&&(h=setInterval(u,n.hearbeat_interval));var p=0;e.on("MethodInvocationRequestMessage",function(o){var r;if(b.forEach(function(e){e.method.MethodRequestSubject===o.MethodRequestSubject&&(r=e)}),void 0!==r){void 0!==global.console&&n.debug===!0&&(console.debug("%c<<< receiving MethodInvocationRequestMessage","background-color:hsla(198, 51%, 79%, 0.5)"),console.debug("%c"+JSON.stringify(o),"background-color:hsla(198, 51%, 79%, 0.5)")),v("Invocations count",p++);var s,i;try{s=r.the_function(helpers.parameters_parse(o.Context.Arguments).arguments)}catch(a){i="string"==typeof a?a:"string"==typeof a.message?a.message:null}if(("object"!=typeof s||s.constructor===Array)&&(s={_result:s}),"null"!==o.MethodResponseSubject){var c={MethodRequestSubject:o.MethodRequestSubject,MethodResponseSubject:o.MethodResponseSubject,MethodName:r.method.Method.Name,InvocationId:o.Context.InvocationId,ResultContext:helpers.parameters_stringify(s),Server:t.info(),ResultMessage:i,Status:void 0===i?0:1};e.send("MethodInvocationResultMessage",c),void 0!==global.console&&n.debug===!0&&(console.debug("%c>>> sending MethodInvocationResultMessage","background-color:hsla(118, 51%, 79%, 0.5)"),console.debug("%c"+JSON.stringify(c),"background-color:hsla(118, 51%, 79%, 0.5)"))}}});var m=!0;return{register:o,unregister:g,start:i,stop:a}};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./agm_helpers":35}],39:[function(require,module,exports){
(function (global){
var application=require("./application"),instance=require("./instance"),helpers=require("./helpers");module.exports=global.app_manager=function(n,e){function t(n){"function"==typeof d&&d(helpers.vals(n))}function a(n){n.IsReady?c._trigger_app_event("available",n):c._trigger_app_event("unavailable",n)}function i(n){c._trigger_instance_event("error",n,n.Context.guid)}var r=application(n,function(){return o}),o=instance(n,r),c={applications:r.all,application:r.get_by_id,on_app_added:helpers.add_callback("added").bind(r),on_app_available:helpers.add_callback("available").bind(r),on_app_removed:helpers.add_callback("removed").bind(r),on_app_unavailable:helpers.add_callback("unavailable").bind(r),instances:o.all,on_instance_started:helpers.add_callback("started").bind(o),on_instance_stopped:helpers.add_callback("stopped").bind(o),get_branches:function(e,t){n.invoke("T42.ACS.GetBranches",{},"best",{},function(n){e&&e(helpers.vals(n.returned.Branches))},t)},get_current_branch:function(e,t){n.invoke("T42.ACS.GetCurrentBranch",{},"best",{},function(n){e&&e(n.returned.Branch)},t)},set_current_branch:function(e,t,a){n.invoke("T42.ACS.SetCurrentBranch",{Branch:e},"best",{},t,a)},current_user:function(e,t){n.invoke("T42.ACS.GetUser",{},"best",{},e,t)},get_functional_entitlement:function(e,t,a){n.invoke("T42.ACS.GetFunctionalEntitlement",{Function:e},"best",{},function(n){t&&t(n.returned.Entitlement)},a)},can_i:function(e,t,a){n.invoke("T42.ACS.CanI",{Function:e},"best",{},t,a)},exit:function(){n.invoke("T42.ACS.Shutdown",{},"all",{},function(n){console.log(n)},function(n){console.log(n)})},_trigger_app_event:r._trigger,_trigger_instance_event:o._trigger};c.on_instance_started(function(n){function t(n){var e=n.returned[Object.keys(n.returned)[0]],t=glue.windows._from_event(e.windowName,a,e.url,e.windowId);c._trigger_instance_event("window_added",t,i)}if(n.application){c._trigger_app_event("instance_started",n,n.application.name);var a;if(e){var i=n.context&&n.context.guid?n.context.guid:n.id;a=n.application.configuration.container.split(".")[1],glue.agm.invoke("T42.Wnd.FindById",{windowId:n.id},{application:n.application.configuration.container},{},t)}}}),c.on_instance_stopped(function(n){if(n.application){c._trigger_app_event("instance_stopped",n,n.application.name);var e=n.context&&n.context.guid?n.context.guid:n.id;c._trigger_instance_event("window_removed",{},e)}}),c.on_app_removed(function(n){n.instances.forEach(function(n){var e=n.context&&n.context.guid?n.context.guid:n.id;c._trigger_instance_event("stopped",{},e)})});var d;if(c.on_branches_changed=function(n){d=n},n&&n.subscribe){c.agm=n;var p=[{event:"OnApplicationAdded",trigger:"added",on:r},{event:"OnApplicationRemoved",trigger:"removed",on:r},{event:"OnApplicationChanged",trigger:"changed",on:r},{event:"OnApplicationStarted",trigger:"started",on:o},{event:"OnApplicationStopped",trigger:"stopped",on:o},{event:"OnApplicationAgmServerReady",trigger:"agm_ready",on:o},{event:"OnApplicationReady",func:a},{event:"OnBranchesModified",func:t},{event:"OnApplicationStartFailed",raw_func:i}];n.subscribe("T42.ACS.OnEvent",{target:"all"}).then(function(n){n.onData(streamData);var e=streamData.data;p.forEach(function(n){var t=e[n.event];if(t){if(void 0!==n.raw_func)return void n.raw_func(t);helpers.vals(t).forEach(function(e){void 0!==n.on?n.on._trigger(n.trigger,e):n.func(e)})}})})}return c.version="__VERSION__",c},global.tick42=global.tick42||{},global.tick42.app_manager=global.app_manager;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./application":40,"./helpers":42,"./instance":43}],40:[function(require,module,exports){
var event_manager=require("./event_manager"),helpers=require("./helpers");module.exports=function(n,t){function e(n,t){return t.name=n.Name,t.title=n.Title,t.version=n.Version,t.instances=[],t.configuration={},t.configuration.auto_start=n.AutoStart,t.configuration.caption=n.Caption,t.configuration.hidden=n.IsHidden,t.configuration.container=n.ApplicationName,t.configuration.allow_multiple=n.AllowMultiple,t.available=n.IsReady||!1,t.icon=n.Icon,t}var a=helpers.add_callbacks({start:function(e,a,i){return e=e||{},e.guid=e.guid||Math.floor(1e7*Math.random()),n&&n.invoke("T42.ACS.StartApplication",{Name:this.name,Context:e},"best",{},function(n){},i),t()._trigger("create",{Context:e})}},["added","removed","available","unavailable","instance_started","instance_stopped","changed"],"on_");return event_manager({create:function(n){return e(n,Object.create(a))},update:e,init_event:"added",exit_event:"removed",id_field:"Name",callbacks:{available:function(){this.available=!0},changed:function(n){this.icon=n.Icon,this.title=n.Title,this.configuration.caption=n.Caption},unavailable:function(){this.available=!1},instance_started:function(n){this.instances.push(n)},instance_stopped:function(n){this.instances=this.instances.filter(function(t){return t!==n})}}})};

},{"./event_manager":41,"./helpers":42}],41:[function(require,module,exports){
function exec_callbacks(e,c,t){void 0!==c&&c.forEach(function(c){c.call(e,t)})}function init_object(e){return e.callbacks={},e.active=!1,e}var helpers=require("./helpers");module.exports=function(e){var c={},t={};return{all:function(){return helpers.vals(c)},get_by_id:function(e){return c[e]},_trigger:function(i,a,l){if(l=l||("function"==typeof e.id_field?e.id_field(a):a[e.id_field]),void 0!==c[l]||i===e.init_event||i===e.create_event){var n=c[l]=c[l]||init_object(e.create(a));if(i===e.init_event){if(n.active)return;n.active=!0,e.update(a,n)}else if(i===e.exit_event)n.active=!1;else if(i===e.create_event)return n;return void 0!==e.callbacks[i]&&e.callbacks[i].call(n,a),exec_callbacks(void 0,t[i],n),exec_callbacks(n,n.callbacks[i],a),i===e.exit_event&&(n.callbacks={}),n}},callbacks:t}};

},{"./helpers":42}],42:[function(require,module,exports){
function noop(){}function exec_if(n){return function(t,e){n(t)&&e.call(t)}}exports.add_callbacks=function(n,t,e){return t.forEach(function(t){"string"==typeof t&&(t={name:t,trigger_when:noop}),n[e+t.name]=exports.add_callback(t.name,exec_if(t.trigger_when))}),n},exports.add_callback=function(n,t){return function(e){var c=this.callbacks;return void 0===c[n]?c[n]=[e]:c[n].push(e),"function"==typeof t&&t(this,e),this}},exports.vals=function(n){return Object.keys(n).reduce(function(t,e){return t.push(n[e]),t},[])};

},{}],43:[function(require,module,exports){
function convert_agm_instance(e){return{machine:e.machineName,user:e.userName,environment:e.environment,application:e.applicationName}}var event_manager=require("./event_manager"),helpers=require("./helpers");module.exports=function(e,n){function t(e,t){return t.id=e.Id,t.application=n.get_by_id(e.Name),t.context=e.Context,t}var i=helpers.add_callbacks({stop:function(n,t,i){e.invoke("T42.ACS.StopApplication",{Name:this.application.name,Id:this.id},"best",{},function(e){console.log(e)},i)},activate:function(n,t,i){e.invoke("T42.ACS.ActivateApplication",{Name:this.application.name,Id:this.id},"best",{},function(e){console.log(e)},i)}},[{name:"window_added",trigger_when:function(e){return e.active&&void 0!==e.main_window}},{name:"window_removed",trigger_when:function(e){return void 0===e.main_window}},{name:"started",trigger_when:function(e){return void 0!==e.id&&e.active}},{name:"stopped",trigger_when:function(e){return void 0!==e.id&&!e.active}},{name:"agm_ready",trigger_when:function(e){return e.active&&void 0!==e.agm}},{name:"error",trigger_when:function(e){return void 0!==e.error}}],"on_");return event_manager({create:function(e){return t(e,Object.create(i))},update:t,create_event:"create",init_event:"started",exit_event:"stopped",id_field:function(e){return void 0!==e.Context&&void 0!==e.Context.guid?e.Context.guid:e.Id},callbacks:{agm_ready:function(e){var n=Object.keys(e.AgmServers)[0];this.agm=convert_agm_instance(e.AgmServers[n])},error:function(e){this.error=e},window_added:function(e){this.main_window=e,this.windows=this.windows||[],this.windows.push(e)},window_removed:function(){this.main_window=void 0,this.windows=[]}}})};

},{"./event_manager":41,"./helpers":42}],44:[function(require,module,exports){
"use strict";var _=require("./util"),Model=require("./model"),helpers=require("./helpers"),events={connect:"connect",disconnect:"disconnect",update:"update",status:"status"},EventBus=function(){var e,n=function(n,t,i,o){if(_.isFunction(i)){var c={type:n,once:t,callback:i,scope:o},u=e[n];return"undefined"==typeof u&&(u=e[n]=[]),c.id=u.push(c)-1,c}},t=function(){var n=[].slice.call(arguments),t=n.splice(0,1)[0],o=e[t];"undefined"==typeof o&&(o=e[t]=[]),o.forEach(function(e){if(e){try{e.callback.apply(e.scope,n)}catch(t){_.warn("Exception during execution of callback",e,n,t)}e.once&&i(e)}})},i=function(n){var t=e[n.type];"undefined"!=typeof t&&delete t[n.id]},o=function(t){if("undefined"==typeof t.id)return n(t.type,t.once,t.callback,t.scope);var i=e[t.type];return"undefined"==typeof i&&(i=e[t.type]=[]),i[t.id]=t,t},c=function(){"undefined"!=typeof e&&Object.keys(e).forEach(function(n){var t=e[n];"undefined"!=typeof t&&t.forEach(function(e){delete e.id})}),e={}};return c(),{on:n,emit:t,off:i,resume:o,reset:c}},AppConfig=function(){var e,n,t,i,o=!0,c=new EventBus,u=new Model(c),r=require("./props")(u.root),f=this,a=function(){"undefined"!=typeof i&&clearInterval(i)};f.init=function(e){e=e||{};var t="object"==typeof e.identity&&Object.keys(e.identity).length>0;if(t&&(f.identity=e.identity),o=e.defaultListen||o,!f.identity)throw new TypeError("identity must be non empty object.");u.separator=e.defaultSeparator||u.separator,f.schema=e.schema||f.schema||"ApplicationConfiguration",n=_.isFunction(e.gateway)?e.gateway:function(){return"undefined"==typeof e.gateway&&(e.gateway={}),"undefined"==typeof e.gateway.instance&&(e.gateway.instance=_.uuid()),require("./gateway")(e.gateway)}},f.connect=function(r,s,d){a();var p;arguments.length>0&&(_.isFunction(r)&&(s=r,d=s,r=o),p=c.on(events.connect,!0,s,d));var y;if(f.identity)if(e||(e=n()),r){var l=!1;t=e.connect(f.schema,f.identity,!0,function(e,n,t){"undefined"!=typeof n&&u.applySnapshot(n),"undefined"!=typeof t&&u.applyUpdates(t),l||(l=!0,c.emit(events.connect,e))},function(n,o){var c=8;o.code===c&&(i=setInterval(function(){e.disconnect(t),t=e.connect(f.schema,f.identity,!1,function(e,n){u.applySnapshot(n,!1)})},2e3))})}else t=e.connect(f.schema,f.identity,!1,function(e,n,t){"undefined"==typeof e&&u.applySnapshot(n),c.emit(events.connect,e)},function(e,n){c.emit(events.status,e,n)});else y="identity is not specified. did you forget to call init()?";if(y)throw setTimeout(c.emit,0,events.connect,y),new Error(y);return p},f.props=function(e,n){return r.props(e,n)},f.modify=function(e,n,t){"object"==typeof e&&(e=[e]);var i=c.on(events.update,!0,n,t);return i},f.onConnect=function(e,n){return c.on(events.connect,!1,e,n)},f.onDisconnect=function(e,n){return c.on(events.disconnect,!1,e,n)},f.off=function(e){e&&c.off(e)},f.on=function(e){e&&c.resume(e)},f.disconnect=function(n,i){_.isFunction(n)&&c.on(events.disconnect,!0,n,i),a(),"undefined"!=typeof e?(e.disconnect(t,function(e){c.emit(events.disconnect,e)}),e=void 0):c.emit(events.disconnect,"not connected")}};AppConfig.prototype.identityEqual=helpers.identityEqual,AppConfig.prototype.identityToString=helpers.identityToString,module.exports=function(){return new AppConfig};

},{"./gateway":45,"./helpers":46,"./model":47,"./props":48,"./util":49}],45:[function(require,module,exports){
"use strict";var gatewayConnection=require("tick42-gateway-connection"),helpers=require("./helpers"),identityToString=helpers.identityToString,PRODUCT="appconfig",GatewayTransport=function(e){function n(e){var n=s[e.instance];n&&n(e.error,e.status)}function t(e){var n=e.schema,t=o[n];if("undefined"!=typeof t){var i=identityToString(e.identity,!0),a=t[i];"undefined"!=typeof a&&a.forEach(function(n){n&&n(e.error,e.snapshot,e.updates)})}}function i(){"undefined"==typeof a&&(a="undefined"!=typeof e.connection?e.connection:gatewayConnection(e.settings,e.custom_connection))}var a,o={},s={};e=e||{};var r,d,c=function(c,f,y,p,u){i();var T=o[c];"undefined"==typeof T&&(T=o[c]={});var g=identityToString(f,!0),h=T[g];"undefined"==typeof h&&(h=T[g]=[]);var l,v;l=y?p:function(e,n,t){p(e,n,t),delete h[v]},v=h.push(l)-1,"undefined"==typeof r&&(r=a.on(PRODUCT,GatewayTransport.MessageType.DATA,function(e){t(e)}));var C=e.instance;s[C]=u,"undefined"==typeof d&&(d=a.on(PRODUCT,GatewayTransport.MessageType.STATUS,function(e){n(e)}));var O={schema:c,identity:f,instance:C,listen:y};return a.send(PRODUCT,GatewayTransport.MessageType.CONNECT,O),{schema:c,identity:f,listen:y,handler:p,index:v}},f=function(e,n,t){i(),a.send(PRODUCT,GatewayTransport.MessageType.MODIFY,t)},y=function(n){var t=o[n.schema];if("undefined"!=typeof t){var i=identityToString(n.identity,!0),c=t[i];if("undefined"!=typeof c){var f=c[n.index];if("undefined"!=typeof f){var y={schema:n.schema,identity:n.identity,instance:e.instance};a.send(GatewayTransport.MessageType.DISCONNECT,y),delete c[n.index]}0===c.length&&delete t[i]}0===Object.keys(t).length&&delete o[n.schema]}0===Object.keys(o).length&&"undefined"!=typeof r&&a.off(r),delete s[n.instance],0===Object.keys(s).length&&"undefined"!=typeof d&&a.off(d)};return{connect:c,modify:f,disconnect:y}};GatewayTransport.MessageType={CONNECT:"connect",DISCONNECT:"disconnect",MODIFY:"modify",DATA:"data",STATUS:"status"},module.exports=GatewayTransport;

},{"./helpers":46,"tick42-gateway-connection":50}],46:[function(require,module,exports){
"use strict";function escapeIdentityText(t){return"string"==typeof t?t.replace(/[\\]/g,"\\\\").replace(/[:]/g,"\\:"):t}function identityToString(t,e,n,i){if("undefined"==typeof t)return null;n=n||"/";var r=Object.keys(t);return"function"==typeof i?r.sort(i):r.sort(),r.map(function(n){return e?escapeIdentityText(n)+":"+escapeIdentityText(t[n]):t[n]}).join(n)}function identityEqual(t,e){return identityToString(t,!0)===identityToString(e,!0)}function flatten(t,e,n){e=e||".";var i=n?n+e:"",r={};return Object.keys(t).forEach(function(n){if(0===n.indexOf(i)){var u,a=n.substring(i.length),l=r,o=a.split(e);for(u=0;u<o.length-1;u++)l[o[u]]||(l[o[u]]={}),l=l[o[u]];l[o[u]]=t[n].value}}),r}function propEqual(t,e){if(t.value!==e.value)return!1;for(var n=0;n<t.underlying.length;n++){var i=t.underlying[n],r=e.underlying[n]||{};if(i.value!==r.value||!identityEqual(i.parent,r.parent))return!1}return!0}module.exports={flatten:flatten,propEqual:propEqual,identityToString:identityToString,identityEqual:identityEqual};

},{}],47:[function(require,module,exports){
"use strict";function updateTypeForPath(e){var t="update";return""!==e&&(t=t+"|"+e),t}function cloneUpdateForPath(e,t){var o={type:e.type,name:e.name.substring(t.length)};switch(e.type){case UpdateType.Changed:o.oldValue=e.oldValue;case UpdateType.Added:o.value=e.value;break;case UpdateType.Removed:}return o}function applyUpdatesAndEmitEvents(e,t,o){var p=Object.keys(e.views),a={"":t};p.length>0&&(p.length>1&&p.sort(),t.forEach(function(e){for(var t=0;t<p.length&&0!==e.name.indexOf(p[t]);p++);var o=p[t];"undefined"!=typeof o&&a[o].push(cloneUpdateForPath(e,o))}));var n=Object.keys(a);n.length>1&&n.sort(),n.forEach(function(t){var p=""===t?e.root:e.views[t].model;o&&(p.props={}),a[t].forEach(function(e){switch(e.type){case UpdateType.Added:case UpdateType.Changed:p.props[e.name]=e.value;break;case UpdateType.Removed:delete p.props[e.name]}})}),n.forEach(function(p){var a=updateTypeForPath(p);e.bus.emit(a,o,t)})}function toUpdates(e,t){t=t||{};var o=[],p=Object.keys(e);return Object.keys(t).forEach(function(a){var n={};if("undefined"==typeof e[a])n.type=UpdateType.Added;else{propEqual(e[a],t[a])||(n.type=UpdateType.Changed,n.oldValue=e[a]);for(var r=0;r<p.length&&p[r]!==a;p++);"undefined"!=typeof p[r]&&p.splice(r,1)}n.type&&(n.value=t[a],n.name=a,o.push(n))}),p.forEach(function(e){o.push({type:UpdateType.Removed,name:e})}),o}var propEqual=require("./helpers").propEqual,UpdateType={Added:"Added",Changed:"Changed",Removed:"Removed"},Model=function(e,t){this.bus=e,this.root=new ViewModel(this,"",t||"."),this.views={}},ViewModel=function(e,t,o){var p=this;p.model=e,p.props={},p.separator=o||e.separator,p.path=t};ViewModel.prototype.getViewModel=function(e,t){var o=this.path+e+(t?t:"."),p=this.model;if(""===o)return p.root;if(!p.views[o]){var a="";Object.keys(p.views).forEach(function(e){if(0===o.indexOf(e)){a.length<e.length&&(a=e);for(var t=p.views[e].subviews,n=0;n<t.length;n++)if(t[n].indexOf(o))return void t.splice(n,0,o);t.push(o)}});var n=new ViewModel(p,o,t),r=""===a?p.root.props:p.views[a].model.props;Object.keys(r).forEach(function(e){var t=r[e];if(0===t.name.indexOf(o)){var p=t.name.substring(o.length);n.props[p]=t}}),p.views[o]={subviews:[],model:n}}return p.views[o].model},ViewModel.prototype.on=function(e,t){return this.model.on(this.path,e,t)},Model.prototype.on=function(e,t,o){var p=updateTypeForPath(e);return this.bus.on(p,!1,t,o)},Model.prototype.applySnapshot=function(e,t){t="undefined"==typeof t?!0:t;var o=toUpdates(t?{}:this.root.props,e.props);applyUpdatesAndEmitEvents(this,o,t)},Model.prototype.applyUpdates=function(e){applyUpdatesAndEmitEvents(this,e,!1)},module.exports=Model;

},{"./helpers":46}],48:[function(require,module,exports){
"use strict";var flatten=require("./helpers").flatten,Props=function(r){var e=function(e){return r.props[e]},o=function(e){return"undefined"==typeof e||"undefined"==typeof r.props[e]?flatten(r.props,r.separator,e):r.props[e].value},n=function(e,o){return e=e||"",""===e?s:(o=o||r.separator,new Props(r.getViewModel(e,o)))},t=function(e,o){Object.keys(r.props).forEach(function(n){e.call(o,r.props[n])})},p=function(e,o){r.on(e,o)},s={prop:e,val:o,props:n,forEach:t,onUpdate:p};return s};module.exports=Props;

},{"./helpers":46}],49:[function(require,module,exports){
"use strict";var uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var o=16*Math.random()|0,e="x"===n?o:3&o|8;return e.toString(16)})},isFunction=function(n){return void 0===n||null===n?!1:"function"==typeof n},isString=function(n){return"string"==typeof n},levels={debug:"debug",info:"info",warn:"warn",error:"error"},log=function(n,o){if(console){var e=console[n];if(isFunction(e)){var i=new Date;[].splice.call(o,0,0,i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()),e.apply(console,o)}}},info=function(){log(levels.info,arguments)},warn=function(){log(levels.warn,arguments)},debug=function(){log(levels.debug,arguments)};module.exports={uuid:uuid,isFunction:isFunction,isString:isString,log:log,warn:warn,info:info,debug:debug};

},{}],50:[function(require,module,exports){
(function (global){
var connection=function(n,e){function o(n){return n.send=function(n,o,i){e.publish({type:o,message:i})},e.subscribe(n._handle_message),n}n=n||{};var i={},t=0,r={_handle_message:function(n){var e=i[n.type];void 0!==e&&Object.keys(e).forEach(function(o){var i=e[o];void 0!==i&&i(n.message)})},on:function(n,e,o){void 0===i[e]&&(i[e]={});var r=t++;return i[e][r]=o,{type:e,id:r}},off:function(n){delete i[n.type][n.id]},connected:function(n){n()},disconnected:function(){},version:"__VERSION__"};if(void 0!==n.websocket_url)return require("./ws")(r,n);if(void 0!==n.http_url)return require("./http")(r,n);if(void 0!==global.fin)return require("./fin")(r,n);if(void 0!==e)return o(r,n);if(void 0!==global.htmlContainer)return require("./cont")(r,n);throw"No connection. Make sure you are running the application from OpenFin, or Tick42 HTML Container or fill the 'connection.websocket_url' property."};void 0===global.tick42&&(global.tick42={}),global.tick42.connection=connection,module.exports=connection;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./cont":51,"./fin":52,"./http":53,"./ws":54}],51:[function(require,module,exports){
(function (global){
module.exports=function(n){var o=Math.floor(1e10*Math.random()).toString();return n.send=function(n,a,e){"metrics"===n?global.htmlContainer.metricsFacade.send(a,JSON.stringify(e)):"log"===n?global.htmlContainer.loggingFacade.send(a,JSON.stringify(e)):"appconfig"==n&&global.htmlContainer.appConfigFacade.send(a,JSON.stringify(e),o)},void 0!==global.htmlContainer.appConfigFacade&&global.htmlContainer.appConfigFacade.initConnection(o,function(o){return n._handle_message(JSON.parse(o))}),global.connections=global.connections||{},global.connections["connection"+o]=n._handle_message,n};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],52:[function(require,module,exports){
(function (global){
module.exports=function(e,n){return void 0!==global.console&&n.debug===!0&&console.log("Attemping to connect to Gateway via OpenFin Inter Application Bus."),e.send=function(e,n,o){fin.desktop.InterApplicationBus.publish("AGM",{type:n,message:o})},fin.desktop.InterApplicationBus.subscribe("*","AGM",e._handle_message),void 0!==global.console&&n.debug===!0&&console.log("Connected to OpenFin transport."),e};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],53:[function(require,module,exports){
(function (global){
module.exports=function(e,n){function t(e){void 0===global.console||n.debug!==!0&&n.trace!==!0||console.log(e)}function o(e){void 0!==global.console&&n.trace===!0&&console.log(e)}function a(e,n,i,s){var u=e;0!==i&&(u=e+"?sequence="+i+"&no-cache="+(new Date).getTime());var c=r("GET",u,function(){0===i&&t("Connected to Gateway on "+e),o("Response from '"+u+"' is "+c.responseText);var r=JSON.parse(c.responseText),l=r.nextSequence;s(r.data),setTimeout(function(){a(e,n,l,s)},n)});c.onerror=function(t){console.log("Error polling data from http server '"+u+"' - "+t),setTimeout(function(){a(e,n,i,s)},n)},o("Sending GET to '"+u+"'"),c.send()}function i(e,n){var t=r("POST",e);o("Sending POST to '"+e+"' : "+n),t.send(n)}function r(e,n,t){var o=new XMLHttpRequest;return"withCredentials"in o?(o.open(e,n,!0),"undefined"!=typeof t&&(o.onreadystatechange=function(){4==o.readyState&&200==o.status&&t()})):"undefined"!=typeof XDomainRequest?(o=new XDomainRequest,o.open(e,n),"undefined"!=typeof t&&(o.onload=t)):o=null,o}var s=n.http_url,u=n.http_interval_ms;return u||(u=1e3),t("Attemping to connect to Gateway via HTTP with url '"+s+"' and polling interval "+u+" ms"),a(s,u,0,function(n){for(var t=0;t<n.length;t++)e._handle_message(n[t])}),e.send=function(e,n,t,o){var a=JSON.stringify({type:n,message:t,id:o});i(s,a)},e};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],54:[function(require,module,exports){
(function (global){
module.exports=function(e,n){function o(){void 0!==global.console&&n.debug===!0&&console.log("Attemping to connect to Gateway via WebSocket.");var o=new c(n.websocket_url);return o.onclose=function(e){"function"==typeof n.disconnected&&n.disconnected(n.websocket_url,e),t=!1},o.onopen=function(){"function"==typeof n.connected&&n.connected(n.websocket_url),void 0!==global.console&&n.debug===!0&&console.log("Connected to WS URL "+n.websocket_url),t=!0},o.onmessage=function(n){e._handle_message(JSON.parse(n.data))},o}var t=!1,c=require("detect-node")?require("ws"):global.WebSocket,s=o();return e.send=function(e,n,t,c){1===s.readyState?s.send(JSON.stringify({type:n,message:t,id:c})):0!==s.readyState&&(s=o())},e.websocket_url=function(e){n.websocket_url=e,s.close(),s=o()},e.connected=function(e){t&&e(n.websocket_url),n.connected=e},e.disconnected=function(e){n.disconnected=e},e};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"detect-node":55,"ws":56}],55:[function(require,module,exports){
(function (global){
module.exports=!1;try{module.exports="[object process]"===Object.prototype.toString.call(global.process)}catch(e){}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],56:[function(require,module,exports){
function ws(e,o,t){var b;return b=o?new WebSocket(e,o):new WebSocket(e)}var global=function(){return this}(),WebSocket=global.WebSocket||global.MozWebSocket;module.exports=WebSocket?ws:null,WebSocket&&(ws.prototype=WebSocket.prototype);

},{}],57:[function(require,module,exports){
function serializePath(e){return 0===e.length?"":e.join(".")}function getLevel(e,n){return void 0!==e[n]?e[n]:void 0!==e.parent?getLevel(e.parent,n):void 0}function messageToTable(e,n){var t=getAllKeys(n),i=n.map(function(e){return t.map(function(n){return e[n]})}),o=asciiTable.factory({title:e,heading:t,rows:i});return o.toString()}function getAllKeys(e){var n=[];return e.forEach(function(e){Object.keys(e).forEach(function(e){-1===n.indexOf(e)&&n.push(e)})}),n}function logger(e){function n(e,n,i){var o=Object.create(s);return o.name=e,o.path=n,o.subloggers=[],o.parent=i,void 0!==i&&(i.subloggers.push(o),i[o.name]=o,void 0!==i.metricSystem&&o.metricsLevel("warn",i.metricSystem.subSystem(o.name))),levels.forEach(function(e){o[e]=function(n){t(o,e,n)}}),o.off=function(){},o.version="__VERSION__",o}function t(e,n,t){var o=l(e);if("error"===n){var s=new Error;s.stack&&(t=t+"\n"+s.stack.split("\n").slice(3).join("\n"))}c(getLevel(e,"_consoleLevel"),n)&&console[n](o+": "+t),c(getLevel(e,"_publishLevel"),n)&&i.send("log","LogMessage",{instance:r,level:levels.indexOf(n),logger:o,message:t}),c(getLevel(e,"_metricLevel"),n)&&void 0!==e.metricSystem&&e.metricSystem.objectMetric("LogMessage",{Time:new Date,Logger:o,Level:n,Message:t})}"object"!=typeof e.connection&&(e.connection={}),e.connection.debug=e.debug;var i=isConnection(e.connection)?e.connection:tick42Connection(e.connection),o=["system","service","instance"],r=o.map(function(n){var t=e.identity[n];if("string"!=typeof t)throw'Please specify "'+n+'" in your identity';return t}).join("/"),s={subLogger:function(e){var t=this.subloggers.filter(function(n){return n.name===e})[0];if(void 0!==t)return t;Object.keys(this).forEach(function(n){if(n===e)throw"This sub logger name is not allowed."}),Object.keys(s).forEach(function(n){if(n===e)throw"This sub logger name is not allowed."});var i=this.path.slice(0);return i.push(this.name),n(e,i,this)},publishLevel:function(e){return null!==e&&void 0!==e&&(this._publishLevel=e),getLevel(this,"_publishLevel")},consoleLevel:function(e){return null!==e&&void 0!==e&&(this._consoleLevel=e),getLevel(this,"_consoleLevel")},metricsLevel:function(e,n){if(null!==e&&void 0!==e&&(this._metricLevel=e),void 0!==n){if("object"!=typeof n||"function"!=typeof n.objectMetric)throw"Please specify metric system ";this.metricSystem=n}},table:function(e){if(!Array.isArray(e))throw"The message must be in an array";var n=l(this);c(getLevel(this,"_consoleLevel"),"info")&&(console.info(n+":"),console.table(e)),c(getLevel(this,"_publishLevel"),"info")&&i.send("log","LogMessage",{instance:r,level:levels.indexOf("info"),logger:n,message:messageToTable(n,e)})},log:function(e,n){t(this,n||"info",e)}},c=function(e,n){return!e||levels.indexOf(e)<=levels.indexOf(n)},l=function(e){var n=e.path.slice();return n.push(e.name),"["+serializePath(n)+"]"},a=n("main",[],void 0);return a.publishLevel("warn"),a.consoleLevel("info"),a.metricsLevel("warn"),a}var asciiTable=require("ascii-table"),tick42Connection=require("tick42-gateway-connection"),levels=["trace","debug","info","warn","error","off"],isConnection=function(e){return"object"==typeof e&&"function"==typeof e.send&&"function"==typeof e.on};void 0===window.tick42&&(window.tick42={}),window.tick42.log=logger,module.exports=logger;

},{"ascii-table":3,"tick42-gateway-connection":50}],58:[function(require,module,exports){
var objectMetric_1=require("../metrics/objectMetric"),stringMetric_1=require("../metrics/stringMetric"),numberMetric_1=require("../metrics/numberMetric"),timestampMetric_1=require("../metrics/timestampMetric"),MetricSerializer=function(){function e(){}return e.metricToMessage=function(t){var r=e._getMetricDefinition(t.name,t.value,t.path,t.type,t.description,t.period,t.resolution);return{id:t.id,instance:t.repo.instance,definition:r,value:e._serializeValue(t.value)}},e._getMetricDefinition=function(t,r,i,n,c,a,u){var s={name:t,description:c,type:n?n:e._getTypeFromValue(r),path:i,resolution:a,period:u};return s.type===objectMetric_1.ObjectMetric.type&&(s.Composite=Object.keys(r).reduce(function(t,n){var c=r[n];return t.push(e._getMetricDefinition(n,c,i)),t},[])),s},e._serializeValue=function(t){return t&&t.constructor===Date?{value:{type:this._valueTypes.indexOf("date"),value:t.valueOf(),isArray:!1}}:"object"==typeof t?{CompositeValue:Object.keys(t).reduce(function(r,i){var n=e._serializeValue(t[i]);return n.InnerMetricName=i,r.push(n),r},[])}:{value:{type:this._valueTypes.indexOf(typeof t),value:t,isArray:!1}}},e._getTypeFromValue=function(e){var t=e.constructor===Date?"timestamp":typeof e;switch(t){case"string":return stringMetric_1.StringMetric.type;case"number":return numberMetric_1.NumberMetric.type;case"timestamp":return timestampMetric_1.TimestampMetric.type;case"object":return objectMetric_1.ObjectMetric.type}return 0},e._valueTypes=["boolean","int","number","long","string","date","object"],e}();exports.MetricSerializer=MetricSerializer;

},{"../metrics/numberMetric":63,"../metrics/objectMetric":64,"../metrics/stringMetric":67,"../metrics/timestampMetric":69}],59:[function(require,module,exports){
var metricSerializer_1=require("./metricSerializer"),MetricsBridge=function(){function e(e,t){var i=this;this._repo=e,this._connection=t,t.on("metrics","MetricsSnapshotRequest",function(t){t.Instance===e.instance&&i.sendFull(i._repo)})}return e.prototype.sendFull=function(e){var t=e.root;t&&0!=t.subSystems.length&&this.sendFullSystem(t)},e.prototype.sendFullSystem=function(e){var t=this;this.createSystem(e),e.subSystems.forEach(function(e){t.sendFullSystem(e)}),e.metrics.forEach(function(e){t.createMetric(e)})},e.prototype.createMetric=function(e){this._send("CreateMetric",metricSerializer_1.MetricSerializer.metricToMessage(e))},e.prototype.updateMetric=function(e){this._send("UpdateMetric",metricSerializer_1.MetricSerializer.metricToMessage(e))},e.prototype.createSystem=function(e){void 0!==e.parent&&this._send("CreateMetricSystem",{id:e.id,instance:e.repo.instance,definition:{name:e.name,description:e.description,path:e.path}})},e.prototype.updateSystem=function(e,t){this._send("UpdateMetricSystem",{id:e.id,instance:e.repo.instance,state:t})},e.prototype.heartbeat=function(e,t){this._send("HeartbeatMetrics",{publishingInterval:t,instance:e.instance})},e.prototype._send=function(e,t){this._connection.send("metrics",e,t)},e}();exports.MetricsBridge=MetricsBridge;

},{"./metricSerializer":58}],60:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},metric_1=require("./metric"),AddressMetric=function(t){function e(r,i,n,c){t.call(this,r,i,n,e.type,c||"")}return __extends(e,t),e.type=8,e}(metric_1.Metric);exports.AddressMetric=AddressMetric;

},{"./metric":62}],61:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},metric_1=require("./metric"),CountMetric=function(t){function e(n,r,i,o){t.call(this,n,r,i,e.type,o||0)}return __extends(e,t),e.prototype.increment=function(){this.incrementBy(1)},e.prototype.decrement=function(){this.decrementBy(1)},e.prototype.incrementBy=function(t){this.update((this.value||0)+t)},e.prototype.decrementBy=function(t){this.update((this.value||0)-t)},e.type=3,e}(metric_1.Metric);exports.CountMetric=CountMetric;

},{"./metric":62}],62:[function(require,module,exports){
var Metric=function(){function t(t,i,e,s,h){this.name=t.name,this.description=t.description,this.system=i,this.repo=i.repo,this.id=i.path+"/"+this.name,this.value=h,this.type=s,this.path=i.path.slice(0),this.path.push(i.name),this._transport=e,this._transport.createMetric(this)}return t.prototype.update=function(t){this.value=t,this._transport.updateMetric(this)},t.type=0,t}();exports.Metric=Metric;

},{}],63:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},metric_1=require("./metric"),NumberMetric=function(t){function e(r,n,i,o){t.call(this,r,n,i,e.type,o||0)}return __extends(e,t),e.prototype.increment=function(){this.incrementBy(1)},e.prototype.decrement=function(){this.decrementBy(1)},e.prototype.incrementBy=function(t){this.update((this.value||0)+t)},e.prototype.decrementBy=function(t){this.update((this.value||0)-t)},e.type=2,e}(metric_1.Metric);exports.NumberMetric=NumberMetric;

},{"./metric":62}],64:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var c in e)e.hasOwnProperty(c)&&(t[c]=e[c]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},metric_1=require("./metric"),ObjectMetric=function(t){function e(r,c,o,i){t.call(this,r,c,o,e.type,i)}return __extends(e,t),e.prototype.update=function(e){t.prototype.update.call(this,e)},e.type=11,e}(metric_1.Metric);exports.ObjectMetric=ObjectMetric;

},{"./metric":62}],65:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},metric_1=require("./metric"),RateMetric=function(t){function e(r,i,o,n){this.period=r.period,this.resolution=r.resolution,t.call(this,r,i,o,e.type,n||0)}return __extends(e,t),e.type=4,e}(metric_1.Metric);exports.RateMetric=RateMetric;

},{"./metric":62}],66:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},metric_1=require("./metric"),StatisticsMetric=function(t){function e(i,r,o,s){this.period=i.period,this.resolution=i.resolution,t.call(this,i,r,o,e.type,s||0)}return __extends(e,t),e.type=6,e}(metric_1.Metric);exports.StatisticsMetric=StatisticsMetric;

},{"./metric":62}],67:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},metric_1=require("./metric"),StringMetric=function(t){function e(r,i,n,c){t.call(this,r,i,n,e.type,c||"")}return __extends(e,t),e.type=1,e}(metric_1.Metric);exports.StringMetric=StringMetric;

},{"./metric":62}],68:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},metric_1=require("./metric"),TimespanMetric=function(t){function e(r,i,n,o){t.call(this,r,i,n,e.type,o||!1)}return __extends(e,t),e.prototype.start=function(){this.update(!0)},e.prototype.stop=function(){this.update(!1)},e.type=10,e}(metric_1.Metric);exports.TimespanMetric=TimespanMetric;

},{"./metric":62}],69:[function(require,module,exports){
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},metric_1=require("./metric"),TimestampMetric=function(t){function e(r,i,n,o){t.call(this,r,i,n,e.type,o||new Date)}return __extends(e,t),e.prototype.now=function(){this.update(new Date)},e.type=7,e}(metric_1.Metric);exports.TimestampMetric=TimestampMetric;

},{"./metric":62}],70:[function(require,module,exports){
var system_1=require("./system"),transport_1=require("./bridge/transport"),Repository=function(){function t(t){this._config=t,this._transport=new transport_1.MetricsBridge(this,t.connection),this.instance=t.identity.system+"/"+t.identity.service+"/"+t.identity.instance,this.identity=t.identity,this._startHeartbeating(),this.root=new system_1.System("",this,this._transport),this._initSystemMetrics(this.root,t.clickStream||void 0===t.clickStream)}return t.prototype._startHeartbeating=function(){var t=this;this._transport.heartbeat(this,this._config.settings.heartbeatInterval),setInterval(function(){t._transport.heartbeat(t,t._config.settings.heartbeatInterval)},this._config.settings.heartbeatInterval)},t.prototype._initSystemMetrics=function(t,e){if(navigator&&t.stringMetric("UserAgent",navigator.userAgent),e&&document){var i=t.subSystem("ClickStream"),r=function(t){t.target&&i.objectMetric("LastBrowserEvent",{type:"click",timestamp:new Date,target:{className:t.target?t.target.className:"",id:t.target.id,type:"<"+t.target.tagName.toLowerCase()+">",href:t.target.href||""}})};i.objectMetric("Page",{title:document.title,page:window.location.href}),document.addEventListener?document.addEventListener("click",r):document.attachEvent("onclick",r)}},t}();exports.Repository=Repository;

},{"./bridge/transport":59,"./system":71}],71:[function(require,module,exports){
var numberMetric_1=require("./metrics/numberMetric"),timespanMetric_1=require("./metrics/timespanMetric"),stringMetric_1=require("./metrics/stringMetric"),addressMetric_1=require("./metrics/addressMetric"),objectMetric_1=require("./metrics/objectMetric"),timestampMetric_1=require("./metrics/timestampMetric"),countMetric_1=require("./metrics/countMetric"),statisticsMetric_1=require("./metrics/statisticsMetric"),rateMetric_1=require("./metrics/rateMetric"),System=function(){function t(t,e,r,i,n){this.metrics=[],this.subSystems=[],this.name=t,this.description=n||"",this.repo=e,this.parent=i,this._transport=r,this.path=this._buildPath(this.parent),this.id=(this.path.length>0?this.path.join("/")+"/":"")+this.name,this.identity=e.identity,this.root=e.root,this._transport.createSystem(this)}return t.prototype.subSystem=function(e,r){if(!e||0===e.length)throw new Error("name is required");var i=this.subSystems.filter(function(t){return t.name===e});if(i.length>0)return i[0];var n=new t(e,this.repo,this._transport,this,r);return this.subSystems.push(n),n},t.prototype.setState=function(t,e){this._transport.updateSystem(this,{state:t,description:e})},t.prototype.stringMetric=function(t,e){var r=this;return this._getOrCreateMetric(t,stringMetric_1.StringMetric.type,e,function(t){return new stringMetric_1.StringMetric(t,r,r._transport,e)})},t.prototype.numberMetric=function(t,e){var r=this;return this._getOrCreateMetric(t,numberMetric_1.NumberMetric.type,e,function(t){return new numberMetric_1.NumberMetric(t,r,r._transport,e)})},t.prototype.countMetric=function(t,e){var r=this;return this._getOrCreateMetric(t,countMetric_1.CountMetric.type,e,function(t){return new countMetric_1.CountMetric(t,r,r._transport,e)})},t.prototype.addressMetric=function(t,e){var r=this;return this._getOrCreateMetric(t,addressMetric_1.AddressMetric.type,e,function(t){return new addressMetric_1.AddressMetric(t,r,r._transport,e)})},t.prototype.objectMetric=function(t,e){var r=this;return this._getOrCreateMetric(t,objectMetric_1.ObjectMetric.type,e,function(t){return new objectMetric_1.ObjectMetric(t,r,r._transport,e)})},t.prototype.timespanMetric=function(t,e){var r=this;return this._getOrCreateMetric(t,timespanMetric_1.TimespanMetric.type,e,function(t){return new timespanMetric_1.TimespanMetric(t,r,r._transport,e)})},t.prototype.timestampMetric=function(t,e){var r=this;return this._getOrCreateMetric(t,timestampMetric_1.TimestampMetric.type,e,function(t){return new timestampMetric_1.TimestampMetric(t,r,r._transport,e)})},t.prototype.rateMetric=function(t,e){var r=this;return this._getOrCreateMetric(t,rateMetric_1.RateMetric.type,e,function(t){return new rateMetric_1.RateMetric(t,r,r._transport,e)})},t.prototype.statiticsMetric=function(t,e){var r=this;return this._getOrCreateMetric(t,statisticsMetric_1.StatisticsMetric.type,e,function(t){return new statisticsMetric_1.StatisticsMetric(t,r,r._transport,e)})},t.prototype._unionToMetricDef=function(t){var e;if(e="string"==typeof t?{name:t}:t,void 0===e.name)throw new Error("Metric name is required.");return e},t.prototype._getOrCreateMetric=function(t,e,r,i){var n=this._unionToMetricDef(t),s=this.metrics.filter(function(t){return t.name===n.name});if(s.length>0){var c=s[0];if(c.type!==e)throw new Error("A metric named "+n.name+" is already defined with different type");return"undefined"!=typeof r&&c.update(r),c}var o=i(n);return this.metrics.push(o),o},t.prototype._buildPath=function(t){if(!t||!t.parent)return[];var e=this._buildPath(t.parent);return e.push(t.name),e},t}();exports.System=System;

},{"./metrics/addressMetric":60,"./metrics/countMetric":61,"./metrics/numberMetric":63,"./metrics/objectMetric":64,"./metrics/rateMetric":65,"./metrics/statisticsMetric":66,"./metrics/stringMetric":67,"./metrics/timespanMetric":68,"./metrics/timestampMetric":69}],72:[function(require,module,exports){
var repository_1=require("./core/repository"),tick42_gateway_connection_1=require("tick42-gateway-connection"),windowAsAny=window;windowAsAny.tick42=windowAsAny.tick42||{},windowAsAny.tick42.metrics=windowAsAny.tick42.metrics||function(i){if(!i.identity)throw new Error("Identity missing from metrics configuration");if(!i.identity.service||"string"!=typeof i.identity.service)throw new Error("Service missing or invalid in metrics identity configuration");if(!i.identity.system||"string"!=typeof i.identity.system)throw new Error("System missing or invalid in metrics identity configuration");if(!i.identity.instance||"string"!=typeof i.identity.instance)throw new Error("Instancemissing or invalid in metrics identity configuration");i.settings=i.settings||{},i.settings.heartbeatInterval=i.settings.heartbeatInterval||15e3,"object"!=typeof i.connection&&(i.connection={}),("object"!=typeof i.connection||"function"!=typeof i.connection.send||"function"!=typeof i.connection.on)&&(i.connection=tick42_gateway_connection_1.connection(i.connection));var n=new repository_1.Repository(i);return n.version=n.root.version="__VERSION__",n.root},module.exports=windowAsAny.tick42.metrics;

},{"./core/repository":70,"tick42-gateway-connection":50}],73:[function(require,module,exports){
function add_callback(n,i){return function(e){var t=this.callbacks;void 0===t[n]?t[n]=[e]:t[n].push(e),"function"==typeof i&&i(this,e)}}function exec_callbacks(n,i){void 0!==n&&n.forEach(function(n){n(i)})}function eq(n,i){return function(e){return void 0===n||void 0===i||e[n]===i}}function vals(n){return Object.keys(n).reduce(function(i,e){return i.push(n[e]),i},[])}function map_obj(n,i){return Object.keys(n).reduce(function(e,t){return e[t]=i(n[t]),e},{})}function container_filter(n){var i="HtmlContainer.";return(void 0!==htmlContainer.env.env||void 0!==htmlContainer.env.region)&&-1===n.indexOf(htmlContainer.env.env)&&-1===n.indexOf(htmlContainer.env.region)&&(i+=htmlContainer.env.env+"-"+htmlContainer.env.region+"."),i+=n,{application:i}}function container_from_filter(n){return n.application.match(/HtmlContainer\.(.*?)$/)[1]}function invoke_agm_success_callback(n,i){"function"==typeof n&&n(i)}function invoke_agm_error_callback(n,i){"function"==typeof n&&n(i.message)}function get_callbacks(n,i){return void 0!==n.containers_callbacks[i]?n.all_containers_callbacks.concat(n.containers_callbacks[i]):n.all_containers_callbacks}function put_callbacks(n,i,e){void 0===e?n.all_containers_callbacks.push(i):void 0===n.containers_callbacks[e]?n.containers_callbacks[e]=[i]:n.containers_callbacks[e].push(i)}var windows=function(n){function i(n,i){var t=i+"."+n.windowName,o=a[t];if(void 0===o){if(!(get_callbacks(c,i).length>0||get_callbacks(r,i).length>0))return;o=e(n.windowName,i,n.url,n.windowId)}return void 0===o.id&&(o.id=n.windowId,exec_callbacks(o.callbacks.on_available,o)),o.url!==n.url&&(o.url=n.url,exec_callbacks(o.callbacks.on_url_changed,n.url)),"Created"===n.state&&exec_callbacks(get_callbacks(c,i),o),"Closed"===n.state?(exec_callbacks(get_callbacks(r,i),o),exec_callbacks(o.callbacks.on_close),o.id=void 0,void(o.callbacks={})):void 0}function e(n,i,e,t){if(i=i||(void 0!==window.htmlContainer?htmlContainer.containerName:void 0),void 0===i)throw"Please specify a container.";var o=i+"."+n,c=a[o];if(void 0!==c)return c.opened()||(c.url=e),c;var r=Object.create(l);return r.name=n,r.container=i,r.url=e,r.id=t,r.callbacks={},r.application=o,a[o]=r,r}function t(e,t,o){function a(n){var a=vals(n.returned)[0];void 0===a?"function"==typeof o&&o("we cound not open/find this window"):(a.state="Attached",i(a,e.container),invoke_agm_success_callback(t,e))}return void 0===e.id?n.invoke("T42.Wnd.FindByName",{windowName:e.name},container_filter(e.container),{},a,o):invoke_agm_success_callback(t,e),e}function o(i){return function(e,t,o){function a(){invoke_agm_success_callback(e,c)}if(void 0===this.url)return void("function"==typeof t&&t("Cannot execute a command on a closed window."));o=o||{},o.windowId=this.id,n.invoke(i,o,container_filter(this.container),{},a,t);var c=this;return this}}n.subscribe&&n.subscribe("T42.Wnd.WindowStateChanged",{target:"all"}).then(function(n){n.onData(function(n){i(n.data,container_from_filter(n.server))})});var a={},c={containers_callbacks:{},all_containers_callbacks:[]},r={containers_callbacks:{},all_containers_callbacks:[]},l={open:function(i,e,o,a){function c(n){void 0!==n.returned&&(l.id=n.returned.id),invoke_agm_success_callback(o,l)}function r(n){"function"==typeof a&&a(n),t(l)}var l=this;i=i||{},e=e||{};var d=e.isSticky;delete e.isSticky;var s=e.stickyGroup;return delete e.stickyGroup,n.invoke("T42.Html.CreateWindow",{windowName:l.name,url:l.url,top:i.top,left:i.left,width:i.width,height:i.height,isSticky:d,stickyGroup:s,windowStyleAttributes:JSON.stringify(e)},container_filter(l.container),{},c,r),l},set_style:function(n,i,e){return o("T42.Wnd.SetWindowStyle").call(this,i,e,{windowStyleAttributes:JSON.stringify(n)})},opened:function(){return void 0!==this.id},on_available:add_callback("on_available",function(n,i){n.opened()&&i(n)}),close:o("T42.Wnd.Close"),on_close:add_callback("on_close"),navigate:function(n,i,e){return o("T42.Html.OpenUrl").call(this,i,e,{url:n})},on_url_changed:add_callback("on_url_changed"),focus:o("T42.Wnd.Activate"),set_title:function(i,e,t){function o(){invoke_agm_success_callback(e,this)}function a(n){invoke_agm_error_callback(t,n)}n.invoke("T42.Wnd.SetWindowTitle",{windowId:this.id,title:i},container_filter(this.container),{},o,a)},get_details:function(i,e){function t(n){invoke_agm_success_callback(i,n.returned[a])}function o(n){invoke_agm_error_callback(e,n)}var a=this.id;n.invoke("T42.Wnd.FindById",{windowId:this.id},container_filter(this.container),{},t,o)},move_resize:function(n,i,e){return o("T42.Wnd.resizeAndMove").call(this,i,e,n)},maximize:o("T42.Wnd.Maximize"),restore:o("T42.Wnd.Restore"),minimize:o("T42.Wnd.Minimize"),maximize_restore:o("T42.Wnd.MaximizeOrRestoreDown")},d={my:function(){var n=window.htmlContainer;return void 0===n?void 0:e(n.browserWindowName,n.containerName,window.location.href,n.windowId)},open:function(n,i,t,o,a,c,r){return e(n,t,i).open(o,a,c,r)},find:function(n,i,o,a){return t(e(n,i),o,a)},_from_event:e,list:function(i,t,o){function a(n){if(void 0===n.returned)return void t([]);var o=vals(n.returned).map(function(n){return e(n.windowName,i,n.url,n.windowId)});t(o)}function c(n){invoke_agm_error_callback(o,n)}"function"==typeof t&&n.invoke("T42.Wnd.ListWindows",{},container_filter(i),{wait_for_method_timeout:15e3},a,c)},window_added:function(n,i){put_callbacks(c,n,i),d.container_added(function(e){(void 0===i||i===e)&&d.list(e,function(i){i.forEach(function(i){n(i)})},function(n){console.log("Unable to load existing windows. "+n.message)})})},window_removed:function(n,i){put_callbacks(r,n,i)},container_added:function(i){n.server_added(function(n){-1!==n.application.indexOf("HtmlContainer.")&&invoke_agm_success_callback(i,container_from_filter(n))})},container_removed:function(i){n.server_removed(function(n){-1!==n.application.indexOf("HtmlContainer.")&&invoke_agm_success_callback(i,container_from_filter(n))})}};return d.version="__VERSION__",d};void 0===window.tick42&&(window.tick42={}),window.tick42.windows=windows,module.exports=windows;

},{}]},{},[1])
//# sourceMappingURL=tick42-glue-2.3.0.min.map
